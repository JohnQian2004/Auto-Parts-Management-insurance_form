<div class="container-fluid">
    <section class="content-header">
        <div class="container-fluid">
            <div class="row mb-2">
                <div class="col-sm-6">
                    <div class="modal fade" id="staticBackdropLive" data-bs-backdrop="static" data-bs-keyboard="false"
                        tabindex="-1" aria-labelledby="staticBackdropLiveLabel" aria-hidden="true"
                        style="display: none;">
                        <div class="modal-dialog modal-lg">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h1 class="modal-title fs-5" id="staticBackdropLiveLabel">Repair Order</h1>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div id="print-content">
                                        <div id="componentID" class="container-fluid">
                                            <div class="container-fluid">
                                                <div id="componentID2" class="container-fluid">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                                            <div class="d-flex align-items-center gap-3"> <img
                                                                    [src]="company.iconString" class="img-fluid rounded"
                                                                    alt="Company Logo" width="120" />
                                                                <h3 class="fs-20 fw-300 line-height-150">
                                                                    {{this.company.name}}, Inc.<br />
                                                                    <span class="fs-13"
                                                                        [innerHtml]="company.slogan"></span>
                                                                </h3>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-3">
                                                            <hr />
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4">
                                                            <p class="fs-15 d-block my-3">Repair Order</p>
                                                            <ng-container *ngFor="let employee of this.employees">
                                                                <ng-container
                                                                    *ngIf="employee.id==this.currentEmplyeeId">
                                                                    <h3 class="fs-20 fw-700 my-3">{{employee.firstName}}
                                                                        {{employee.lastName}}</h3>
                                                                    <p class="fs-15 d-block my-3"> {{employee.phone}}
                                                                    </p>
                                                                    <br>
                                                                    <ng-container
                                                                        *ngFor="let role of this.employeeRoles">
                                                                        <ng-container *ngIf="role.id==employee.roleId">
                                                                            <p class="fs-15 d-block my-3">{{role.name}}
                                                                            </p>
                                                                            <br>
                                                                        </ng-container>
                                                                    </ng-container>
                                                                </ng-container>
                                                            </ng-container>

                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4 text-end">
                                                            <p class="fs-15 d-block my-3">Repair Order</p>
                                                            <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                                                <div [innerHtml]="company.slogan"></div>
                                                            </h3>
                                                            <p class="fs-15 d-block my-3 line-height-150">
                                                                {{formatPhoneNumber(this.company.phone)}} -
                                                                {{this.company.street}}, {{this.company.city}},
                                                                {{this.company.zip}},
                                                                {{this.company.state}}.</p>
                                                            <p class="fs-15 d-block my-3 fw-700">
                                                                {{formatPhoneNumber(this.company.phone)}}</p>
                                                            <p class="fs-15 d-block mb-3 mt-4 text-primary-abs"
                                                                style="word-break: break-word;">
                                                                {{this.company.email}}</p>
                                                            <p class="fs-15 d-block my-3 fw-700">Repair Order for
                                                                Vehicle #{{vehicleJob.id}}</p>
                                                            <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                                                    class="text-danger">{{vehicleJob.targetDate| date:
                                                                    'MM/dd/yyyy'}}</span></p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped">
                                                                <thead class="bg-navy">
                                                                    <tr class="bg-navy">
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-white py-3">
                                                                            Item</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-white py-3">
                                                                            Info</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Vehicle</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.year}}
                                                                            {{vehicleJob.make}}
                                                                            {{vehicleJob.model}}
                                                                            {{vehicleJob.color}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3">
                                                                            <strong>Specification</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3">
                                                                            {{vehicleJob.description}}</td>
                                                                    </tr>
                                                                    <tr *ngIf="vehicleJob.vin != ''">
                                                                        <td class="fs-13 py-3"><strong>VIN</strong></td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.vin}} </td>
                                                                    </tr>
                                                                    <tr *ngIf="vehicleJob.plate != ''">
                                                                        <td class="fs-13 py-3"><strong>License
                                                                                Plate</strong></td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.plate}}
                                                                        </td>
                                                                    </tr>
                                                                    <tr *ngIf="vehicleJob.priorDamage != ''">
                                                                        <td class="fs-13 py-3"><strong>Prior
                                                                                Damanages</strong></td>
                                                                        <td class="fs-13 py-3">
                                                                            {{vehicleJob.priorDamage}} </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Job Type</strong>
                                                                        </td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td class="fs-13 py-3"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}} </td>
                                                                        </ng-container>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Work
                                                                                Request</strong></td>
                                                                        <td class="fs-13 py-3">
                                                                            {{vehicleJob.workRequest}} </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row" *ngIf="vehicleJob.jobs.length >0">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped">
                                                                <thead class="bg-navy">
                                                                    <tr class="bg-navy">
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-white py-3">
                                                                            #</th>
                                                                        <th
                                                                            class="bg-navy mw-130 fs-14 text-white py-3">
                                                                            Job Item</th>
                                                                        <th
                                                                            class="bg-navy mw-130 fs-14 text-white py-3">
                                                                            Instructions</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-white py-3">
                                                                            Deadline</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-white py-3">
                                                                            Status</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr
                                                                        *ngFor="let job of vehicleJob.jobs; let i=index">
                                                                        <td class="fs-13 py-3"> {{job.id}}</td>
                                                                        <td class="fs-13 py-3"> {{job.name}}</td>
                                                                        <td class="fs-13 py-3"> {{job.notes}}</td>
                                                                        <td class="fs-13 py-3"> {{job.targetDate | date:
                                                                            'MM/dd/yyyy'}}</td>
                                                                        <ng-container *ngIf="job.status ==0">
                                                                            <td class="fs-13 py-3"> Not Completed</td>
                                                                        </ng-container>
                                                                        <ng-container *ngIf="job.status ==1">
                                                                            <td class="fs-13 py-3"> Completed</td>
                                                                        </ng-container>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                                                    <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="print-content-job">
                                        <div id="componentID" class="container-fluid">
                                            <div class="container-fluid">
                                                <div id="componentID2" class="container-fluid">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3"></div>

                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Printed
                                                                on Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-3">
                                                            <hr />
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4">
                                                            <p class="fs-15 d-block my-3"> </p>


                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4 text-end">
                                                            <p class="fs-15 d-block my-3"></p>
                                                            <h2 class="fs-17, fw-700">JOB ORDER # {{this.job.id}}</h2>


                                                            <p class="fs-15 d-block my-3">Issued By:
                                                                <strong>{{user.firstName}}
                                                                    {{user.lastName}}</strong> <br>
                                                            </p>

                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12 table-responsive tt">
                                                            <table class="table table-bordered"
                                                                style="border:2px solid">

                                                                <tbody>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-17 py-3"><strong>Vehicle</strong>
                                                                        </td>
                                                                        <td class="fs-17 py-3 ">
                                                                            <strong>{{vehicleJob.year}}
                                                                                {{vehicleJob.make}}
                                                                                {{vehicleJob.model}}
                                                                                {{vehicleJob.color}} </strong>
                                                                        </td>
                                                                    </tr>

                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Job Type</strong>
                                                                        </td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td class="fs-13 py-3"
                                                                                *ngIf="jobRequestType.id == vehicleJob.jobRequestType">
                                                                                {{jobRequestType.name}} </td>
                                                                        </ng-container>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Work
                                                                                Request</strong></td>
                                                                        <td class="fs-13 py-3">
                                                                            {{vehicleJob.workRequest}} </td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Vehicle Due
                                                                                day</strong></td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.targetDate
                                                                            | date: 'MM/dd/yyyy'}} </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row" *ngIf="this.job.id> 0">
                                                        <div class="col-12 mt-3">
                                                            <hr />
                                                        </div>
                                                        <div class="col-12 table-responsive tt">
                                                            <table class="table table-bordered"
                                                                style="border:2px solid">

                                                                <tbody>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Job # </strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3 fw-700"> {{this.job.id}}
                                                                        </td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Job Name</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{this.job.name}}</td>
                                                                    </tr>
                                                                    <tr style="border:2px solid; min-height: 100px;">
                                                                        <td class="fs-13 py-3">
                                                                            <strong>Description</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{this.job.notes}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"
                                                                            style="background-color:lightgray">
                                                                            <strong>Technician</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"><ng-container
                                                                                *ngFor="let employee of this.employees">
                                                                                <ng-container
                                                                                    *ngIf="employee.id==job.employeeId">
                                                                                    <ng-container
                                                                                        *ngFor="let role of this.employeeRoles">
                                                                                        <ng-container
                                                                                            *ngIf="role.id==employee.roleId">
                                                                                            <strong
                                                                                                class="capitalized">{{employee.firstName}}
                                                                                                {{employee.lastName}}</strong>
                                                                                            <small>
                                                                                                {{role.name}}</small>
                                                                                            <br>
                                                                                        </ng-container>
                                                                                    </ng-container>
                                                                                </ng-container>
                                                                            </ng-container></td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Hours</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{this.job.hours}}</td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Value $</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{this.job.price}}</td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Start
                                                                                Date</strong></td>
                                                                        <td class="fs-13 py-3"> {{this.job.startDate |
                                                                            date: 'MM/dd/yyyy'}}</td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Target</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{this.job.targetDate |
                                                                            date: 'MM/dd/yyyy'}}</td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Finish
                                                                                Date</strong></td>
                                                                        <td class="fs-13 py-3"> {{this.job.endDate |
                                                                            date: 'MM/dd/yyyy'}}</td>
                                                                    </tr>
                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Status</strong>
                                                                        </td>
                                                                        <ng-container *ngIf="this.job.status ==0">
                                                                            <td class="fs-13 py-3"> Not Completed</td>
                                                                        </ng-container>
                                                                        <ng-container *ngIf="this.job.status ==1">
                                                                            <td class="fs-13 py-3"> Completed</td>
                                                                        </ng-container>
                                                                    </tr>

                                                                    <tr style="border:2px solid">
                                                                        <td class="fs-13 py-3"><strong>Authorized By
                                                                            </strong></td>
                                                                        <td class="fs-13 py-3"></td>
                                                                    </tr>

                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                                                    <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="print-content-jobs">
                                        <div id="componentID" class="container-fluid">
                                            <div class="container-fluid">
                                                <div id="componentID2" class="container-fluid">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                                            <div class="d-flex align-items-center gap-3"> <img
                                                                    [src]="company.iconString" class="img-fluid rounded"
                                                                    alt="Company Logo" width="120" />
                                                                <h3 class="fs-20 fw-300 line-height-150">
                                                                    {{this.company.name}}, Inc.<br />
                                                                    <span class="fs-13"
                                                                        [innerHtml]="company.slogan"></span>
                                                                </h3>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-3">
                                                            <hr />
                                                        </div>
                                                        <!-- <div class="col-md-6 col-sm-6 mb-4">
                                <p class="fs-15 d-block my-3">Repair Order</p>
                                <ng-container *ngFor="let employee of this.employees">
                                  <ng-container *ngIf="employee.id==this.currentEmplyeeId">
                                    <h3 class="fs-20 fw-700 my-3">{{employee.firstName}} {{employee.lastName}}</h3>
                                    <p class="fs-15 d-block my-3"> {{employee.phone}}</p>
                                    <br>
                                    <ng-container *ngFor="let role of this.employeeRoles">
                                      <ng-container *ngIf="role.id==employee.roleId">
                                        <p class="fs-15 d-block my-3">{{role.name}} </p>
                                        <br>
                                      </ng-container>
                                    </ng-container>
                                  </ng-container>
                                </ng-container>
  
                              </div> -->
                                                        <!-- <div class="col-md-6 col-sm-6 mb-4 text-end">
                                <p class="fs-15 d-block my-3">Repair Order [{{this.job.id}}]</p>
                                <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                  <div [innerHtml]="company.slogan"></div>
                                </h3>
                                <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                  {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                  {{this.company.state}}.</p>
                                <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                                <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                  {{this.company.email}}</p>
                                <p class="fs-15 d-block my-3 fw-700">Repair Order for Vehicle #{{vehicleJob.id}}</p>
                                <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                    class="text-danger">{{vehicleJob.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                              </div> -->
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12 table-responsive tt">
                                                            <table class="table table-striped">
                                                                <thead class="bg-navy">
                                                                    <tr class="bg-navy">
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            Item</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            Info</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Vehicle</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.year}}
                                                                            {{vehicleJob.make}}
                                                                            {{vehicleJob.model}}
                                                                            {{vehicleJob.color}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3">
                                                                            <strong>Specification</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3">
                                                                            {{vehicleJob.description}}</td>
                                                                    </tr>
                                                                    <tr *ngIf="vehicleJob.vin != ''">
                                                                        <td class="fs-13 py-3"><strong>VIN</strong></td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.vin}} </td>
                                                                    </tr>
                                                                    <tr *ngIf="vehicleJob.plate != ''">
                                                                        <td class="fs-13 py-3"><strong>License
                                                                                Plate</strong></td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.plate}}
                                                                        </td>
                                                                    </tr>
                                                                    <tr *ngIf="vehicleJob.priorDamage != ''">
                                                                        <td class="fs-13 py-3"><strong>Prior
                                                                                Damanages</strong></td>
                                                                        <td class="fs-13 py-3">
                                                                            {{vehicleJob.priorDamage}} </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Job Type</strong>
                                                                        </td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td class="fs-13 py-3"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}} </td>
                                                                        </ng-container>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Work
                                                                                Request</strong></td>
                                                                        <td class="fs-13 py-3">
                                                                            {{vehicleJob.workRequest}} </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Since</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{vehicleJob.createdAt |
                                                                            date}} </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row" *ngIf="this.jobs.length >0">
                                                        <div class="col-12 table-responsive tt">
                                                            <table class="table table-striped">
                                                                <thead class="bg-navy">
                                                                    <tr class="bg-navy">
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            #</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            Job Item</th>
                                                                        <th
                                                                            class="bg-navy mw-130 fs-14 text-black py-3">
                                                                            Instructions</th>
                                                                        <th
                                                                            class="bg-navy mw-130 fs-14 text-black py-3">
                                                                            Assigned To</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            Hours</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            Value $</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            Deadline</th>
                                                                        <th
                                                                            class="bg-navy mw-100 fs-14 text-black py-3">
                                                                            Status</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr *ngFor="let job of this.jobs; let i=index">
                                                                        <td class="fs-13 py-3"> {{job.id}}</td>
                                                                        <td class="fs-13 py-3"> {{job.name}}</td>
                                                                        <td class="fs-13 py-3"> {{job.notes}}</td>
                                                                        <ng-container
                                                                            *ngFor="let employee of this.employees">
                                                                            <ng-container
                                                                                *ngIf="employee.id==job.employeeId">
                                                                                <ng-container
                                                                                    *ngFor="let role of this.employeeRoles">
                                                                                    <ng-container
                                                                                        *ngIf="role.id==employee.roleId">
                                                                                        <td class="fs-13 py-3">
                                                                                            {{employee.firstName}}
                                                                                            {{employee.lastName}} <br>
                                                                                            <small>{{role.name}}</small>
                                                                                        </td>
                                                                                    </ng-container>
                                                                                </ng-container>
                                                                            </ng-container>
                                                                        </ng-container>
                                                                        <td class="fs-13 py-3"><span
                                                                                *ngIf="job.hours > 0">{{job.hours}}</span>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{job.price}}</td>
                                                                        <td class="fs-13 py-3"> {{job.targetDate | date:
                                                                            'MM/dd/yyyy'}}</td>
                                                                        <ng-container *ngIf="job.status ==0">
                                                                            <td class="fs-13 py-3"> Not Completed</td>
                                                                        </ng-container>
                                                                        <ng-container *ngIf="job.status ==1">
                                                                            <td class="fs-13 py-3"> Completed</td>
                                                                        </ng-container>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                                                    <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="print-content-estimate" style="background-color:white">
                                        <div id="componentID" class="container-fluid" style="background-color:white">
                                            <div class="container-fluid" style="background-color:white">
                                                <div id="componentID2" class="container-fluid"
                                                    style="background-color:white">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                                            <div class="d-flex align-items-center gap-3"> <img
                                                                    [src]="company.iconString" class="img-fluid rounded"
                                                                    alt="Company Logo" width="120" />
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-dark pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-1">
                                                            <hr />
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-2">
                                                            <p class="fs-15 d-block my-1">Estimate To</p>
                                                            <h3 class="fs-20 fw-700 my-1">
                                                                {{this.vehicle.customer.title}}
                                                                {{this.vehicle.customer.firstName}}
                                                                {{this.vehicle.customer.lastName}} </h3>
                                                            <p class="fs-17 d-block my-1 line-height-150">
                                                                {{this.vehicle.customer.street}},
                                                                {{this.vehicle.customer.city}}, <br />
                                                                {{this.vehicle.customer.zip}},
                                                                {{this.vehicle.customer.state}}.</p>
                                                            <p class="fs-15 d-block my-1">
                                                                {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-2 text-end">
                                                            <p class="fs-15 d-block my-1">Estimate From</p>
                                                            <h3 class="fs-20 fw-700 my-1">{{this.company.name}}<br />
                                                            </h3>
                                                            <p class="fs-17 d-block my-1 line-height-150">
                                                                {{this.company.street}}, {{this.company.city}},
                                                                {{this.company.zip}},
                                                                {{this.company.state}}.</p>
                                                            <p class="fs-17 d-block my-1">
                                                                {{formatPhoneNumber(this.company.phone)}}</p>

                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped">
                                                                <tbody>
                                                                    <tr>
                                                                        <td class="fs-15"><strong>Vehicle</strong></td>
                                                                        <td class="fs-15"> {{vehicle.year}}
                                                                            {{vehicle.make}}
                                                                            {{vehicle.model}}
                                                                            {{vehicle.color}}</td>
                                                                        <td class="fs-15"><strong>Job Type</strong></td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td class="fs-15"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}} </td>
                                                                        </ng-container>

                                                                        <td class="fs-15"><strong>Mileage Out</strong>
                                                                        </td>
                                                                        <td class="fs-15"> {{vehicle.miles}}</td>
                                                                    </tr>

                                                                    <tr>
                                                                        <td class="fs-15"><strong>Work Request</strong>
                                                                        </td>
                                                                        <td class="fs-15" colspan="5">
                                                                            {{vehicle.workRequest}} </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row" *ngIf="claims.length >0">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped w-100">
                                                                <thead>
                                                                    <tr class="bg-white">
                                                                        <th class="mw-50 fs-14 fw-700 text-black py-3">
                                                                            #</th>

                                                                        <th class="mw-150 fs-14 fw-700 text-black py-3">
                                                                            Description</th>
                                                                        <th class="mw-150 fs-14 fw-700 text-black py-3">
                                                                            Type</th>
                                                                        <th class="mw-80 fs-14 fw-700 text-black py-3">
                                                                            Quantity</th>
                                                                        <th class="mw-80 fs-14 fw-700 text-black py-3">
                                                                            Amount</th>

                                                                        <th class="mw-80 fs-14 fw-700 text-black py-3">
                                                                            Subtotal</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr *ngFor="let claim of claims; let i=index">
                                                                        <td class="fs-13 py-3">{{i +1}}</td>


                                                                        <td class="fs-13 py-3"> {{claim.notes}}</td>
                                                                        <td class="fs-13 py-3">
                                                                            <ng-container
                                                                                *ngFor="let itemType of this.itemTypes">
                                                                                <ng-container
                                                                                    *ngIf="itemType.id == claim.itemType">
                                                                                    <span>{{itemType.name}}</span>
                                                                                </ng-container>
                                                                            </ng-container>
                                                                        </td>
                                                                        <td class="fs-13 py-3">{{claim.quantity }}</td>
                                                                        <td class="fs-13 py-3">${{claim.amount }}</td>

                                                                        <td class="fs-13 py-3">
                                                                            ${{getClaimSubTotal(claim) }}</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-lg-6 col-md-8 col-sm-8">
                                                            <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                                                        class="text-danger">{{currentDate|
                                                                        date}}</span></small> </div>
                                                            <ng-container
                                                                *ngFor="let paymentMethod of this.paymentMethods">
                                                                <p class="lead"
                                                                    *ngIf="paymentMethod.id==vehicle.paymentMethod">
                                                                    Paid By
                                                                    {{paymentMethod.name}} </p>
                                                            </ng-container>
                                                        </div>
                                                        <div class="col-lg-3 col-md-12 hide-sm"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4">
                                                            <ul>
                                                                <li class="d-flex justify-content-between my-4"><strong
                                                                        class="fs-18">Subtotal:</strong>
                                                                    <p class="fs-18 text-black opacity-75">
                                                                        ${{getSubtotalClaims()}}</p>
                                                                </li>
                                                                <li class="d-flex justify-content-between my-4"><strong
                                                                        class="fs-18">Tax
                                                                        ({{company.taxRate
                                                                        *100}}%):</strong>
                                                                    <p class="fs-15 text-black opacity-75">
                                                                        ${{getTaxClaim() }}</p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between my-4 fw-700 text-black">
                                                                    <strong class="fs-18 fw-700">Total Estimates:
                                                                    </strong>
                                                                    <p class="fs-18 fw-700">${{getTotalClaims()}}</p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between my-4 fw-700 text-black">
                                                                    <strong class="fs-18 fw-700">Total Payments:
                                                                    </strong>
                                                                    <p class="fs-18 fw-700">${{getTotalPayments()}}</p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between my-4 fw-700 text-black">
                                                                    <strong class="fs-18 fw-700">Balance: </strong>
                                                                    <p class="fs-18 fw-700">${{getTotalBalance()}}</p>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                        <div class="col-12 mt-5">
                                                            <div [innerHtml]="warrantyText"></div>
                                                            <br>
                                                            <div [innerHtml]="disclaimerText"></div>
                                                            <div class="ps-3 pe-3 pb-3 pt-5">
                                                                <div
                                                                    class="d-flex align-items-end justify-content-between">
                                                                    <div class="d-flex gap-2">
                                                                        <p>Signature</p>
                                                                        <span>_________________________________</span>
                                                                    </div>
                                                                    <div class="d-flex gap-2 mt-30-mob">
                                                                        <p>Date</p>
                                                                        <span>_________________________________</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="print-ai-estimate" style="background-color:white">
                                        <div id="componentID" class="container-fluid" style="background-color:white">
                                            <div class="container-fluid" style="background-color:white">
                                                <div id="componentID2" class="container-fluid"
                                                    style="background-color:white">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                                            <div class="d-flex align-items-center gap-3"> <img
                                                                    [src]="company.iconString" class="img-fluid rounded"
                                                                    alt="Company Logo" width="120" />
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-dark pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-1">
                                                            <hr />
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-2">
                                                            <p class="fs-15 d-block my-1">Estimate To</p>
                                                            <h3 class="fs-20 fw-700 my-1">
                                                                {{this.vehicle.customer.title}}
                                                                {{this.vehicle.customer.firstName}}
                                                                {{this.vehicle.customer.lastName}} </h3>
                                                            <p class="fs-17 d-block my-1 line-height-150">
                                                                {{this.vehicle.customer.street}},
                                                                {{this.vehicle.customer.city}}, <br />
                                                                {{this.vehicle.customer.zip}},
                                                                {{this.vehicle.customer.state}}.</p>
                                                            <p class="fs-15 d-block my-1">
                                                                {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-2 text-end">
                                                            <p class="fs-15 d-block my-1">Estimate From</p>
                                                            <h3 class="fs-20 fw-700 my-1">{{this.company.name}}<br />
                                                            </h3>
                                                            <p class="fs-17 d-block my-1 line-height-150">
                                                                {{this.company.street}}, {{this.company.city}},
                                                                {{this.company.zip}},
                                                                {{this.company.state}}.</p>
                                                            <p class="fs-17 d-block my-1">
                                                                {{formatPhoneNumber(this.company.phone)}}</p>

                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped">
                                                                <tbody>
                                                                    <tr>
                                                                        <td class="fs-15"><strong>Vehicle</strong></td>
                                                                        <td class="fs-15"> {{vehicle.year}}
                                                                            {{vehicle.make}}
                                                                            {{vehicle.model}}
                                                                            {{vehicle.color}}</td>
                                                                        <td class="fs-15"><strong>Job Type</strong></td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td class="fs-15"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}} </td>
                                                                        </ng-container>

                                                                        <td class="fs-15"><strong>Mileage Out</strong>
                                                                        </td>
                                                                        <td class="fs-15"> {{vehicle.miles}}</td>
                                                                    </tr>

                                                                    <tr>
                                                                        <td class="fs-15"><strong>Work Request</strong>
                                                                        </td>
                                                                        <td class="fs-15" colspan="5">
                                                                            {{vehicle.workRequest}} </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row mt-1">
                                                        <div class="mt-4 pt-1 px-0">
                                                            <table class="col-12 w-100 px-1 bg-white border-radius-8">
                                                                <tr class="text-center h-40 bg-secondary text-white">
                                                                    <th class="text-center v-align-middle mw-50"> #
                                                                    </th>
                                                                    <th class="text-center v-align-middle mw-50"> Ind
                                                                    </th>
                                                                    <th class="text-center v-align-middle  mw-100"> Oper
                                                                    </th>
                                                                    <th class="text-center v-align-middle"> Description
                                                                    </th>
                                                                    <th class="text-center v-align-middle"
                                                                        *ngIf="showEmployees == false"> Part Number
                                                                    </th>
                                                                    <th class="text-center v-align-middle"
                                                                        *ngIf="showEmployees == false"> Qty </th>
                                                                    <th class="text-center v-align-middle"
                                                                        *ngIf="showEmployees == false"> Ext.
                                                                        Price $
                                                                    </th>
                                                                    <th class="text-center v-align-middle mw-50"> Labor
                                                                    </th>
                                                                    <th class="text-center v-align-middle mw-50"
                                                                        *ngIf="showEmployees == true"><i
                                                                            class="fa-solid fa-home"></i> </th>
                                                                    <th class="text-center v-align-middle mw-50"
                                                                        *ngIf="showEmployees == true"><i
                                                                            class="fa-solid fa-dollar-sign"></i></th>
                                                                    <!-- <th class="text-center v-align-middle mw-50" *ngIf="showEmployees == false"> Paint
                                    </th> -->

                                                                </tr>
                                                                <ng-container
                                                                    *ngFor="let claim of estimateResponse.estimates; let i=index">
                                                                    <tr>
                                                                        <td class="text-center v-align-middle h-40 ">
                                                                            {{claim.index}}</td>
                                                                        <td colspan="9"
                                                                            class="v-align-middle h-40 fw-700 px-1">
                                                                            {{claim.notes}}</td>
                                                                    </tr>
                                                                    <tr
                                                                        *ngFor="let part of claim.autoparts; let j=index ">
                                                                        <td class="text-center v-align-middle">
                                                                            {{part.index}}</td>
                                                                        <td class="text-left v-align-middle">*</td>
                                                                        <td class="text-center v-align-middle">Repl</td>
                                                                        <td
                                                                            class="text-left v-align-middle text-primary">
                                                                            {{part.title}}</td>
                                                                        <td class="text-center v-align-middle">
                                                                            {{part.partNumber}}</td>
                                                                        <td class="text-center v-align-middle">1</td>
                                                                        <td class="text-right v-align-middle">
                                                                            {{part.price}}.00</td>
                                                                        <td class="text-right v-align-middle"></td>
                                                                        <!-- <td class="text-center v-align-middle">0.0</td> -->
                                                                    </tr>
                                                                    <tr *ngFor="let job of claim.jobs; let k=index ">
                                                                        <td class="text-center v-align-middle">
                                                                            {{job.index}}</td>
                                                                        <td class="text-left v-align-middle">**</td>
                                                                        <td class="text-center v-align-middle">
                                                                            <ng-container
                                                                                *ngFor="let jobOrderType of this.jobOrderTypes">
                                                                                <span
                                                                                    *ngIf="job.jobRequestType == jobOrderType.id">{{jobOrderType.code}}</span>
                                                                            </ng-container>
                                                                        </td>
                                                                        <td class="text-left v-align-middle">
                                                                            {{job.notes}}</td>
                                                                        <td class="text-center v-align-middle"></td>
                                                                        <td class="text-center v-align-middle">1</td>
                                                                        <td class="text-right v-align-middle">
                                                                            {{job.price}}.00</td>
                                                                        <td class="text-right v-align-middle">
                                                                            {{job.hours}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td colspan="10">
                                                                            <hr>
                                                                        </td>
                                                                    </tr>
                                                                </ng-container>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-lg-6 col-md-8"></div>
                                                        <div class="col-lg-1 col-md-12"></div>
                                                        <div class="col-lg-5 col-md-4 p-0">
                                                            <ul>
                                                                <li class="d-flex justify-content-between my-4"><strong
                                                                        class="fs-15">ESTIMATE
                                                                        TOTALS</strong>
                                                                </li>
                                                                <li *ngFor="let receipt of estimateResponse.receipts"
                                                                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                                                    <strong class="fs-15">{{receipt.notes}}:</strong>
                                                                    <p class="fs-15 px-1">${{receipt.amount}}</p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                                                    <strong class="fs-15">Total:</strong>
                                                                    <p class="fs-15 px-1">${{getReceiptTotal()}}</p>
                                                                </li>

                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- <div id="print-content-estimate" style="background-color:white">
                      <div id="componentID" class="container-fluid" style="background-color:white">
                        <div class="container-fluid" style="background-color:white">
                          <div id="componentID2" class="container-fluid" style="background-color:white">
                            <div class="row">
                              <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                    class="img-fluid rounded" alt="Company Logo" width="120" />
                               
                                </div>
                              </div>
                              <div class="col-lg-4 col-md-2 col-sm-2"></div>
                              <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                  class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                  {{currentDate|date}}</span> </div>
                              <div class="col-12 mt-3">
                                <hr />
                              </div>
                              <div class="col-md-6 col-sm-6 mb-4">
                                <p class="fs-15 d-block my-3">Estimate To</p>
                                <h3 class="fs-20 fw-700 my-3">{{this.vehicle.customer.title}}
                                  {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                                <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p>
                                <p class="fs-15 d-block my-4 line-height-150" style="word-break: break-word;">
                                  {{this.vehicle.customer.street}},
                                  {{this.vehicle.customer.city}}, <br />
                                  {{this.vehicle.customer.zip}},
                                  {{this.vehicle.customer.state}}.</p>
                                <p class="fs-15 d-block my-3"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>
  
                              </div>
                              <div class="col-md-6 col-sm-6 mb-4 text-end">
                                <p class="fs-15 d-block my-3 pb-3">Estimate From</p>
                                <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                  <small class="fs-15" [innerHtml]="company.slogan"></small>
                                </h3>
                                <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                  {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                  {{this.company.state}}.</p>
                                <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                                <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                  {{this.company.email}}</p>
                                <p class="fs-15 d-block my-3 fw-700">Receipt for Vehicle #{{this.vehicle.id}}</p>
                                <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                    class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-12 table-responsive">
                                <table class="table table-striped">
                                  <thead>
                                    <tr class="bg-white">
                                      <th class="mw-100 fs-14 fw-700 text-black py-3"> Item</th>
                                      <th class="mw-100 fs-14 fw-700 text-black py-3"> Info</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td class="fs-13 py-3"><strong>Vehicle</strong></td>
                                      <td class="fs-13 py-3"> {{vehicle.year}}
                                        {{vehicle.make}}
                                        {{vehicle.model}}
                                        {{vehicle.color}}</td>
                                    </tr>
                                    <tr *ngIf="vehicle.description != ''">
                                      <td class="fs-13 py-3"><strong>Specification</strong></td>
                                      <td class="fs-13 py-3"> {{vehicle.description}}</td>
                                    </tr>
                                    <tr>
                                      <td class="fs-13 py-3"><strong>Mileage In</strong></td>
                                      <td class="fs-13 py-3"> {{vehicle.miles}}</td>
                                    </tr>
                                    <tr>
                                      <td class="fs-13 py-3"><strong>Job Type</strong></td>
                                      <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                        <td class="fs-13 py-3" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                          {{jobRequestType.name}} </td>
                                      </ng-container>
                                    </tr>
                                    <tr>
                                      <td class="fs-13 py-3"><strong>Work Request</strong></td>
                                      <td class="fs-13 py-3"> {{vehicle.workRequest}} </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            <div class="row" *ngIf="claims.length >0">
                              <div class="col-12 table-responsive">
                                <table class="table table-striped w-100">
                                  <thead>
                                    <tr class="bg-white">
                                      <th class="mw-50 fs-14 fw-700 text-black py-3"> #</th>
                                    
                                      <th class="mw-150 fs-14 fw-700 text-black py-3"> Description</th>
                                      <th class="mw-150 fs-14 fw-700 text-black py-3"> Type</th>
                                      <th class="mw-80 fs-14 fw-700 text-black py-3"> Quantity</th>
                                      <th class="mw-80 fs-14 fw-700 text-black py-3"> Amount</th>
  
                                      <th class="mw-80 fs-14 fw-700 text-black py-3"> Subtotal</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr *ngFor="let claim of claims; let i=index">
                                      <td class="fs-13 py-3">{{i +1}}</td>
                                    
                                      <td class="fs-13 py-3">
                                        <ng-container *ngFor="let itemType of this.itemTypes">
                                          <ng-container *ngIf="itemType.id == claim.itemType">
                                            <span>{{itemType.name}}</span>
                                          </ng-container>
                                        </ng-container>
                                      </td>
                                      <td class="fs-13 py-3"> {{claim.notes}}</td>
                                      <td class="fs-13 py-3">{{claim.quantity }}</td>
                                      <td class="fs-13 py-3">${{claim.amount }}</td>
  
                                      <td class="fs-13 py-3">${{getClaimSubTotal(claim) }}</td>
                                    </tr>
                                  </tbody>
                                </table>
                              </div>
                            </div>
                            <div class="row">
                              <div class="col-lg-6 col-md-8 col-sm-8">
                                <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                      class="text-danger">{{currentDate|
                                      date}}</span></small> </div>
                                <ng-container *ngFor="let paymentMethod of this.paymentMethods">
                                  <p class="lead" *ngIf="paymentMethod.id==vehicle.paymentMethod"> Paid By
                                    {{paymentMethod.name}} </p>
                                </ng-container>
                              </div>
                              <div class="col-lg-3 col-md-12 hide-sm"></div>
                              <div class="col-lg-3 col-md-4 col-sm-4">
                                <ul>
                                  <li class="d-flex justify-content-between my-4"><strong class="fs-18">Subtotal:</strong>
                                    <p class="fs-18 text-black opacity-75">${{getSubtotalClaims()}}</p>
                                  </li>
                                  <li class="d-flex justify-content-between my-4"><strong class="fs-18">Tax
                                      ({{company.taxRate
                                      *100}}%):</strong>
                                    <p class="fs-15 text-black opacity-75">${{getTaxClaim() }}</p>
                                  </li>
                                  <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                    <strong class="fs-18 fw-700">Total Estimates: </strong>
                                    <p class="fs-18 fw-700">${{getTotalClaims()}}</p>
                                  </li>
                                  <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                    <strong class="fs-18 fw-700">Total Payments: </strong>
                                    <p class="fs-18 fw-700">${{getTotalPayments()}}</p>
                                  </li>
                                  <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                    <strong class="fs-18 fw-700">Balance: </strong>
                                    <p class="fs-18 fw-700">${{getTotalBalance()}}</p>
                                  </li>
                                </ul>
                              </div>
                              <div class="col-12 mt-5">
                                <div [innerHtml]="warrantyText"></div>
                                <br>
                                <div [innerHtml]="disclaimerText"></div>
                                <div class="ps-3 pe-3 pb-3 pt-5">
                                  <div class="d-flex align-items-end justify-content-between">
                                    <div class="d-flex gap-2">
                                      <p>Signature</p>
                                      <span>_________________________________</span>
                                    </div>
                                    <div class="d-flex gap-2 mt-30-mob">
                                      <p>Date</p>
                                      <span>_________________________________</span>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div> -->
                                    <div id="print-content-estimate-invoice" style="background-color:white">
                                        <div id="componentID" class="container-fluid" style="background-color:white">
                                            <div class="container-fluid" style="background-color:white">
                                                <div id="componentID2" class="container-fluid"
                                                    style="background-color:white">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                                            <div class="d-flex align-items-center gap-3"> <img
                                                                    [src]="company.iconString" class="img-fluid rounded"
                                                                    alt="Company Logo" width="120" />
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-3">
                                                            <hr />
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4">
                                                            <p class="fs-15 d-block my-3">Estimate To</p>
                                                            <h3 class="fs-20 fw-700 my-3">
                                                                {{this.vehicle.customer.title}}
                                                                {{this.vehicle.customer.firstName}}
                                                                {{this.vehicle.customer.lastName}} </h3>
                                                            <p class="fs-15 d-block my-3">
                                                                {{this.vehicle.customer.email}}</p>
                                                            <p class="fs-15 d-block my-4 line-height-150"
                                                                style="word-break: break-word;">
                                                                {{this.vehicle.customer.street}},
                                                                {{this.vehicle.customer.city}}, <br />
                                                                {{this.vehicle.customer.zip}},
                                                                {{this.vehicle.customer.state}}.</p>
                                                            <p class="fs-15 d-block my-3">
                                                                {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4 text-end">
                                                            <p class="fs-15 d-block my-3 pb-3">Estimate From</p>
                                                            <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                                                <small class="fs-15"
                                                                    [innerHtml]="company.slogan"></small>
                                                            </h3>
                                                            <p class="fs-15 d-block my-3 line-height-150">
                                                                {{formatPhoneNumber(this.company.phone)}} -
                                                                {{this.company.street}}, {{this.company.city}},
                                                                {{this.company.zip}},
                                                                {{this.company.state}}.</p>
                                                            <p class="fs-15 d-block my-3 fw-700">
                                                                {{formatPhoneNumber(this.company.phone)}}</p>
                                                            <p class="fs-15 d-block mb-3 mt-4 text-primary-abs"
                                                                style="word-break: break-word;">
                                                                {{this.company.email}}</p>
                                                            <p class="fs-15 d-block my-3 fw-700">Receipt for Vehicle
                                                                #{{this.vehicle.id}}</p>
                                                            <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                                                    class="text-danger">{{vehicle.targetDate| date:
                                                                    'MM/dd/yyyy'}}</span></p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped">
                                                                <thead>
                                                                    <tr class="bg-white">
                                                                        <th class="mw-100 fs-14 fw-700 text-black py-3">
                                                                            Item</th>
                                                                        <th class="mw-100 fs-14 fw-700 text-black py-3">
                                                                            Info</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Vehicle</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{vehicle.year}}
                                                                            {{vehicle.make}}
                                                                            {{vehicle.model}}
                                                                            {{vehicle.color}}</td>
                                                                    </tr>
                                                                    <tr *ngIf="vehicle.description != ''">
                                                                        <td class="fs-13 py-3">
                                                                            <strong>Specification</strong>
                                                                        </td>
                                                                        <td class="fs-13 py-3"> {{vehicle.description}}
                                                                        </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Mileage
                                                                                In</strong></td>
                                                                        <td class="fs-13 py-3"> {{vehicle.miles}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Job Type</strong>
                                                                        </td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td class="fs-13 py-3"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}} </td>
                                                                        </ng-container>
                                                                    </tr>
                                                                    <tr>
                                                                        <td class="fs-13 py-3"><strong>Work
                                                                                Request</strong></td>
                                                                        <td class="fs-13 py-3"> {{vehicle.workRequest}}
                                                                        </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row" *ngIf="filterClaims(1).length >0">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped w-100">
                                                                <thead>
                                                                    <tr class="bg-white">
                                                                        <th class="mw-50 fs-14 fw-700 text-black py-3">
                                                                            #</th>
                                                                        <th class="mw-150 fs-14 fw-700 text-black py-3">
                                                                            Description</th>
                                                                        <th class="mw-80 fs-14 fw-700 text-black py-3">
                                                                            Type</th>
                                                                        <th class="mw-80 fs-14 fw-700 text-black py-3">
                                                                            Quantity</th>
                                                                        <th class="mw-80 fs-14 fw-700 text-black py-3">
                                                                            Amount</th>

                                                                        <th class="mw-80 fs-14 fw-700 text-black py-3">
                                                                            Subtotal</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr
                                                                        *ngFor="let claim of filterClaims(1); let i=index">
                                                                        <td class="fs-13 py-3">{{i +1}}</td>
                                                                        <td class="fs-13 py-3"> {{claim.notes}}</td>
                                                                        <td class="fs-13 py-3">
                                                                            <ng-container
                                                                                *ngFor="let itemType of this.itemTypes">
                                                                                <ng-container
                                                                                    *ngIf="itemType.id == claim.itemType">
                                                                                    <span>{{itemType.name}}</span>
                                                                                </ng-container>
                                                                            </ng-container>
                                                                        </td>
                                                                        <td class="fs-13 py-3">{{claim.quantity }}</td>
                                                                        <td class="fs-13 py-3">${{claim.amount }}</td>
                                                                        <td class="fs-13 py-3">
                                                                            ${{getClaimSubTotal(claim) }}</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-lg-6 col-md-8 col-sm-8">
                                                            <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                                                        class="text-danger">{{currentDate|
                                                                        date}}</span></small> </div>
                                                            <ng-container
                                                                *ngFor="let paymentMethod of this.paymentMethods">
                                                                <p class="lead"
                                                                    *ngIf="paymentMethod.id==vehicle.paymentMethod">
                                                                    Paid By
                                                                    {{paymentMethod.name}} </p>
                                                            </ng-container>
                                                        </div>
                                                        <div class="col-lg-3 col-md-12 hide-sm"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4">
                                                            <ul>
                                                                <li class="d-flex justify-content-between my-4"><strong
                                                                        class="fs-18">Subtotal:</strong>
                                                                    <p class="fs-18 text-black opacity-75">
                                                                        ${{getSubtotalClaimsLocked()}}</p>
                                                                </li>
                                                                <li class="d-flex justify-content-between my-4"><strong
                                                                        class="fs-18">Tax
                                                                        ({{company.taxRate
                                                                        *100}}%):</strong>
                                                                    <p class="fs-15 text-black opacity-75">
                                                                        ${{getTaxClaimLocked() }}</p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between my-4 fw-700 text-black">
                                                                    <strong class="fs-18 fw-700">Total Estimates:
                                                                    </strong>
                                                                    <p class="fs-18 fw-700">${{getTotalClaimsLocked()}}
                                                                    </p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between my-4 fw-700 text-black">
                                                                    <strong class="fs-18 fw-700">Total Payments:
                                                                    </strong>
                                                                    <p class="fs-18 fw-700">${{getTotalPayments()}}</p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between my-4 fw-700 text-black">
                                                                    <strong class="fs-18 fw-700">Balance: </strong>
                                                                    <p class="fs-18 fw-700">${{getTotalBalanceLocked()}}
                                                                    </p>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                        <div class="col-12 mt-5">
                                                            <div [innerHtml]="warrantyText"></div>
                                                            <br>
                                                            <div [innerHtml]="disclaimerText"></div>
                                                            <div class="ps-3 pe-3 pb-3 pt-5">
                                                                <div
                                                                    class="d-flex align-items-end justify-content-between">
                                                                    <div class="d-flex gap-2">
                                                                        <p>Signature</p>
                                                                        <span>_________________________________</span>
                                                                    </div>
                                                                    <div class="d-flex gap-2 mt-30-mob">
                                                                        <p>Date</p>
                                                                        <span>_________________________________</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="print-content-receipt" style="background-color:white">
                                        <div id="componentID" class="container-fluid" style="background-color:white">
                                            <div class="container-fluid" style="background-color:white">
                                                <div id="componentID2" class="container-fluid"
                                                    style="background-color:white">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                                            <div class="d-flex align-items-center gap-3"> <img
                                                                    [src]="company.iconString" class="img-fluid rounded"
                                                                    alt="Company Logo" width="120" />
                                                                <!-- <h3 class="fs-20 fw-300 line-height-150">{{this.company.name}}, Inc.<br />
                                    <small class="fs-15" [innerHtml]="company.slogan"></small>
                                  </h3> -->
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-dark pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-1">
                                                            <hr />
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-2">
                                                            <p class="fs-15 d-block my-1">Invoice To</p>
                                                            <h3 class="fs-20 fw-700 my-1">
                                                                {{this.vehicle.customer.title}}
                                                                {{this.vehicle.customer.firstName}}
                                                                {{this.vehicle.customer.lastName}} </h3>
                                                            <!-- <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p> -->
                                                            <p class="fs-17 d-block my-1 line-height-150">
                                                                {{this.vehicle.customer.street}},
                                                                {{this.vehicle.customer.city}}, <br />
                                                                {{this.vehicle.customer.zip}},
                                                                {{this.vehicle.customer.state}}.</p>
                                                            <p class="fs-15 d-block my-1">
                                                                {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-2 text-end">
                                                            <p class="fs-15 d-block my-1">Invoice From</p>
                                                            <h3 class="fs-20 fw-700 my-1">{{this.company.name}}<br />
                                                                <!-- <small class="fs-15" [innerHtml]="company.slogan"></small> -->
                                                            </h3>
                                                            <p class="fs-17 d-block my-1 line-height-150">
                                                                {{this.company.street}}, {{this.company.city}},
                                                                {{this.company.zip}},
                                                                {{this.company.state}}.</p>
                                                            <p class="fs-17 d-block my-1">
                                                                {{formatPhoneNumber(this.company.phone)}}</p>
                                                            <!-- <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                  {{this.company.email}}</p> -->
                                                            <!-- <p class="fs-15 d-block my-3 fw-700">Receipt for Vehicle #{{this.vehicle.id}}</p>
                                <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                    class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p> -->
                                                        </div>
                                                    </div>
                                                    <div class="row mt-3">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped">
                                                                <!-- <thead>
                                    <tr class="bg-white">
                                      <th class="mw-100 fs-14 fw-700 text-black">
                                        Item</th>
                                      <th class="mw-100 fs-14 fw-700 text-black">
                                        Info</th>
                                    </tr>
                                  </thead> -->
                                                                <tbody>
                                                                    <tr>
                                                                        <td class="fs-15"><strong>Vehicle</strong></td>
                                                                        <td class="fs-15"> {{vehicle.year}}
                                                                            {{vehicle.make}}
                                                                            {{vehicle.model}}
                                                                            {{vehicle.color}}</td>
                                                                        <td class="fs-15"><strong>Job Type</strong></td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td class="fs-15"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}} </td>
                                                                        </ng-container>

                                                                        <td class="fs-15"><strong>Mileage Out</strong>
                                                                        </td>
                                                                        <td class="fs-15"> {{vehicle.miles}}</td>

                                                                        <!-- <td class="fs-13"><strong>Specification</strong></td>
                                      <td class="fs-13"> {{vehicle.description}}</td> -->
                                                                    </tr>
                                                                    <!-- <tr *ngIf="vehicle.description != ''">
                                      <td class="fs-13"><strong>Specification</strong></td>
                                      <td class="fs-13"> {{vehicle.description}}</td>
                                    </tr> -->
                                                                    <tr>
                                                                        <!-- <td class="fs-13"><strong>Mileage Out</strong></td>
                                      <td class="fs-13"> {{vehicle.miles}}</td> -->
                                                                        <td class="fs-15"><strong>Work Request</strong>
                                                                        </td>
                                                                        <td class="fs-15" colspan="5">
                                                                            {{vehicle.workRequest}} </td>
                                                                    </tr>
                                                                    <!-- <tr>
                                      <td class="fs-13"><strong>Job Type</strong></td>
                                      <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                        <td class="fs-13" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                          {{jobRequestType.name}} </td>
                                      </ng-container>
                                    </tr> -->
                                                                    <!-- <tr>
                                      <td class="fs-13"><strong>Work Request</strong></td>
                                      <td class="fs-13"> {{vehicle.workRequest}} </td>
                                    </tr> -->
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row" *ngIf="receipts.length >0">
                                                        <div class="col-12 table-responsive">
                                                            <table class="table table-striped w-100">
                                                                <thead>
                                                                    <tr class="bg-white">
                                                                        <th class="mw-50 fs-16 fw-700 text-black"> #
                                                                        </th>
                                                                        <!-- <th class="mw-150 fs-14 fw-700 text-black py-3"> Item</th> -->
                                                                        <th class="mw-150 fs-16 fw-700 text-black">
                                                                            Description</th>
                                                                        <th class="mw-150 fs-16 fw-700 text-black"> Type
                                                                        </th>
                                                                        <th class="mw-80 fs-16 fw-700 text-black">
                                                                            Quantity</th>
                                                                        <th class="mw-80 fs-16 fw-700 text-black">
                                                                            Amount</th>

                                                                        <th class="mw-80 fs-16 fw-700 text-black">
                                                                            Subtotal</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr *ngFor="let receipt of receipts; let i=index">
                                                                        <td class="fs-15">{{i +1}}</td>
                                                                        <!-- <td class="fs-13">{{receipt.name}}</td> -->
                                                                        <td class="fs-15"> {{receipt.notes}}</td>
                                                                        <td class="fs-15">
                                                                            <ng-container
                                                                                *ngFor="let itemType of this.itemTypes">
                                                                                <ng-container
                                                                                    *ngIf="itemType.id == receipt.itemType">
                                                                                    <span>{{itemType.name}}</span>
                                                                                </ng-container>
                                                                            </ng-container>
                                                                        </td>
                                                                        <td class="fs-15">{{receipt.quantity }}</td>
                                                                        <td class="fs-15">${{receipt.amount }}</td>

                                                                        <td class="fs-15">${{getReceiptSubTotal(receipt)
                                                                            }}</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-lg-6 col-md-8 col-sm-8">
                                                            <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                                                        class="text-danger">{{currentDate|
                                                                        date}}</span></small> </div>
                                                            <ng-container
                                                                *ngFor="let paymentMethod of this.paymentMethods">
                                                                <p class="lead"
                                                                    *ngIf="paymentMethod.id==vehicle.paymentMethod">
                                                                    Paid By
                                                                    {{paymentMethod.name}} </p>
                                                            </ng-container>
                                                        </div>
                                                        <div class="col-lg-3 col-md-12 hide-sm"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4">
                                                            <ul>
                                                                <li class="d-flex justify-content-between my-4"><strong
                                                                        class="fs-20">Subtotal:</strong>
                                                                    <p class="fs-20 text-black opacity-75 fw-700">
                                                                        ${{getSubtotal()}}</p>
                                                                </li>
                                                                <li class="d-flex justify-content-between my-4"><strong
                                                                        class="fs-20">Tax
                                                                        ({{company.taxRate
                                                                        *100}}%):</strong>
                                                                    <p class="fs-20 text-black opacity-75 fw-7--">
                                                                        ${{getTax() }}</p>
                                                                </li>
                                                                <li
                                                                    class="d-flex justify-content-between my-4 fw-700 text-black">
                                                                    <strong class="fs-20 fw-700">Total: </strong>
                                                                    <p class="fs-20 text-black opacity-75 fw-700">
                                                                        ${{getTotal()}}</p>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                        <div class="col-12 mt-5">
                                                            <div [innerHtml]="warrantyText"></div>
                                                            <br>
                                                            <div [innerHtml]="disclaimerText"></div>
                                                            <div class="ps-3 pe-3 pb-3 pt-5">
                                                                <div
                                                                    class="d-flex align-items-end justify-content-between">
                                                                    <div class="d-flex gap-2">
                                                                        <p>Signature</p>
                                                                        <span>_________________________________</span>
                                                                    </div>
                                                                    <div class="d-flex gap-2 mt-30-mob">
                                                                        <p>Date</p>
                                                                        <span>_________________________________</span>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="print-content-vehicle">
                                        <div id="componentID" class="container-fluid">
                                            <div class="container-fluid">
                                                <div id="componentID2" class="container-fluid">
                                                    <div class="row">
                                                        <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                                            <div class="d-flex align-items-center gap-3"> <img
                                                                    [src]="company.iconString" class="img-fluid rounded"
                                                                    alt="Company Logo" width="120" />
                                                                <h3 class="fs-20 fw-300 line-height-150">
                                                                    {{this.company.name}}, Inc.<br />
                                                                    <span class="fs-13"
                                                                        [innerHtml]="company.slogan"></span>
                                                                </h3>
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-4 col-md-2 col-sm-2"></div>
                                                        <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                                                {{currentDate|date}}</span> </div>
                                                        <div class="col-12 mt-3">
                                                            <hr />
                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4">
                                                            <p class="fs-15 d-block my-3">Invoice To</p>
                                                            <h3 class="fs-20 fw-700 my-3">
                                                                {{this.vehicle.customer.title}}
                                                                {{this.vehicle.customer.firstName}}
                                                                {{this.vehicle.customer.lastName}} </h3>
                                                            <p class="fs-15 d-block my-3">
                                                                {{this.vehicle.customer.email}}</p>
                                                            <p class="fs-15 d-block my-4 line-height-150"
                                                                style="word-break: break-word;">
                                                                {{this.vehicle.customer.street}},
                                                                {{this.vehicle.customer.city}}, <br />
                                                                {{this.vehicle.customer.zip}},
                                                                {{this.vehicle.customer.state}}.</p>
                                                            <p class="fs-15 d-block my-3">
                                                                {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                                                        </div>
                                                        <div class="col-md-6 col-sm-6 mb-4 text-end">
                                                            <p class="fs-15 d-block my-3">Invoice From</p>
                                                            <h3 class="fs-20 fw-700 my-3 pb-3">
                                                                {{this.company.name}}<br />
                                                                <div [innerHtml]="company.slogan"></div>
                                                            </h3>
                                                            <p class="fs-15 d-block my-3 line-height-150">
                                                                {{formatPhoneNumber(this.company.phone)}} -
                                                                {{this.company.street}}, {{this.company.city}},
                                                                {{this.company.zip}},
                                                                {{this.company.state}}.</p>
                                                            <p class="fs-15 d-block my-3 fw-700">
                                                                {{formatPhoneNumber(this.company.phone)}}</p>
                                                            <p class="fs-15 d-block mb-3 mt-4 text-primary-abs"
                                                                style="word-break: break-word;">
                                                                {{this.company.email}}</p>
                                                            <p class="fs-15 d-block my-3 fw-700">ork Request for Vehicle
                                                                #{{this.vehicle.id}}</p>
                                                            <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                                                    class="text-danger">{{vehicle.targetDate| date:
                                                                    'MM/dd/yyyy'}}</span></p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12 table-responsive tt">
                                                            <table
                                                                class="table table-bordered border-radius-8 overflow-hidden">
                                                                <thead>
                                                                    <tr class="bg-navy">
                                                                        <th
                                                                            style="background-color: rgb(13, 173, 226);">
                                                                            Item</th>
                                                                        <th
                                                                            style="background-color: rgb(13, 173, 226);">
                                                                            Info</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Vehicle</strong>
                                                                        </td>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            {{vehicle.year}}
                                                                            {{vehicle.make}}
                                                                            {{vehicle.model}}
                                                                            {{vehicle.color}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Specification</strong>
                                                                        </td>
                                                                        <td
                                                                            style="border: 1px solid lightgray;word-break:break-all">
                                                                            {{vehicle.description}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>VIN</strong>
                                                                        </td>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            {{vehicle.vin}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Job Type</strong>
                                                                        </td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td style="border: 1px solid lightgray;"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}}
                                                                            </td>
                                                                        </ng-container>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Work Request</strong>
                                                                        </td>
                                                                        <td
                                                                            style="border: 1px solid lightgray;word-break:break-all">
                                                                            {{vehicle.workRequest}} </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Prior Damage</strong>
                                                                        </td>
                                                                        <td
                                                                            style="border: 1px solid lightgray;word-break:break-all">
                                                                            {{vehicle.priorDamage}} </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6"></div>
                                                        <div class="col-2 text-right">
                                                            <label>Signature:</label>
                                                        </div>
                                                        <div class="col-4"> _________________________________ </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p></p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p></p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6"></div>
                                                        <div class="col-2 text-right">
                                                            <label>Date:</label>
                                                        </div>
                                                        <div class="col-4"> _________________________________ </div>
                                                    </div>
                                                    <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                                                    <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="print-content-vehicle-QRCode">
                                        <div id="componentID" class="container-fluid">
                                            <div class="container-fluid">
                                                <div id="componentID2" class="container-fluid">
                                                    <div class="row">
                                                        <div class="col-12 mt-3">
                                                            <qrcode [qrdata]="url" id="qrcode" [width]="150"
                                                                title="Scan it with your phone"
                                                                [errorCorrectionLevel]="'M'" [allowEmptyString]="true">
                                                            </qrcode>
                                                        </div>
                                                    </div>
                                                    <!-- <div class="row">
                              <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                                <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                    class="img-fluid rounded" alt="Company Logo" width="120" />
                                  <h3 class="fs-20 fw-300 line-height-150">{{this.company.name}}, Inc.<br />
                                    <span class="fs-13" [innerHtml]="company.slogan"></span>
                                  </h3>
                                </div>
                              </div>
                              <div class="col-lg-4 col-md-2 col-sm-2"></div>
                              <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                  class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                  {{currentDate|date}}</span> </div>
                              <div class="col-12 mt-3">
                                <hr />
                              </div>
                              <div class="col-md-6 col-sm-6 mb-4">
                                <p class="fs-15 d-block my-3">Invoice To</p>
                                <h3 class="fs-20 fw-700 my-3">{{this.vehicle.customer.title}}
                                  {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                                <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p>
                                <p class="fs-15 d-block my-4 line-height-150" style="word-break: break-word;">
                                  {{this.vehicle.customer.street}},
                                  {{this.vehicle.customer.city}}, <br />
                                  {{this.vehicle.customer.zip}},
                                  {{this.vehicle.customer.state}}.</p>
                                <p class="fs-15 d-block my-3"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>
  
                              </div>
                              <div class="col-md-6 col-sm-6 mb-4 text-end">
                                <p class="fs-15 d-block my-3">Invoice From</p>
                                <h3 class="fs-20 fw-700 my-3 pb-3">{{this.company.name}}<br />
                                  <div [innerHtml]="company.slogan"></div>
                                </h3>
                                <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                  {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                  {{this.company.state}}.</p>
                                <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                                <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                  {{this.company.email}}</p>
                                <p class="fs-15 d-block my-3 fw-700">ork Request for Vehicle #{{this.vehicle.id}}</p>
                                <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                    class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                              </div>
                            </div> -->
                                                    <div class="row">
                                                        <div class="col-12 table-responsive tt">
                                                            <table
                                                                class="table table-bordered border-radius-8 overflow-hidden">
                                                                <thead>
                                                                    <tr class="bg-navy">
                                                                        <th
                                                                            style="background-color: rgb(13, 173, 226);">
                                                                            Item</th>
                                                                        <th
                                                                            style="background-color: rgb(13, 173, 226);">
                                                                            Info</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Vehicle</strong>
                                                                        </td>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            {{vehicle.year}}
                                                                            {{vehicle.make}}
                                                                            {{vehicle.model}}
                                                                            {{vehicle.color}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Specification</strong>
                                                                        </td>
                                                                        <td
                                                                            style="border: 1px solid lightgray;word-break:break-all">
                                                                            {{vehicle.description}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>VIN</strong>
                                                                        </td>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            {{vehicle.vin}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>url</strong>
                                                                        </td>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            {{vehicle.url}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Token</strong>
                                                                        </td>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            {{vehicle.token}}</td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Job Type</strong>
                                                                        </td>
                                                                        <ng-container
                                                                            *ngFor="let jobRequestType of this.jobRequestTypes">
                                                                            <td style="border: 1px solid lightgray;"
                                                                                *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                                                                {{jobRequestType.name}}
                                                                            </td>
                                                                        </ng-container>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Work Request</strong>
                                                                        </td>
                                                                        <td
                                                                            style="border: 1px solid lightgray;word-break:break-all">
                                                                            {{vehicle.workRequest}} </td>
                                                                    </tr>
                                                                    <tr>
                                                                        <td style="border: 1px solid lightgray;">
                                                                            <strong>Prior Damage</strong>
                                                                        </td>
                                                                        <td
                                                                            style="border: 1px solid lightgray;word-break:break-all">
                                                                            {{vehicle.priorDamage}} </td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p> </p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6"></div>
                                                        <div class="col-2 text-right">
                                                            <label>Signature:</label>
                                                        </div>
                                                        <div class="col-4"> _________________________________ </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <p></p>
                                                        </div>
                                                        <div class="col-6">
                                                            <p></p>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-6"></div>
                                                        <div class="col-2 text-right">
                                                            <label>Date:</label>
                                                        </div>
                                                        <div class="col-4"> _________________________________ </div>
                                                    </div>
                                                    <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                                                    <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary"
                                        data-bs-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.container-fluid -->
    </section>
</div>
<!-- Report Viewing Component - Phase 1 POC -->
<div style="padding:30px 10px;">
    <div class="row nogot">
        <div class="my-fluid-col main-content col">
            <div class="row px-2 position-sticky common-bar-top">
                <nav class="navbar navbar-expand  border-radius-8 d-flex justify-content-between"
                    style="background-color: #253052;">
                    <button class="btn btn-outline-secondary" title="toggle reminders" (click)="toggleClass()"><i
                            class="fa fa-bars text-secondary"></i></button>
                    <ul class="navbar-nav d-flex align-items-center gap-5">
                        <li class="nav-item dropdown">
                            <div class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                <div class="d-flex align-items-center gap-3"> <img width="40" height="40"
                                        class="border-radius-4" *ngIf="company.icon != null && company.icon.length > 0"
                                        [src]="'data:image/jpeg;base64,'+ company.icon" />
                                    <div class="user-details"> <strong
                                            class="fs-14 mb-1 d-block text-white">{{user.firstName}}
                                            {{user.lastName}}</strong> <small
                                            class="fs-13 text-dark- opacity-50 text-white">{{this.company.name}}</small>
                                    </div>
                                    <i class="fa fa-angle-down opacity-50 bg-white"></i>
                                </div>
                            </div>
                            <div class="dropdown-menu p-0 border-0 shadow border-radius-8 overflow-hidden w-100 mt-3">
                                <ul class="d-flex flex-column">
                                    <li class="d-block p-0"><a routerLink="/users" class="dropdown-item p-3 fs-12"><i
                                                class="fa fa-users text-primary-abs fs-15 me-2 ms-1"></i> Manage
                                            Users</a></li>
                                    <li class="d-block p-0">
                                        <button data-bs-toggle="modal" data-bs-target="#myAccount"
                                            class="dropdown-item p-3 fs-12"><i
                                                class="fa fa-user text-primary-abs fs-15 me-2 ms-1"></i> My
                                            Account</button>
                                    </li>
                                    <li class="d-block p-0">
                                        <button data-bs-toggle="modal" data-bs-target="#resetPassword"
                                            class="dropdown-item p-3 fs-12"><i
                                                class="fa fa-key text-primary-abs fs-15 me-2 ms-1"></i> Reset
                                            Password</button>
                                    </li>
                                    <li class="d-block p-0"><a routerLink="/login" class="dropdown-item p-3 fs-12"
                                            (click)="logout()"><i
                                                class="fa fa-power-off text-primary-abs fs-15 me-2 ms-1"></i> Logout</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                    </ul>
                </nav>
            </div>


            <!-- Loading State -->
            <div *ngIf="isLoading" class="text-center py-5">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading vehicles...</span>
                </div>
                <p class="mt-3 text-muted">Loading vehicle data...</p>
            </div>

            <!-- Error State -->
            <div *ngIf="errorMessage && !isLoading" class="alert alert-danger" role="alert">
                <i class="fas fa-exclamation-triangle me-2"></i>
                {{ errorMessage }}
                <button class="btn btn-outline-danger btn-sm ms-3" (click)="refreshReport()">
                    <i class="fas fa-sync me-1"></i>Retry
                </button>
            </div>

            <!-- Report Engine Card -->
            <div *ngIf="showReport && !isLoading && user.allowAddAndUpdateReport"
                class="card mb-4 border-primary mt-4 ml-2 mr-2">
                <div class="card-header bg-primary text-white">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4 class="mb-0">
                                <i class="fas fa-chart-line me-2"></i>
                                Report Engine - {{ currentReport.name }}
                            </h4>
                            <small class="opacity-75">{{ currentReport.description }}</small>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="btn-group" role="group">
                                <!-- <button type="button" class="btn btn-light btn-sm"
                                    (click)="loadReport('current-shop-summary')"
                                    [class.active]="currentReport.id === 'current-shop-summary'">
                                    <i class="fas fa-list me-1"></i>Current Shop Summary
                                </button> -->
                                <button type="button" class="btn btn-light btn-sm"
                                    (click)="loadReport('payment-tracking')"
                                    [class.active]="currentReport.id === 'payment-tracking'">
                                    <i class="fas fa-credit-card me-1"></i>Payment Tracking
                                </button>
                                <!-- <button type="button" class="btn btn-outline-info btn-sm ms-2"
                                    (click)="testNestedDataCalls()">
                                    <i class="fas fa-flask me-1"></i>Test Nested Data
                                </button> -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">

                    <!-- Payment Tracking Summary Table (only shown for payment tracking report) -->
                    <div *ngIf="currentReport.id === 'payment-tracking' && paymentMetrics" class="mt-3 pt-3 border-top">
                        <div class="row">
                            <div class="col-12">
                                <h6 class="text-primary mb-3">
                                    <i class="fas fa-credit-card me-2"></i>Payment Tracking Summary
                                </h6>
                            </div>
                        </div>

                        <!-- Report Title and Date Info -->
                        <div class="row mb-3">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body py-2">
                                        <div class="row">
                                            <div class="col-md-8">
                                                <h6 class="mb-1 text-primary">
                                                    {{ company.name || '' }} Payment Tracking Report
                                                    <span *ngIf="paymentTrackingFilters.dataSource === 'archived'">For
                                                        Archived Vehicles</span>
                                                </h6>
                                                <div *ngIf="paymentTrackingFilters.dataSource === 'archived' && getReportDateRangeLabel()"
                                                    class="text-muted small">
                                                    ( {{ getReportDateRangeLabel() }} )
                                                </div>
                                            </div>
                                            <div class="col-md-4 text-end">
                                                <small class="text-muted">{{ getCurrentReportDate() }}</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Summary Metrics Table -->
                        <div class="row">
                            <div class="col-6">
                                <div class="card">
                                    <div class="card-header">
                                        <h6 class="mb-0">
                                            <i class="fas fa-filter me-2"></i>Payment Tracking Filters
                                            <span *ngIf="getActivePaymentFiltersCount() > 0"
                                                class="badge bg-primary ms-2">
                                                {{ getActivePaymentFiltersCount() }} Active
                                            </span>

                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <div class="row g-3">

                                            <!-- Data Source Dropdown -->
                                            <div class="col-md-3">
                                                <label class="form-label">Source</label>
                                                <select class="form-select"
                                                    [(ngModel)]="paymentTrackingFilters.dataSource"
                                                    (change)="onDataSourceChange()">
                                                    <option value="current">Current Shop</option>
                                                    <option value="archived">Archived Vehicles</option>
                                                </select>
                                            </div>

                                            <div class="col-md-3"
                                                *ngIf="paymentTrackingFilters.dataSource === 'archived'">
                                                <label class="form-label">Starting Week</label>
                                                <input type="week" class="form-control"
                                                    [value]="getWeekInputValue(selectedWeek)"
                                                    (change)="onWeekChange($event)">
                                            </div>

                                            <!-- Range preset for archived -->
                                            <div class="col-md-3"
                                                *ngIf="paymentTrackingFilters.dataSource === 'archived'">
                                                <label class="form-label">Range</label>
                                                <select class="form-select"
                                                    [(ngModel)]="paymentTrackingFilters.rangePreset"
                                                    (change)="onRangePresetChange()">
                                                    <option value="7">Last 7 days</option>
                                                    <option value="30">Last 30 days</option>
                                                    <option value="90">Last 90 days</option>
                                                    <option value="180">Last 180 days</option>
                                                    <option value="custom">Custom week</option>
                                                </select>
                                            </div>

                                            <!-- Status Dropdown -->
                                            <div class="col-md-3">
                                                <label class="form-label">Status</label>
                                                <select class="form-select" (change)="onStatusFilterChange($event)"
                                                    [(ngModel)]="paymentTrackingFilters.status">
                                                    <option value="">All Statuses</option>
                                                    <option *ngFor="let status of statuss" [value]="status.id">
                                                        {{ status.name }}
                                                    </option>
                                                </select>
                                            </div>

                                            <!-- Payment Status Dropdown -->
                                            <div class="col-md-3">
                                                <label class="form-label">Payment Status</label>
                                                <select class="form-select"
                                                    (change)="onPaymentStatusFilterChange($event)"
                                                    [(ngModel)]="paymentTrackingFilters.paymentStatus">
                                                    <option value="">All Payment Statuses</option>
                                                    <option value="paid">Paid</option>
                                                    <option value="unpaid">Unpaid</option>
                                                    <option value="partial">Partial</option>
                                                </select>
                                            </div>

                                            <!-- Additional Info Multi-Select -->
                                            <!-- <div class="col-md-3">
                                                <label class="form-label">Additional Info</label>
                                                <div class="border rounded p-2" style="max-height: 120px; overflow-y: auto;">
                                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                                        <small class="text-muted">Select collections:</small>
                                                        <div class="btn-group btn-group-sm">
                                                            <button type="button" class="btn btn-outline-primary btn-sm"
                                                                (click)="selectAllCollections('additionalInfo')">All</button>
                                                            <button type="button" class="btn btn-outline-secondary btn-sm"
                                                                (click)="deselectAllCollections('additionalInfo')">None</button>
                                                        </div>
                                                    </div>
                                                    <div class="form-check" *ngFor="let collection of availableCollections">
                                                        <input class="form-check-input" type="checkbox"
                                                            [id]="'additionalInfo-' + collection.value"
                                                            [checked]="isCollectionSelected(collection.value, 'additionalInfo')"
                                                            (change)="toggleCollectionSelection(collection.value, 'additionalInfo')">
                                                        <label class="form-check-label"
                                                            [for]="'additionalInfo-' + collection.value">
                                                            {{ collection.label }}
                                                        </label>
                                                    </div>
                                                </div>
                                            </div> -->

                                            <!-- PDF Includes Multi-Select -->
                                            <!-- <div class="col-md-3">
                                                <label class="form-label">PDF Includes</label>
                                                <div class="border rounded p-2" style="max-height: 120px; overflow-y: auto;">
                                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                                        <small class="text-muted">Select collections:</small>
                                                        <div class="btn-group btn-group-sm">
                                                            <button type="button" class="btn btn-outline-primary btn-sm"
                                                                (click)="selectAllCollections('pdfIncludes')">All</button>
                                                            <button type="button" class="btn btn-outline-secondary btn-sm"
                                                                (click)="deselectAllCollections('pdfIncludes')">None</button>
                                                        </div>
                                                    </div>
                                                    <div class="form-check" *ngFor="let collection of availableCollections">
                                                        <input class="form-check-input" type="checkbox"
                                                            [id]="'pdfIncludes-' + collection.value"
                                                            [checked]="isCollectionSelected(collection.value, 'pdfIncludes')"
                                                            (change)="toggleCollectionSelection(collection.value, 'pdfIncludes')">
                                                        <label class="form-check-label" [for]="'pdfIncludes-' + collection.value">
                                                            {{ collection.label }}
                                                        </label>
                                                    </div>
                                                </div>
                                            </div> -->
                                        </div>



                                        <!-- Action Buttons -->
                                        <div class="row mt-3">
                                            <div class="col-12">
                                                <div class="d-flex gap-2">
                                                    <!-- <button class="btn btn-primary" (click)="applyPaymentFilters()">
                                                        <i class="fas fa-search me-1"></i>Apply Filters
                                                    </button>
                                                    <button class="btn btn-outline-secondary"
                                                        (click)="clearPaymentFilters()">
                                                        <i class="fas fa-times me-1"></i>Clear All Filters
                                                    </button>
                                                    <button class="btn btn-outline-info"
                                                        (click)="togglePaymentFilters()">
                                                        <i class="fas fa-eye-slash me-1"></i>Hide Filters
                                                    </button> -->
                                                    <button *ngIf="user.allowAddAndUpdateReport"
                                                        class="btn btn-warning me-2"
                                                        (click)="exportPaymentTrackingToPDF()">
                                                        <i class="fas fa-file-pdf me-1"></i>Export Payment Tracking PDF
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="table-responsive">
                                    <table class="table table-bordered table-sm">
                                        <tbody>
                                            <tr
                                                *ngIf="paymentTrackingFilters.dataSource === 'archived' && getReportDateRangeLabel()">
                                                <td class="fw-bold bg-light">Effective Date Range</td>
                                                <td class="text-end fw-bold">{{ getReportDateRangeLabel() }}</td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Total Vehicles</td>
                                                <td class="text-end fw-bold">{{ vehicles.length }}</td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Paid Vehicles</td>
                                                <td class="text-end fw-bold text-success">{{ getPaidVehiclesCount() }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Unpaid Vehicles</td>
                                                <td class="text-end fw-bold text-warning">{{ getUnpaidVehiclesCount() }}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Total Estimates</td>
                                                <td class="text-end fw-bold">{{ getTotalEstimates() | currency }}</td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Total Supplements</td>
                                                <td class="text-end fw-bold">{{ getTotalSupplementsAmount() | currency
                                                    }}</td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Total Payments</td>
                                                <td class="text-end fw-bold">{{ getReportTotalPaymentAmount() | currency
                                                    }}</td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Total Receipts</td>
                                                <td class="text-end fw-bold">{{ (paymentMetrics.totalReceiptAmount || 0)
                                                    | currency
                                                    }}</td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Outstanding Amount</td>
                                                <td class="text-end fw-bold text-warning">{{
                                                    getReportOutstandingAmount() | currency }}</td>
                                            </tr>
                                            <tr>
                                                <td class="fw-bold bg-light">Payment Completion Rate</td>
                                                <td class="text-end fw-bold text-success">{{
                                                    getReportPaymentCompletionRate() | number:'1.1-1' }}%</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>



            <!-- Report Controls -->
            <div *ngIf="showReport && !isLoading" class="row mb-4 mt-4 ml-2 mr-2">
                <div class="col-md-6">
                    <div class="d-flex gap-2 align-items-center">
                        <!-- Search Input -->
                        <div class="input-group flex-grow-1">
                            <span class="input-group-text">
                                <i class="fas fa-search"></i>
                            </span>
                            <input type="text" class="form-control"
                                placeholder="Search vehicles (year, make, model, color, customer)..."
                                (input)="onSearchChange($event)">
                        </div>

                        <!-- Filter By Status Dropdown -->
                        <!-- <div class="input-group">
                            <span class="input-group-text">
                                <i class="fas fa-filter"></i>
                            </span>
                            <select class="form-select" (change)="onStatusFilterChange($event)" style="width: auto">
                                <option value="">All</option>
                                <option *ngFor="let status of statuss" [value]="status.id">
                                    {{ status.name }}
                                </option>
                            </select>
                        </div> -->
                    </div>
                </div>
                <div class="col-md-6 text-end">
                    <!-- <button class="btn btn-primary me-2" (click)="printReport()">
                        <i class="fas fa-print me-1"></i>Print Report
                    </button>
                    <button class="btn btn-success me-2" (click)="exportToPDF()">
                        <i class="fas fa-file-pdf me-1"></i>Export to PDF
                    </button> -->
                    <button *ngIf="currentReport.id === 'payment-tracking' && user.allowAddAndUpdateReport"
                        class="btn btn-warning me-2" (click)="exportPaymentTrackingToPDF()">
                        <i class="fas fa-file-pdf me-1"></i>Export Payment Tracking PDF
                    </button>
                    <!-- <button class="btn btn-outline-info" (click)="refreshReport()">
                        <i class="fas fa-sync me-1"></i>Refresh
                    </button> -->
                </div>
            </div>

            <!-- Report Table -->
            <div *ngIf="showReport && !isLoading" class="card shadow-sm border-0 ml-2 mr-2" id="report-table">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-table me-2"></i>Vehicle Summary Report
                        <span class="badge bg-primary ms-2">{{ vehicles.length }} vehicles</span>
                    </h5>
                </div>
                <div class="card-body p-0">
                    <!-- Vehicle Data Loading Indicator -->
                    <div *ngIf="isLoadingVehicles" class="text-center py-4">
                        <div class="spinner-border spinner-border-sm text-primary" role="status">
                            <span class="visually-hidden">Loading vehicle data...</span>
                        </div>
                        <span class="ms-2 text-muted">Loading vehicle data...</span>
                    </div>

                    <div class="table-container shadow border-radius-8 border w-100 d-box ss-table"
                        *ngIf="!isLoadingVehicles">
                        <table class="table-bordered overflow-hidden border-radius-8  w-100">
                            <thead class="table-dark">
                                <tr>
                                    <th class="text-center align-middle" style="cursor: pointer;"
                                        (click)="sortList('id')">#</th>
                                    <th class="align-middle">Vehicle</th>
                                    <th class="align-middle" style="cursor: pointer;" (click)="sortList('createdAt')">
                                        Date</th>
                                    <th class="align-middle" style="cursor: pointer;" (click)="sortList('year')">Year
                                    </th>
                                    <th class="align-middle" style="cursor: pointer;" (click)="sortList('make')">Make
                                    </th>
                                    <th class="align-middle" style="cursor: pointer;" (click)="sortList('model')">Model
                                    </th>
                                    <th class="align-middle" style="cursor: pointer;" (click)="sortList('color')">Color
                                    </th>
                                    <th class="text-end align-middle" style="cursor: pointer;"
                                        (click)="sortList('price')">Estimate</th>
                                    <th class="align-middle" style="cursor: pointer;" (click)="sortList('customer')">
                                        Customer</th>
                                    <th class="align-middle">Phone</th>
                                    <th class="align-middle" style="cursor: pointer;"
                                        (click)="sortList('jobRequestType')">Job Type</th>
                                    <th class="align-middle" style="cursor: pointer;" (click)="sortList('status')">Job
                                        Status</th>
                                    <th class="text-center align-middle" style="cursor: pointer;"
                                        (click)="sortList('paid')">Paid</th>

                                    <!-- Dynamic columns based on report type -->
                                    <th *ngIf="shouldShowPaymentsColumn()" class="text-center align-middle">
                                        <div class="d-flex flex-column align-items-center">
                                            <i class="fas fa-credit-card me-1"></i>
                                            <small>Payments</small>
                                            <small class="text-muted">Count & Total</small>
                                        </div>
                                    </th>
                                    <th *ngIf="shouldShowReceiptsColumn()" class="text-center align-middle">
                                        <div class="d-flex flex-column align-items-center">
                                            <i class="fas fa-receipt me-1"></i>
                                            <small>Receipts</small>
                                            <small class="text-muted">Count & Total</small>
                                        </div>
                                    </th>
                                    <th *ngIf="shouldShowSupplementsColumn()" class="text-center align-middle">
                                        <div class="d-flex flex-column align-items-center">
                                            <i class="fas fa-plus-circle me-1"></i>
                                            <small>Supplements</small>
                                            <small class="text-muted">Count & Total</small>
                                        </div>
                                    </th>
                                    <th *ngIf="shouldShowResultColumn()" class="text-center align-middle">
                                        <div class="d-flex flex-column align-items-center">
                                            <i class="fas fa-calculator me-1"></i>
                                            <small>Result</small>
                                            <small class="text-muted">Payment Status</small>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let vehicle of vehicles; let i = index" data-bs-toggle="modal"
                                    data-bs-target="#editVehicle" title="Click to view details"
                                    (click)="toggleDivs(); getDetail(vehicle, i)" style="cursor: pointer;">
                                    <td class="text-center fw-bold align-middle">{{ i + 1 }}</td>
                                    <td class="align-middle">
                                        <div
                                            class="overflow-hidden hover-img transition rounded-1 border inline-block position-relative">
                                            <img *ngIf="vehicle.imageModels.length > 0 && vehicle.showInSearchImageId > 0"
                                                [src]="getVehicleImage(vehicle)" height="40" alt="Image"
                                                class="object-fill rounded-1 w-100" />
                                            <span *ngIf="vehicle.imageModels.length > 1"
                                                title="{{vehicle.imageModels.length}} images/photos"
                                                class="badge position-absolute top-3 end-12 translate-middle badge-pill bg-danger"
                                                style="top:8px; left:10px">
                                                {{vehicle.imageModels.length}}
                                            </span>
                                        </div>
                                    </td>
                                    <td class="text-center fs-13">
                                        {{ vehicle.createdAt | date: 'MM/dd' }}
                                    </td>
                                    <td class="align-middle">{{ vehicle.year }}</td>
                                    <td class="align-middle">
                                        <span [ngClass]="{'text-danger fw-700': vehicle.special ==true}"
                                            title="{{vehicle.make}}" class="car-{{ vehicle.make| lowercase }}">
                                            {{vehicle.make}}
                                        </span>
                                    </td>
                                    <td class="align-middle">{{ vehicle.model }}</td>
                                    <td class="text-center fs-13 text-shadow align-middle">
                                        <i class="fa-solid fa-square" title="{{vehicle.color}}"
                                            [style.color]="vehicle.color"></i>
                                    </td>
                                    <td class="text-end align-middle">
                                        <span class="fw-bold">{{ calculateEstimate(vehicle) | currency }}</span>
                                    </td>
                                    <td class="align-middle">{{ getCustomerName(vehicle) }}</td>
                                    <td class="align-middle">
                                        <small>{{ formatPhoneNumber(vehicle.customer.phone) || 'N/A' }}</small>
                                    </td>
                                    <td class="align-middle">
                                        <span class="badge bg-info">{{ getJobType(vehicle) }}</span>
                                    </td>
                                    <td class="align-middle">
                                        <span class="badge bg-warning">{{ getJobStatus(vehicle) }}</span>
                                    </td>
                                    <td class="text-center align-middle">
                                        <span class="badge" [ngClass]="vehicle.paid ? 'bg-success' : 'bg-danger'">
                                            {{ vehicle.paid ? 'Paid' : 'Unpaid' }}
                                        </span>
                                    </td>

                                    <!-- Dynamic columns based on report type - showing counts and totals (hide content if 0) -->
                                    <td *ngIf="shouldShowPaymentsColumn()" class="text-center align-middle">
                                        <div *ngIf="shouldShowVehiclePayments(vehicle)"
                                            class="d-flex flex-row align-items-middle">
                                            <span class="badge bg-info mb-1">
                                                {{ getVehiclePaymentsCount(vehicle) }}
                                            </span>
                                            <small class="text-muted">
                                                {{ getVehicleTotalPayments(vehicle) | currency }}
                                            </small>
                                        </div>
                                    </td>
                                    <td *ngIf="shouldShowReceiptsColumn()" class="text-center align-middle">
                                        <div *ngIf="shouldShowVehicleReceipts(vehicle)"
                                            class="d-flex flex-row align-items-middle">
                                            <span class="badge bg-secondary mb-1">
                                                {{ getVehicleReceiptsCount(vehicle) }}
                                            </span>
                                            <small class="text-muted">
                                                {{ getVehicleTotalReceipts(vehicle) | currency }}
                                            </small>
                                        </div>
                                    </td>
                                    <td *ngIf="shouldShowSupplementsColumn()" class="text-center align-middle">
                                        <div *ngIf="shouldShowVehicleSupplements(vehicle)"
                                            class="d-flex flex-row align-items-middle">
                                            <span class="badge bg-warning mb-1">
                                                {{ getVehicleSupplementsCount(vehicle) }}
                                            </span>
                                            <small class="text-muted">
                                                {{ getVehicleTotalSupplements(vehicle) | currency }}
                                            </small>
                                        </div>
                                    </td>
                                    <td *ngIf="shouldShowResultColumn()" class="text-center align-middle">
                                        <div class="d-flex flex-column align-items-center">
                                            <span class="badge"
                                                [ngClass]="'bg-' + getVehiclePaymentResult(vehicle).class">
                                                <i [class]="getVehiclePaymentResult(vehicle).icon" class="me-1"></i>
                                                {{ getVehiclePaymentResult(vehicle).text }}
                                            </span>
                                        </div>
                                    </td>
                                </tr>

                                <!-- Empty State -->
                                <tr *ngIf="vehicles.length === 0">
                                    <td [attr.colspan]="13 + (shouldShowPaymentsColumn() ? 1 : 0) + (shouldShowReceiptsColumn() ? 1 : 0) + (shouldShowSupplementsColumn() ? 1 : 0) + (shouldShowResultColumn() ? 1 : 0)"
                                        class="text-center py-5 text-muted">
                                        <i class="fas fa-car fa-3x mb-3"></i>
                                        <p class="mb-0">No vehicles found matching your criteria</p>
                                        <button class="btn btn-outline-primary btn-sm mt-2" (click)="refreshReport()">
                                            <i class="fas fa-sync me-1"></i>Refresh Data
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Footer with summary -->
                <div class="card-footer bg-light" *ngIf="vehicles.length > 0">
                    <div class="row text-center">
                        <div class="col-md-3">
                            <strong>Total Vehicles:</strong> {{ vehicles.length }}
                        </div>
                        <div class="col-md-3">
                            <strong>Paid:</strong> {{ getPaidVehiclesCount() }}
                        </div>
                        <div class="col-md-3">
                            <strong>Unpaid:</strong> {{ getUnpaidVehiclesCount() }}
                        </div>
                        <div class="col-md-3">
                            <strong>Total Estimates:</strong> {{ getTotalEstimates() | currency }}
                        </div>
                    </div>
                </div> <!-- Close table-container -->
            </div>
        </div>

        <!-- No Authentication Required Message -->
        <div *ngIf="!showReport && !isLoading && !errorMessage" class="text-center py-5">
            <i class="fas fa-shield-alt fa-3x text-success mb-3"></i>
            <h4>Production Mode Active</h4>
            <p class="text-muted">Authentication handled by backend. Loading report data...</p>
        </div>
    </div>
</div>


<div class="modal fade" id="addNewPart" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="addNewPartLabel">
    <div class="modal-dialog modal-lg">
        <div class="modal-content border-radius-8">
            <div class="modal-header p-4">
                <h1 class="modal-title fs-20 fw-600 text-capitalize" id="addNewPartLabel">Add Parts</h1>
                <button type="button" class="btn-close mt-1" aria-label="Close"
                    (click)="closeAddNewPartModal()"></button>
            </div>
            <div class="modal-body px-2 submit-form" style="max-height: 75vh; overflow-y: auto;">
                <div class="row">
                    <div class="col-12">
                        <div class="mt-4 pt-1 position-relative">
                            <label for="phone" class="form-label fs-14 fw-400 mb-3">Images / Photos</label>
                            <button name="btn" class="btn btn-secondary-abs py-3 px-3 w-100"><i
                                    class="fa fa-cloud-upload me-2"></i>
                                Upload Images</button>
                            <input type='file' accept="image/jpg, image/jpeg"
                                class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-5 position-absolute"
                                #fileInput (click)="fileInput.value = ''" (change)="onSelectFileNew($event)" multiple />
                        </div>
                        <h5 class="text-danger fw-700 mt-3">{{ message1}}</h5>
                    </div>
                    <div class="col-lg-6">
                        <div class="mt-2 pt-1 position-relative"> <img
                                *ngFor='let imageModel of imageModels;let i=index' (click)="setShowInSearch(i)"
                                [src]="imageModel.picByte" class="mt-3 preview img-fluid img-thumbnail me-3"
                                width="100" /> </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="mt-4 pt-1 position-relative">
                            <div class="containerImage" *ngIf="imageModels.length> 0"> <img *ngIf="imageUrl"
                                    [src]="imageUrl" class="image w-100 img-fluid img-thumbnail" />
                                <label *ngIf="imageUrl" class="top-left" for="title">Will Show This During
                                    Search</label>
                                <label *ngIf="imageUrl" class="bottom-left" for="title">Will Show This During
                                    Search</label>
                                <div class="bottom-right py-2">
                                    <button data-toggle="tooltip" data-placement="top" title="Remove this image"
                                        *ngIf="imageUrl" (click)="deleteCurerntImage()"
                                        class="btn btn-outline-danger mt-3 btn-sm" for="title"> <i class="bi-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="mt-4 pt-1">
                            <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Name</label>
                            <input trimText class="form-control h-48 px-3 border-radius-0" type="text" required
                                placeholder="Enter Parts name" #name="ngModel" [ngClass]="{ 'is-invalid': name.errors }"
                                minlength="2" maxlength="50" [(ngModel)]="selectedAutopart.title" />
                            <div class="invalid-feedback" *ngIf="name.errors "> <span
                                    *ngIf="name.errors['required']">Parts Name
                                    is
                                    required</span> <span *ngIf="name.errors['minlength']">Parts Name must be at least 2
                                    characters</span> <span *ngIf="name.errors['maxlength']">Parts Name must be at most
                                    50
                                    characters</span> </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="mt-4 pt-1">
                            <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Number</label>
                            <div class="input-group">
                                <input trimText class="form-control h-48 px-3 border-radius-0" type="text"
                                    placeholder="Enter Parts Number" #partNumber="ngModel"
                                    [ngClass]="{ 'is-invalid': partNumber.errors }" minlength="2" maxlength="50"
                                    [(ngModel)]="selectedAutopart.partNumber" name="partInfo" />

                            </div>
                            <div class="invalid-feedback" *ngIf="partNumber.errors "> <span
                                    *ngIf="partNumber.errors['required']">Parts Number is required</span> <span
                                    *ngIf="partNumber.errors['minlength']">Parts Number must be at least 2
                                    characters</span> <span *ngIf="partNumber.errors['maxlength']">Parts Number must be
                                    at most 50 characters</span> </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="mt-4 pt-1">
                            <label for="vendor" data-bs-toggle="tooltip" title="Click to go to Configuration"
                                [routerLink]="'/vendors'"
                                class="form-label fs-14 fw-400 mb-3 cursor-pointer">Vendor</label>
                            <select class="form-select h-48 px-3 border-radius-8" name="vendor"
                                [(ngModel)]="selectedAutopart.vendorId"
                                [disabled]="user.allowAddUpdateAutopart == false" #vendor="ngModel" required
                                [ngClass]="{ 'is-invalid': vendor.errors }">
                                <option value="undefined" disabled selected>Select Vendor</option>
                                <option [value]="vendor.id" *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}
                                </option>
                            </select>
                            <div class="invalid-feedback" *ngIf="vendor.errors">
                                <span *ngIf="vendor.errors['required']">Vendor is required</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="mt-4 pt-1">
                            <label for="description" class="form-label fs-14 fw-400 mb-3">Parts Description</label>
                            <textarea class="form-control h-48 px-3 border-radius-8" type="text"
                                placeholder="Enter Description" #description="ngModel" style="line-height: 2;"
                                [ngClass]="{ 'is-invalid': description.errors }" minlength="2" rows="2" maxlength="2000"
                                required [(ngModel)]="selectedAutopart.description" name="description"></textarea>
                            <div class="invalid-feedback" *ngIf="description.errors "> <span
                                    *ngIf="description.errors['required']">Part Description is required</span> <span
                                    *ngIf="description.errors['minlength']">Part Description must be at least 2
                                    characters</span> <span *ngIf="description.errors['maxlength']">Part Descripton must
                                    be at most
                                    2000
                                    characters</span> </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="mt-4 pt-1">
                            <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Comments</label>
                            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                                placeholder="Enter Comments" #comments="ngModel"
                                [ngClass]="{ 'is-invalid': comments.errors }" minlength="2" maxlength="500"
                                [(ngModel)]="selectedAutopart.comments" name="comments" />
                            <div class="invalid-feedback" *ngIf="comments.errors ">
                                <!-- <span *ngIf="partNumber.errors['required']">Parts Number is required</span> -->
                                <span *ngIf="comments.errors['minlength']">Parts Comments must be at least 2
                                    characters</span>
                                <span *ngIf="comments.errors['maxlength']">Parts Comments must be at most 500
                                    characters</span>
                            </div>
                        </div>
                    </div>


                    <div class="col-lg-6">
                        <div class="mt-4 pt-1">
                            <label for="grade" class="form-label fs-14 fw-400 mb-3">Grade</label>
                            <select name="grade" class="form-select h-48 px-3 border-radius-8" size="1"
                                [(ngModel)]="selectedAutopart.grade" required #grade="ngModel"
                                [ngClass]="{ 'is-invalid': grade.errors }">
                                <option value="undefined" disabled selected>Select Grade</option>
                                <option value="A">A</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                                <option value="Used">Used</option>
                                <option value="New">New</option>
                                <option value="Insurance">Insurance</option>
                            </select>
                            <div class="invalid-feedback" *ngIf="grade.errors "> <span
                                    *ngIf="grade.errors['required']">Grade is
                                    required</span> </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="mt-4 pt-1">
                            <label for="price" class="form-label fs-14 fw-400 mb-3">Price ($)</label>
                            <input trimText class="form-control h-48 px-3 border-radius-8" type="number"
                                placeholder="Enter Price" #salePrice="ngModel"
                                [ngClass]="{ 'is-invalid': salePrice.errors }" minlength="1" maxlength="10"
                                onKeyPress="if(this.value.length==10) return false" maxlength="10" required
                                oninput="if(this.value<0)this.value=this.value * -1"
                                [(ngModel)]="selectedAutopart.salePrice" name="price" />
                            <div class="invalid-feedback" *ngIf="salePrice.errors "> <span
                                    *ngIf="salePrice.errors['required']">Price
                                    is required</span> <span *ngIf="salePrice.errors['minlength']">Price must be at
                                    least 1
                                    characters</span> <span *ngIf="salePrice.errors['maxlength']">Price must be at most
                                    10
                                    characters</span> </div>
                        </div>
                    </div>

                    <div class="col-md-12" *ngIf="errorMessage !=''">
                        <div class="alert alert-danger mt-4">{{ errorMessage}}</div>
                    </div>
                    <div class="col-md-12">
                        <div class="mt-4 pt-1">
                            <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600"
                                *ngIf="selectedAutopart.id ==0" (click)="createNewAutopart()"> Save Info</button>
                            <button *ngIf="selectedAutopart.id> 0"
                                class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600" data-bs-toggle="modal"
                                data-bs-target="#partDetails" (click)="editAutopart(selectedAutopart, 0)">
                                Details</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" [hidden]="detailSelected == false" id="partDetails" data-bs-backdrop="static"
    data-bs-keyboard="false" tabindex="-1" aria-labelledby="partDetailsLabel">
    <div class="modal-dialog modal-lg" *ngIf="selectedAutopart">
        <div class="modal-content border-radius-8">
            <div class="modal-header p-4">
                <h1 class="modal-title fs-20 fw-600 text-capitalize" id="partDetailsLabel"
                    style="display: inline-block; word-break: break-word;">[ {{selectedAutopart.title
                    }} ] <span class="text-danger">[{{selectedAutopart.id}}]</span> FOR {{
                    selectedAutopart.year }} {{ selectedAutopart.make }} {{selectedAutopart.model }}
                </h1>
                <button type="button" class="btn-close mt-1" (click)="closePartDetailsModal()"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body px-2 submit-form">
                <div class="row" *ngIf="selectedAutopart.claimId > 0">
                    <div class="col-12">
                        <div class="row">
                            <h2 class="fs-15 pt-1 fw-700">Estimate ID - <span class="text-danger" titile="Estimate Id"
                                    *ngIf="selectedAutopart.claimId > 0">[{{selectedAutopart.claimId}}]</span><span
                                    class="text-danger"
                                    titile="Purchase Order Id">[{{selectedAutopart.purchaseOrderId}}]</span></h2>
                            <!-- <h2 class="fs-20 pt-1 fw-700">Purchase Order ID - <span class="text-danger"
                    titile="Purchase Order Id">[{{selectedAutopart.purchaseOrderId}}]</span></h2> -->
                            <div class="pt-1">
                                <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                                    <div class="table-responsive jobs-table bg-white border-radius-8 shadow">
                                        <table class="table table-bordered table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                                        style="width: 50px;">#</th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                                                        title="Click to go to Configuration"
                                                        [routerLink]="'/item-types'"
                                                        style="width:120px; cursor: pointer; ">Item Type</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">
                                                        Estimate Item
                                                        Description
                                                    </th>

                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                                                        style="width: 50px;">
                                                        Quantity</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120">
                                                        <i class="fa-solid fa-dollar-sign"></i>
                                                    </th>

                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                        style="width: 100px;">Subtotal</th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                        style="width: 120px;"><i class="fa-solid fa-clock"></i>
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                        style="width: 120px;">Locked <i class="fa-solid fa-clock"></i>
                                                    </th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                        <i class="fa-solid fa-user"></i>
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                        style="width:100px;">
                                                        Action</th>
                                                </tr>


                                            </thead>
                                            <tbody class="readonly">

                                                <tr (click)="setClaimId(claim.id)" class="shadow"
                                                    [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                                                    <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                                                        title="Drag and drop index number to change the order"
                                                        [cdkDragDisabled]="isMobile==true" cdkDrag>
                                                        <span class="fs-15 fw-700 text-danger">{{claim.id}}</span>
                                                    </td>
                                                    <td class="p-2 text-center">
                                                        <select class="form-select h-48 px-3 border-radius-8 "
                                                            [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                            (change)="onEnterClaimClaim('item type',claim)"
                                                            [(ngModel)]="claim.itemType">
                                                            <option value="0" disabled selected>Select Type</option>
                                                            <option value="0" *ngIf="claim.itemType>0">Un-select Type
                                                            </option>
                                                            <option [value]="itemType.id"
                                                                *ngFor="let itemType of itemTypes;let i=index;">
                                                                {{itemType.name}}
                                                            </option>
                                                        </select>
                                                    </td>
                                                    <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes"
                                                            class="form-control" placeholder="Please Specify"
                                                            (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                                            maxlength="200"
                                                            [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea>
                                                    </td>

                                                    <td class="fs-13 p-2"><input
                                                            (keyup.enter)="onEnterClaim('quantity',claim)"
                                                            [(ngModel)]="claim.quantity"
                                                            [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                            onKeyPress="if(this.value.length==10) return false"
                                                            pattern="[0-9]" type="number"
                                                            class="form-control form-control-sm h-40 border-radius-4" />
                                                    </td>
                                                    <td class="fs-13 p-2"><input
                                                            (keyup.enter)="onEnterClaim('amount',claim)"
                                                            [(ngModel)]="claim.amount"
                                                            [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                            onKeyPress="if(this.value.length==10) return false"
                                                            pattern="[0-9]" type="number"
                                                            class="form-control form-control-sm h-40 border-radius-4" />
                                                    </td>

                                                    <td class="fs-13 p-2 text-center v-align-middle">
                                                        ${{getClaimSubTotal(claim)}}</td>
                                                    <td class="fs-13 p-2 text-center v-align-middle">
                                                        {{claim.createdAt | date: 'MM/dd/yyyy'}}
                                                    </td>
                                                    <td class="fs-13  p-2 text-center v-align-middle"><span
                                                            *ngIf="claim.status==1">{{claim.lockedAt |
                                                            date }}</span></td>
                                                    <td class="p-2 text-center  v-align-middle">
                                                        <ng-container *ngFor="let user of users;let i=index;">
                                                            <span *ngIf="user.id == claim.userId">
                                                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                            </span>
                                                        </ng-container>

                                                    </td>
                                                    <td class="p-2 text-center">
                                                        <div
                                                            class="d-flex align-items-center justifyc-cntent-center gap-1">
                                                            <button class="btn btn-outline-success btn-sm"
                                                                *ngIf="claim.status==1"
                                                                [disabled]="user.allowUnlockEstimate == false"
                                                                title="Unlock this estimate item"
                                                                (click)="lockClaim('unlock', claim)"><i
                                                                    class="fa fa-lock-open"></i></button>
                                                            <button class="btn btn-outline-success btn-sm"
                                                                *ngIf="claim.status==0"
                                                                [disabled]="user.allowLockEstimate == false"
                                                                title="Lock this estimate item"
                                                                (click)="lockClaim('lock', claim)"><i
                                                                    class="fa fa-lock"></i></button>
                                                            <button class="btn btn-outline-danger btn-sm"
                                                                [disabled]="user.allowAddUpdateEstimate == false"
                                                                title="Delete"
                                                                (click)="deleteVehicleClaim(null, claim)"><i
                                                                    class="fa fa-trash"></i></button>
                                                            <button class="btn btn-outline-success btn-sm"
                                                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                title="Save"
                                                                (click)="onEnterClaimClaim('update', claim)"><i
                                                                    class="fa fa-save"></i></button>

                                                            <button class="btn btn-navy btn-sm"
                                                                *ngIf="claim.createPurchaseOrder == true"
                                                                [disabled]="user.allowAddUpdatePurchaseOrder == false || claim.notes =='' "
                                                                title="Add Purchase Order"
                                                                (click)="addPurchaseOrderToClaim( claim)"><i
                                                                    class="fa fa-plus"></i></button>

                                                            <button class="btn btn-info btn-sm"
                                                                *ngIf="claim.createJobOrder == true"
                                                                [disabled]="user.allowAddService == false || claim.notes ==''"
                                                                title="Add Job Order" (click)="addJobToClaim( claim)"><i
                                                                    class="fa fa-plus"></i></button>


                                                        </div>
                                                    </td>
                                                </tr>

                                                <ng-container
                                                    *ngIf="claim.createPurchaseOrder == true && claim.purchaseOrders.length> 0 ">
                                                    <tr>
                                                        <!-- <td></td> -->
                                                        <td class="text-center fs-14 v-align-middle opacity-50"><i
                                                                class="fa-solid fa-cart-shopping"></i></td>
                                                        <td colspan="9" cdkDropList
                                                            (cdkDropListDropped)="droppedPurchaseOrdersClaim($event, claim)">

                                                            <table
                                                                class="table-bordered table-sm shadow overflow-hidden  line-height-100 w-100"
                                                                *ngIf="claim.purchaseOrders.length >0">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="fs-12 text-center bg-navy text-white mw-50"
                                                                            (click)="sortListPurchseOrdersClaim('id',claim.purchaseOrders)"
                                                                            title="Sort By Most Recent">
                                                                            PO #
                                                                        </th>


                                                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                            (click)="sortListPurchseOrdersClaim('title',claim.purchaseOrders)"
                                                                            title="Sort By Item Name"> PO Item Name
                                                                        </th>
                                                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                            (click)="sortListPurchseOrdersClaim('partNumber',claim.purchaseOrders)"
                                                                            title="Sort By Parts Number"> Parts #
                                                                        </th>
                                                                        <th class="fs-12 text-center bg-navy text-white mw-150"
                                                                            (click)="sortListPurchseOrdersClaim('description',claim.purchaseOrders)"
                                                                            title="Sort By Description">
                                                                            Description </th>

                                                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                            (click)="sortListPurchseOrdersClaim('vendorId',claim.purchaseOrders)"
                                                                            title="Sort By Most Recent">Vender</th>

                                                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                            (click)="sortListPurchseOrdersClaim('status',claim.purchaseOrders)"
                                                                            title="Sort By Status">Approval</th>

                                                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                            style="width:100px"
                                                                            (click)="sortListPurchseOrdersClaim('purchaseStatus',claim.purchaseOrders)"
                                                                            title="Sort By Status">Status
                                                                        </th>
                                                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                            style="width:100px"
                                                                            (click)="sortListPurchseOrdersClaim('grade',claim.purchaseOrders)"
                                                                            title="Sort By Grade">
                                                                            Grade
                                                                        </th>
                                                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                            style="width:100px"
                                                                            (click)="sortListPurchseOrdersClaim('salePrice',claim.purchaseOrders)"
                                                                            title="Sort By Price">Price</th>
                                                                        <th class="fs-12 text-center bg-navy text-white mw-50"
                                                                            (click)="sortListPurchseOrdersClaim('createdAt',claim.purchaseOrders)"
                                                                            title="Sort By Date"><i
                                                                                class="fa-solid fa-clock"></i></th>
                                                                        <th
                                                                            class="fs-12 text-center bg-navy text-white mw-50">
                                                                            <i class="fa-solid fa-user"></i>
                                                                        </th>

                                                                        <th
                                                                            class="fs-12 text-center bg-navy text-white mw-100">
                                                                            Action</th>
                                                                    </tr>
                                                                </thead>
                                                                <ng-container
                                                                    *ngFor="let purchaseOrder of claim.purchaseOrders; let i = index;  let even=even">
                                                                    <tr id="{{vehicle.id}}"
                                                                        (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                        title="" style="cursor: pointer;"
                                                                        [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                                        <td class="text-center fs-12 v-align-middle"
                                                                            title="Drag and drop index number to change the order"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                            [cdkDragDisabled]="isMobile==true" cdkDrag>

                                                                            <ng-container
                                                                                *ngIf="selectedAutopart.purchaseOrderId == purchaseOrder.id">
                                                                                <span
                                                                                    class="fs-15 fw-700 text-danger">{{purchaseOrder.id}}</span>
                                                                            </ng-container>
                                                                            <ng-container
                                                                                *ngIf="selectedAutopart.purchaseOrderId != purchaseOrder.id">
                                                                                {{purchaseOrder.id}}
                                                                            </ng-container>
                                                                        </td>


                                                                        <td class="text-center fs-12 v-align-middle"
                                                                            title="Click to view details. Drag and drop index number to change the order"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                            <p class="fs-12 text-black opacity-75"
                                                                                style="display: inline-block; word-break: break-word;">
                                                                                {{purchaseOrder.title}}</p>
                                                                        </td>
                                                                        <td class="text-center fs-12 v-align-middle"
                                                                            title="Click to view details. Drag and drop index number to change the order"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                            <p class="fs-12 text-black opacity-75"
                                                                                style="display: inline-block; word-break: break-word;">
                                                                                {{purchaseOrder.partNumber}}</p>
                                                                        </td>


                                                                        <td class="text-center fs-12 v-align-middle"
                                                                            title="Click to view details. Drag and drop index number to change the order"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                            <p class="fs-12 text-black opacity-75"
                                                                                style="  display: -webkit-box;
                                  -webkit-box-orient: vertical;
                                  -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                   overflow: hidden;"> {{purchaseOrder.description}}
                                                                                <ng-container
                                                                                    *ngIf="purchaseOrder.purchaseStatus==1">
                                                                                    <br>
                                                                                    <span class="text-danger">Ordered
                                                                                        At: {{ purchaseOrder.orderedAt|
                                                                                        date: 'MM/dd/yyyy'}}</span>
                                                                                </ng-container>
                                                                                <ng-container
                                                                                    *ngIf="purchaseOrder.purchaseStatus==2">
                                                                                    <br>
                                                                                    <span class="text-danger">Ordered
                                                                                        At: {{ purchaseOrder.orderedAt|
                                                                                        date: 'MM/dd/yyyy'}}</span>
                                                                                    <br>
                                                                                    <span class="text-danger">Received
                                                                                        At:{{ purchaseOrder.receivedAt|
                                                                                        date: 'MM/dd/yyyy'}}</span>
                                                                                </ng-container>
                                                                                <ng-container
                                                                                    *ngIf="purchaseOrder.purchaseStatus==3">
                                                                                    <br>
                                                                                    <span class="text-danger">Ordered
                                                                                        At: {{ purchaseOrder.orderedAt|
                                                                                        date: 'MM/dd/yyyy'}}</span>
                                                                                    <br>
                                                                                    <span class="text-danger">Received
                                                                                        At:{{ purchaseOrder.receivedAt|
                                                                                        date: 'MM/dd/yyyy'}}</span>
                                                                                    <br>
                                                                                    <span class="text-danger">Returned
                                                                                        At:{{ purchaseOrder.returnedAt|
                                                                                        date: 'MM/dd/yyyy'}}</span>
                                                                                </ng-container>
                                                                            </p>
                                                                        </td>


                                                                        <td
                                                                            class="p-2 text-center  v-align-middle fs-12">

                                                                            <select
                                                                                class="form-select h-48 px-3 border-radius-8 fs-12"
                                                                                style="height:30px; appearance: none; background-image: url('');"
                                                                                disabled
                                                                                [(ngModel)]="purchaseOrder.vendorId">
                                                                                <option [value]=" vendor.id"
                                                                                    *ngFor="let vendor of vendors;let i=index;">
                                                                                    {{vendor.name}}
                                                                                </option>
                                                                            </select>
                                                                        </td>

                                                                        <td title="Set Approval Status"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                            class="text-center fs-12 v-align-middle">
                                                                            <select name="status"
                                                                                class="form-select border-radius-4 border fs-12"
                                                                                size="1" disabled
                                                                                style="height:30px; appearance: none; background-image: url('');"
                                                                                [(ngModel)]="purchaseOrder.status">
                                                                                <option value="0" selected>Not Submitted
                                                                                </option>
                                                                                <option value="1" style="color:green">
                                                                                    For Approval</option>
                                                                                <option value="2" style="color:red">
                                                                                    Rejected</option>
                                                                                <option value="3" style="color:blue">
                                                                                    Approved</option>
                                                                            </select>
                                                                        </td>

                                                                        <td title="Set Status" data-bs-toggle="modal"
                                                                            data-bs-toggle="modal"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                            class="text-center fs-12 v-align-middle">
                                                                            <select name="purchaseStatus"
                                                                                class="form-select border-radius-4 border fs-12"
                                                                                style="height:30px;" size="1"
                                                                                (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                                                                *ngIf="purchaseOrder.status == 3"
                                                                                [(ngModel)]="purchaseOrder.purchaseStatus">
                                                                                <option value="0" selected>No Status
                                                                                </option>
                                                                                <option value="1">Ordered</option>
                                                                                <option value="2">Received</option>
                                                                                <option value="3">Returned</option>
                                                                                <option value="4">Wrong Part</option>
                                                                            </select>
                                                                        </td>
                                                                        <td data-bs-toggle="modal"
                                                                            class="text-center fs-12 v-align-middle"
                                                                            title="Click to view details"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                            <select name="grade"
                                                                                style="height:30px; appearance: none; background-image: url('');"
                                                                                class="form-select h-48 border px-3 border-radius-8 fs-12"
                                                                                size="1" disabled
                                                                                [(ngModel)]="purchaseOrder.grade">
                                                                                <option value="undefined" disabled
                                                                                    selected>Select Grade</option>
                                                                                <option value="A">A</option>
                                                                                <option value="B">B</option>
                                                                                <option value="C">C</option>
                                                                                <option value="Used">Used</option>
                                                                                <option value="New">New</option>
                                                                                <option value="Insurance">Insurance
                                                                                </option>
                                                                            </select>
                                                                        </td>


                                                                        <td class="text-center fs-12 v-align-middle"
                                                                            title="Click to view details"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                            ${{purchaseOrder.salePrice}}
                                                                        </td>
                                                                        <td class="text-center fs-12 v-align-middle"
                                                                            title="Click to view details"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                            {{purchaseOrder.createdAt |
                                                                            date: 'MM/dd/yyyy'}} </td>
                                                                        <td
                                                                            class="p-2 text-center  v-align-middle fs-12">
                                                                            <ng-container
                                                                                *ngFor="let user of users;let i=index;">
                                                                                <span
                                                                                    *ngIf="user.id == purchaseOrder.userId">
                                                                                    {{(user.firstName + " " +
                                                                                    user.lastName) | shortName:2}}
                                                                                </span>
                                                                            </ng-container>

                                                                        </td>
                                                                        <td class="text-center fs-12 v-align-middle">
                                                                            <div class="d-flex gap-1">
                                                                                <button
                                                                                    class="btn btn-outline-danger btn-sm"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                    *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                                                                    (click)="deletePurchaseOrderInline(purchaseOrder, i)">
                                                                                    <i class="fa fa-trash"></i>
                                                                                </button>

                                                                                <button
                                                                                    class="btn btn-outline-warning btn-sm"
                                                                                    *ngIf="purchaseOrder.status ==0"
                                                                                    title="Submit for Approval"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                                                    [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                    <i class="fa fa-arrow-right"></i>
                                                                                </button>

                                                                                <button
                                                                                    class="btn btn-outline-warning btn-sm"
                                                                                    *ngIf="purchaseOrder.status ==2"
                                                                                    title="Re-Submit for Approval"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                                                    [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                    <i class="fa fa-arrow-right"></i>
                                                                                </button>

                                                                                <button
                                                                                    class="btn btn-outline-danger btn-sm"
                                                                                    *ngIf="purchaseOrder.status ==1"
                                                                                    title="Reject It"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                                                                    [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                    <i class="fa fa-ban"></i>
                                                                                </button>

                                                                                <button
                                                                                    class="btn btn-outline-success btn-sm"
                                                                                    *ngIf="purchaseOrder.status ==1"
                                                                                    title="Approve It"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                                                                    [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                    <i class="fa fa-check-square"></i>
                                                                                </button>

                                                                                <button
                                                                                    class="btn btn-outline-danger btn-sm"
                                                                                    *ngIf="purchaseOrder.status ==3"
                                                                                    title="Un-Approve It"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                                                                    [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                    <i class="fa fa-arrow-left"></i>
                                                                                </button>

                                                                                <button class="btn btn-warning btn-sm"
                                                                                    *ngIf="purchaseOrder.status == 3"
                                                                                    [disabled]="user.allowAddUpdateAutopart == false"
                                                                                    title="Add Parts"
                                                                                    (click)="addAutopartToPurchaseOrder( claim, purchaseOrder)"><i
                                                                                        class="fa fa-plus"></i></button>

                                                                            </div>
                                                                        </td>
                                                                    </tr>

                                                                    <ng-container
                                                                        *ngIf="purchaseOrder.autoparts.length> 0 ">
                                                                        <tr>
                                                                            <!-- <td></td> -->
                                                                            <td
                                                                                class="text-center fs-14 v-align-middle opacity-50">
                                                                                <i class="fa-solid fa-tools"></i>
                                                                            </td>
                                                                            <td colspan="11" cdkDropList
                                                                                (cdkDropListDropped)="droppedAutoprtsPurchaseOrder($event, purchaseOrder)">


                                                                                <table
                                                                                    class="table-bordered table-sm overflow-hidden shadow line-height-100 w-100">
                                                                                    <thead>
                                                                                        <tr
                                                                                            class="fs-12 text-center bg-warning v-align-middle text-white mw-50">
                                                                                            <th class="fs-12 text-center  mw-50"
                                                                                                (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                                                                title="Sort By Most Recent">
                                                                                                #
                                                                                            </th>
                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                                                                title="Sort By Most Recent">
                                                                                                Image</th>

                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)="sortListAutopartsPurchaseOrder('title', purchaseOrder)"
                                                                                                title="Sort By Parts Name">
                                                                                                Name </th>
                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)=" sortListAutopartsPurchaseOrder('partNumber', purchaseOrder)"
                                                                                                title="Sort By Parts Number">
                                                                                                Parts # </th>
                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)=" sortListAutopartsPurchaseOrder('description', purchaseOrder)"
                                                                                                title="Sort By Description">
                                                                                                Desc </th>


                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)="sortListAutopartsPurchaseOrder('purchaseStatus', purchaseOrder)"
                                                                                                title="Sort By Status">
                                                                                                Status </th>
                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)="sortListAutopartsPurchaseOrder('grade', purchaseOrder)"
                                                                                                title="Sort By Grade">
                                                                                                Grade
                                                                                            </th>
                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)="sortListAutopartsPurchaseOrder('salePrice', purchaseOrder)"
                                                                                                title="Sort By Price">
                                                                                                Price </th>
                                                                                            <th class="fs-12 text-center  mw-100"
                                                                                                (click)="sortListAutopartsPurchaseOrder('createdAt', purchaseOrder)"
                                                                                                title="Sort By Date"> At
                                                                                            </th>
                                                                                            <th
                                                                                                class="fs-14 text-center mw-50">
                                                                                                By </th>
                                                                                            <th
                                                                                                class="fs-12 text-center  mw-100">
                                                                                                Action</th>
                                                                                        </tr>
                                                                                    </thead>
                                                                                    <ng-container
                                                                                        *ngFor="let autopart of purchaseOrder.autoparts; let i = index;  let even=even">
                                                                                        <tr id="{{vehicle.id}}"
                                                                                            (click)="editAutopart(autopart, i)"
                                                                                            title=""
                                                                                            class="cursor-pointer"
                                                                                            [style.background-color]="i == cindexAutpartPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                                data-bs-toggle="modal"
                                                                                                data-bs-target="#partDetails"
                                                                                                title="Drag and drop index number to change the order"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()"
                                                                                                [cdkDragDisabled]="isMobile==true"
                                                                                                cdkDrag>

                                                                                                <ng-container
                                                                                                    *ngIf="autopart.id == selectedAutopart.id">
                                                                                                    <span
                                                                                                        class="fs-15 fw-700 text-danger">
                                                                                                        {{autopart.id}}</span>
                                                                                                </ng-container>
                                                                                                <ng-container
                                                                                                    *ngIf="autopart.id != selectedAutopart.id">
                                                                                                    {{autopart.id}}
                                                                                                </ng-container>

                                                                                            </td>
                                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                                data-bs-toggle="modal"
                                                                                                data-bs-target="#partDetails"
                                                                                                (mouseover)="hover = vehicle"
                                                                                                (mouseleave)="hover = null"
                                                                                                title="Click to view details. Drag and drop index number to change the order"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                <div
                                                                                                    class="overflow-hidden hover-img transition rounded-1 border">
                                                                                                    <img *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                                                                        src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                                                                        height="40"
                                                                                                        width="100"
                                                                                                        alt="Image"
                                                                                                        class="object-fill rounded-1 w-100" />
                                                                                                </div>
                                                                                            </td>
                                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                                data-bs-toggle="modal"
                                                                                                data-bs-target="#partDetails"
                                                                                                title="Click to view details. Drag and drop index number to change the order"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                <p class="fs-12 text-black opacity-75"
                                                                                                    style="display: inline-block; word-break: break-word;">
                                                                                                    {{autopart.title}}
                                                                                                </p>
                                                                                            </td>
                                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                                data-bs-toggle="modal"
                                                                                                data-bs-target="#partDetails"
                                                                                                title="Click to view details. Drag and drop index number to change the order"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                <p class="fs-12 text-black opacity-75"
                                                                                                    style="display: inline-block; word-break: break-word;">
                                                                                                    {{autopart.partNumber}}
                                                                                                </p>
                                                                                            </td>
                                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                                data-bs-toggle="modal"
                                                                                                data-bs-target="#partDetails"
                                                                                                title="Click to view details. Drag and drop index number to change the order"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                <p class="fs-12 text-black opacity-75"
                                                                                                    style="  display: -webkit-box;
                                                -webkit-box-orient: vertical;
                                                -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                                 overflow: hidden;"> {{autopart.description}}
                                                                                                    <ng-container
                                                                                                        *ngIf="autopart.purchaseStatus==1">
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Ordered
                                                                                                            At: {{
                                                                                                            autopart.orderedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                    </ng-container>
                                                                                                    <ng-container
                                                                                                        *ngIf="autopart.purchaseStatus==2">
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Ordered
                                                                                                            At: {{
                                                                                                            autopart.orderedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Received
                                                                                                            At:{{
                                                                                                            autopart.receivedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                    </ng-container>
                                                                                                    <ng-container
                                                                                                        *ngIf="autopart.purchaseStatus==3">
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Ordered
                                                                                                            At: {{
                                                                                                            autopart.orderedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Received
                                                                                                            At:{{
                                                                                                            autopart.receivedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Returned
                                                                                                            At:{{
                                                                                                            autopart.returnedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                    </ng-container>
                                                                                                    <ng-container
                                                                                                        *ngIf="autopart.purchaseStatus==4">
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Ordered
                                                                                                            At: {{
                                                                                                            autopart.orderedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Received
                                                                                                            At:{{
                                                                                                            autopart.receivedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                        <br>
                                                                                                        <span
                                                                                                            class="text-danger">Returned
                                                                                                            At:{{
                                                                                                            autopart.returnedAt|
                                                                                                            date:
                                                                                                            'MM/dd/yyyy'}}</span>
                                                                                                    </ng-container>
                                                                                                </p>
                                                                                            </td>

                                                                                            <td title="Set Status"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()"
                                                                                                class="text-center fs-12 v-align-middle">
                                                                                                <select
                                                                                                    name="purchaseStatus"
                                                                                                    class="form-select border-radius-4 border fs-12"
                                                                                                    size="1"
                                                                                                    (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                                                                    [(ngModel)]="autopart.purchaseStatus">
                                                                                                    <option value="0"
                                                                                                        selected>No
                                                                                                        Status</option>
                                                                                                    <option value="1">
                                                                                                        Ordered</option>
                                                                                                    <option value="2">
                                                                                                        Received
                                                                                                    </option>
                                                                                                    <option value="3">
                                                                                                        Returned
                                                                                                    </option>
                                                                                                    <option value="4">
                                                                                                        Wrong Part
                                                                                                    </option>
                                                                                                </select>
                                                                                            </td>
                                                                                            <td data-bs-toggle="modal"
                                                                                                class="text-center fs-12 v-align-middle"
                                                                                                data-bs-target="#partDetails"
                                                                                                title="Click to view details"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                <select name="grade"
                                                                                                    style=" appearance: none;
                                            background-image: url('');" class="form-select border px-3 border-radius-8 fs-12"
                                                                                                    size="1" disabled
                                                                                                    [(ngModel)]="autopart.grade">
                                                                                                    <option
                                                                                                        value="undefined"
                                                                                                        disabled
                                                                                                        selected>Select
                                                                                                        Grade</option>
                                                                                                    <option value="A">A
                                                                                                    </option>
                                                                                                    <option value="B">B
                                                                                                    </option>
                                                                                                    <option value="C">C
                                                                                                    </option>
                                                                                                    <option
                                                                                                        value="Used">
                                                                                                        Used</option>
                                                                                                    <option value="New">
                                                                                                        New</option>
                                                                                                    <option
                                                                                                        value="Insurance">
                                                                                                        Insurance
                                                                                                    </option>
                                                                                                </select>
                                                                                            </td>


                                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                                data-bs-toggle="modal"
                                                                                                data-bs-target="#partDetails"
                                                                                                title="Click to view details"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                ${{autopart.salePrice}}
                                                                                            </td>
                                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                                data-bs-toggle="modal"
                                                                                                data-bs-target="#partDetails"
                                                                                                title="Click to view details"
                                                                                                (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                {{autopart.createdAt |
                                                                                                date: 'MM/dd/yyyy'}}
                                                                                            </td>
                                                                                            <td
                                                                                                class="p-2 text-center fs-12  v-align-middle">

                                                                                                <ng-container
                                                                                                    *ngFor="let user of users;let i=index;">
                                                                                                    <span
                                                                                                        *ngIf="user.id == autopart.userId">
                                                                                                        {{(user.firstName
                                                                                                        + " " +
                                                                                                        user.lastName) |
                                                                                                        shortName:2}}
                                                                                                    </span>
                                                                                                </ng-container>



                                                                                            </td>
                                                                                            <td
                                                                                                class="text-center fs-12 v-align-middle">
                                                                                                <div
                                                                                                    class="d-flex gap-2">
                                                                                                    <button
                                                                                                        class="btn btn-outline-danger btn-sm"
                                                                                                        (click)="editAutopart(autopart, i)"
                                                                                                        *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                                                                        (click)="deleteAutopartPurchaseOrder(autopart, i, purchaseOrder)">
                                                                                                        <i
                                                                                                            class="fa fa-trash"></i>
                                                                                                    </button>
                                                                                                    <button
                                                                                                        class="btn btn-outline-warning btn-sm"
                                                                                                        (click)="editAutopart(autopart, i)"
                                                                                                        *ngIf="this.user.allowAddUpdateAutopart == true"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#editPart"
                                                                                                        (click)="showEditPartModal()"><i
                                                                                                            class="fa fa-edit"></i>
                                                                                                    </button>
                                                                                                </div>
                                                                                            </td>
                                                                                        </tr>
                                                                                    </ng-container>
                                                                                </table>



                                                                            </td>
                                                                        </tr>
                                                                    </ng-container>

                                                                </ng-container>
                                                            </table>

                                                        </td>
                                                    </tr>
                                                </ng-container>

                                                <ng-container
                                                    *ngIf="claim.createJobOrder == true && claim.jobs.length> 0">
                                                    <tr>
                                                        <td></td>
                                                        <td class="text-center fs-14 v-align-middle opacity-50"><i
                                                                class="fas fa-user"></i></td>
                                                        <td colspan="8">
                                                            <ng-container>
                                                                <table
                                                                    class="table-bordered table-sm overflow-hidden shadow  line-height-100 w-100"
                                                                    cdkDropList
                                                                    (cdkDropListDropped)="droppedJobsClaim($event, claim)">
                                                                    <thead>

                                                                        <tr>
                                                                            <th class="fs-12 text-center bg-info text-white"
                                                                                style="width:50px">JO #</th>
                                                                            <th
                                                                                class="fs-12 text-center bg-info text-white mw-100">
                                                                                Job Order Name</th>
                                                                            <th class="fs-12 text-center bg-info text-white"
                                                                                style="min-width:150px">
                                                                                Instruction
                                                                            </th>
                                                                            <th class="fs-12 text-center bg-info text-white mw-100"
                                                                                style="width:100px">
                                                                                Assigned
                                                                                To</th>
                                                                            <th class="fs-12 text-center bg-info text-white"
                                                                                style="width:100px">$
                                                                            </th>
                                                                            <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                                                            <th
                                                                                class="fs-12 text-center bg-info text-white mw-100">
                                                                                Target</th>
                                                                            <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                                                            <th class="fs-12 text-center bg-info text-white "
                                                                                style="width:50px">Status
                                                                            </th>
                                                                            <th
                                                                                class="fs-12 text-center bg-info text-white mw-50">
                                                                                <i class="fa-solid fa-user"></i>
                                                                            </th>
                                                                            <th
                                                                                class="fs-12 text-center bg-info text-white mw-100">
                                                                                Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>

                                                                        <tr (click)="setJobId(job.id)"
                                                                            *ngFor="let job of claim.jobs; let i=index">
                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                [cdkDragDisabled]="isMobile==true"
                                                                                cdkDrag>
                                                                                {{job.id}}
                                                                            </td>
                                                                            <td
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <input placeholder="Enter Job Name"
                                                                                    [(ngModel)]="job.name"
                                                                                    maxlength="50"
                                                                                    (keyup.enter)="onEnter('job name',job)"
                                                                                    type="text"
                                                                                    [disabled]="job.paidWeek> 0"
                                                                                    class="form-control h-40 border-radius-4 border" />
                                                                            </td>
                                                                            <td
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <textarea type="text" rows="1"
                                                                                    [(ngModel)]="job.notes"
                                                                                    class="form-control my-2"
                                                                                    maxlength="200"
                                                                                    (keyup.enter)="onEnter('job notes',job)"
                                                                                    title="Job Instruction"
                                                                                    [disabled]="job.paidWeek> 0"
                                                                                    oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                                                            </td>

                                                                            <td
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <select
                                                                                    class="form-select border-radius-4 h-40 border fs-12 "
                                                                                    [(ngModel)]="job.employeeId" #device
                                                                                    [disabled]="job.paidWeek> 0"
                                                                                    style="height:30px;"
                                                                                    (change)="onChangeEmployee2Claim($event, device.value, job, claim)">
                                                                                    <option value="0" disabled selected>
                                                                                        Select Employee</option>
                                                                                    <option [value]="employee.id"
                                                                                        [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                                                                        *ngFor="let employee of employees;let i=index;">
                                                                                        {{employee.firstName}}
                                                                                        {{employee.lastName}}
                                                                                        (
                                                                                        {{employee.roleName}},{{employee.rolePrecentage}}%
                                                                                        <ng-container
                                                                                            *ngIf="employee.commissionBased == true">
                                                                                            - <span
                                                                                                class="fw-700 text-danger">Commission
                                                                                                Based</span>
                                                                                        </ng-container>)
                                                                                        [{{
                                                                                        employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                                                                        +
                                                                                        employee.jobCountsFinished}}]
                                                                                    </option>
                                                                                </select>
                                                                            </td>
                                                                            <td
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <input placeholder="Enter Job Value"
                                                                                    [(ngModel)]="job.price"
                                                                                    maxlength="50" class="fs-12"
                                                                                    (keyup.enter)="onEnter('job price',job)"
                                                                                    type="number"
                                                                                    [disabled]="job.paidWeek> 0"
                                                                                    class="form-control border h-40 border-radius-4" />
                                                                            </td>

                                                                            <td
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <input *ngIf="job.employeeId > 0"
                                                                                    (change)="onChangeCalendar($event, job)"
                                                                                    max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                                                                    [disabled]="job.paidWeek> 0"
                                                                                    [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                                                                                    title="Target Date" type="date"
                                                                                    class="form-control border h-40 border-radius-4" />
                                                                            </td>

                                                                            <td class="p-2 text-center v-align-middle">
                                                                                <div
                                                                                    class="form-check text-center pt-2">
                                                                                    <input trimText
                                                                                        class="form-check-input mx-auto mt-0"
                                                                                        type="checkbox"
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        *ngIf="job.employeeId > 0 && job.targetDate != null"
                                                                                        [checked]="isJobChecked(job)"
                                                                                        (change)="updateJobStatus(job)" />
                                                                                </div>
                                                                            </td>
                                                                            <td
                                                                                class="p-2 text-center  v-align-middle fs-12">

                                                                                <ng-container
                                                                                    *ngFor="let user of users;let i=index;">
                                                                                    <span *ngIf="user.id == job.userId">
                                                                                        {{(user.firstName + " " +
                                                                                        user.lastName) | shortName:2}}
                                                                                    </span>
                                                                                </ng-container>





                                                                            </td>
                                                                            <td
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <div
                                                                                    class="d-flex align-items-center justifyc-ntent-center gap-1">
                                                                                    <button
                                                                                        class="btn btn-outline-danger btn-sm"
                                                                                        title="Remove"
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        (click)="deleteVehicleJobClaim(null, job)"><i
                                                                                            class="fa fa-trash"></i></button>
                                                                                    <button
                                                                                        class="btn btn-outline-primary btn-sm"
                                                                                        title="Save"
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        (click)="saveJobNotes(job)"><i
                                                                                            class="fa fa-save"></i></button>
                                                                                    <button
                                                                                        class="btn btn-outline-dark btn-sm"
                                                                                        title="Print"
                                                                                        (click)="setJobId(job.id)"
                                                                                        (click)="printPageJob('print-content-job', 'jobs', job)">
                                                                                        <i class="fa fa-print"></i>
                                                                                    </button>
                                                                                </div>
                                                                            </td>
                                                                        </tr>

                                                                    </tbody>
                                                                </table>
                                                            </ng-container>

                                                        </td>
                                                    </tr>


                                                </ng-container>


                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <div class="mt-2 pt-1 position-relative">
                            <div *ngFor='let imageModel of selectedAutopart.imageModels; let i=index'
                                class="d-inline-block me-2">
                                <img class="mt-3 preview img-fluid img-thumbnail me-3" width="100"
                                    *ngIf="selectedAutopart.showInSearchImageId != imageModel.id"
                                    src="{{baseUrlResizeImageParts + '/' + imageModel.id}}"
                                    (click)="setImageAutoPart(i)" style="border: 3px solid #555;"> <img
                                    class="mt-3 preview img-fluid img-thumbnail me-3" width="100"
                                    *ngIf="selectedAutopart.showInSearchImageId == imageModel.id"
                                    src="{{baseUrlResizeImageParts + '/' + imageModel.id}}"
                                    (click)="setImageAutoPart(i)" title="Show in search"
                                    style="border: 3px solid lightcoral;">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="mt-4 pt-1 position-relative">
                            <div class="containerImage"> <img
                                    *ngIf="selectedImage != null && selectedAutopart.showInSearchImageId > 0 && selectedAutopart.showInSearchImageId != selectedImage"
                                    class="image w-100 img-fluid img-thumbnail"
                                    src="{{baseUrlImageParts + '/' + selectedImage}}" alt="Image" /> <img
                                    *ngIf="selectedImage != null &&  selectedAutopart.showInSearchImageId > 0 && selectedAutopart.showInSearchImageId == selectedImage"
                                    class="image w-100 img-fluid img-thumbnail"
                                    src="{{baseUrlImageParts + '/' + selectedImage}}" alt="Image" /> </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="mt-4 pt-1">
                            <p class="py-2 fs-13 line-height-130"
                                style="display: inline-block; word-break: break-word;">{{
                                selectedAutopart.comments }}</p>
                            <p class="py-2 fs-13 line-height-130"
                                style="display: inline-block; word-break: break-word;">{{
                                selectedAutopart.description }}</p>
                            <div class="clearfix"></div>
                            <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"
                                style="display: inline-block; word-break: break-word;"><b>Part No.: </b> {{
                                selectedAutopart.partNumber
                                }}</p>
                            <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"
                                style="display: inline-block; word-break: break-word;"><b>Vendor.: </b> {{
                                getVendorName(selectedAutopart.vendorId)
                                }}</p>
                            <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"
                                style="display: inline-block; word-break: break-word;"><b>Stock No.: </b> {{
                                selectedAutopart.stocknumber
                                }}</p>
                            <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"><b>Grade: </b> {{
                                selectedAutopart.grade
                                }}
                            </p>
                            <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"><b>Sales Price: </b> $ {{
                                selectedAutopart.salePrice }}</p>
                            <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"><b>Created At: </b>{{
                                selectedAutopart.createdAt| date: 'MM/dd/yyyy' }}</p>
                            <p class="py-2 fs-13 line-height-130 w-50 d-inline-block">
                                <ng-container *ngIf="selectedAutopart.purchaseStatus==1"> <br>
                                    <span style="color:red">Ordered At: {{ selectedAutopart.orderedAt| date:
                                        'MM/dd/yyyy'}}</span>
                                </ng-container>
                                <ng-container *ngIf="selectedAutopart.purchaseStatus==2"> <br>
                                    <span style="color:red">Ordered At: {{ selectedAutopart.orderedAt| date:
                                        'MM/dd/yyyy'}}</span>
                                    <br>
                                    <span style="color:red">Received At:{{ selectedAutopart.receivedAt| date:
                                        'MM/dd/yyyy'}}</span>
                                </ng-container>
                                <ng-container *ngIf="selectedAutopart.purchaseStatus==3"> <br>
                                    <span style="color:red">Ordered At: {{ selectedAutopart.orderedAt| date:
                                        'MM/dd/yyyy'}}</span>
                                    <br>
                                    <span style="color:red">Received At:{{ selectedAutopart.receivedAt| date:
                                        'MM/dd/yyyy'}}</span>
                                    <br>
                                    <span style="color:red">Returned At:{{ selectedAutopart.returnedAt| date:
                                        'MM/dd/yyyy'}}</span>
                                </ng-container>
                            </p>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<div class="modal fade" id="editPart" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="editPartLabel">
    <div class="modal-dialog modal-lg">
        <div class="modal-content border-radius-8">
            <div class="modal-header p-4">
                <h1 class="modal-title fs-20 fw-600 text-capitalize" id="editPartLabel"
                    style="display: inline-block; word-break: break-word;">Edit [{{selectedAutopart.title
                    }}] <span class="text-danger">[{{selectedAutopart.id}}]</span> FOR {{
                    selectedAutopart.year }} {{ selectedAutopart.make }} {{selectedAutopart.model }}
                </h1>
                <button type="button" (click)="closeEditPartModal()" class="btn-close mt-1" aria-label="Close"></button>
            </div>
            <div class="modal-body px-2 submit-form" *ngIf="currentUser">
                <div class="modal-body px-2 submit-form">
                    <div class="row" *ngIf="selectedAutopart.claimId > 0">
                        <div class="col-12">
                            <div class="row">
                                <h2 class="fs-20 pt-1 fw-700">Estimate ID - <span class="text-danger"
                                        titile="Estimate Id">[{{selectedAutopart.claimId}}]</span></h2>
                                <h2 class="fs-20 pt-1 fw-700">Purchase Order ID - <span class="text-danger"
                                        titile="Purchase Order Id">[{{selectedAutopart.purchaseOrderId}}]</span></h2>
                                <div class="pt-1">
                                    <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                                        <div class="table-responsive jobs-table bg-white border-radius-8 shadow">
                                            <table class="table table-bordered table-sm">
                                                <thead>
                                                    <tr>
                                                        <!-- <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120" style="width: 150px;">Item Name</th> -->
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                                            style="width: 50px;">#</th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                                                            title="Click to go to Configuration"
                                                            [routerLink]="'/item-types'"
                                                            style="width:120px; cursor: pointer; ">Item Type</th>
                                                        <th
                                                            class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">
                                                            Estimate Item
                                                            Description
                                                        </th>

                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                                                            style="width: 50px;">
                                                            Quantity</th>
                                                        <th
                                                            class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120">
                                                            <i class="fa-solid fa-dollar-sign"></i>
                                                        </th>

                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                            style="width: 100px;">Subtotal</th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                            style="width: 120px;"><i class="fa-solid fa-clock"></i>
                                                        </th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                            style="width: 120px;">Locked <i
                                                                class="fa-solid fa-clock"></i></th>
                                                        <th
                                                            class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                            <i class="fa-solid fa-user"></i>
                                                        </th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                            style="width:100px;">
                                                            Action</th>
                                                    </tr>


                                                </thead>
                                                <tbody class="readonly">

                                                    <tr (click)="setClaimId(claim.id)" class="shadow"
                                                        [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                                                        <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                                                            title="Drag and drop index number to change the order"
                                                            [cdkDragDisabled]="isMobile==true" cdkDrag>
                                                            <span class="fs-15 fw-700 text-danger">{{claim.id}}</span>
                                                        </td>
                                                        <td class="p-2 text-center">
                                                            <select class="form-select h-48 px-3 border-radius-8 "
                                                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                (change)="onEnterClaimClaim('item type',claim)"
                                                                [(ngModel)]="claim.itemType">
                                                                <option value="0" disabled selected>Select Type</option>
                                                                <option value="0" *ngIf="claim.itemType>0">Un-select
                                                                    Type</option>
                                                                <option [value]="itemType.id"
                                                                    *ngFor="let itemType of itemTypes;let i=index;">
                                                                    {{itemType.name}}
                                                                </option>
                                                            </select>
                                                        </td>
                                                        <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes"
                                                                class="form-control" placeholder="Please Specify"
                                                                (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                                                maxlength="200"
                                                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea>
                                                        </td>

                                                        <td class="fs-13 p-2"><input
                                                                (keyup.enter)="onEnterClaim('quantity',claim)"
                                                                [(ngModel)]="claim.quantity"
                                                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                onKeyPress="if(this.value.length==10) return false"
                                                                pattern="[0-9]" type="number"
                                                                class="form-control form-control-sm h-40 border-radius-4" />
                                                        </td>
                                                        <td class="fs-13 p-2"><input
                                                                (keyup.enter)="onEnterClaim('amount',claim)"
                                                                [(ngModel)]="claim.amount"
                                                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                onKeyPress="if(this.value.length==10) return false"
                                                                pattern="[0-9]" type="number"
                                                                class="form-control form-control-sm h-40 border-radius-4" />
                                                        </td>

                                                        <td class="fs-13 p-2 text-center v-align-middle">
                                                            ${{getClaimSubTotal(claim)}}</td>
                                                        <td class="fs-13 p-2 text-center v-align-middle">
                                                            {{claim.createdAt | date: 'MM/dd/yyyy'}}
                                                        </td>
                                                        <td class="fs-13  p-2 text-center v-align-middle"><span
                                                                *ngIf="claim.status==1">{{claim.lockedAt |
                                                                date }}</span></td>
                                                        <td class="p-2 text-center  v-align-middle">

                                                            <ng-container *ngFor="let user of users;let i=index;">
                                                                <span *ngIf="user.id == claim.userId">
                                                                    {{(user.firstName + " " + user.lastName) |
                                                                    shortName:2}}
                                                                </span>
                                                            </ng-container>


                                                        </td>
                                                        <td class="p-2 text-center">
                                                            <div
                                                                class="d-flex align-items-center justifyc-cntent-center gap-1">
                                                                <button class="btn btn-outline-success btn-sm"
                                                                    *ngIf="claim.status==1"
                                                                    [disabled]="user.allowUnlockEstimate == false"
                                                                    title="Unlock this estimate item"
                                                                    (click)="lockClaim('unlock', claim)"><i
                                                                        class="fa fa-lock-open"></i></button>
                                                                <button class="btn btn-outline-success btn-sm"
                                                                    *ngIf="claim.status==0"
                                                                    [disabled]="user.allowLockEstimate == false"
                                                                    title="Lock this estimate item"
                                                                    (click)="lockClaim('lock', claim)"><i
                                                                        class="fa fa-lock"></i></button>
                                                                <button class="btn btn-outline-danger btn-sm"
                                                                    [disabled]="user.allowAddUpdateEstimate == false"
                                                                    title="Delete"
                                                                    (click)="deleteVehicleClaim(null, claim)"><i
                                                                        class="fa fa-trash"></i></button>
                                                                <button class="btn btn-outline-success btn-sm"
                                                                    [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                    title="Save"
                                                                    (click)="onEnterClaimClaim('update', claim)"><i
                                                                        class="fa fa-save"></i></button>

                                                                <button class="btn btn-navy btn-sm"
                                                                    *ngIf="claim.createPurchaseOrder == true"
                                                                    [disabled]="user.allowAddUpdatePurchaseOrder == false"
                                                                    title="Add Purchase Order"
                                                                    (click)="addPurchaseOrderToClaim( claim)"><i
                                                                        class="fa fa-plus"></i></button>

                                                                <button class="btn btn-info btn-sm"
                                                                    *ngIf="claim.createJobOrder == true"
                                                                    [disabled]="user.allowAddService == false"
                                                                    title="Add Job Order"
                                                                    (click)="addJobToClaim( claim)"><i
                                                                        class="fa fa-plus"></i></button>


                                                            </div>
                                                        </td>
                                                    </tr>

                                                    <ng-container
                                                        *ngIf="claim.createPurchaseOrder == true && claim.purchaseOrders.length> 0 ">
                                                        <tr>
                                                            <!-- <td></td> -->
                                                            <td class="text-center fs-14 v-align-middle opacity-50"><i
                                                                    class="fa-solid fa-cart-shopping"></i></td>
                                                            <td colspan="9" cdkDropList
                                                                (cdkDropListDropped)="droppedPurchaseOrdersClaim($event, claim)">

                                                                <table
                                                                    class="table-bordered table-sm shadow overflow-hidden  line-height-100 w-100"
                                                                    *ngIf="claim.purchaseOrders.length >0">
                                                                    <thead>
                                                                        <tr>
                                                                            <th class="fs-12 text-center bg-navy text-white mw-50"
                                                                                (click)="sortListPurchseOrdersClaim('id',claim.purchaseOrders)"
                                                                                title="Sort By Most Recent">
                                                                                PO #
                                                                            </th>


                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                (click)="sortListPurchseOrdersClaim('title',claim.purchaseOrders)"
                                                                                title="Sort By Item Name"> PO Item Name
                                                                            </th>
                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                (click)="sortListPurchseOrdersClaim('partNumber',claim.purchaseOrders)"
                                                                                title="Sort By Parts Number"> Parts #
                                                                            </th>
                                                                            <th class="fs-12 text-center bg-navy text-white mw-150"
                                                                                (click)="sortListPurchseOrdersClaim('description',claim.purchaseOrders)"
                                                                                title="Sort By Description">
                                                                                Description </th>

                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                (click)="sortListPurchseOrdersClaim('vendorId',claim.purchaseOrders)"
                                                                                title="Sort By Most Recent">Vender</th>

                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                (click)="sortListPurchseOrdersClaim('status',claim.purchaseOrders)"
                                                                                title="Sort By Status">Approval</th>

                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                style="width:100px"
                                                                                (click)="sortListPurchseOrdersClaim('purchaseStatus',claim.purchaseOrders)"
                                                                                title="Sort By Status">Status
                                                                            </th>
                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                style="width:100px"
                                                                                (click)="sortListPurchseOrdersClaim('grade',claim.purchaseOrders)"
                                                                                title="Sort By Grade">
                                                                                Grade
                                                                            </th>
                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                style="width:100px"
                                                                                (click)="sortListPurchseOrdersClaim('salePrice',claim.purchaseOrders)"
                                                                                title="Sort By Price">Price</th>
                                                                            <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                (click)="sortListPurchseOrdersClaim('createdAt',claim.purchaseOrders)"
                                                                                title="Sort By Date"><i
                                                                                    class="fa-solid fa-clock"></i></th>
                                                                            <th
                                                                                class="fs-12 text-center bg-navy text-white mw-50">
                                                                                <i class="fa-solid fa-user"></i>
                                                                            </th>

                                                                            <th
                                                                                class="fs-12 text-center bg-navy text-white mw-100">
                                                                                Action</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <ng-container
                                                                        *ngFor="let purchaseOrder of claim.purchaseOrders; let i = index;  let even=even">
                                                                        <tr id="{{vehicle.id}}"
                                                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                            title="" style="cursor: pointer;"
                                                                            [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                title="Drag and drop index number to change the order"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                [cdkDragDisabled]="isMobile==true"
                                                                                cdkDrag>

                                                                                <ng-container
                                                                                    *ngIf="selectedAutopart.purchaseOrderId == purchaseOrder.id">
                                                                                    <span
                                                                                        class="fs-15 fw-700 text-danger">
                                                                                        {{purchaseOrder.id}}</span>
                                                                                </ng-container>
                                                                                <ng-container
                                                                                    *ngIf="selectedAutopart.purchaseOrderId != purchaseOrder.id">
                                                                                    {{purchaseOrder.id}}
                                                                                </ng-container>
                                                                            </td>

                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                title="Click to view details. Drag and drop index number to change the order"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                <p class="fs-12 text-black opacity-75"
                                                                                    style="display: inline-block; word-break: break-word;">
                                                                                    {{purchaseOrder.title}}</p>
                                                                            </td>
                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                title="Click to view details. Drag and drop index number to change the order"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                <p class="fs-12 text-black opacity-75"
                                                                                    style="display: inline-block; word-break: break-word;">
                                                                                    {{purchaseOrder.partNumber}}</p>
                                                                            </td>


                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                title="Click to view details. Drag and drop index number to change the order"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                <p class="fs-12 text-black opacity-75"
                                                                                    style="  display: -webkit-box;
                                    -webkit-box-orient: vertical;
                                    -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                     overflow: hidden;"> {{purchaseOrder.description}}
                                                                                    <ng-container
                                                                                        *ngIf="purchaseOrder.purchaseStatus==1">
                                                                                        <br>
                                                                                        <span
                                                                                            class="text-danger">Ordered
                                                                                            At: {{
                                                                                            purchaseOrder.orderedAt|
                                                                                            date: 'MM/dd/yyyy'}}</span>
                                                                                    </ng-container>
                                                                                    <ng-container
                                                                                        *ngIf="purchaseOrder.purchaseStatus==2">
                                                                                        <br>
                                                                                        <span
                                                                                            class="text-danger">Ordered
                                                                                            At: {{
                                                                                            purchaseOrder.orderedAt|
                                                                                            date: 'MM/dd/yyyy'}}</span>
                                                                                        <br>
                                                                                        <span
                                                                                            class="text-danger">Received
                                                                                            At:{{
                                                                                            purchaseOrder.receivedAt|
                                                                                            date: 'MM/dd/yyyy'}}</span>
                                                                                    </ng-container>
                                                                                    <ng-container
                                                                                        *ngIf="purchaseOrder.purchaseStatus==3">
                                                                                        <br>
                                                                                        <span
                                                                                            class="text-danger">Ordered
                                                                                            At: {{
                                                                                            purchaseOrder.orderedAt|
                                                                                            date: 'MM/dd/yyyy'}}</span>
                                                                                        <br>
                                                                                        <span
                                                                                            class="text-danger">Received
                                                                                            At:{{
                                                                                            purchaseOrder.receivedAt|
                                                                                            date: 'MM/dd/yyyy'}}</span>
                                                                                        <br>
                                                                                        <span
                                                                                            class="text-danger">Returned
                                                                                            At:{{
                                                                                            purchaseOrder.returnedAt|
                                                                                            date: 'MM/dd/yyyy'}}</span>
                                                                                    </ng-container>
                                                                                </p>
                                                                            </td>

                                                                            <td
                                                                                class="p-2 text-center  v-align-middle fs-12">

                                                                                <select
                                                                                    class="form-select h-48 px-3 border-radius-8 fs-12"
                                                                                    style="height:30px; appearance: none; background-image: url('');"
                                                                                    disabled
                                                                                    [(ngModel)]="purchaseOrder.vendorId">
                                                                                    <option [value]=" vendor.id"
                                                                                        *ngFor="let vendor of vendors;let i=index;">
                                                                                        {{vendor.name}}
                                                                                    </option>
                                                                                </select>
                                                                            </td>

                                                                            <td title="Set Approval Status"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <select name="status"
                                                                                    class="form-select border-radius-4 border fs-12"
                                                                                    size="1" disabled
                                                                                    style="height:30px; appearance: none; background-image: url('');"
                                                                                    [(ngModel)]="purchaseOrder.status">
                                                                                    <option value="0" selected>Not
                                                                                        Submitted</option>
                                                                                    <option value="1"
                                                                                        style="color:green">For Approval
                                                                                    </option>
                                                                                    <option value="2" style="color:red">
                                                                                        Rejected</option>
                                                                                    <option value="3"
                                                                                        style="color:blue">Approved
                                                                                    </option>
                                                                                </select>
                                                                            </td>

                                                                            <td title="Set Status"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <select name="purchaseStatus"
                                                                                    class="form-select border-radius-4 border fs-12"
                                                                                    style="height:30px;" size="1"
                                                                                    (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                                                                    *ngIf="purchaseOrder.status == 3"
                                                                                    [(ngModel)]="purchaseOrder.purchaseStatus">
                                                                                    <option value="0" selected>No Status
                                                                                    </option>
                                                                                    <option value="1">Ordered</option>
                                                                                    <option value="2">Received</option>
                                                                                    <option value="3">Returned</option>
                                                                                    <option value="4">Wrong Part
                                                                                    </option>
                                                                                </select>
                                                                            </td>
                                                                            <td data-bs-toggle="modal"
                                                                                class="text-center fs-12 v-align-middle"
                                                                                title="Click to view details"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                <select name="grade"
                                                                                    style="height:30px; appearance: none; background-image: url('');"
                                                                                    class="form-select h-48 border px-3 border-radius-8 fs-12"
                                                                                    size="1" disabled
                                                                                    [(ngModel)]="purchaseOrder.grade">
                                                                                    <option value="undefined" disabled
                                                                                        selected>Select Grade</option>
                                                                                    <option value="A">A</option>
                                                                                    <option value="B">B</option>
                                                                                    <option value="C">C</option>
                                                                                    <option value="Used">Used</option>
                                                                                    <option value="New">New</option>
                                                                                    <option value="Insurance">Insurance
                                                                                    </option>
                                                                                </select>
                                                                            </td>


                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                title="Click to view details"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                ${{purchaseOrder.salePrice}}
                                                                            </td>
                                                                            <td class="text-center fs-12 v-align-middle"
                                                                                title="Click to view details"
                                                                                data-bs-toggle="modal"
                                                                                data-bs-toggle="modal"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                {{purchaseOrder.createdAt |
                                                                                date: 'MM/dd/yyyy'}} </td>
                                                                            <td
                                                                                class="p-2 text-center  v-align-middle fs-12">

                                                                                <ng-container
                                                                                    *ngFor="let user of users;let i=index;">
                                                                                    <span
                                                                                        *ngIf="user.id == purchaseOrder.userId">
                                                                                        {{(user.firstName + " " +
                                                                                        user.lastName) | shortName:2}}
                                                                                    </span>
                                                                                </ng-container>




                                                                            </td>
                                                                            <td
                                                                                class="text-center fs-12 v-align-middle">
                                                                                <div class="d-flex gap-1">
                                                                                    <button
                                                                                        class="btn btn-outline-danger btn-sm"
                                                                                        (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                        *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                                                                        (click)="deletePurchaseOrderInline(purchaseOrder, i)">
                                                                                        <i class="fa fa-trash"></i>
                                                                                    </button>

                                                                                    <button
                                                                                        class="btn btn-outline-warning btn-sm"
                                                                                        *ngIf="purchaseOrder.status ==0"
                                                                                        title="Submit for Approval"
                                                                                        (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                                                        [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                        <i
                                                                                            class="fa fa-arrow-right"></i>
                                                                                    </button>

                                                                                    <button
                                                                                        class="btn btn-outline-warning btn-sm"
                                                                                        *ngIf="purchaseOrder.status ==2"
                                                                                        title="Re-Submit for Approval"
                                                                                        (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                                                        [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                        <i
                                                                                            class="fa fa-arrow-right"></i>
                                                                                    </button>

                                                                                    <button
                                                                                        class="btn btn-outline-danger btn-sm"
                                                                                        *ngIf="purchaseOrder.status ==1"
                                                                                        title="Reject It"
                                                                                        (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                                                                        [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                        <i class="fa fa-ban"></i>
                                                                                    </button>

                                                                                    <button
                                                                                        class="btn btn-outline-success btn-sm"
                                                                                        *ngIf="purchaseOrder.status ==1"
                                                                                        title="Approve It"
                                                                                        (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                                                                        [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                        <i
                                                                                            class="fa fa-check-square"></i>
                                                                                    </button>

                                                                                    <button
                                                                                        class="btn btn-outline-danger btn-sm"
                                                                                        *ngIf="purchaseOrder.status ==3"
                                                                                        title="Un-Approve It"
                                                                                        (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                                                                        [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                        <i class="fa fa-arrow-left"></i>
                                                                                    </button>

                                                                                    <button
                                                                                        class="btn btn-warning btn-sm"
                                                                                        *ngIf="purchaseOrder.status == 3"
                                                                                        [disabled]="user.allowAddUpdateAutopart == false"
                                                                                        title="Add Parts"
                                                                                        (click)="addAutopartToPurchaseOrder( claim, purchaseOrder)"><i
                                                                                            class="fa fa-plus"></i></button>

                                                                                </div>
                                                                            </td>
                                                                        </tr>

                                                                        <ng-container
                                                                            *ngIf="purchaseOrder.autoparts.length> 0 ">
                                                                            <tr>
                                                                                <!-- <td></td> -->
                                                                                <td
                                                                                    class="text-center fs-14 v-align-middle opacity-50">
                                                                                    <i class="fa-solid fa-tools"></i>
                                                                                </td>
                                                                                <td colspan="10" cdkDropList
                                                                                    (cdkDropListDropped)="droppedAutoprtsPurchaseOrder($event, purchaseOrder)">


                                                                                    <table
                                                                                        class="table-bordered table-sm overflow-hidden shadow line-height-100 w-100">
                                                                                        <thead>
                                                                                            <tr
                                                                                                class="fs-12 text-center bg-warning v-align-middle text-white mw-50">
                                                                                                <th class="fs-12 text-center  mw-50"
                                                                                                    (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                                                                    title="Sort By Most Recent">
                                                                                                    #
                                                                                                </th>
                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                                                                    title="Sort By Most Recent">
                                                                                                    Image</th>

                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)="sortListAutopartsPurchaseOrder('title', purchaseOrder)"
                                                                                                    title="Sort By Parts Name">
                                                                                                    Name </th>
                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)=" sortListAutopartsPurchaseOrder('partNumber', purchaseOrder)"
                                                                                                    title="Sort By Parts Number">
                                                                                                    Parts # </th>
                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)=" sortListAutopartsPurchaseOrder('description', purchaseOrder)"
                                                                                                    title="Sort By Description">
                                                                                                    Desc </th>


                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)="sortListAutopartsPurchaseOrder('purchaseStatus', purchaseOrder)"
                                                                                                    title="Sort By Status">
                                                                                                    Status </th>
                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)="sortListAutopartsPurchaseOrder('grade', purchaseOrder)"
                                                                                                    title="Sort By Grade">
                                                                                                    Grade
                                                                                                </th>
                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)="sortListAutopartsPurchaseOrder('salePrice', purchaseOrder)"
                                                                                                    title="Sort By Price">
                                                                                                    Price</th>
                                                                                                <th class="fs-12 text-center  mw-100"
                                                                                                    (click)="sortListAutopartsPurchaseOrder('createdAt', purchaseOrder)"
                                                                                                    title="Sort By Date">
                                                                                                    Created <i
                                                                                                        class="fa-solid fa-clock"></i>
                                                                                                </th>
                                                                                                <th class="fs-14 text-center"
                                                                                                    style="width:150px">
                                                                                                    <i
                                                                                                        class="fa-solid fa-user"></i>
                                                                                                </th>
                                                                                                <th
                                                                                                    class="fs-12 text-center  mw-100">
                                                                                                    Action</th>
                                                                                            </tr>
                                                                                        </thead>
                                                                                        <ng-container
                                                                                            *ngFor="let autopart of purchaseOrder.autoparts; let i = index;  let even=even">
                                                                                            <tr id="{{vehicle.id}}"
                                                                                                (click)="editAutopart(autopart, i)"
                                                                                                title=""
                                                                                                class="cursor-pointer"
                                                                                                [style.background-color]="i == cindexAutpartPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    title="Drag and drop index number to change the order"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()"
                                                                                                    [cdkDragDisabled]="isMobile==true"
                                                                                                    cdkDrag>
                                                                                                    <ng-container
                                                                                                        *ngIf="autopart.id == selectedAutopart.id">
                                                                                                        <span
                                                                                                            class="fs-15 fw-700 text-danger">
                                                                                                            {{autopart.id}}</span>
                                                                                                    </ng-container>
                                                                                                    <ng-container
                                                                                                        *ngIf="autopart.id != selectedAutopart.id">
                                                                                                        {{autopart.id}}
                                                                                                    </ng-container>

                                                                                                </td>
                                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    (mouseover)="hover = vehicle"
                                                                                                    (mouseleave)="hover = null"
                                                                                                    title="Click to view details. Drag and drop index number to change the order"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                    <div
                                                                                                        class="overflow-hidden hover-img transition rounded-1 border">
                                                                                                        <img *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                                                                            src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                                                                            height="40"
                                                                                                            width="100"
                                                                                                            alt="Image"
                                                                                                            class="object-fill rounded-1 w-100" />
                                                                                                    </div>
                                                                                                </td>
                                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    title="Click to view details. Drag and drop index number to change the order"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                    <p class="fs-12 text-black opacity-75"
                                                                                                        style="display: inline-block; word-break: break-word;">
                                                                                                        {{autopart.title}}
                                                                                                    </p>
                                                                                                </td>
                                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    title="Click to view details. Drag and drop index number to change the order"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                    <p class="fs-12 text-black opacity-75"
                                                                                                        style="display: inline-block; word-break: break-word;">
                                                                                                        {{autopart.partNumber}}
                                                                                                    </p>
                                                                                                </td>
                                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    title="Click to view details. Drag and drop index number to change the order"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                    <p class="fs-12 text-black opacity-75"
                                                                                                        style="  display: -webkit-box;
                                                  -webkit-box-orient: vertical;
                                                  -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                                   overflow: hidden;"> {{autopart.description}}
                                                                                                        <ng-container
                                                                                                            *ngIf="autopart.purchaseStatus==1">
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Ordered
                                                                                                                At: {{
                                                                                                                autopart.orderedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                        </ng-container>
                                                                                                        <ng-container
                                                                                                            *ngIf="autopart.purchaseStatus==2">
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Ordered
                                                                                                                At: {{
                                                                                                                autopart.orderedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Received
                                                                                                                At:{{
                                                                                                                autopart.receivedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                        </ng-container>
                                                                                                        <ng-container
                                                                                                            *ngIf="autopart.purchaseStatus==3">
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Ordered
                                                                                                                At: {{
                                                                                                                autopart.orderedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Received
                                                                                                                At:{{
                                                                                                                autopart.receivedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Returned
                                                                                                                At:{{
                                                                                                                autopart.returnedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                        </ng-container>
                                                                                                        <ng-container
                                                                                                            *ngIf="autopart.purchaseStatus==4">
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Ordered
                                                                                                                At: {{
                                                                                                                autopart.orderedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Received
                                                                                                                At:{{
                                                                                                                autopart.receivedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                            <br>
                                                                                                            <span
                                                                                                                class="text-danger">Returned
                                                                                                                At:{{
                                                                                                                autopart.returnedAt|
                                                                                                                date:
                                                                                                                'MM/dd/yyyy'}}</span>
                                                                                                        </ng-container>
                                                                                                    </p>
                                                                                                </td>
                                                                                                <!-- <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal" data-bs-target="#partDetails"
                                                  title="Click to view details" (click)=" editAutopart(autopart, i)">
                                                  {{autopart.stocknumber }} </td> -->
                                                                                                <td title="Set Status"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()"
                                                                                                    class="text-center fs-12 v-align-middle">
                                                                                                    <select
                                                                                                        name="purchaseStatus"
                                                                                                        class="form-select border-radius-4 border fs-12"
                                                                                                        size="1"
                                                                                                        (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                                                                        [(ngModel)]="autopart.purchaseStatus">
                                                                                                        <option
                                                                                                            value="0"
                                                                                                            selected>No
                                                                                                            Status
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="1">
                                                                                                            Ordered
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="2">
                                                                                                            Received
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="3">
                                                                                                            Returned
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="4">
                                                                                                            Wrong Part
                                                                                                        </option>
                                                                                                    </select>
                                                                                                </td>
                                                                                                <td data-bs-toggle="modal"
                                                                                                    class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    title="Click to view details"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                    <select name="grade"
                                                                                                        style=" appearance: none;
                                              background-image: url('');" class="form-select border px-3 border-radius-8 fs-12"
                                                                                                        size="1"
                                                                                                        disabled
                                                                                                        [(ngModel)]="autopart.grade">
                                                                                                        <option
                                                                                                            value="undefined"
                                                                                                            disabled
                                                                                                            selected>
                                                                                                            Select Grade
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="A">A
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="B">B
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="C">C
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="Used">
                                                                                                            Used
                                                                                                        </option>
                                                                                                        <option
                                                                                                            value="New">
                                                                                                            New</option>
                                                                                                        <option
                                                                                                            value="Insurance">
                                                                                                            Insurance
                                                                                                        </option>
                                                                                                    </select>
                                                                                                </td>


                                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    title="Click to view details"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                    ${{autopart.salePrice}}
                                                                                                </td>
                                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#partDetails"
                                                                                                    title="Click to view details"
                                                                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                    {{autopart.createdAt
                                                                                                    |
                                                                                                    date: 'MM/dd/yyyy'}}
                                                                                                </td>
                                                                                                <td
                                                                                                    class="p-2 text-center fs-12  v-align-middle">

                                                                                                    <ng-container
                                                                                                        *ngFor="let user of users;let i=index;">
                                                                                                        <span
                                                                                                            *ngIf="user.id == autopart.userId">
                                                                                                            {{(user.firstName
                                                                                                            + " " +
                                                                                                            user.lastName)
                                                                                                            |
                                                                                                            shortName:2}}
                                                                                                        </span>
                                                                                                    </ng-container>

                                                                                                </td>
                                                                                                <td
                                                                                                    class="text-center fs-12 v-align-middle">
                                                                                                    <div
                                                                                                        class="d-flex gap-2">
                                                                                                        <button
                                                                                                            class="btn btn-outline-danger btn-sm"
                                                                                                            (click)="editAutopart(autopart, i)"
                                                                                                            *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                                                                            (click)="deleteAutopartPurchaseOrder(autopart, i, purchaseOrder)">
                                                                                                            <i
                                                                                                                class="fa fa-trash"></i>
                                                                                                        </button>
                                                                                                        <button
                                                                                                            class="btn btn-outline-warning btn-sm"
                                                                                                            (click)="editAutopart(autopart, i); showEditPartModal()"
                                                                                                            *ngIf="this.user.allowAddUpdateAutopart == true"><i
                                                                                                                class="fa fa-edit"></i>
                                                                                                        </button>
                                                                                                    </div>
                                                                                                </td>
                                                                                            </tr>
                                                                                        </ng-container>
                                                                                    </table>



                                                                                </td>
                                                                            </tr>
                                                                        </ng-container>

                                                                    </ng-container>
                                                                </table>

                                                            </td>
                                                        </tr>
                                                    </ng-container>

                                                    <ng-container
                                                        *ngIf="claim.createJobOrder == true && claim.jobs.length> 0">
                                                        <tr>
                                                            <!-- <td></td> -->
                                                            <td class="text-center fs-14 v-align-middle opacity-50"><i
                                                                    class="fas fa-user"></i>
                                                            </td>
                                                            <td colspan="9">
                                                                <ng-container>
                                                                    <table
                                                                        class="table-bordered table-sm overflow-hidden shadow  line-height-100 w-100"
                                                                        cdkDropList
                                                                        (cdkDropListDropped)="droppedJobsClaim($event, claim)">
                                                                        <thead>

                                                                            <tr>
                                                                                <th class="fs-12 text-center bg-info text-white"
                                                                                    style="width:50px">JO #
                                                                                </th>
                                                                                <th
                                                                                    class="fs-12 text-center bg-info text-white mw-100">
                                                                                    Job Order Name</th>
                                                                                <th class="fs-12 text-center bg-info text-white"
                                                                                    style="min-width:150px">
                                                                                    Instruction
                                                                                </th>
                                                                                <th class="fs-12 text-center bg-info text-white mw-100"
                                                                                    style="width:100px">
                                                                                    Assigned
                                                                                    To</th>
                                                                                <th class="fs-12 text-center bg-info text-white"
                                                                                    style="width:100px">$
                                                                                </th>
                                                                                <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                                                                <th
                                                                                    class="fs-12 text-center bg-info text-white mw-100">
                                                                                    Target</th>
                                                                                <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                                                                <th class="fs-12 text-center bg-info text-white "
                                                                                    style="width:50px">Status
                                                                                </th>
                                                                                <th
                                                                                    class="fs-12 text-center bg-info text-white mw-50">
                                                                                    <i class="fa-solid fa-user"></i>
                                                                                </th>
                                                                                <th
                                                                                    class="fs-12 text-center bg-info text-white mw-100">
                                                                                    Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>

                                                                            <tr (click)="setJobId(job.id)"
                                                                                *ngFor="let job of claim.jobs; let i=index">
                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                    [cdkDragDisabled]="isMobile==true"
                                                                                    cdkDrag>
                                                                                    {{job.id}}
                                                                                </td>
                                                                                <td
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <input placeholder="Enter Job Name"
                                                                                        [(ngModel)]="job.name"
                                                                                        maxlength="50"
                                                                                        (keyup.enter)="onEnter('job name',job)"
                                                                                        type="text"
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        class="form-control h-40 border-radius-4 border" />
                                                                                </td>
                                                                                <td
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <textarea type="text" rows="1"
                                                                                        [(ngModel)]="job.notes"
                                                                                        class="form-control my-2"
                                                                                        maxlength="200"
                                                                                        (keyup.enter)="onEnter('job notes',job)"
                                                                                        title="Job Instruction"
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                                                                </td>

                                                                                <td
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <select
                                                                                        class="form-select border-radius-4 h-40 border fs-12 "
                                                                                        [(ngModel)]="job.employeeId"
                                                                                        #device
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        style="height:30px;"
                                                                                        (change)="onChangeEmployee2Claim($event, device.value, job, claim)">
                                                                                        <option value="0" disabled
                                                                                            selected>Select Employee
                                                                                        </option>
                                                                                        <option [value]="employee.id"
                                                                                            [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                                                                            *ngFor="let employee of employees;let i=index;">
                                                                                            {{employee.firstName}}
                                                                                            {{employee.lastName}}
                                                                                            (
                                                                                            {{employee.roleName}},{{employee.rolePrecentage}}%
                                                                                            <ng-container
                                                                                                *ngIf="employee.commissionBased == true">
                                                                                                - <span
                                                                                                    class="fw-700 text-danger">Commission
                                                                                                    Based</span>
                                                                                            </ng-container>)
                                                                                            [{{
                                                                                            employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                                                                            +
                                                                                            employee.jobCountsFinished}}]
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <td
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <input placeholder="Enter Job Value"
                                                                                        [(ngModel)]="job.price"
                                                                                        maxlength="50" class="fs-12"
                                                                                        (keyup.enter)="onEnter('job price',job)"
                                                                                        type="number"
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        class="form-control border h-40 border-radius-4" />
                                                                                </td>

                                                                                <td
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <input *ngIf="job.employeeId > 0"
                                                                                        (change)="onChangeCalendar($event, job)"
                                                                                        max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                                                                        [disabled]="job.paidWeek> 0"
                                                                                        [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                                                                                        title="Target Date" type="date"
                                                                                        class="form-control border h-40 border-radius-4" />
                                                                                </td>

                                                                                <td
                                                                                    class="p-2 text-center v-align-middle">
                                                                                    <div
                                                                                        class="form-check text-center pt-2">
                                                                                        <input trimText
                                                                                            class="form-check-input mx-auto mt-0"
                                                                                            type="checkbox"
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            *ngIf="job.employeeId > 0 && job.targetDate != null"
                                                                                            [checked]="isJobChecked(job)"
                                                                                            (change)="updateJobStatus(job)" />
                                                                                    </div>
                                                                                </td>
                                                                                <td
                                                                                    class="p-2 text-center  v-align-middle fs-12">


                                                                                    <ng-container
                                                                                        *ngFor="let user of users;let i=index;">
                                                                                        <span
                                                                                            *ngIf="user.id == job.userId">
                                                                                            {{(user.firstName + " " +
                                                                                            user.lastName) |
                                                                                            shortName:2}}
                                                                                        </span>
                                                                                    </ng-container>




                                                                                </td>
                                                                                <td
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <div
                                                                                        class="d-flex align-items-center justifyc-ntent-center gap-1">
                                                                                        <button
                                                                                            class="btn btn-outline-danger btn-sm"
                                                                                            title="Remove"
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            (click)="deleteVehicleJobClaim(null, job)"><i
                                                                                                class="fa fa-trash"></i></button>
                                                                                        <button
                                                                                            class="btn btn-outline-primary btn-sm"
                                                                                            title="Save"
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            (click)="saveJobNotes(job)"><i
                                                                                                class="fa fa-save"></i></button>
                                                                                        <button
                                                                                            class="btn btn-outline-dark btn-sm"
                                                                                            title="Print"
                                                                                            (click)="setJobId(job.id)"
                                                                                            (click)="printPageJob('print-content-job', 'jobs', job)">
                                                                                            <i class="fa fa-print"></i>
                                                                                        </button>
                                                                                    </div>
                                                                                </td>
                                                                            </tr>

                                                                        </tbody>
                                                                    </table>
                                                                </ng-container>

                                                            </td>
                                                        </tr>


                                                    </ng-container>


                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="mt-4 pt-1 position-relative">
                                <button name="btn" class="btn btn-secondary-abs py-3 px-3 w-100"
                                    (click)="fileInput.click()"><i class="fa fa-cloud-upload me-2"></i> Upload
                                    Images</button>
                                <input type='file'
                                    class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute"
                                    accept="image/jpg, image/jpeg" #fileInput
                                    (change)="onSelectFileEditorAutoparts($event)" multiple
                                    (click)="fileInput.value = ''" />
                            </div>
                            <!-- <div class="mt-4 pt-1 position-relative">
              <button (click)="deleteImage(selectedAutopart.id, selectedImage)" class="btn btn-outline-danger mt-3 btn-sm"
                title="Remove Current Image"><i class="fa fa-trash"></i></button>
            </div> -->
                        </div>
                        <div class="col-md-4">
                            <div class="mt-2 pt-1 position-relative">
                                <div *ngFor='let imageModel of selectedAutopart.imageModels; let i=index'
                                    class="d-inline-block me-2">
                                    <img class="mt-3 preview img-fluid img-thumbnail me-3" width="100"
                                        *ngIf="selectedAutopart.showInSearchImageId != imageModel.id"
                                        src="{{baseUrlResizeImageParts + '/' + imageModel.id}}"
                                        (click)="setImageAutoPart(i)" style="border: 3px solid #555;"> <img
                                        class="mt-3 preview img-fluid img-thumbnail me-3" width="100"
                                        *ngIf="selectedAutopart.showInSearchImageId == imageModel.id"
                                        src="{{baseUrlResizeImageParts + '/' + imageModel.id}}"
                                        (click)="setImageAutoPart(i)" title="Show in search"
                                        style="border: 3px solid lightcoral;">
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mt-4 pt-1 position-relative">
                                <div class="containerImage" *ngIf="selectedAutopart.imageModels.length> 0"> <img
                                        *ngIf="selectedImage != null && selectedImage != 0 &&  selectedAutopart.showInSearchImageId != selectedImage"
                                        class="image w-100 img-fluid img-thumbnail"
                                        src="{{baseUrlImageParts + '/' + selectedImage}}" alt="Image" /> <img
                                        *ngIf="selectedImage != null && selectedImage != 0 &&  selectedAutopart.showInSearchImageId == selectedImage"
                                        class="image w-100 img-fluid img-thumbnail"
                                        src="{{baseUrlImageParts + '/' + selectedImage}}" alt="Image" />
                                    <label *ngIf="selectedImage == selectedAutopart.showInSearchImageId"
                                        class="top-left" for="title">Will
                                        Show This During Search</label>
                                    <div class="bottom-right py-2">
                                        <button *ngIf="selectedImage != selectedAutopart.showInSearchImageId"
                                            title="As index image during search"
                                            (click)="setImageForSearchAutoparts(selectedAutopart.id, selectedImage)"
                                            class="btn btn-primary mt-3 btn-sm" for="title">Set for Search</button>
                                        <button (click)="deleteImageAutopart(selectedAutopart.id, selectedImage)"
                                            data-toggle="tooltip" data-placement="top" title="Remove this image"
                                            class="btn btn-danger mt-3 btn-sm" for="title">
                                            <i class="bi-trash"></i> </button>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <div class="col-md-8">
                            <div class="mt-4 pt-1">
                                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Name</label>
                                <input trimText class="form-control h-48 px-3 border-radius-0" type="text" required
                                    placeholder="Enter Parts name" #name="ngModel"
                                    [ngClass]="{ 'is-invalid': name.errors }" minlength="2" maxlength="50"
                                    [(ngModel)]="selectedAutopart.title" />
                                <div class="invalid-feedback" *ngIf="name.errors "> <span
                                        *ngIf="name.errors['required']">Parts Name
                                        is
                                        required</span> <span *ngIf="name.errors['minlength']">Parts Name must be at
                                        least 2
                                        characters</span> <span *ngIf="name.errors['maxlength']">Parts Name must be at
                                        most 50
                                        characters</span> </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mt-4 pt-1">
                                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Number</label>
                                <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                                    placeholder="Enter Parts Number" #partNumber="ngModel"
                                    [ngClass]="{ 'is-invalid': partNumber.errors }" minlength="2" maxlength="50"
                                    [(ngModel)]="selectedAutopart.partNumber" name="partInfo" />
                                <div class="invalid-feedback" *ngIf="partNumber.errors "> <span
                                        *ngIf="partNumber.errors['required']">Parts Number is required</span> <span
                                        *ngIf="partNumber.errors['minlength']">Parts Number must be at least 2
                                        characters</span> <span *ngIf="partNumber.errors['maxlength']">Parts Number must
                                        be at most 50 characters</span> </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="mt-4 pt-1">
                                <label for="description" class="form-label fs-14 fw-400 mb-3">Description</label>
                                <textarea class="form-control h-48 px-3 border-radius-8" type="text"
                                    style="line-height: 2;" placeholder="Enter Description" #description="ngModel"
                                    [ngClass]="{ 'is-invalid': description.errors }" minlength="2" rows="2"
                                    maxlength="2000" required [(ngModel)]="selectedAutopart.description"
                                    name="description"></textarea>
                                <div class="invalid-feedback" *ngIf="description.errors "> <span
                                        *ngIf="description.errors['required']">Description is required</span> <span
                                        *ngIf="description.errors['minlength']">Description must be at least 2
                                        characters</span> <span *ngIf="description.errors['maxlength']">Descripton must
                                        be at most 2000 characters</span> </div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="mt-4 pt-1">
                                <label for="vendor" data-bs-toggle="tooltip" title="Click to go to Configuration"
                                    [routerLink]="'/vendors'"
                                    class="form-label fs-14 fw-400 mb-3 cursor-pointer">Vendor</label>
                                <select class="form-select h-48 px-3 border-radius-8" name="vendor"
                                    [(ngModel)]="selectedAutopart.vendorId"
                                    [disabled]="user.allowAddUpdateAutopart == false" #vendor="ngModel" required
                                    [ngClass]="{ 'is-invalid': vendor.errors }">
                                    <option value="undefined" disabled selected>Select Vendor</option>
                                    <option [value]="vendor.id" *ngFor="let vendor of vendors;let i=index;">
                                        {{vendor.name}}</option>
                                </select>
                                <div class="invalid-feedback" *ngIf="vendor.errors">
                                    <span *ngIf="vendor.errors['required']">Vendor is required</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-9">
                            <div class="mt-4 pt-1">
                                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Comments</label>
                                <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                                    placeholder="Enter Comments" #comments="ngModel"
                                    [ngClass]="{ 'is-invalid': comments.errors }" minlength="2" maxlength="50"
                                    [(ngModel)]="selectedAutopart.comments" name="comments" />
                                <div class="invalid-feedback" *ngIf="comments.errors ">
                                    <!-- <span *ngIf="partNumber.errors['required']">Parts Number is required</span> -->
                                    <span *ngIf="comments.errors['minlength']">Comments must be at least 2
                                        characters</span> <span *ngIf="comments.errors['maxlength']">Comments must be at
                                        most 500 characters</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mt-4 pt-1">
                                <label for="grade" class="form-label fs-14 fw-400 mb-3">Grade</label>
                                <select name="grade" class="form-select h-48 px-3 border-radius-8" size="1"
                                    [(ngModel)]="selectedAutopart.grade" required #grade="ngModel"
                                    [ngClass]="{ 'is-invalid': grade.errors }">
                                    <option value="undefined" disabled selected>Select Grade</option>
                                    <option value="A">A</option>
                                    <option value="B">B</option>
                                    <option value="C">C</option>
                                    <option value="Used">Used</option>
                                    <option value="New">New</option>
                                    <option value="Insurance">Insurance</option>
                                </select>
                                <div class="invalid-feedback" *ngIf="grade.errors "> <span
                                        *ngIf="grade.errors['required']">Grade is
                                        required</span> </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mt-4 pt-1">
                                <label for="price" class="form-label fs-14 fw-400 mb-3">Price ($)</label>
                                <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                                    placeholder="Enter Price" #salePrice="ngModel"
                                    [ngClass]="{ 'is-invalid': salePrice.errors }" minlength="1" maxlength="10"
                                    onKeyPress="if(this.value.length==10) return false" maxlength="10" required
                                    oninput="if(this.value<0)this.value=this.value * -1"
                                    [(ngModel)]="selectedAutopart.salePrice" name="price" />
                                <div class="invalid-feedback" *ngIf="salePrice.errors "> <span
                                        *ngIf="salePrice.errors['required']">Price
                                        is required</span> <span *ngIf="salePrice.errors['minlength']">Price must be at
                                        least 1
                                        characters</span> <span *ngIf="salePrice.errors['maxlength']">Price must be at
                                        most 10
                                        characters</span> </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="mt-4 pt-1">
                                <label for="status" class="form-label fs-14 fw-400 mb-3">Status</label>
                                <select name="purchaseStatus" class="form-select border-radius-4" size="1"
                                    (change)="onChangeAutopartPurchaseStatus($event, selectedAutopart)"
                                    [(ngModel)]="selectedAutopart.purchaseStatus">
                                    <option value="0" selected>No Status</option>
                                    <option value="1">Ordered</option>
                                    <option value="2">Received</option>
                                    <option value="3">Returned</option>
                                    <option value="4">Wrong Part</option>
                                </select>
                            </div>
                        </div>


                        <div class="col-md-12">
                            <h5 class="text-success fw-700 my-3">{{ message1}}</h5>
                            <div class="pt-1 d-flex gap-3">
                                <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600 mt-4 "
                                    (click)="saveAutopartEditor()" *ngIf="selectedAutopart.id> 0">Save
                                    Info</button>

                                <button class="btn btn-outline-warning h-45 px-4 rounded-4 fs-14 fw-600 mt-4 "
                                    (click)="addNewPurchaseOrder($event)" title="Add Purchase Order">
                                    <i class="fa fa-plus"></i> Purchase Order
                                </button>

                                <button class="btn btn-outline-success h-45 px-4 rounded-4 fs-14 fw-600 mt-4 "
                                    (click)="closeEditPartModal()">Back</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Vehicle Details Modal -->
<div [ngStyle]="{'visibility':displayStyle2, 'opacity':displayStyle3}" class="modal fade" id="editVehicle"
    data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="editVehicleLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-xl modal-fullscreen-lg-down">
        <div class="modal-content border-radius-8">
            <div class="modal-header p-4">
                <h1 class="modal-title fs-20 fw-600 text-capitalize" id="editVehicleLabel">
                    {{ vehicle.year }} {{ vehicle.make }} {{ vehicle.model }}
                    <i class="fa-solid fa-square" title="{{ vehicle.color }}" [style.color]="vehicle.color"></i>
                    {{ vehicle.color }}
                </h1>
                <div class="d-flex justify-content-center">
                    <button (click)="toggleDivs()" aria-label="Close" title="Close This Form"
                        class="btn rounded-0 btn-sm btn-secondary-abs">
                        <i class="fa fa-window-close fa-2x"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body py-4 px-2">
                <!-- Tab Navigation -->
                <ul class="nav nav-tabs" id="vehicleDetailsTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="details-tab" data-bs-toggle="tab" data-bs-target="#details"
                            type="button" role="tab" aria-controls="details" aria-selected="true">
                            <i class="fas fa-car"></i> Details
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="edit-details-tab" data-bs-toggle="tab"
                            data-bs-target="#editDetails" type="button" role="tab" aria-controls="editDetails"
                            aria-selected="true">
                            <i class="fas fa-car"></i> Edit Details
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="estimates-tab" data-bs-toggle="tab" data-bs-target="#estimates"
                            type="button" role="tab" aria-controls="estimates" aria-selected="false">
                            <i class="fas fa-file-invoice-dollar"></i> Estimates
                            <span class="badge bg-primary ms-1">{{claims.length || 0}}</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="purchase-orders-tab" data-bs-toggle="pill"
                            data-bs-target="#purchase-orders" type="button" role="tab" aria-controls="purchase-orders"
                            aria-selected="false">
                            <i class="fas fa-shopping-cart"></i> Purchase Orders
                            <span class="badge bg-success ms-1">{{purchaseOrders.length || 0}}</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="parts-tab" data-bs-toggle="pill" data-bs-target="#parts"
                            type="button" role="tab" aria-controls="parts" aria-selected="false">
                            <i class="fas fa-cogs"></i> Parts
                            <span class="badge bg-info ms-1">{{autopartsSearch.length || 0}}</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="jobs-tab" data-bs-toggle="pill" data-bs-target="#jobs"
                            type="button" role="tab" aria-controls="jobs" aria-selected="false">
                            <i class="fas fa-tasks"></i> Jobs Orders
                            <span class="badge bg-warning ms-1">{{jobCompletedCount || 0}}/{{jobs.length || 0}}</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="payments-tab" data-bs-toggle="pill" data-bs-target="#payments"
                            type="button" role="tab" aria-controls="payments" aria-selected="false">
                            <i class="fas fa-credit-card"></i> Payments
                            <span class="badge bg-danger ms-1">{{payments.length || 0}}</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="invoices-tab" data-bs-toggle="pill" data-bs-target="#invoices"
                            type="button" role="tab" aria-controls="invoices" aria-selected="false">
                            <i class="fas fa-receipt"></i> Invoices
                            <span class="badge bg-secondary ms-1">{{receipts.length || 0}}</span>
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="history-tab" data-bs-toggle="pill" data-bs-target="#history"
                            (click)="getVehicleHistory(vehicle.id)" type="button" role="tab" aria-controls="history"
                            aria-selected="false">
                            <i class="fas fa-history"></i> History
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="print-tab" type="button"
                            (click)="openUrl('vehicle2/'+ vehicle.token)">
                            <i class="fas fa-mobile-alt"></i> Mobile View
                        </button>
                    </li>
                </ul>

                <!-- Tab Content -->
                <div class="tab-content" id="vehicleDetailsTabContent">
                    <!-- Details Tab -->
                    <div class="tab-pane fade show active" id="details" role="tabpanel" aria-labelledby="details-tab">
                        <div class="row">
                            <div class="col-12" *ngIf="vehicle.id > 0">
                                <div class="table-container2 shadow-sm border-radius-8 border w-100">
                                    <table
                                        class="table-bordered table-striped overflow-hidden border-radius-8 line-height-100 w-100">

                                        <tr>
                                            <th class="fs-13 w-25 bg-light">Customer</th>
                                            <td class="fs-13 w-25" style="word-break: break-word;">
                                                {{vehicle.customer.title}}
                                                {{vehicle.customer.firstName}}
                                                {{vehicle.customer.lastName}} @ {{
                                                formatPhoneNumber( vehicle.customer.phone) }}</td>
                                            <th class="fs-13 w-25 bg-light">Address</th>
                                            <td class="fs-13 w-25" style="word-break: break-word;">{{
                                                vehicle.customer.street
                                                }} {{ vehicle.customer.city }} {{ vehicle.customer.state }} {{
                                                vehicle.customer.zip }} </td>
                                        </tr>
                                        <tr *ngIf="vehicle.description && vehicle.description != ''">
                                            <th class="fs-13 w-25 bg-light">Description</th>
                                            <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">
                                                {{vehicle.description}}</td>
                                        </tr>
                                        <tr>
                                            <th class="fs-13 w-25 bg-light">Work Request(Repair Order)</th>
                                            <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{
                                                vehicle.workRequest }}</td>
                                        </tr>
                                        <tr>
                                            <th class="fs-13 w-25 bg-light">Job Request</th>
                                            <td class="fs-13 w-25"><ng-container
                                                    *ngFor="let jobRequestType of jobRequestTypes; let i=index">
                                                    <ng-container
                                                        *ngIf="vehicle.jobRequestType==jobRequestType.id"><strong>
                                                            {{jobRequestType.name}}</strong></ng-container>
                                                </ng-container></td>
                                            <th class="fs-13 w-25 bg-light">Claim Number</th>
                                            <td class="fs-13 w-25">{{vehicle.claimNumber}}</td>
                                        </tr>
                                        <tr>
                                            <th class="fs-13 w-25 bg-light">Vehicle Status</th>
                                            <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                                                    *ngFor="let option of statuss; let i=index"><strong
                                                        *ngIf="vehicle.status==option.id">{{option.name}}</strong></ng-container>
                                            </td>
                                            <th class="fs-13 w-25 bg-light">Parking Location</th>
                                            <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                                                    *ngFor="let location of locations; let i=index">
                                                    <label
                                                        *ngIf="vehicle.location==location.id">{{location.name}}</label>
                                                </ng-container></td>
                                        </tr>
                                        <tr>
                                            <th class="fs-13 w-25 bg-light">Insurance Company</th>
                                            <td class="fs-13 w-25" style="word-break: break-word;"><ng-container *ngIf="vehicle.insuranceCompany != null && vehicle.insuranceCompany !='' && 
                                          ! vehicle.insuranceCompany.toLowerCase().includes('cash')">
                                                    <ng-container *ngFor=" let insurance of this.insurancers">
                                                        <ng-container
                                                            *ngIf="insurance.name == vehicle.insuranceCompany"> {{
                                                            vehicle.insuranceCompany.toUpperCase() }}
                                                            {{insurance.contactFirstName
                                                            }} {{ insurance.contactLastName}} - {{ insurance.phone }}
                                                        </ng-container>
                                                    </ng-container>
                                                </ng-container></td>
                                            <th class="fs-13 w-25 bg-light">Amount</th>
                                            <td class="fs-13 w-25">
                                                <div class="dropdown">
                                                    <button
                                                        class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold"
                                                        type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                                        aria-expanded="false">
                                                        <span title="Initial Estimates">${{vehicle.price}}</span>
                                                        <span>-</span>
                                                        <span
                                                            title="Supplement">${{getTotalSupplements(vehicle)}}</span>
                                                        <i class="fa fa-angle-down ms-2"></i>
                                                    </button>
                                                    <div class="dropdown-menu bg-light" style="min-width: 400px"
                                                        aria-labelledby="dropdownMenuButton">
                                                        <div class="row">
                                                            <div class="col-6 px-1">
                                                                <a class="dropdown-item">Items</a>
                                                                <div class="dropdown-divider"></div>

                                                                <a class="dropdown-item">Estimates</a>
                                                                <a class="dropdown-item">Parts
                                                                    ({{autopartsSearch.length}})</a>
                                                                <a class="dropdown-item fw-700">Est. - Parts</a>
                                                                <a class="dropdown-item"></a>

                                                                <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                                                                <a class="dropdown-item">Management</a>
                                                                <!-- <a class="dropdown-item">Sales Commission</a> -->
                                                                <a class="dropdown-item">Tax
                                                                    ({{this.company.taxRate*100}}%)</a>
                                                                <div class="dropdown-divider"></div>

                                                                <a class="dropdown-item fw-700">Total Costs</a>
                                                                <a class="dropdown-item fw-700">Gross</a>

                                                            </div>
                                                            <div class="col-6 px-1">
                                                                <a class="dropdown-item">#</a>
                                                                <div class="dropdown-divider"></div>

                                                                <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}}
                                                                    (${{vehicle.price}} +
                                                                    ${{getTotalSupplements(vehicle)}})</a>
                                                                <a
                                                                    class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                                                                <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                                                                    (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                                                                <a class="dropdown-item"></a>


                                                                <a
                                                                    class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                                                                <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                                                                    ({{this.company.managementRate * 100}}% of
                                                                    ${{getVehicleRemaining(vehicle)}})</a>

                                                                <a class="dropdown-item">${{getSaleTax(vehicle)}}
                                                                    ({{this.company.taxRate * 100}}% of
                                                                    {{getVehicleTotalEstimates(vehicle)}})</a>
                                                                <div class="dropdown-divider"></div>

                                                                <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle,
                                                                    jobs)}}</a>
                                                                <a class="dropdown-item fw-700">${{getVehicleGross(vehicle,
                                                                    jobs)}}</a>


                                                            </div>
                                                        </div>

                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th class="fs-13 w-25 bg-light">Approval Status</th>
                                            <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                                                    *ngFor="let approvalStatus of approvalStatuss; let i=index">
                                                    <label
                                                        *ngIf="vehicle.approvalStatus==approvalStatus.id">{{approvalStatus.name}}</label>
                                                </ng-container></td>
                                            <th class="fs-13 w-25 bg-light">Paid Status</th>
                                            <td class="fs-13 w-25"><strong class="badge badge-success"
                                                    *ngIf="vehicle.paid==true"
                                                    (click)="changePaidStatus(vehicle, false)">Paid</strong> <strong
                                                    class="badge badge-danger" *ngIf="vehicle.paid==false"
                                                    (click)="changePaidStatus(vehicle, true)">Not Paid</strong></td>
                                        </tr>
                                        <tr *ngIf="vehicle.supplements.length> 0">
                                            <th class="fs-13 w-25 bg-light">Supplements <span
                                                    class="fs-13 fw-700 text-deanger"
                                                    *ngIf="vehicle.supplements.length> 0">(${{getTotalSupplements(vehicle)}})
                                                </span></th>
                                            <td class="fs-13 w-25" colspan="3">
                                                <ng-container
                                                    *ngFor="let supplement of vehicle.supplements; let i=index">
                                                    <span *ngIf="vehicle.supplements.length> 0">{{i+1}}</span>.<span>
                                                        {{supplement.name}} <span class="text-danger fw-700">
                                                            (${{supplement.price}})</span>:
                                                        <ng-container *ngIf="supplement.status > 0">
                                                            <ng-container
                                                                *ngFor="let approvalStatus of approvalStatuss; let i=index">
                                                                <span class="text-primary"
                                                                    *ngIf="supplement.status==approvalStatus.id">
                                                                    [{{approvalStatus.name}}]</span>
                                                            </ng-container>
                                                        </ng-container>
                                                        <ng-container *ngIf="supplement.status == 0">
                                                            <span>[has no status]</span>
                                                        </ng-container>
                                                        <br>
                                                    </span>
                                                </ng-container>

                                            </td>
                                        </tr>
                                        <tr>
                                            <th class="fs-13 w-25 bg-light">Rental Info</th>
                                            <td class="fs-13 w-25" style="word-break: break-word;">{{vehicle.rentalDate
                                                | date: 'MM/dd/yyyy'}}
                                                <ng-container
                                                    *ngIf="vehicle.loanerCarName != null && vehicle.loanerCarName !='' ">
                                                    {{
                                                    vehicle.loanerCarName }}
                                                    - <span *ngIf="vehicle.rentalDate != null "
                                                        [ngClass]="{ 'text-danger fw-bold': vehicle.rentalCountDown < 0, 'text-black fw-bold': vehicle.rentalCountDown >= 0 }">{{vehicle.rentalCountDown}}
                                                        Days</span> </ng-container>
                                            </td>
                                            <th class="fs-13 w-25 bg-light">Target Date</th>
                                            <td class="fs-13 w-25">{{ vehicle.targetDate |
                                                date}} - <span
                                                    [ngClass]="{ 'text-danger fw-bold': vehicle.targetDateCountDown < 0, 'text-black fw-bold': vehicle.targetDateCountDown >= 0 }">{{vehicle.targetDateCountDown}}
                                                    Days</span><span> Been: </span><span
                                                    class="text-danger">{{vehicle.daysInShop}} Days</span>

                                            </td>
                                        </tr>
                                        <tr>
                                            <th class="fs-13 w-25 bg-light">WIP (Work In Progress)</th>

                                            <td class="fs-13 w-25" title="Click to set VIP"><strong
                                                    class="badge badge-success" *ngIf="vehicle.special == true"
                                                    (click)="special(vehicle)">YES</strong> <strong
                                                    class="badge badge-danger" *ngIf="vehicle.special==false"
                                                    (click)="special(vehicle)">NO</strong>
                                            </td>


                                            <th class="fs-13 w-25 bg-light fw-700">VIN</th>
                                            <td class="fs-13 w-25 " colspan="1">
                                                <div class="d-flex justify-content-between align-items-center">
                                                    <span>{{ vehicle.vin }}</span>
                                                    <div *ngIf="vehicle.vin != '' ">
                                                        <button class="btn btn-sm btn-outline-secondary" type="button"
                                                            (click)="searchVin2()"> Decode
                                                        </button>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr *ngIf="vehicle.description2 && vehicle.description2 != ''">
                                            <th class="fs-13 w-25 bg-light">VIN Decode Info</th>
                                            <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">
                                                {{vehicle.description2}}</td>
                                        </tr>

                                        <tr *ngIf="vehicle.comments && vehicle.comments != ''">
                                            <th class="fs-13 w-25 bg-light">Notes</th>
                                            <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{
                                                vehicle.comments }} </td>
                                        </tr>

                                        <tr *ngIf="vehicle.pdfFiles.length> 0">
                                            <th class="fs-13 w-25 bg-light">Documents (in pdf)</th>
                                            <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">
                                                <div class="badge badge-secondary gap-3  m-1" style="cursor: pointer;"
                                                    *ngFor="let pdf of this.vehicle.pdfFiles"
                                                    title="Click to view detail" (click)="getPdf(pdf.token)">
                                                    <div class="d-flex align-items-start gap-3">
                                                        <i class="fa-solid fa-file-pdf fa-3x"></i>
                                                        <div class="user-details">
                                                            <strong class="fs-14 mb-1 d-block">{{pdf.fileName}}
                                                            </strong>
                                                            <small class="fs-13 text-dark- opacity-50">
                                                                ( {{pdf.createdAt | date: 'KMM/dd/yyyy, HH:mm'}} )
                                                            </small>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr *ngIf="vehicle.pdfFiles.length > 0 && pdfSrc ">
                                            <td class="fs-13 w-75" colspan="4">
                                                <div class="mt-4 pt-1 position-relative">
                                                    <div class="containerImage" *ngIf="vehicle.pdfFiles.length > 0">
                                                        <embed *ngIf="pdfSrc" [src]="pdfSrc" type="application/pdf"
                                                            width="100%" height="100%"
                                                            style="min-height:100vh;width:100%" />
                                                        <div class="bottom-right py-2">
                                                            <button *ngIf="pdfSrc" (click)="pdfSrc = null"
                                                                data-toggle="tooltip" data-placement="top"
                                                                title="Close this pdf"
                                                                class="btn btn-outline-primary me-3 mt-3 btn-sm"
                                                                for="title">
                                                                Close
                                                            </button>
                                                            <button *ngIf="pdfSrc" (click)="deletePdf(currentToken)"
                                                                data-toggle="tooltip" data-placement="top"
                                                                title="Remove this pdf"
                                                                class="btn btn-outline-primary me-3 mt-3 btn-sm"
                                                                for="title"> <i class="bi-trash"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="fs-13 w-75" colspan="4">
                                                <div class="row overflow-x-auto overflow-y-hidden">
                                                    <div cdkDropList (cdkDropListDropped)="droppedVehicleImage($event)"
                                                        class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-4">
                                                        <qrcode [qrdata]="url" [width]="150"
                                                            class="preview img-fluid img-thumbnail"
                                                            (click)="switchQrCode()"
                                                            (click)="showDocTypedImageModels = !showDocTypedImageModels"
                                                            title="Scan it with your phone" [errorCorrectionLevel]="'M'"
                                                            [allowEmptyString]="true"></qrcode>
                                                        <div *ngFor='let imageModel of vehicle.imageModels; let i=index'
                                                            [cdkDragDisabled]="isMobile==true" cdkDrag
                                                            class="containerImage v-imgs float-start my-2 transition"
                                                            style="cursor: pointer;">

                                                            <ng-container *ngFor="let docType of this.docTypes">

                                                                <ng-container *ngIf="docType.name !='Not Sorted'">
                                                                    <label class="top-left-8 badge" for="title"
                                                                        *ngIf="imageModel.docType == docType.id"
                                                                        style="color:{{docType.color}}">
                                                                        {{docType.name}} </label>
                                                                </ng-container>
                                                            </ng-container>

                                                            <img class="preview img-fluid img-thumbnail" width="100%"
                                                                title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}} Click to enlarge, Change doc type, or Drag and drop to arrange order"
                                                                *ngIf="vehicle.showInSearchImageId != imageModel.id"
                                                                src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                                                (click)="setImage2(i)" style="border: 3px solid #555;">
                                                            <img class="preview img-fluid img-thumbnail" width="100%"
                                                                title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}} Click to enlarge, Change doc type,  or Drag and drop to arrange order"
                                                                *ngIf="vehicle.showInSearchImageId == imageModel.id"
                                                                src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                                                (click)="setImage2(i)" title="Show in search"
                                                                style="border: 3px solid lightcoral;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr *ngIf="showDocTypedImageModels==true">
                                            <td colspan="4">
                                                <div class="row pt-3">
                                                    <div class="col-12">
                                                        <div class="table-container shadow border-radius-8 border w-100 d-box ss-table"
                                                            cdkDropList (cdkDropListDropped)="droppedDocType($event)">
                                                            <table class="table-bordered border-radius-8 w-100"
                                                                *ngIf="docTypes.length > 0 &&    this.vehicle.imageModels.length> 0"
                                                                cdkDropListGroup>
                                                                <thead>
                                                                    <tr>

                                                                        <th class="fs-14 text-center mxw-150"
                                                                            style="width:100px" data-bs-dismiss="modal"
                                                                            title="Click to navigagte to Document Type Setting"
                                                                            (click)="navigateTo('doc-types')">
                                                                            Doc Type</th>

                                                                        <th class="fs-14 text-center "
                                                                            title="Sorted by vehicle make">Images [ {{
                                                                            this.vehicle.imageModels.length }} ]
                                                                            Ordered by created date</th>

                                                                    </tr>
                                                                </thead>
                                                                <ng-container
                                                                    *ngFor="let docType of docTypes; let i = index;  let even=even">
                                                                    <tr id="{{docType.id}}" title=""
                                                                        [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')"
                                                                        [cdkDragDisabled]="isMobile==true || docType.id==0 "
                                                                        cdkDrag>

                                                                        <td class="fs-15 text-center "
                                                                            title="Drag and drop to arrange orders">
                                                                            <strong *ngIf="docType.color != null"
                                                                                [style.color]="docType.color">{{docType.name}}
                                                                                <br
                                                                                    *ngIf="docType.imageModels.length>0">
                                                                                <span
                                                                                    *ngIf="docType.imageModels.length>0">(
                                                                                    {{ docType.imageModels!.length}}
                                                                                    )</span></strong>
                                                                            <strong
                                                                                *ngIf="docType.color == null">{{docType.name}}
                                                                                <br
                                                                                    *ngIf="docType.imageModels.length>0">
                                                                                <span
                                                                                    *ngIf="docType.imageModels.length>0">(
                                                                                    {{ docType.imageModels!.length}}
                                                                                    )</span></strong>
                                                                        </td>

                                                                        <td *ngIf="docType.imageModels && docType.imageModels!.length == 0"
                                                                            cdkDropList
                                                                            (cdkDropListDropped)="droppedDocType3($event, docType, docType.id)">
                                                                        </td>
                                                                        <td
                                                                            *ngIf="docType.imageModels && docType.imageModels!.length >0">
                                                                            <div class="d-flex flex-wrap gap-1"
                                                                                cdkDropList
                                                                                (cdkDropListDropped)="droppedDocType3($event, docType,docType.id)">

                                                                                <div class="containerImage btn btn-light images-lists gap-2 align-items-center white-space my-1 border p-1 shadow my-2 transition v-imgs"
                                                                                    [style.background-color]="imageModel.id == indexImageModelDrop? '#EEE' : (true ? 'white' : 'white')"
                                                                                    *ngFor=" let imageModel of  docType.imageModels; let i=index"
                                                                                    title="Click to enlarge, or drag and drop to change doc type"
                                                                                    cdkDropListOrientation="horizontal"
                                                                                    [cdkDragDisabled]="isMobile==true"
                                                                                    cdkDrag [cdkDragData]="i"
                                                                                    (click)="  getDetailImageModel(imageModel,i)">
                                                                                    <label class="top-left" for="title">
                                                                                        {{imageModel.createdAt| date:
                                                                                        'MM/dd/yyyy' }}</label>
                                                                                    <img class="preview img-fluid img-thumbnail"
                                                                                        width="150" height="150"
                                                                                        title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                                                                        *ngIf="vehicle.showInSearchImageId != imageModel.id"
                                                                                        src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                                                                        style="border: 3px solid #555;">
                                                                                    <img class="preview img-fluid img-thumbnail"
                                                                                        width="150" height="150"
                                                                                        title="{{imageModel.createdAt| date:   'MM/dd/yyyy, HH:mm'}}"
                                                                                        *ngIf="vehicle.showInSearchImageId == imageModel.id"
                                                                                        src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                                                                        title="Show in search"
                                                                                        style="border: 3px solid lightcoral;">

                                                                                </div>

                                                                            </div>

                                                                        </td>
                                                                    </tr>

                                                                </ng-container>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr *ngIf="selectedImage2 > 0 ">
                                            <td colspan="4">

                                                <div class="mt-4 pt-1 position-relative w-100 h-100"
                                                    *ngIf="selectedImage2 > 0 ">
                                                    <div class="containerImage" *ngIf="vehicle.imageModels.length > 0">
                                                        <img *ngIf="selectedImage2 != null && selectedImage2!=0 &&  vehicle.showInSearchImageId != selectedImage2"
                                                            class="image w-100 img-fluid img-thumbnail"
                                                            src="{{baseUrlImage + '/' + selectedImage2}}" alt="Image" />
                                                        <img *ngIf="selectedImage2 != null  && selectedImage2!=0 &&  vehicle.showInSearchImageId == selectedImage2"
                                                            class="image w-100 img-fluid img-thumbnail"
                                                            src="{{baseUrlImage + '/' + selectedImage2}}" alt="Image" />
                                                        <label *ngIf="selectedImage2 == vehicle.showInSearchImageId"
                                                            class="top-left" for="title">
                                                            Will Show this in listing</label>

                                                        <label *ngIf="selectedImage2 != vehicle.showInSearchImageId"
                                                            class="top-left" for="title">
                                                            Created At: {{imageModelSelected.createdAt | date:
                                                            'MM/dd/yyyy, HH:mm'}}</label>

                                                        <div class="top-right"
                                                            *ngIf="selectedImage2 != null && selectedImage2 !=0">

                                                            <select class="btn btn-success fw-700 me-3 mt-3 btn-sm"
                                                                [(ngModel)]="imageModelSelected.docType" title="Type"
                                                                style="color: {{getDocTypeColor(imageModelSelected.docType)}}"
                                                                placeholder="Doc Type" #docType
                                                                (change)="onChangeDocType($event)">
                                                                <option *ngFor="let docType of docTypes let i=index"
                                                                    value="{{docType.id}}" class="bg-white fw-700"
                                                                    style="color:{{docType.color}}">
                                                                    {{docType.name}} </option>
                                                            </select>

                                                            <button title="Close Image" (click)="selectedImage2 =0"
                                                                class="btn btn-primary me-3 mt-3 btn-sm"
                                                                for="title">Close</button>
                                                            <button
                                                                *ngIf="selectedImage2 != vehicle.showInSearchImageId"
                                                                title="As index image during search"
                                                                (click)="setImageForSearch2(vehicle.id, selectedImage2)"
                                                                class="btn btn-primary me-3 mt-3 btn-sm" for="title">Set
                                                                for Index</button>
                                                            <button (click)="deleteImage2(vehicle.id, selectedImage2)"
                                                                data-toggle="tooltip" data-placement="top"
                                                                title="Remove this image"
                                                                class="btn btn-outline-danger mt-3 btn-sm" for="title">
                                                                <i class="bi-trash"></i>
                                                            </button>
                                                        </div>


                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>

                        </div>

                        <div class="d-flex align-items-center gap-3 mt-5">
                            <a *ngIf="vehicle.archived==false && vehicle.paid==true && 
                              user.allowAddAndUpdateVehicle == true && 
                                        this.user.allowArchiveVehicle==true" (click)="archiveVehicle(vehicle)"
                                href="javascript:;"
                                class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Archive
                                This Vehicle</a>

                            <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                                (click)="printPage('print-content-vehicle','vehicle');" href="javascript:;"
                                class="btn btn-outline-dark h-45 px-4 rounded-2 fs-14 fw-600">Print</a>

                            <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                                (click)="openVehicleUrl(vehicle.token)" href="javascript:;"
                                class="btn btn-outline-dark h-45 px-4 rounded-2 fs-14 fw-600">Print QR Code</a>

                            <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0" title="WIP or Un-WIP"
                                (click)="special(vehicle); " href="javascript:;"
                                class="btn btn-outline-danger h-45 px-4 rounded-2 fs-14 fw-600">WIP</a>

                            <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0 && vehicle.imageModels.length > 0"
                                title="Sort Images to different types"
                                (click)="showDocTypedImageModels = !showDocTypedImageModels" href="javascript:;"
                                class="btn btn-outline-success h-45 px-4 rounded-2 fs-14 fw-600">Sort Images</a>

                            <button name="btn" *ngIf="user.allowAddAndUpdateVehicle == true "
                                class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600" title="Upload pdf"
                                (click)="fileInputPdf.click()"><i class="fa fa-cloud-upload me-2"></i> Upload
                                PDF</button>
                            <input type='file' accept="application/pdf"
                                class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 bottom-0 position-absolute"
                                #fileInputPdf (change)="onSelectFileEditorPdf($event)" multiple
                                (click)="fileInput.value = ''" />


                            <button name="btn" *ngIf="user.allowAddAndUpdateVehicle == true"
                                class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600"
                                (click)="fileInputModal.click()"><i class="fa fa-cloud-upload me-2"></i> Upload
                                Images</button>

                            <input type='file' accept="image/jpg, image/jpeg"
                                class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 bottom-0 position-absolute"
                                #fileInputModal (change)="onSelectFileEditor($event)" multiple
                                (click)="fileInputModal.value = ''" />

                            <a *ngIf="vehicle.archived==false && user.allowAddAndUpdateVehicle == true"
                                (click)="editModeVehicle =!editModeVehicle; refresh(); setStep(0)" href="javascript:;"
                                class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Edit
                                Details</a> <a *ngIf="vehicle.archived==true" (click)="unArchive(vehicle)"
                                href="javascript:;"
                                class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Un-Archive
                                This Vehicle</a>




                        </div>
                    </div>

                    <div class="tab-pane" id="editDetails" role="tabpanel" aria-labelledby="editDetails-tab">
                        <div class="row">
                            <div class="col-12 px-0">
                                <div class="vehicle-form"
                                    *ngIf="vehicle.id> 0 && user.allowAddAndUpdateVehicle == true">
                                    <div class="row">
                                        <div class="col-12">
                                            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist"
                                                *ngIf="currentUser">
                                                <li class="nav-item me-3" role="presentation">
                                                    <button
                                                        class="nav-link active py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                                                        id="info-tab" data-bs-toggle="pill" data-bs-target="#info-tabs"
                                                        type="button" role="tab" aria-controls="info-tabs"
                                                        aria-selected="true"><i class="fa fa-circle me-2"></i>
                                                        Information</button>
                                                </li>
                                                <li class="nav-item me-3" role="presentation">
                                                    <button
                                                        class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                                                        id="requests-tab" data-bs-toggle="pill"
                                                        data-bs-target="#requests-tabs" type="button" role="tab"
                                                        aria-controls="requests-tabs" aria-selected="false"><i
                                                            class="fa fa-circle me-2"></i>Job
                                                        Order/Request</button>
                                                </li>
                                                <li class="nav-item me-3" role="presentation">
                                                    <button
                                                        class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                                                        id="prior-damage" data-bs-toggle="pill"
                                                        data-bs-target="#prior-damages" type="button" role="tab"
                                                        aria-controls="prior-damages" aria-selected="false"><i
                                                            class="fa fa-circle me-2"></i> Prior
                                                        Damage</button>
                                                </li>
                                                <li class="nav-item me-3" role="presentation">
                                                    <button
                                                        class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                                                        id="image-modal" data-bs-toggle="pill"
                                                        data-bs-target="#image-modals" type="button" role="tab"
                                                        aria-controls="image-modals" aria-selected="false"><i
                                                            class="fa fa-circle me-2"></i> Images
                                                        [{{this.vehicle.imageModels.length}}]</button>
                                                </li>
                                                <li class="nav-item me-3" role="presentation">
                                                    <button
                                                        class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                                                        id="pdf-modal" data-bs-toggle="pill"
                                                        data-bs-target="#pdf-modals" type="button" role="tab"
                                                        aria-controls="pdf-modals" aria-selected="false"><i
                                                            class="fa fa-circle me-2"></i> Documents
                                                        [{{this.vehicle.pdfFiles.length}}]</button>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="tab-content" id="pills-tabContent">
                                        <div #taggroup class="tab-pane fade show active" id="info-tabs" role="tabpanel"
                                            aria-labelledby="info-tab" tabindex="0">
                                            <div class="row pt-1">
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="year"
                                                            class="form-label fs-14 fw-400 mb-3">Year</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.year" placeholder="Year">
                                                            <option value="undefined" disabled selected>Select Year
                                                            </option>
                                                            <option [value]="option"
                                                                *ngFor="let option of optionsYear;let i=index;">
                                                                {{option}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="makeake"
                                                            class="form-label fs-14 fw-400 mb-3">Make</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.make" #device
                                                            (change)="onChange($event, device.value)"
                                                            placeholder="Make">
                                                            <option value="undefined" disabled selected>Select Make
                                                            </option>
                                                            <option [value]="option"
                                                                *ngFor="let option of optionsMake;let i=index;">
                                                                {{option}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="model"
                                                            class="form-label fs-14 fw-400 mb-3">Model</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.model" placeholder="Model">
                                                            <option value="undefined" disabled selected>Select Model
                                                            </option>
                                                            <option [value]="option"
                                                                *ngFor="let option of optionsModel;let i=index;">
                                                                {{option}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="color"
                                                            class="form-label fs-14 fw-400 mb-3">Color</label>
                                                        <select
                                                            class="form-select h-48 px-3 border-radius-8 text-capitalize text-shadow text-white"
                                                            style="background-color: {{vehicle.color}}"
                                                            [(ngModel)]="vehicle.color" placeholder="Color">
                                                            <option value="undefined" disabled selected>Select Color
                                                            </option>
                                                            <option style="background-color: {{color}}"
                                                                *ngFor="let color of optionsColor;let i=index;">
                                                                {{color}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="miles"
                                                            class="form-label fs-14 fw-400 mb-3">Miles</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="text" placeholder="Enter Miles" maxlength="20"
                                                            [(ngModel)]="vehicle.miles" />
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="mt-4 pt-1">
                                                        <label for="Description"
                                                            class="form-label fs-14 fw-400 mb-3">Description</label>
                                                        <textarea trimText style="line-height: 2;"
                                                            class="form-control h-48 px-3 border-radius-8" type="text"
                                                            rows="2" placeholder="Enter Description" maxlength="255"
                                                            [(ngModel)]="vehicle.description"></textarea>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="plate"
                                                            class="form-label fs-14 fw-400 mb-3">Plate</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="text" placeholder="Enter Plate" maxlength="50"
                                                            [(ngModel)]="vehicle.plate" />
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="vin"
                                                            class="form-label fs-14 fw-400 mb-3">VIN</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="text" placeholder="Enter VIN" maxlength="17"
                                                            [(ngModel)]="vehicle.vin" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="mt-4 pt-1">
                                                    <label for="notesComment" class="form-label fs-14 fw-400 mb-3">Notes
                                                        / Comments</label>
                                                    <textarea trimText class="form-control h-48 px-3 border-radius-8"
                                                        type="text" maxlength="2000" rows="4" style="line-height: 2;"
                                                        placeholder="Enter Notes / Comments"
                                                        [(ngModel)]="vehicle.comments"></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div #taggroup class="tab-pane fade" id="requests-tabs" role="tabpanel"
                                            aria-labelledby="requests-tab" tabindex="0">
                                            <div class="row pt-1">
                                                <div class="col-md-12">
                                                    <div class="mt-4 pt-1">
                                                        <label for="workRequest"
                                                            class="form-label fs-14 fw-400 mb-3">Work Requests</label>
                                                        <textarea class="form-control px-3 border-radius-8 pt-3"
                                                            rows="4" placeHolder="Enter Work Request" maxlength="255"
                                                            [(ngModel)]="vehicle.workRequest"></textarea>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="jobRequestType" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/job-request-type'"
                                                            class="form-label fs-14 fw-400 mb-3">Job Request
                                                            Type</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.jobRequestType"
                                                            placeholder="Job Request Type">
                                                            <option value="undefined" disabled selected>Select Job
                                                                Request Type</option>
                                                            <option [value]="jobRequestType.id"
                                                                *ngFor="let jobRequestType of jobRequestTypes;let i=index;">
                                                                {{jobRequestType.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="claimNumber"
                                                            class="form-label fs-14 fw-400 mb-3">Claim Number</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="text" placeholder="Enter Claim Number" maxlength="200"
                                                            [(ngModel)]="vehicle.claimNumber" />
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="price"
                                                            class="form-label fs-14 fw-400 mb-3">Price</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="number" placeholder="Enter Price" maxlength="10"
                                                            onKeyPress="if(this.value.length==10) return false"
                                                            [(ngModel)]="vehicle.price" pattern="[0-9]" />
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="mt-4 pt-1">
                                                        <label for="Supplements"
                                                            class="form-label fs-14 fw-400 mb-3">Supplements
                                                            <span class="fs-14 fw-700 text-deanger"
                                                                *ngIf="vehicle.supplements.length> 0">${{getTotalSupplements(vehicle)}}
                                                            </span>
                                                            <button (click)="createSupplyment(vehicle)"
                                                                title="Add Supplement"
                                                                class="btn rounded-0 btn-sm btn-secondary-abs"><i
                                                                    class="fa fa-plus fa-1x"></i>Add
                                                                Supplement</button>
                                                        </label>
                                                        <div
                                                            class="table-container shadow border-radius-8 border w-100">
                                                            <table
                                                                class="table-bordered overflow-hidden border-radius-8 w-100"
                                                                *ngIf="vehicle.supplements.length >0">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="fs-14 text-center mw-50"
                                                                            style="width: 50px;"> #</th>
                                                                        <th class="fs-14 text-center w-auto"
                                                                            style="min-width: 50px; max-width:150px">
                                                                            Description</th>
                                                                        <!-- <th class="fs-14 text-center mw-100 w-auto"> Description</th> -->
                                                                        <th class="fs-14 text-center  mw-100"
                                                                            style="width: 100px;"> Price $</th>
                                                                        <th class="fs-14 text-center mw-100 w-auto"
                                                                            title="Approval Status, click to configure"
                                                                            (click)="navigateTo('approval-status')">
                                                                            Approval Status</th>
                                                                        <th class="fs-14 text-center mw-100 w-auto">
                                                                            Updated <i class="fa-solid fa-clock"></i>
                                                                        </th>
                                                                        <th class="fs-14 text-center mw-100 w-auto">
                                                                            Created <i class="fa-solid fa-clock"></i>
                                                                        </th>
                                                                        <th class="fs-14 text-center mw-100 w-auto">
                                                                            Action</th>
                                                                    </tr>
                                                                    <tr
                                                                        *ngFor='let supplement of vehicle.supplements; let i=index'>
                                                                        <td class="text-center fs-13">{{i+1}}</td>
                                                                        <td class="text-center fs-13">
                                                                            <input trimText
                                                                                [ngClass]="{'blink': supplement.name=='Change Me' }"
                                                                                class="form-control h-48 px-3 border-radius-8"
                                                                                type="text"
                                                                                (key.enter)=" saveSupplyment(vehicle, supplement, 'name')"
                                                                                placeholder="Enter Name" maxlength="200"
                                                                                [(ngModel)]="supplement.name" />
                                                                        </td>

                                                                        <td class="text-center fs-13">
                                                                            <input trimText
                                                                                class="form-control h-48 px-3 border-radius-8"
                                                                                type="number"
                                                                                onKeyPress="if(this.value.length==10) return false"
                                                                                placeholder="Enter Price"
                                                                                (key.enter)=" saveSupplyment(vehicle, supplement, 'price')"
                                                                                maxlength="20"
                                                                                [(ngModel)]="supplement.price" />
                                                                        </td>

                                                                        <td class="text-center fs-13">
                                                                            <select
                                                                                class="form-select h-48 px-3 border-radius-8"
                                                                                (change)="saveSupplyment(vehicle, supplement, 'approval status')"
                                                                                #approvalStatus
                                                                                [(ngModel)]="supplement.status"
                                                                                placeholder="Approval Status">
                                                                                <option value="0" disabled selected>
                                                                                    Select Approval Status</option>
                                                                                <option [value]="approvalStatus.id"
                                                                                    *ngFor="let approvalStatus of approvalStatuss;let i=index;">
                                                                                    {{approvalStatus.name}}
                                                                                </option>
                                                                            </select>
                                                                        </td>

                                                                        <td class="text-center fs-13">
                                                                            <input trimText
                                                                                class="form-control h-48 px-3 border-radius-8"
                                                                                type="date"
                                                                                placeholder="Supplement Date"
                                                                                (change)="onChangeSupplementDate($event, vehicle, supplement)"
                                                                                [ngModel]="supplement.updatedAt |  date:'yyyy-MM-dd'" />

                                                                        </td>
                                                                        <td class="text-center fs-13">
                                                                            {{ supplement.createdAt| date:
                                                                            'MM/dd/yyyy'}}
                                                                        </td>
                                                                        <td class="text-center fs-13">
                                                                            <div class="d-flex gap-2">
                                                                                <button title="Remove this supplement"
                                                                                    (click)="deleteSupplyment(supplement.id)"
                                                                                    class="btn btn-outline-danger btn-sm"
                                                                                    for="title"> <i
                                                                                        class="bi-trash"></i>
                                                                                </button>
                                                                                <button title="Save this supplement"
                                                                                    (click)="saveSupplyment(vehicle, supplement, 'update')"
                                                                                    class="btn btn-outline-success btn-sm"
                                                                                    for="title"> <i class="bi-save"></i>
                                                                                </button>
                                                                            </div>

                                                                        </td>
                                                                    </tr>
                                                                </thead>
                                                            </table>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="arrivalMode" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/arrival-mode'"
                                                            class="form-label fs-14 fw-400 mb-3">Arrival Mode</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.inTakeWay" placeholder="Arrival Mode">
                                                            <option value="0" disabled selected>Select Arrival Mode
                                                            </option>
                                                            <option [value]="inTakeWay.id"
                                                                *ngFor="let inTakeWay of inTakeWays;let i=index;">
                                                                {{inTakeWay.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="paymentMethod" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/payment-method'"
                                                            class="form-label fs-14 fw-400 mb-3">Payment Method</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.paymentMethod"
                                                            placeholder="Payment Method">
                                                            <option value="0" disabled selected>Select Payment Method
                                                            </option>
                                                            <option [value]="paymentMethod.id"
                                                                *ngFor="let paymentMethod of paymentMethods;let i=index;">
                                                                {{paymentMethod.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="insuranceCompany" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/insurance-companies'"
                                                            class="form-label fs-14 fw-400 mb-3">Insurance
                                                            Company</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.insuranceCompany"
                                                            placeholder="Payment Method">
                                                            <option value="undefined" disabled selected>Select Insurance
                                                                Company</option>
                                                            <option [value]="insurancer.name"
                                                                *ngFor="let insurancer of insurancers;let i=index;">
                                                                {{insurancer.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="approvalStatus" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/approval-status'"
                                                            class="form-label fs-14 fw-400 mb-3">Approval Status</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            (change)="onChangeApprovalStatus($event, approvalStatus.value)"
                                                            #approvalStatus [(ngModel)]="vehicle.approvalStatus"
                                                            placeholder="Approval Status">
                                                            <option value="0" disabled selected>Select Approval Status
                                                            </option>
                                                            <option [value]="approvalStatus.id"
                                                                *ngFor="let approvalStatus of approvalStatuss;let i=index;">
                                                                {{approvalStatus.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="Parking" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/parking-location'"
                                                            class="form-label fs-14 fw-400 mb-3">Parking</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.location" placeholder="Parking">
                                                            <option value="0" disabled selected>Select Parking</option>
                                                            <option [value]="location.id"
                                                                *ngFor="let location of locations;let i=index;">
                                                                {{location.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="rentalCompany" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/rental-companies'"
                                                            class="form-label fs-14 fw-400 mb-3">Rental Company</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.loanerCarName"
                                                            placeholder="Rental Company">
                                                            <option value="0" disabled selected>Select Rental Company
                                                            </option>
                                                            <option [value]="rental.name"
                                                                *ngFor="let rental of rentals;let i=index;">
                                                                {{rental.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-4"
                                                    *ngIf="vehicle.loanerCarName !=  null && vehicle.loanerCarName !=''">
                                                    <div class="mt-4 pt-1">
                                                        <label for="rentalDueDate"
                                                            class="form-label fs-14 fw-400 mb-3">Rental Due Date</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="date" placeholder="Rental Due Date"
                                                            (change)="onChangeVehicleCalendarRental($event, vehicle)"
                                                            [ngModel]="vehicle.rentalDate |  date:'yyyy-MM-dd'" />
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="targetDate"
                                                            class="form-label fs-14 fw-400 mb-3">Target Date</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="date" placeholder="Target Date"
                                                            [disabled]="user.allowChangeJobTargetDate == false"
                                                            (change)="onChangeVehicleCalendar($event, vehicle)"
                                                            [ngModel]="vehicle.targetDate |  date:'yyyy-MM-dd'" />
                                                    </div>
                                                </div>
                                                <div class="col-md-4"
                                                    *ngIf="vehicle.targetDateChangeReason != null && vehicle.targetDateChangeReason != '' ">
                                                    <div class="mt-4 pt-1">
                                                        <label for="reasonChnageDate"
                                                            class="form-label fs-14 fw-400 mb-3">Reason for Target Date
                                                            Change</label>
                                                        <input trimText class="form-control h-48 px-3 border-radius-8"
                                                            type="text" placeholder="Reason for Target Date Change"
                                                            disabled [(ngModel)]="vehicle.targetDateChangeReason" />
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="mt-4 pt-1">
                                                        <label for="status" data-bs-toggle="tooltip"
                                                            data-bs-dismiss="modal" title="Click to go to Configuration"
                                                            [routerLink]="'/job-status'"
                                                            class="form-label fs-14 fw-400 mb-3">Status</label>
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [(ngModel)]="vehicle.status" placeholder="status" #status
                                                            [disabled]="user.allowUpdateVehicleStatus == false"
                                                            (change)="onChangeStatus($event, status.value)"
                                                            placeholder="Status">
                                                            <option value="0" disabled selected>Select Status</option>
                                                            <option *ngFor="let option of statuss; let i=index"
                                                                value="{{option.id}}">{{option.name}}
                                                            </option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div #taggroup class="tab-pane fade" id="prior-damages" role="tabpanel"
                                            aria-labelledby="prior-damage" tabindex="0">
                                            <div class="row pt-1">
                                                <div class="col-md-12">
                                                    <div class="mt-4 pt-1">
                                                        <label for="priorDamages"
                                                            class="form-label fs-14 fw-400 mb-3">Prior Damages
                                                            {{getPriorDamageWordCount()}} <small>Words (500
                                                                Max)</small></label>
                                                        <textarea class="form-control px-3 border-radius-8 pt-3"
                                                            rows="4" placeHolder="Enter Prior Damages" maxlength="500"
                                                            [(ngModel)]="vehicle.priorDamage"
                                                            (keyup.enter)="onSavePriorDamage(vehicle)"></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div #taggroup class="tab-pane fade" id="image-modals" role="tabpanel"
                                            aria-labelledby="image-modals" tabindex="0">

                                            <div class="row pt-1">
                                                <div class="col-md-12">
                                                    <div class="mt-4 pt-1">
                                                        <div class="row">
                                                            <div class="col-md-5 "> <strong class="fs-5 h-48">Please
                                                                    Upload Images:</strong> </div>
                                                            <div class="col-md-7 px-0">
                                                                <div class="position-relative">
                                                                    <button name="btn"
                                                                        class="btn btn-secondary-abs py-3 px-0 w-100"
                                                                        (click)="fileInput.click()"><i
                                                                            class="fa fa-cloud-upload me-2"></i> Upload
                                                                        Images</button>
                                                                    <input type='file' accept="image/jpg, image/jpeg"
                                                                        class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute"
                                                                        #fileInput (change)="onSelectFileEditor($event)"
                                                                        multiple (click)="fileInput.value = ''" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row pt-3">
                                                <div class="col-12">
                                                    <div class="table-container shadow border-radius-8 border w-100 d-box ss-table"
                                                        cdkDropList (cdkDropListDropped)="droppedDocType($event)">
                                                        <table class="table-bordered border-radius-8 w-100"
                                                            *ngIf="docTypes.length > 0 && this.vehicle && this.vehicle.imageModels && this.vehicle.imageModels.length > 0"
                                                            cdkDropListGroup>
                                                            <thead>
                                                                <tr>

                                                                    <th class="fs-14 text-center mxw-150"
                                                                        style="width:100px" data-bs-dismiss="modal"
                                                                        title="Click to navigagte to Document Type Setting"
                                                                        (click)="navigateTo('doc-types')">
                                                                        Doc Type</th>

                                                                    <th class="fs-14 text-center "
                                                                        title="Sorted by vehicle make">Images [ {{
                                                                        this.vehicle.imageModels.length }} ] Ordered by
                                                                        created date</th>

                                                                </tr>
                                                            </thead>
                                                            <ng-container
                                                                *ngFor="let docType of docTypes; let i = index;  let even=even">
                                                                <tr id="{{docType.id}}" title=""
                                                                    [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')"
                                                                    [cdkDragDisabled]="isMobile==true || docType.id==0 "
                                                                    cdkDrag>

                                                                    <td class="fs-15 text-center "
                                                                        title="Drag and drop to arrange orders">
                                                                        <strong *ngIf="docType.color != null"
                                                                            [style.color]="docType.color">{{docType.name}}
                                                                            <br
                                                                                *ngIf="docType.imageModels && docType.imageModels.length>0">
                                                                            <span
                                                                                *ngIf="docType.imageModels && docType.imageModels.length>0">(
                                                                                {{ docType.imageModels.length}}
                                                                                )</span></strong>
                                                                        <strong
                                                                            *ngIf="docType.color == null">{{docType.name}}
                                                                            <br
                                                                                *ngIf="docType.imageModels && docType.imageModels.length>0">
                                                                            <span
                                                                                *ngIf="docType.imageModels && docType.imageModels.length>0">(
                                                                                {{ docType.imageModels.length}}
                                                                                )</span></strong>
                                                                    </td>

                                                                    <td *ngIf="docType.imageModels && docType.imageModels.length == 0"
                                                                        cdkDropList
                                                                        (cdkDropListDropped)="droppedDocType3($event, docType, docType.id)">
                                                                    </td>
                                                                    <td
                                                                        *ngIf="docType.imageModels && docType.imageModels.length >0">
                                                                        <div class="d-flex flex-wrap gap-1" cdkDropList
                                                                            (cdkDropListDropped)="droppedDocType3($event, docType,docType.id)">

                                                                            <div class="containerImage btn btn-light images-lists gap-2 align-items-center white-space my-1 border p-1 shadow my-2 transition v-imgs"
                                                                                [style.background-color]="imageModel.id == indexImageModelDrop? '#EEE' : (true ? 'white' : 'white')"
                                                                                *ngFor=" let imageModel of  docType.imageModels; let i=index"
                                                                                title="Click to enlarge, or drag and drop to change doc type"
                                                                                cdkDropListOrientation="horizontal"
                                                                                [cdkDragDisabled]="isMobile==true"
                                                                                cdkDrag [cdkDragData]="i"
                                                                                (click)=" getDetailImageModel(imageModel,i)">
                                                                                <label class="top-left" for="title">
                                                                                    {{imageModel.createdAt| date:
                                                                                    'MM/dd/yyyy' }}</label>
                                                                                <img class="preview img-fluid img-thumbnail"
                                                                                    width="150" height="150"
                                                                                    title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                                                                    *ngIf="vehicle.showInSearchImageId != imageModel.id"
                                                                                    src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                                                                    style="border: 3px solid #555;">
                                                                                <img class="preview img-fluid img-thumbnail"
                                                                                    width="150" height="150"
                                                                                    title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}}"
                                                                                    *ngIf="vehicle.showInSearchImageId == imageModel.id"
                                                                                    src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                                                                    title="Show in search"
                                                                                    style="border: 3px solid lightcoral;">

                                                                            </div>

                                                                        </div>

                                                                    </td>
                                                                </tr>

                                                            </ng-container>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row pt-1">
                                                <div class="col-md-12">
                                                    <div class="mt-4 pt-1">
                                                        <div class="row">

                                                            <div class="col-md-12 px-0" *ngIf="selectedImage > 0">
                                                                <div class=" mt-4 pt-1 position-relative"
                                                                    *ngIf="selectedImage > 0 ">
                                                                    <div class="containerImage"
                                                                        *ngIf="vehicle.imageModels.length > 0 && selectedImage > 0">
                                                                        <img *ngIf="selectedImage != null && selectedImage > 0 &&  vehicle.showInSearchImageId != selectedImage"
                                                                            class="image w-100 img-fluid img-thumbnail"
                                                                            src="{{baseUrlImage + '/' + selectedImage}}"
                                                                            alt="Image" />
                                                                        <img *ngIf="selectedImage != null && selectedImage > 0 && vehicle.showInSearchImageId == selectedImage"
                                                                            class="image w-100 img-fluid img-thumbnail"
                                                                            src="{{baseUrlImage + '/' + selectedImage}}"
                                                                            alt="Image" />
                                                                        <label
                                                                            *ngIf="selectedImage == vehicle.showInSearchImageId"
                                                                            class="top-left" for="title">
                                                                            Will Show this in listing</label>
                                                                        <div class="top-right py-1"
                                                                            *ngIf="selectedImage > 0">

                                                                            <select
                                                                                class="btn btn-outline-success fw-700 me-3 mt-3 btn-sm"
                                                                                [(ngModel)]="imageModelDrop.docType"
                                                                                title="Type"
                                                                                style="color: {{getDocTypeColor(imageModelDrop.docType)}}"
                                                                                placeholder="Doc Type" #docType
                                                                                (change)="onChangeDocTypeDropped($event)">
                                                                                <option
                                                                                    *ngFor="let docType of docTypes let i=index"
                                                                                    value="{{docType.id}}"
                                                                                    class="bg-white fw-700"
                                                                                    style="color:{{docType.color}}">
                                                                                    {{docType.name}} </option>
                                                                            </select>

                                                                            <button title="Close"
                                                                                (click)="selectedImage = 0"
                                                                                class="btn btn-outline-primary me-3 mt-3 btn-sm"
                                                                                for="title">Close</button>
                                                                            <button
                                                                                *ngIf="selectedImage > 0 && selectedImage != vehicle.showInSearchImageId"
                                                                                title="As index image during search"
                                                                                (click)="setImageForSearch(vehicle.id, selectedImage)"
                                                                                class="btn btn-outline-primary me-3 mt-3 btn-sm"
                                                                                for="title">Set for
                                                                                Index</button>
                                                                            <button *ngIf="selectedImage > 0"
                                                                                (click)="deleteImage(vehicle.id, selectedImage)"
                                                                                data-toggle="tooltip"
                                                                                data-placement="top"
                                                                                title="Remove this image"
                                                                                class="btn btn-outline-danger mt-3 btn-sm"
                                                                                for="title"> <i class="bi-trash"></i>
                                                                            </button>
                                                                        </div>

                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div #taggroup class="tab-pane fade" id="pdf-modals" role="tabpanel"
                                            aria-labelledby="pdf-modals" tabindex="0">
                                            <div class="row pt-1">
                                                <div class="col-md-12">
                                                    <div class="mt-4 pt-1">

                                                        <div class="row">
                                                            <div class="col-md-5 mt-4 pt-4"> <strong class="fs-5">Please
                                                                    Upload The PDF
                                                                    File:</strong>
                                                            </div>
                                                            <div class="col-md-7">
                                                                <div class="mt-4 pt-1 position-relative">
                                                                    <button name="btn"
                                                                        class="btn btn-secondary-abs py-3 px-3 w-100"
                                                                        (click)="fileInputPdf.click()"><i
                                                                            class="fa fa-cloud-upload me-2"></i> Upload
                                                                        PDF</button>
                                                                    <input type='file' accept="application/pdf"
                                                                        class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute"
                                                                        #fileInputPdf
                                                                        (change)="onSelectFileEditorPdf($event)"
                                                                        multiple (click)="fileInput.value = ''" />
                                                                </div>
                                                            </div>
                                                            <div class="col-md-12">
                                                                <div class="mt-2 pt-4 position-relative">
                                                                    <div
                                                                        class="table-container shadow border-radius-8 border w-100">
                                                                        <table
                                                                            class="table-bordered overflow-hidden border-radius-8 w-100"
                                                                            *ngIf="vehicle.pdfFiles.length >0">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th
                                                                                        class="fs-14 text-center mw-100 w-auto">
                                                                                        #</th>
                                                                                    <th
                                                                                        class="fs-14 text-center mw-100 w-auto">
                                                                                        File Name</th>
                                                                                    <th
                                                                                        class="fs-14 text-center mw-100 w-auto">
                                                                                        Created <i
                                                                                            class="fa-solid fa-clock"></i>
                                                                                    </th>
                                                                                    <th
                                                                                        class="fs-14 text-center mw-100 w-auto">
                                                                                        Action</th>
                                                                                </tr>
                                                                                <tr
                                                                                    *ngFor='let pdfFile of vehicle.pdfFiles; let i=index'>
                                                                                    <td class="text-center fs-13"
                                                                                        (click)="getPdf(pdfFile.token)">
                                                                                        {{i+1}}</td>
                                                                                    <td class="text-center fs-13"
                                                                                        (click)="getPdf(pdfFile.token)">
                                                                                        {{pdfFile.fileName}}</td>
                                                                                    <td class="text-center fs-13"
                                                                                        (click)="getPdf(pdfFile.token)">
                                                                                        {{
                                                                                        pdfFile.createdAt | date:
                                                                                        'MM/dd/yyyy'}}</td>
                                                                                    <td class="text-center fs-13">
                                                                                        <button
                                                                                            (click)="deletePdf(pdfFile.token)"
                                                                                            title="Remove this pdf"
                                                                                            class="btn btn-outline-danger btn-sm"
                                                                                            for="title">
                                                                                            <i class="bi-trash"></i>
                                                                                        </button>
                                                                                    </td>
                                                                                </tr>
                                                                            </thead>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                                <div class="mt-4 pt-1 position-relative">
                                                                    <div class="containerImage"
                                                                        *ngIf="vehicle.pdfFiles.length > 0">
                                                                        <embed *ngIf="pdfSrc" [src]="pdfSrc"
                                                                            type="application/pdf" width="100%"
                                                                            height="600px" />
                                                                        <div class="bottom-right py-2">
                                                                            <button *ngIf="pdfSrc"
                                                                                (click)="deletePdf(currentToken)"
                                                                                data-toggle="tooltip"
                                                                                data-placement="top"
                                                                                title="Remove this pdf"
                                                                                class="btn btn-outline-danger mt-3 btn-sm"
                                                                                for="title"> <i class="bi-trash"></i>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center gap-3 mt-5 px-3">
                                        <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                                            (click)="createVehicle(vehicle);"
                                            class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Save
                                            Details</a> <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                                            (click)="printPage('print-content-vehicle','vehicle');"
                                            class="btn btn-outline-dark h-45 px-4 rounded-2 fs-14 fw-600">Print
                                            Here</a> <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                                            (click)="special(vehicle);"
                                            class="btn btn-outline-danger h-45 px-4 rounded-2 fs-14 fw-600">VIP</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Estimates Tab -->
                    <div class="tab-pane" id="estimates" role="tabpanel" aria-labelledby="estimates-tab">
                        <div class="tab-pane fade show" id="claims-tabs" role="tabpanel" #taggroup
                            aria-labelledby="claims-damages-tab">
                            <h2 class="heading-color fw-700 text-uppercase pt-5 fs-16 pb-3">Vehicle Estimates for:
                                <strong class="text-primary fw-700" style="cursor: pointer;"
                                    title="Click to view details">{{vehicle.year}}
                                    {{vehicle.make}}
                                    {{vehicle.model}} {{vehicle.color}} ({{ claims.length}})</strong><span
                                    class="text-danger" title="Total estimates">
                                    [${{getTotalClaims()}}]</span>
                                - <span class="text-danger" title="Total payments">[${{getTotalPayments()}}] </span>
                                = <span class="text-danger" title="Balance">[${{getTotalBalance()}}]</span>
                            </h2>
                            <div class="d-lg-flex align-items-center justify-content-between px-1 mt-3">
                                <div class="d-flex align-items-center gap-3 w-50 v-receipt">
                                    <select class="form-select h-48 px-3 border-radius-8"
                                        [(ngModel)]="vehicle.paymentMethod" #paymentMethod title="Payment Methods"
                                        (change)="onChangeVehiclePaymentMethod($event, paymentMethod.value)">
                                        <option value="0" disabled selected>Select Payment Method</option>
                                        <option [value]="paymentMethod.id"
                                            *ngFor="let paymentMethod of paymentMethods;let i=index;">
                                            {{paymentMethod.name}}</option>
                                    </select>
                                    <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="disclaimerId"
                                        #optionDisclaimerId title="Disclaimers"
                                        (change)="setDisclaimerText(optionDisclaimerId.value)">
                                        <option value="0" disabled selected>Select Disclaimer</option>
                                        <option [value]="disclaimer.id"
                                            *ngFor="let disclaimer of disclaimers;let i=index;">
                                            {{disclaimer.name}} <span
                                                *ngIf="disclaimer.isDefault ==true">(default)</span></option>
                                    </select>
                                    <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="warrantyId"
                                        #optionWarrantyId title="Warranties"
                                        (change)="setWarrantyText(optionWarrantyId.value)">
                                        <option value="0" disabled selected>Select Warranty</option>
                                        <option [value]="warranty.id" [selected]="warranty.isDefault == true"
                                            *ngFor="let warranty of warranties;let i=index;">
                                            {{warranty.name}} <span *ngIf="warranty.isDefault ==true">(default)</span>
                                        </option>
                                    </select>
                                    <div class="form-check form-switch d-flex ms-3 mw-150">
                                        <input class="form-check-input mt-0" type="checkbox" role="switch" id="tax"
                                            title="Apply Tax or No Tax" (change)="onChangeNoTax($event)" />
                                        <label class="form-check-label fa-13 mt-1 ms-4" for="tax">No Tax</label>
                                    </div>
                                </div>
                                <div class="add-r">


                                    <div class="dropdown h-40 fs-13 mt-2 btn btn-primary px-1 border-radius-4 ms-md-2"
                                        *ngIf="user.allowAddUpdateEstimate == true">
                                        <button class="dropdown-toggle btn-primary" type="button"
                                            data-bs-toggle="dropdown" aria-expanded="false"><i
                                                class="fa fa-plus me-2"></i> Add Item
                                            <i class="fa fa-angle-down ms-2"></i></button>
                                        <ul class="dropdown-menu p-0 border-0">
                                            <ng-container *ngFor="let itemType of itemTypes; let i=index">
                                                <li><a (click)="createClaimClaim(itemType);"
                                                        class="dropdown-item p-3 fs-12" href="javascript:;"><i
                                                            class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                                                        {{itemType.name}}
                                                        <ng-container *ngIf="itemType.createPurchaseOrder == true">
                                                            <span class="fw-700 text-primary opacity-50"> <i
                                                                    class="fa-solid fa-cart-shopping"></i></span>
                                                        </ng-container>
                                                        <ng-container *ngIf="itemType.createJobOrder == true">
                                                            <span class="fw-700 text-info"> <i
                                                                    class="fa-solid fa-user"></i> </span>
                                                        </ng-container>
                                                    </a></li>
                                            </ng-container>
                                        </ul>
                                    </div>

                                    <div class="dropdown h-40 fs-13 mt-2 btn btn-primary px-1 border-radius-4 ms-md-2"
                                        *ngIf="user.allowAddPayment == true">
                                        <button class="dropdown-toggle btn-primary" type="button"
                                            data-bs-toggle="dropdown" aria-expanded="false"><i
                                                class="fa fa-plus me-2"></i> Add Payment
                                            <i class="fa fa-angle-down ms-2"></i></button>
                                        <ul class="dropdown-menu p-0 border-0">
                                            <ng-container *ngFor="let paymentType of paymentTypes; let i=index">
                                                <li><a (click)="addVehiclePayment(paymentType); scrollToSection('payments')"
                                                        class="dropdown-item p-3 fs-12" href="javascript:;"><i
                                                            class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                                                        {{paymentType.name}}</a></li>
                                            </ng-container>
                                        </ul>
                                    </div>
                                    <button *ngIf="hasPOorJO() == true" title="Show Estimate items only toggle"
                                        (click)="this.showEstimatesOnly =!showEstimatesOnly"
                                        class="h-40 fs-13 mt-2 btn btn-warning border-radius-4 ms-md-2"><i
                                            class="fa fa-toggle-on  me-2  fa-2x"></i></button>

                                    <button *ngIf="filterClaims(0).length > 0"
                                        [disabled]="user.allowLockEstimate == false" (click)="lockAllEstimates(1)"
                                        title="Lock all estimates"
                                        class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                                            class="fa fa-lock me-2"></i>({{filterClaims(0).length}})</button>
                                    <button *ngIf="filterClaims(1).length > 0"
                                        [disabled]="user.allowLockEstimate == false" (click)="lockAllEstimates(0)"
                                        title="Unlock all estimates"
                                        class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                                            class="fa fa-lock-open me-2"></i>({{filterClaims(1).length}})</button>

                                    <button *ngIf="claims.length > 0"
                                        (click)="printPage('print-content-estimate', 'Estimates')"
                                        class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                                            class="fa fa-print me-2"></i> Print Estimate ({{claims.length}})</button>
                                    <button *ngIf="filterClaims(1).length > 0"
                                        (click)="printPage('print-content-estimate-invoice', 'Final Invoice')"
                                        class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                                            class="fa fa-print me-2"></i> Print Invoice ({{filterClaims(1).length
                                        }})</button>

                                </div>
                            </div>
                            <div class="row mt-4">
                                <div class="mt-4 pt-1">
                                    <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                                        <div class="table-responsive jobs-table bg-white border-radius-8 shadow"
                                            cdkDropList (cdkDropListDropped)="droppedClaim($event)">
                                            <table class="table table-bordered table-sm">
                                                <thead>
                                                    <tr>

                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                                            style="width: 50px;">#</th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                                                            title="Click to go to Configuration"
                                                            [routerLink]="'/item-types'"
                                                            style="width:120px; cursor: pointer; ">Item Type</th>
                                                        <th
                                                            class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">
                                                            Estimate Item
                                                            Description
                                                        </th>

                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                                                            style="width: 50px;">
                                                            Quantity</th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                                                            style="width:100px"><i class="fa-solid fa-dollar-sign"></i>
                                                        </th>

                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                            style="width: 100px;">Subtotal</th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                            style="width: 120px;"><i class="fa-solid fa-clock"></i>
                                                        </th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                            style="width: 120px;">Locked <i
                                                                class="fa-solid fa-clock"></i></th>
                                                        <th
                                                            class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                            <i class="fa-solid fa-user"></i>
                                                        </th>
                                                        <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                            style="width:100px;">
                                                            Action</th>
                                                    </tr>


                                                </thead>
                                                <tbody>
                                                    <ng-container *ngFor="let claim of claims; let i=index">
                                                        <tr (click)="setClaimId(claim.id)" class="shadow"
                                                            [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                                                            <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                                                                title="Drag and drop index number to change the order"
                                                                [cdkDragDisabled]="isMobile==true" cdkDrag>
                                                                {{claim.id}}</td>
                                                            <td class="p-2 text-center">
                                                                <select class="form-select h-48 px-3 border-radius-8 "
                                                                    [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                    (change)="onEnterClaimClaim('item type',claim)"
                                                                    [(ngModel)]="claim.itemType">
                                                                    <option value="0" disabled selected>Select Type
                                                                    </option>
                                                                    <option value="0" *ngIf="claim.itemType>0">Un-select
                                                                        Type</option>
                                                                    <option [value]="itemType.id"
                                                                        *ngFor="let itemType of itemTypes;let i=index;">
                                                                        {{itemType.name}}
                                                                    </option>
                                                                </select>
                                                            </td>
                                                            <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes"
                                                                    class="form-control"
                                                                    [ngClass]="{'blink border-danger': claim.notes == ''|| claim.notes == null }"
                                                                    placeholder="Please Specify"
                                                                    (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                                                    oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                                                    maxlength="200"
                                                                    [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea>
                                                            </td>

                                                            <td class="fs-13 p-2"><input
                                                                    (keyup.enter)="onEnterClaim('quantity',claim)"
                                                                    [(ngModel)]="claim.quantity"
                                                                    [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                    onKeyPress="if(this.value.length==10) return false"
                                                                    pattern="[0-9]" type="number"
                                                                    class="form-control form-control-sm h-40 border-radius-4" />
                                                            </td>
                                                            <td class="fs-13 p-2"><input
                                                                    (keyup.enter)="onEnterClaim('amount',claim)"
                                                                    [(ngModel)]="claim.amount"
                                                                    [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                    onKeyPress="if(this.value.length==10) return false"
                                                                    pattern="[0-9]" type="number"
                                                                    class="form-control form-control-sm h-40 border-radius-4" />
                                                            </td>

                                                            <td class="fs-13 p-2 text-center v-align-middle">
                                                                ${{getClaimSubTotal(claim)}}</td>
                                                            <td class="fs-13 p-2 text-center v-align-middle">
                                                                {{claim.createdAt | date: 'MM/dd/yyyy'}}
                                                            </td>
                                                            <td class="fs-13  p-2 text-center v-align-middle"><span
                                                                    *ngIf="claim.status==1">{{claim.lockedAt |
                                                                    date: 'MM/dd/yyyy' }}</span></td>
                                                            <td class="p-2 text-center  v-align-middle">


                                                                <ng-container *ngFor="let user of users;let i=index;">
                                                                    <span *ngIf="user.id == claim.userId">
                                                                        {{(user.firstName + " " + user.lastName) |
                                                                        shortName:2}}
                                                                    </span>
                                                                </ng-container>



                                                            </td>
                                                            <td class="p-2 text-center">
                                                                <div
                                                                    class="d-flex align-items-center justifyc-cntent-center gap-1">
                                                                    <button class="btn btn-outline-success btn-sm"
                                                                        *ngIf="claim.status==1"
                                                                        [disabled]="user.allowUnlockEstimate == false"
                                                                        title="Unlock this estimate item"
                                                                        (click)="lockClaim('unlock', claim)"><i
                                                                            class="fa fa-lock-open"></i></button>
                                                                    <button class="btn btn-outline-success btn-sm"
                                                                        *ngIf="claim.status==0"
                                                                        [disabled]="user.allowLockEstimate == false"
                                                                        title="Lock this estimate item"
                                                                        (click)="lockClaim('lock', claim)"><i
                                                                            class="fa fa-lock"></i></button>
                                                                    <button class="btn btn-outline-danger btn-sm"
                                                                        [disabled]="user.allowAddUpdateEstimate == false || claim.status ==1"
                                                                        title="Delete"
                                                                        (click)="deleteVehicleClaim(null, claim)"><i
                                                                            class="fa fa-trash"></i></button>
                                                                    <button class="btn btn-outline-success btn-sm"
                                                                        [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                                                        title="Save"
                                                                        (click)="onEnterClaimClaim('update', claim)"><i
                                                                            class="fa fa-save"></i></button>

                                                                    <button
                                                                        class="btn btn-navy bg-navy text-white btn-sm"
                                                                        *ngIf="showEstimatesOnly == false && claim.createPurchaseOrder == true && claim.notes !=''"
                                                                        [disabled]="user.allowAddUpdatePurchaseOrder == false "
                                                                        title="Add Purchase Order"
                                                                        (click)="addPurchaseOrderToClaim( claim)"><i
                                                                            class="fa fa-plus"></i></button>

                                                                    <button class="btn btn-info btn-sm"
                                                                        *ngIf="showEstimatesOnly == false && claim.createJobOrder == true && claim.notes !=''"
                                                                        [disabled]="user.allowAddService == false"
                                                                        title="Add Job Order"
                                                                        (click)="addJobToClaim( claim)"><i
                                                                            class="fa fa-plus"></i></button>


                                                                </div>
                                                            </td>
                                                        </tr>

                                                        <ng-container
                                                            *ngIf="showEstimatesOnly == false && claim.createPurchaseOrder == true && claim.purchaseOrders.length> 0 ">
                                                            <tr>
                                                                <!-- <td></td> -->
                                                                <td class="text-center fs-14 v-align-middle opacity-50">
                                                                    <i class="fa-solid fa-cart-shopping"></i>
                                                                </td>
                                                                <td colspan="9" cdkDropList
                                                                    (cdkDropListDropped)="droppedPurchaseOrdersClaim($event, claim)">

                                                                    <table
                                                                        class="table-bordered table-sm shadow overflow-hidden  line-height-100 w-100"
                                                                        *ngIf="claim.purchaseOrders.length >0">
                                                                        <thead>
                                                                            <tr>
                                                                                <th class="fs-12 text-center bg-navy text-white mw-50"
                                                                                    (click)="sortListPurchseOrdersClaim('id',claim.purchaseOrders)"
                                                                                    title="Sort By Most Recent">
                                                                                    PO #
                                                                                </th>


                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    (click)="sortListPurchseOrdersClaim('title',claim.purchaseOrders)"
                                                                                    title="Sort By Item Name"> PO Item
                                                                                    Name </th>
                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    (click)="sortListPurchseOrdersClaim('partNumber',claim.purchaseOrders)"
                                                                                    title="Sort By Parts Number"> Parts
                                                                                    #
                                                                                </th>
                                                                                <th class="fs-12 text-center bg-navy text-white mw-150"
                                                                                    (click)="sortListPurchseOrdersClaim('description',claim.purchaseOrders)"
                                                                                    title="Sort By Description">
                                                                                    Description </th>

                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    (click)="sortListPurchseOrdersClaim('vendorId',claim.purchaseOrders)"
                                                                                    title="Sort By Most Recent">Vender
                                                                                </th>

                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    (click)="sortListPurchseOrdersClaim('status',claim.purchaseOrders)"
                                                                                    title="Sort By Status">Approval</th>

                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    style="width:100px"
                                                                                    (click)="sortListPurchseOrdersClaim('purchaseStatus',claim.purchaseOrders)"
                                                                                    title="Sort By Status">Status
                                                                                </th>
                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    style="width:100px"
                                                                                    (click)="sortListPurchseOrdersClaim('grade',claim.purchaseOrders)"
                                                                                    title="Sort By Grade">
                                                                                    Grade
                                                                                </th>
                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    style="width:100px"
                                                                                    (click)="sortListPurchseOrdersClaim('salePrice',claim.purchaseOrders)"
                                                                                    title="Sort By Price"><i
                                                                                        class="fa-solid fa-dollar-sign"></i>
                                                                                </th>
                                                                                <th class="fs-12 text-center bg-navy text-white mw-100"
                                                                                    (click)="sortListPurchseOrdersClaim('createdAt',claim.purchaseOrders)"
                                                                                    title="Sort By Date"><i
                                                                                        class="fa-solid fa-clock"></i>
                                                                                </th>
                                                                                <th
                                                                                    class="fs-12 text-center bg-navy text-white mw-50">
                                                                                    <i class="fa-solid fa-user"></i>
                                                                                </th>

                                                                                <th
                                                                                    class="fs-12 text-center bg-navy text-white mw-100">
                                                                                    Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <ng-container
                                                                            *ngFor="let purchaseOrder of claim.purchaseOrders; let i = index;  let even=even">
                                                                            <tr id="{{vehicle.id}}"
                                                                                (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                title="" style="cursor: pointer;"
                                                                                [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                    title="Drag and drop index number to change the order"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                    [cdkDragDisabled]="isMobile==true"
                                                                                    cdkDrag>
                                                                                    {{purchaseOrder.id}}
                                                                                </td>


                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                    title="Click to view details. Drag and drop index number to change the order"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                    <p class="fs-12 text-black opacity-75"
                                                                                        style="display: inline-block; word-break: break-word;">
                                                                                        {{purchaseOrder.title}}</p>
                                                                                </td>
                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                    title="Click to view details. Drag and drop index number to change the order"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                    <p class="fs-12 text-black opacity-75"
                                                                                        style="display: inline-block; word-break: break-word;">
                                                                                        {{purchaseOrder.partNumber}}</p>
                                                                                </td>


                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                    title="Click to view details. Drag and drop index number to change the order"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                    <p class="fs-12 text-black opacity-75"
                                                                                        style="  display: -webkit-box;
                                -webkit-box-orient: vertical;
                                -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                 overflow: hidden;"> {{purchaseOrder.description}}
                                                                                        <ng-container
                                                                                            *ngIf="purchaseOrder.purchaseStatus==1">
                                                                                            <br>
                                                                                            <span
                                                                                                class="text-danger">Ordered
                                                                                                At: {{
                                                                                                purchaseOrder.orderedAt|
                                                                                                date:
                                                                                                'MM/dd/yyyy'}}</span>
                                                                                        </ng-container>
                                                                                        <ng-container
                                                                                            *ngIf="purchaseOrder.purchaseStatus==2">
                                                                                            <br>
                                                                                            <span
                                                                                                class="text-danger">Ordered
                                                                                                At: {{
                                                                                                purchaseOrder.orderedAt|
                                                                                                date:
                                                                                                'MM/dd/yyyy'}}</span>
                                                                                            <br>
                                                                                            <span
                                                                                                class="text-danger">Received
                                                                                                At:{{
                                                                                                purchaseOrder.receivedAt|
                                                                                                date:
                                                                                                'MM/dd/yyyy'}}</span>
                                                                                        </ng-container>
                                                                                        <ng-container
                                                                                            *ngIf="purchaseOrder.purchaseStatus==3">
                                                                                            <br>
                                                                                            <span
                                                                                                class="text-danger">Ordered
                                                                                                At: {{
                                                                                                purchaseOrder.orderedAt|
                                                                                                date:
                                                                                                'MM/dd/yyyy'}}</span>
                                                                                            <br>
                                                                                            <span
                                                                                                class="text-danger">Received
                                                                                                At:{{
                                                                                                purchaseOrder.receivedAt|
                                                                                                date:
                                                                                                'MM/dd/yyyy'}}</span>
                                                                                            <br>
                                                                                            <span
                                                                                                class="text-danger">Returned
                                                                                                At:{{
                                                                                                purchaseOrder.returnedAt|
                                                                                                date:
                                                                                                'MM/dd/yyyy'}}</span>
                                                                                        </ng-container>
                                                                                    </p>
                                                                                </td>

                                                                                <td
                                                                                    class="p-2 text-center  v-align-middle fs-12">

                                                                                    <select
                                                                                        class="form-select h-48 px-3 border-radius-8 fs-12"
                                                                                        data-bs-toggle="modal"
                                                                                        style="height:30px; appearance: none; background-image: url('');"
                                                                                        disabled
                                                                                        [(ngModel)]="purchaseOrder.vendorId">
                                                                                        <option [value]=" vendor.id"
                                                                                            *ngFor="let vendor of vendors;let i=index;">
                                                                                            {{vendor.name}}
                                                                                        </option>
                                                                                    </select>
                                                                                </td>

                                                                                <td title="Set Approval Status"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <select name="status"
                                                                                        class="form-select border-radius-4 border fs-12"
                                                                                        size="1" disabled
                                                                                        style="height:30px; appearance: none; background-image: url('');"
                                                                                        [(ngModel)]="purchaseOrder.status">
                                                                                        <option value="0" selected>Not
                                                                                            Submitted</option>
                                                                                        <option value="1"
                                                                                            style="color:green">For
                                                                                            Approval</option>
                                                                                        <option value="2"
                                                                                            style="color:red">Rejected
                                                                                        </option>
                                                                                        <option value="3"
                                                                                            style="color:blue">Approved
                                                                                        </option>
                                                                                    </select>
                                                                                </td>

                                                                                <td title="Set Status"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <select name="purchaseStatus"
                                                                                        class="form-select border-radius-4 border fs-12"
                                                                                        style="height:30px;" size="1"
                                                                                        (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                                                                        *ngIf="purchaseOrder.status == 3"
                                                                                        [(ngModel)]="purchaseOrder.purchaseStatus">
                                                                                        <option value="0" selected>No
                                                                                            Status</option>
                                                                                        <option value="1">Ordered
                                                                                        </option>
                                                                                        <option value="2">Received
                                                                                        </option>
                                                                                        <option value="3">Returned
                                                                                        </option>
                                                                                        <option value="4">Wrong Part
                                                                                        </option>
                                                                                    </select>
                                                                                </td>
                                                                                <td data-bs-toggle="modal"
                                                                                    class="text-center fs-12 v-align-middle"
                                                                                    title="Click to view details"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                    <select name="grade"
                                                                                        style="height:30px; appearance: none; background-image: url('');"
                                                                                        class="form-select h-48 border px-3 border-radius-8 fs-12"
                                                                                        size="1" disabled
                                                                                        [(ngModel)]="purchaseOrder.grade">
                                                                                        <option value="undefined"
                                                                                            disabled selected>Select
                                                                                            Grade</option>
                                                                                        <option value="A">A</option>
                                                                                        <option value="B">B</option>
                                                                                        <option value="C">C</option>
                                                                                        <option value="Used">Used
                                                                                        </option>
                                                                                        <option value="New">New</option>
                                                                                        <option value="Insurance">
                                                                                            Insurance</option>
                                                                                    </select>
                                                                                </td>


                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                    title="Click to view details"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                    ${{purchaseOrder.salePrice}}
                                                                                </td>
                                                                                <td class="text-center fs-12 v-align-middle"
                                                                                    title="Click to view details"
                                                                                    data-bs-toggle="modal"
                                                                                    data-bs-toggle="modal"
                                                                                    (click)="editPurchaseOrder(purchaseOrder, i)">
                                                                                    {{purchaseOrder.createdAt |
                                                                                    date: 'MM/dd/yyyy'}} </td>
                                                                                <td
                                                                                    class="p-2 text-center  v-align-middle fs-12">
                                                                                    <ng-container
                                                                                        *ngFor="let user of users;let i=index;">
                                                                                        <span
                                                                                            *ngIf="user.id == purchaseOrder.userId">
                                                                                            {{(user.firstName + " " +
                                                                                            user.lastName) |
                                                                                            shortName:2}}
                                                                                        </span>
                                                                                    </ng-container>


                                                                                </td>
                                                                                <td
                                                                                    class="text-center fs-12 v-align-middle">
                                                                                    <div class="d-flex gap-1">
                                                                                        <button
                                                                                            class="btn btn-outline-danger btn-sm"
                                                                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                                                                            *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                                                                            (click)="deletePurchaseOrderInline(purchaseOrder, i)">
                                                                                            <i class="fa fa-trash"></i>
                                                                                        </button>

                                                                                        <button
                                                                                            class="btn btn-outline-warning btn-sm"
                                                                                            *ngIf="purchaseOrder.status ==0"
                                                                                            title="Submit for Approval"
                                                                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                            <i
                                                                                                class="fa fa-arrow-right"></i>
                                                                                        </button>

                                                                                        <button
                                                                                            class="btn btn-outline-warning btn-sm"
                                                                                            *ngIf="purchaseOrder.status ==2"
                                                                                            title="Re-Submit for Approval"
                                                                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                            <i
                                                                                                class="fa fa-arrow-right"></i>
                                                                                        </button>

                                                                                        <button
                                                                                            class="btn btn-outline-danger btn-sm"
                                                                                            *ngIf="purchaseOrder.status ==1"
                                                                                            title="Reject It"
                                                                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                            <i class="fa fa-ban"></i>
                                                                                        </button>

                                                                                        <button
                                                                                            class="btn btn-outline-success btn-sm"
                                                                                            *ngIf="purchaseOrder.status ==1"
                                                                                            title="Approve It"
                                                                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                            <i
                                                                                                class="fa fa-check-square"></i>
                                                                                        </button>

                                                                                        <button
                                                                                            class="btn btn-outline-danger btn-sm"
                                                                                            *ngIf="purchaseOrder.status ==3"
                                                                                            title="Un-Approve It"
                                                                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                                                            <i
                                                                                                class="fa fa-arrow-left"></i>
                                                                                        </button>

                                                                                        <button
                                                                                            class="btn btn-warning btn-sm"
                                                                                            *ngIf="purchaseOrder.status == 3 && purchaseOrder.purchaseStatus ==1"
                                                                                            [disabled]="user.allowAddUpdateAutopart == false"
                                                                                            title="Add Parts"
                                                                                            data-bs-toggle="modal"
                                                                                            data-bs-target="#editPart"
                                                                                            (click)="addAutopartToPurchaseOrder( claim, purchaseOrder); showEditPartModal()"><i
                                                                                                class="fa fa-plus"></i></button>

                                                                                    </div>
                                                                                </td>
                                                                            </tr>

                                                                            <ng-container
                                                                                *ngIf="showEstimatesOnly == false && purchaseOrder.autoparts.length> 0 ">
                                                                                <tr>
                                                                                    <!-- <td></td> -->
                                                                                    <td
                                                                                        class="text-center fs-14 v-align-middle opacity-50">
                                                                                        <i
                                                                                            class="fa-solid fa-tools"></i>
                                                                                    </td>
                                                                                    <td colspan="11" cdkDropList
                                                                                        (cdkDropListDropped)="droppedAutoprtsPurchaseOrder($event, purchaseOrder)">


                                                                                        <table
                                                                                            class="table-bordered table-sm overflow-hidden shadow line-height-100 w-100">
                                                                                            <thead>
                                                                                                <tr
                                                                                                    class="fs-12 text-center bg-warning v-align-middle text-white mw-50">
                                                                                                    <th class="fs-12 text-center  mw-50"
                                                                                                        (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                                                                        title="Sort By Most Recent">
                                                                                                        #
                                                                                                    </th>
                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                                                                        title="Sort By Most Recent">
                                                                                                        Image</th>

                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)="sortListAutopartsPurchaseOrder('title', purchaseOrder)"
                                                                                                        title="Sort By Parts Name">
                                                                                                        Name </th>
                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)=" sortListAutopartsPurchaseOrder('partNumber', purchaseOrder)"
                                                                                                        title="Sort By Parts Number">
                                                                                                        Parts # </th>
                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)=" sortListAutopartsPurchaseOrder('description', purchaseOrder)"
                                                                                                        title="Sort By Description">
                                                                                                        Desc </th>


                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)="sortListAutopartsPurchaseOrder('purchaseStatus', purchaseOrder)"
                                                                                                        title="Sort By Status">
                                                                                                        Status </th>
                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)="sortListAutopartsPurchaseOrder('grade', purchaseOrder)"
                                                                                                        title="Sort By Grade">
                                                                                                        Grade
                                                                                                    </th>
                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)="sortListAutopartsPurchaseOrder('salePrice', purchaseOrder)"
                                                                                                        title="Sort By Price">
                                                                                                        Price</th>
                                                                                                    <th class="fs-12 text-center  mw-100"
                                                                                                        (click)="sortListAutopartsPurchaseOrder('createdAt', purchaseOrder)"
                                                                                                        title="Sort By Date">
                                                                                                        Created <i
                                                                                                            class="fa-solid fa-clock"></i>
                                                                                                    </th>
                                                                                                    <th
                                                                                                        class="fs-14 text-center mw-50">
                                                                                                        <i
                                                                                                            class="fa-solid fa-user"></i>
                                                                                                    </th>
                                                                                                    <th
                                                                                                        class="fs-12 text-center  mw-100">
                                                                                                        Action</th>
                                                                                                </tr>
                                                                                            </thead>
                                                                                            <ng-container
                                                                                                *ngFor="let autopart of purchaseOrder.autoparts; let i = index;  let even=even">
                                                                                                <tr id="{{vehicle.id}}"
                                                                                                    (click)="editAutopart(autopart, i)"
                                                                                                    title=""
                                                                                                    class="cursor-pointer"
                                                                                                    [style.background-color]="i == cindexAutpartPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        title="Drag and drop index number to change the order"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()"
                                                                                                        [cdkDragDisabled]="isMobile==true"
                                                                                                        cdkDrag>
                                                                                                        {{autopart.id}}
                                                                                                    </td>
                                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        (mouseover)="hover = vehicle"
                                                                                                        (mouseleave)="hover = null"
                                                                                                        title="Click to view details. Drag and drop index number to change the order"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                        <div
                                                                                                            class="overflow-hidden hover-img transition rounded-1 border">
                                                                                                            <img *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                                                                                src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                                                                                height="40"
                                                                                                                width="100"
                                                                                                                alt="Image"
                                                                                                                class="object-fill rounded-1 w-100" />
                                                                                                        </div>
                                                                                                    </td>
                                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        title="Click to view details. Drag and drop index number to change the order"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                        <p class="fs-12 text-black opacity-75"
                                                                                                            style="display: inline-block; word-break: break-word;">
                                                                                                            {{autopart.title}}
                                                                                                        </p>
                                                                                                    </td>
                                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        title="Click to view details. Drag and drop index number to change the order"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                        <p class="fs-12 text-black opacity-75"
                                                                                                            style="display: inline-block; word-break: break-word;">
                                                                                                            {{autopart.partNumber}}
                                                                                                        </p>
                                                                                                    </td>
                                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        title="Click to view details. Drag and drop index number to change the order"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                        <p class="fs-12 text-black opacity-75"
                                                                                                            style="  display: -webkit-box;
                                              -webkit-box-orient: vertical;
                                              -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                               overflow: hidden;"> {{autopart.description}}
                                                                                                            <ng-container
                                                                                                                *ngIf="autopart.purchaseStatus==1">
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Ordered
                                                                                                                    At:
                                                                                                                    {{
                                                                                                                    autopart.orderedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                            </ng-container>
                                                                                                            <ng-container
                                                                                                                *ngIf="autopart.purchaseStatus==2">
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Ordered
                                                                                                                    At:
                                                                                                                    {{
                                                                                                                    autopart.orderedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Received
                                                                                                                    At:{{
                                                                                                                    autopart.receivedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                            </ng-container>
                                                                                                            <ng-container
                                                                                                                *ngIf="autopart.purchaseStatus==3">
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Ordered
                                                                                                                    At:
                                                                                                                    {{
                                                                                                                    autopart.orderedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Received
                                                                                                                    At:{{
                                                                                                                    autopart.receivedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Returned
                                                                                                                    At:{{
                                                                                                                    autopart.returnedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                            </ng-container>
                                                                                                            <ng-container
                                                                                                                *ngIf="autopart.purchaseStatus==4">
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Ordered
                                                                                                                    At:
                                                                                                                    {{
                                                                                                                    autopart.orderedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Received
                                                                                                                    At:{{
                                                                                                                    autopart.receivedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                                <br>
                                                                                                                <span
                                                                                                                    class="text-danger">Returned
                                                                                                                    At:{{
                                                                                                                    autopart.returnedAt|
                                                                                                                    date:
                                                                                                                    'MM/dd/yyyy'}}</span>
                                                                                                            </ng-container>
                                                                                                        </p>
                                                                                                    </td>

                                                                                                    <td title="Set Status"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()"
                                                                                                        class="text-center fs-12 v-align-middle">
                                                                                                        <select
                                                                                                            name="purchaseStatus"
                                                                                                            class="form-select border-radius-4 border fs-12"
                                                                                                            size="1"
                                                                                                            (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                                                                            [(ngModel)]="autopart.purchaseStatus">
                                                                                                            <option
                                                                                                                value="0"
                                                                                                                selected>
                                                                                                                No
                                                                                                                Status
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="1">
                                                                                                                Ordered
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="2">
                                                                                                                Received
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="3">
                                                                                                                Returned
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="4">
                                                                                                                Wrong
                                                                                                                Part
                                                                                                            </option>
                                                                                                        </select>
                                                                                                    </td>
                                                                                                    <td data-bs-toggle="modal"
                                                                                                        class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        title="Click to view details"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                        <select
                                                                                                            name="grade"
                                                                                                            style=" appearance: none;
                                          background-image: url('');" class="form-select border px-3 border-radius-8 fs-12"
                                                                                                            size="1"
                                                                                                            disabled
                                                                                                            [(ngModel)]="autopart.grade">
                                                                                                            <option
                                                                                                                value="undefined"
                                                                                                                disabled
                                                                                                                selected>
                                                                                                                Select
                                                                                                                Grade
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="A">
                                                                                                                A
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="B">
                                                                                                                B
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="C">
                                                                                                                C
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="Used">
                                                                                                                Used
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="New">
                                                                                                                New
                                                                                                            </option>
                                                                                                            <option
                                                                                                                value="Insurance">
                                                                                                                Insurance
                                                                                                            </option>
                                                                                                        </select>
                                                                                                    </td>


                                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        title="Click to view details"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                        ${{autopart.salePrice}}
                                                                                                    </td>
                                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                                        data-bs-toggle="modal"
                                                                                                        data-bs-target="#partDetails"
                                                                                                        title="Click to view details"
                                                                                                        (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                                                                        {{autopart.createdAt
                                                                                                        |
                                                                                                        date:
                                                                                                        'MM/dd/yyyy'}}
                                                                                                    </td>
                                                                                                    <td
                                                                                                        class="p-2 text-center fs-12  v-align-middle">
                                                                                                        <ng-container
                                                                                                            *ngFor="let user of users;let i=index;">
                                                                                                            <span
                                                                                                                *ngIf="user.id == autopart.userId">
                                                                                                                {{(user.firstName
                                                                                                                + " " +
                                                                                                                user.lastName)
                                                                                                                |
                                                                                                                shortName:2}}
                                                                                                            </span>
                                                                                                        </ng-container>

                                                                                                    </td>
                                                                                                    <td
                                                                                                        class="text-center fs-12 v-align-middle">
                                                                                                        <div
                                                                                                            class="d-flex gap-2">
                                                                                                            <button
                                                                                                                class="btn btn-outline-danger btn-sm"
                                                                                                                (click)="editAutopart(autopart, i)"
                                                                                                                *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                                                                                (click)="deleteAutopartPurchaseOrder(autopart, i, purchaseOrder)">
                                                                                                                <i
                                                                                                                    class="fa fa-trash"></i>
                                                                                                            </button>
                                                                                                            <button
                                                                                                                class="btn btn-outline-warning btn-sm"
                                                                                                                (click)="editAutopart(autopart, i); showEditPartModal()"
                                                                                                                *ngIf="this.user.allowAddUpdateAutopart == true"><i
                                                                                                                    class="fa fa-edit"></i>
                                                                                                            </button>
                                                                                                        </div>
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </ng-container>
                                                                                        </table>



                                                                                    </td>
                                                                                </tr>
                                                                            </ng-container>

                                                                        </ng-container>
                                                                    </table>

                                                                </td>
                                                            </tr>
                                                        </ng-container>

                                                        <ng-container
                                                            *ngIf="showEstimatesOnly == false && claim.createJobOrder == true && claim.jobs.length> 0">
                                                            <tr>
                                                                <!-- <td></td> -->
                                                                <td class="text-center fs-14 v-align-middle opacity-50">
                                                                    <i class="fas fa-user"></i>
                                                                </td>
                                                                <td colspan="9">
                                                                    <ng-container>
                                                                        <table
                                                                            class="table-bordered table-sm overflow-hidden shadow  line-height-100 w-100"
                                                                            cdkDropList
                                                                            (cdkDropListDropped)="droppedJobsClaim($event, claim)">
                                                                            <thead>

                                                                                <tr>
                                                                                    <th class="fs-12 text-center bg-info text-white"
                                                                                        style="width:50px">JO #</th>
                                                                                    <th
                                                                                        class="fs-12 text-center bg-info text-white mw-100">
                                                                                        Job Order Name</th>
                                                                                    <th class="fs-12 text-center bg-info text-white"
                                                                                        style="min-width:150px">
                                                                                        Instruction
                                                                                    </th>
                                                                                    <th class="fs-12 text-center bg-info text-white mw-100"
                                                                                        style="width:100px">
                                                                                        Assigned
                                                                                        To</th>
                                                                                    <th class="fs-12 text-center bg-info text-white"
                                                                                        style="width:100px">$
                                                                                    </th>
                                                                                    <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                                                                    <th
                                                                                        class="fs-12 text-center bg-info text-white mw-100">
                                                                                        Target</th>
                                                                                    <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                                                                    <th class="fs-12 text-center bg-info text-white "
                                                                                        style="width:50px">Status
                                                                                    </th>
                                                                                    <th
                                                                                        class="fs-12 text-center bg-info text-white mw-50">
                                                                                        <i class="fa-solid fa-user"></i>
                                                                                    </th>
                                                                                    <th
                                                                                        class="fs-12 text-center bg-info text-white mw-100">
                                                                                        Action</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>

                                                                                <tr (click)="setJobId(job.id)"
                                                                                    *ngFor="let job of claim.jobs; let i=index">
                                                                                    <td class="text-center fs-12 v-align-middle"
                                                                                        [cdkDragDisabled]="isMobile==true"
                                                                                        cdkDrag>
                                                                                        {{job.id}}
                                                                                    </td>
                                                                                    <td
                                                                                        class="text-center fs-12 v-align-middle">
                                                                                        <input
                                                                                            placeholder="Enter Job Name"
                                                                                            [(ngModel)]="job.name"
                                                                                            maxlength="50"
                                                                                            (keyup.enter)="onEnter('job name',job)"
                                                                                            type="text"
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            class="form-control h-40 border-radius-4 border" />
                                                                                    </td>
                                                                                    <td
                                                                                        class="text-center fs-12 v-align-middle">
                                                                                        <textarea type="text" rows="1"
                                                                                            [(ngModel)]="job.notes"
                                                                                            class="form-control my-2"
                                                                                            maxlength="200"
                                                                                            (keyup.enter)="onEnter('job notes',job)"
                                                                                            title="Job Instruction"
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                                                                    </td>

                                                                                    <td
                                                                                        class="text-center fs-12 v-align-middle">
                                                                                        <select
                                                                                            class="form-select border-radius-4 h-40 border fs-12 "
                                                                                            [(ngModel)]="job.employeeId"
                                                                                            #device
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            style="height:30px;"
                                                                                            (change)="onChangeEmployee2Claim($event, device.value, job, job)">
                                                                                            <option value="0" disabled
                                                                                                selected>Select Employee
                                                                                            </option>
                                                                                            <option
                                                                                                [value]="employee.id"
                                                                                                [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                                                                                *ngFor="let employee of employees;let i=index;">
                                                                                                {{employee.firstName}}
                                                                                                {{employee.lastName}}
                                                                                                (
                                                                                                {{employee.roleName}},{{employee.rolePrecentage}}%
                                                                                                <ng-container
                                                                                                    *ngIf="employee.commissionBased == true">
                                                                                                    - <span
                                                                                                        class="fw-700 text-danger">Commission
                                                                                                        Based</span>
                                                                                                </ng-container>)
                                                                                                [{{
                                                                                                employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                                                                                +
                                                                                                employee.jobCountsFinished}}]
                                                                                            </option>
                                                                                        </select>
                                                                                    </td>
                                                                                    <td
                                                                                        class="text-center fs-12 v-align-middle">
                                                                                        <input
                                                                                            placeholder="Enter Job Value"
                                                                                            [(ngModel)]="job.price"
                                                                                            maxlength="50" class="fs-12"
                                                                                            (keyup.enter)="onEnter('job price',job)"
                                                                                            type="number"
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            class="form-control border h-40 border-radius-4" />
                                                                                    </td>

                                                                                    <td
                                                                                        class="text-center fs-12 v-align-middle">
                                                                                        <input
                                                                                            *ngIf="job.employeeId > 0"
                                                                                            (change)="onChangeCalendar($event, job)"
                                                                                            max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                                                                            [disabled]="job.paidWeek> 0"
                                                                                            [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                                                                                            title="Target Date"
                                                                                            type="date"
                                                                                            class="form-control border h-40 border-radius-4" />
                                                                                    </td>

                                                                                    <td
                                                                                        class="p-2 text-center v-align-middle">
                                                                                        <div
                                                                                            class="form-check text-center pt-2">
                                                                                            <input trimText
                                                                                                class="form-check-input mx-auto mt-0"
                                                                                                type="checkbox"
                                                                                                [disabled]="job.paidWeek> 0"
                                                                                                *ngIf="job.employeeId > 0 && job.targetDate != null"
                                                                                                [checked]="isJobChecked(job)"
                                                                                                (change)="updateJobStatus(job)" />
                                                                                        </div>
                                                                                    </td>
                                                                                    <td
                                                                                        class="p-2 text-center  v-align-middle fs-12">
                                                                                        <ng-container
                                                                                            *ngFor="let user of users;let i=index;">
                                                                                            <span
                                                                                                *ngIf="user.id == job.userId">
                                                                                                {{(user.firstName + " "
                                                                                                + user.lastName) |
                                                                                                shortName:2}}
                                                                                            </span>
                                                                                        </ng-container>


                                                                                    </td>
                                                                                    <td
                                                                                        class="text-center fs-12 v-align-middle">
                                                                                        <div
                                                                                            class="d-flex align-items-center justifyc-ntent-center gap-1">
                                                                                            <button
                                                                                                class="btn btn-outline-danger btn-sm"
                                                                                                title="Remove"
                                                                                                [disabled]="job.paidWeek> 0"
                                                                                                (click)="deleteVehicleJobClaim(null, job)"><i
                                                                                                    class="fa fa-trash"></i></button>
                                                                                            <button
                                                                                                class="btn btn-outline-primary btn-sm"
                                                                                                title="Save"
                                                                                                [disabled]="job.paidWeek> 0"
                                                                                                (click)="saveJobNotes(job)"><i
                                                                                                    class="fa fa-save"></i></button>
                                                                                            <button
                                                                                                class="btn btn-outline-dark btn-sm"
                                                                                                title="Print"
                                                                                                (click)="setJobId(job.id)"
                                                                                                (click)="printPageJob('print-content-job', 'jobs', job)">
                                                                                                <i
                                                                                                    class="fa fa-print"></i>
                                                                                            </button>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </ng-container>

                                                                </td>
                                                            </tr>


                                                        </ng-container>

                                                    </ng-container>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6 col-md-8">
                                    <div *ngIf="getSubtotalClaims() > 0">

                                    </div>
                                    <h3 class="fs-20 fw-700 my-4 pt-3" *ngIf="warrantyText != ''">Warranties</h3>
                                    <p [innerHtml]=" warrantyText" *ngIf="warrantyText != ''"
                                        class="wave fs-13 line-height-130">
                                    </p>
                                    <h3 class="fs-20 fw-700 my-4 pt-3">Terms &amp; Conditions</h3>
                                    <p [innerHtml]="disclaimerText" *ngIf="disclaimerText != ''"
                                        class="wave fs-13 line-height-130"></p>
                                </div>
                                <div class="col-lg-3 col-md-12"></div>
                                <div class="col-lg-3 col-md-4" *ngIf="getSubtotalClaims() > 0">
                                    <ul>
                                        <li class="d-flex justify-content-between my-4"><strong
                                                class="fs-15">Subtotal:</strong>
                                            <p class="fs-15 text-black opacity-75 px-1">${{getSubtotalClaims()}}</p>
                                        </li>
                                        <li class="d-flex justify-content-between my-4"><strong class="fs-15">Tax
                                                ({{company.taxRate
                                                *100}}%):</strong>
                                            <p class="fs-15 text-black opacity-75 px-1">${{getTaxClaim() }}</p>
                                        </li>
                                        <li
                                            class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                            <strong class="fs-15">Estimates:</strong>
                                            <p class="fs-15 px-1">${{getTotalClaims()}}</p>
                                        </li>
                                        <li *ngIf="filterClaims(1).length > 0"
                                            class="d-flex justify-content-between d-block bg-success  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                            <strong class="fs-15">Estimates(Locked):</strong>
                                            <p class="fs-15 px-1">${{getTotalClaimsLocked()}}</p>
                                        </li>
                                        <li
                                            class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                            <strong class="fs-15">Total Payments:</strong>
                                            <p class="fs-15 px-1">${{getTotalPayments()}}</p>
                                        </li>
                                        <li
                                            class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                            <strong class="fs-15">Balance:</strong>
                                            <p class="fs-15 px-1">${{getTotalBalance()}}</p>
                                        </li>
                                        <li *ngIf="filterClaims(1).length > 0"
                                            class="d-flex justify-content-between d-block bg-success  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                            <strong class="fs-15">Balance(Locked):</strong>
                                            <p class="fs-15 px-1">${{getTotalBalanceLocked()}}</p>
                                        </li>
                                    </ul>
                                </div>
                            </div>

                            <section id="payments_section">
                                <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">
                                    <strong class="heading-color fw-700 text-uppercase px-2 pt-4 fs-16"
                                        title="Click to view details"
                                        style="display: inline-block; word-break: break-word;">Payments for: <strong
                                            class="text-primary fw-700">{{vehicle.year}}
                                            {{vehicle.make}}
                                            {{vehicle.model}} {{vehicle.color}} ({{payments.length}}) <span
                                                class="text-danger" title="Total estimates">
                                                [${{getTotalClaims()}}]</span>
                                            - <span class="text-danger" title="Total payments">[${{getTotalPayments()}}]
                                            </span>
                                            = <span class="text-danger" title="Balance">[${{getTotalBalance()}}]</span>
                                        </strong>
                                    </strong>
                                    <div class="d-lg-flex align-items-center px-2 mt-2">

                                        <div class="dropdown" *ngIf="user.allowAddPayment == true">
                                            <button
                                                class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4 dropdown-toggle"
                                                type="button" data-bs-toggle="dropdown" aria-expanded="false">Add
                                                Payment <i class="fa fa-angle-down ms-2"></i></button>
                                            <ul class="dropdown-menu p-0 border-0 shadow">
                                                <ng-container *ngFor="let paymentType of paymentTypes; let i=index">
                                                    <li><a (click)="addVehiclePayment(paymentType)"
                                                            class="dropdown-item p-3 fs-12" href="javascript:;"><i
                                                                class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                                                            {{paymentType.name}}</a></li>
                                                </ng-container>
                                            </ul>
                                        </div>

                                    </div>
                                </div>

                                <div class="row mt-4">
                                    <div class="mt-4 pt-1">
                                        <div class="col-12 p-3 bg-white shadow border border-radius-8">

                                            <div class="table-responsive jobs-table bg-white border-radius-8 shadow"
                                                cdkDropList (cdkDropListDropped)="droppedPayment($event)">
                                                <table class="table table-bordered">
                                                    <thead>
                                                        <tr class="v-align-middle">

                                                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                                                style="width: 50px;">#
                                                            </th>
                                                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                                style="width: 200px;">
                                                                Description
                                                            </th>
                                                            <th
                                                                class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100">
                                                                <i class="fa-solid fa-dollar-sign"></i>
                                                            </th>

                                                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                                                                style="width: 100px;">
                                                                Processed At
                                                            </th>
                                                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                                                                title="Click to go to Configuration"
                                                                [routerLink]="'/payment-method'"
                                                                style="cursor:pointer; width: 150px;">Paid With</th>
                                                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                                                                title="Click to go to Configuration"
                                                                [routerLink]="'/payment-status'"
                                                                style="cursor:pointer; width: 150px;">Pay Status</th>
                                                            <th
                                                                class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                                <i class="fa-solid fa-clock"></i>
                                                            </th>
                                                            <th
                                                                class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                                <i class="fa-solid fa-user"></i>
                                                            </th>
                                                            <th
                                                                class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                                Verified By
                                                            </th>
                                                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                                                                style="width: 100px;">
                                                                Verified At
                                                            </th>
                                                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                                style="width:100px;">
                                                                Action
                                                            </th>
                                                        </tr>


                                                    </thead>
                                                    <tbody>
                                                        <tr class="alert-info"
                                                            *ngFor="let payment of payments; let i=index"
                                                            title="Created at {{payment.createdAt| date: 'MM/dd/yyyy'}}"
                                                            (click)="setPaymentPaymentId(payment.id)"
                                                            [style.background-color]="payment.id == currentPaymentPaymentId? '#FFF3CD' : (true ? '#CFF4FC' : '#CFF4FC')">

                                                            <td class="fs-13 p-2 text-center v-align-middle"
                                                                title="Drag and drop index number to change the order"
                                                                [cdkDragDisabled]="isMobile==true" cdkDrag>{{i+1}}</td>

                                                            <td class="fs-13 p-2"><textarea [(ngModel)]="payment.name"
                                                                    class="form-control"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    placeholder="Please Specify"
                                                                    (keyup.enter)="onEnterPayment('Payment name',payment)"
                                                                    rows="1"
                                                                    oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                                                    maxlength="200"
                                                                    [disabled]="user.allowAddReceipt == false"></textarea>
                                                            </td>

                                                            <td class="fs-13 p-2"><input
                                                                    (keyup.enter)="onEnterPayment('Payment amount',payment)"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    [(ngModel)]="payment.amount"
                                                                    onKeyPress="if(this.value.length==10) return false"
                                                                    pattern="[0-9]" type="number"
                                                                    class="form-control form-control-sm h-40 border-radius-4" />
                                                            </td>

                                                            <td class="fs-13 p-2"><input trimText
                                                                    class="form-control h-48 px-3 border-radius-8"
                                                                    type="date"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    placeholder="Enter Processing Date"
                                                                    (change)="onChangeVehiclePaymentCalendar($event, payment)"
                                                                    [ngModel]="payment.date |  date:'yyyy-MM-dd'" />
                                                            </td>

                                                            <td class="fs-13 p-2">
                                                                <select class="form-select h-48 px-3 border-radius-8"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    (change)="onChangeVehiclePaymentMethod2($event, payment)"
                                                                    [(ngModel)]="payment.paymentMethodId">
                                                                    <option value="0" disabled selected>Select Payment
                                                                        Method</option>
                                                                    <option [value]="paymentMethod.id"
                                                                        *ngFor="let paymentMethod of paymentMethods;let i=index;">
                                                                        {{paymentMethod.name}}</option>
                                                                </select>
                                                            </td>
                                                            <td class="fs-13 p-2">
                                                                <select class="form-select h-48 px-3 border-radius-8"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    (change)="onChangeVehiclePaymentStatus($event, payment)"
                                                                    [(ngModel)]="payment.paymentStatusId">
                                                                    <option value="0" disabled selected>Select Payment
                                                                        Status</option>
                                                                    <option [value]="paymentStatus.id"
                                                                        *ngFor="let paymentStatus of paymentStatuss;let i=index;">
                                                                        {{paymentStatus.name}}</option>
                                                                </select>
                                                            </td>
                                                            <td class="fs-13 p-2  text-center v-align-middle">
                                                                {{payment.createdAt | date:
                                                                'MM/dd/yyyy'}}
                                                            </td>
                                                            <td class="fs-13 p-2 text-center v-align-middle">
                                                                <ng-container *ngFor="let user of users;let i=index;">
                                                                    <span *ngIf="user.id == payment.userId">
                                                                        {{(user.firstName + " " + user.lastName) |
                                                                        shortName:2}}
                                                                    </span>
                                                                </ng-container>
                                                                <!-- <select class="form-select h-48 px-3 border-radius-8" disabled
                                style=" appearance: none; background-image: url('');" [(ngModel)]="payment.userId">
                                <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                                  {{user.lastName}}</option>
                              </select> -->
                                                            </td>
                                                            <td class="fs-13 p-2 text-center v-align-middle">
                                                                <ng-container *ngFor="let user of users;let i=index;">
                                                                    <span *ngIf="user.id == payment.userIdVerified">
                                                                        {{(user.firstName + " " + user.lastName) |
                                                                        shortName:2}}
                                                                    </span>
                                                                </ng-container>
                                                                <!-- <select class="form-select h-48 px-3 border-radius-8" disabled
                                style=" appearance: none; background-image: url('');"
                                [(ngModel)]="payment.userIdVerified">
                                <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                                  {{user.lastName}}</option>
                              </select> -->
                                                            </td>
                                                            <td class="fs-13 p-2">

                                                                <ng-container *ngIf="user.allowVerifyPayment == true ">
                                                                    <input trimText
                                                                        class="form-control h-48 px-3 border-radius-8"
                                                                        type="date" placeholder="Enter Verified Date"
                                                                        (change)="onChangeVehiclePaymentCalendarVerified($event, payment)"
                                                                        [ngModel]="payment.dateVerified |  date:'yyyy-MM-dd'" />
                                                                </ng-container>
                                                                <ng-container *ngIf="user.allowVerifyPayment == false">
                                                                    {{payment.dateVerified | date:
                                                                    'MM/dd/yyyy' }}
                                                                </ng-container>

                                                            </td>

                                                            <td class="p-2 text-center v-align-middle">
                                                                <div
                                                                    class="d-flex align-items-center justifyc-cntent-center gap-2">
                                                                    <button class="btn btn-outline-danger btn-sm"
                                                                        [disabled]="user.allowAddPayment == false"
                                                                        title="Delete"
                                                                        (click)="deleteVehiclePayment(null, payment)"><i
                                                                            class="fa fa-trash"></i></button>
                                                                    <button class="btn btn-outline-success btn-sm"
                                                                        [disabled]="user.allowAddPayment == false"
                                                                        title="Save" (click)="savePayment(payment)"><i
                                                                            class="fa fa-save"></i></button>
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </section>

                            <br />
                            <br />
                        </div>
                    </div>

                    <!-- Purchase Orders Tab -->
                    <div class="tab-pane" id="purchase-orders" role="tabpanel" aria-labelledby="purchase-orders-tab">
                        <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">
                            <h2
                                class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">
                                Vehicle
                                Purchase Orders for: <strong class="fw-700 text-primary" data-bs-toggle="modal"
                                    style="cursor: pointer;" data-bs-target="#editVehicle"
                                    title="Click to view details">{{vehicle.year}}
                                    {{vehicle.make}} {{vehicle.model}}
                                    {{vehicle.color}} ({{purchaseOrders.length}})</strong>
                                <div class="dropdown">
                                    <button
                                        class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold"
                                        type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                        aria-expanded="false">
                                        <span title="Total Purchase Orders">${{getTotalPurchaseOrders()}}</span>
                                        <span>-</span>
                                        <span title="Total Parts Costs">${{getTotalPartCosts(vehicle.id)}}</span>
                                        <span>-</span>
                                        <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                                        <i class="fa fa-angle-down ms-2"></i>
                                    </button>
                                    <div class="dropdown-menu bg-light" style="min-width: 400px"
                                        aria-labelledby="dropdownMenuButton">
                                        <div class="row">
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">Items</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">Estimates</a>
                                                <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                                                <a class="dropdown-item fw-700">Est. - Parts</a>
                                                <a class="dropdown-item"></a>

                                                <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                                                <a class="dropdown-item">Management</a>

                                                <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700">Total Costs</a>
                                                <a class="dropdown-item fw-700">Gross</a>


                                            </div>
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">#</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}}
                                                    (${{vehicle.price}} +
                                                    ${{getTotalSupplements(vehicle)}})</a>
                                                <a
                                                    class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                                                    (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                                                <a class="dropdown-item"></a>


                                                <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                                                <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                                                    ({{this.company.managementRate * 100}}% of
                                                    ${{getVehicleRemaining(vehicle)}})</a>

                                                <a class="dropdown-item">${{getSaleTax(vehicle)}}
                                                    ({{this.company.taxRate * 100}}% of
                                                    {{getVehicleTotalEstimates(vehicle)}})</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle,
                                                    jobs)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </h2>
                            <div class="d-lg-flex align-items-center px-2 mt-2"
                                *ngIf="user.allowAddUpdatePurchaseOrder == true">
                                <button class="btn btn-success fs-13 px-3 py-2 mt-15-mob" title="Add Parts"
                                    *ngIf="this.vehicle.id> 0" (click)="addNewPurchaseOrder($event)"><i
                                        class="fa fa-plus me-2"></i> Add Purchase
                                    Order </button>
                            </div>
                        </div>
                        <div class="row" cdkDropList (cdkDropListDropped)="droppedPurchaseOrders($event)">
                            <div class="col-12 mt-4 pt-1 p-3 border border-radius-8 bg-white shadow">
                                <div class="table-container shadow border-radius-8 bg-white border">
                                    <table class="table table-bordered">
                                        <thead>
                                            <tr class="bg-navy text-white v-align-middle ">
                                                <th class="fs-14 text-center mw-50" style="max-width:80px"
                                                    (click)="sortListPurchseOrders('id')" title="Sort By Most Recent">
                                                    #
                                                </th>
                                                <th class="fs-14 text-center mw-50" style="max-width:80px"
                                                    (click)="sortListPurchseOrders('claimId')"
                                                    title="Sort By Estimate Id">
                                                    EID
                                                </th>

                                                <th class="fs-14 text-center mw-150"
                                                    (click)="sortListPurchseOrders('title')" title="Sort By Parts Name">
                                                    Item Name </th>
                                                <th class="fs-14 text-center mw-100"
                                                    (click)="sortListPurchseOrders('partNumber')"
                                                    title="Sort By Parts Number"> Parts # </th>
                                                <th class="fs-14 text-center mw-150"
                                                    (click)="sortListPurchseOrders('description')"
                                                    title="Sort By Description"> Description </th>

                                                <th class="fs-14 text-center mw-150"
                                                    (click)="sortListPurchseOrders('vendorId')"
                                                    title="Sort By Most Recent">Vender</th>

                                                <th class="fs-14 text-center mw-150"
                                                    (click)="sortListPurchseOrders('status')" title="Sort By Status">
                                                    Approval Status</th>

                                                <th class="fs-14 text-center mw-200" style="width:200px"
                                                    (click)="sortListPurchseOrders('purchaseStatus')"
                                                    title="Sort By Status">Order Status & History</th>

                                                <th class="fs-14 text-center mw-100" style="width:100px"
                                                    (click)="sortListPurchseOrders('grade')" title="Sort By Grade">
                                                    Grade
                                                </th>
                                                <th class="fs-14 text-center mw-100" style="width:100px"
                                                    (click)="sortListPurchseOrders('salePrice')" title="Sort By Price">
                                                    <i class="fa-solid fa-dollar-sign"></i>
                                                </th>
                                                <th class="fs-14 text-center mw-100"
                                                    (click)="sortListPurchseOrders('createdAt')" title="Sort By Date"><i
                                                        class="fa-solid fa-clock"></i></th>
                                                <th class="fs-14 text-center mw-50"><i class="fa-solid fa-user"></i>
                                                </th>

                                                <th class="fs-14 text-center mw-100">Action</th>
                                            </tr>
                                        </thead>
                                        <ng-container
                                            *ngFor="let purchaseOrder of purchaseOrders; let i = index;  let even=even">
                                            <tr id="{{vehicle.id}}" (click)="editPurchaseOrder(purchaseOrder, i)"
                                                title="" style="cursor: pointer;" class="v-align-middle"
                                                [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                <td class="text-center fs-13"
                                                    title="Drag and drop index number to change the order"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)"
                                                    [cdkDragDisabled]="isMobile==true" cdkDrag>
                                                    {{purchaseOrder.id}}
                                                </td>
                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)">
                                                    <p class="fs-12 text-danger fw-700"
                                                        *ngIf="purchaseOrder.claimId > 0">
                                                        {{purchaseOrder.claimId}}</p>
                                                </td>


                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)">
                                                    <!-- <p class="fs-12 text-black opacity-75"
                                                        style="display: inline-block; word-break: break-word;">
                                                        {{purchaseOrder.title}}</p> -->
                                                    <input placeholder="Enter Name" [(ngModel)]="purchaseOrder.title"
                                                        type="text" class="form-control h-40 border-radius-4 border" />
                                                </td>
                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)">
                                                    <!-- <p class="fs-12 text-black opacity-75"
                                                        style="display: inline-block; word-break: break-word;">
                                                        {{purchaseOrder.partNumber}}</p> -->
                                                    <input placeholder="Enter Part Number"
                                                        [(ngModel)]="purchaseOrder.partNumber" type="text"
                                                        class="form-control h-40 border-radius-4 border" />
                                                </td>


                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)">
                                                    <input placeholder="Enter Description"
                                                        [(ngModel)]="purchaseOrder.description" type="text"
                                                        class="form-control h-40 border-radius-4 border" />
                                                </td>

                                                <td class="p-2 text-center  v-align-middle">

                                                    <select class="form-select h-48 px-3 border-radius-8 "
                                                        [(ngModel)]="purchaseOrder.vendorId">
                                                        <option [value]=" vendor.id"
                                                            *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}
                                                        </option>
                                                    </select>
                                                </td>

                                                <td title="Set Approval Status"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)"
                                                    class="text-center fs-13">
                                                    <select name="status" class="form-select border-radius-4 border"
                                                        size="1" [(ngModel)]="purchaseOrder.status">
                                                        <option value="0" selected>Not Submitted</option>
                                                        <option value="1" style="color:green">For Approval</option>
                                                        <option value="2" style="color:red">Rejected</option>
                                                        <option value="3" style="color:blue">Approved</option>
                                                    </select>
                                                </td>

                                                <td title="Set Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                                    class="text-center fs-13">
                                                    <select name="purchaseStatus"
                                                        class="form-select border-radius-4 border" size="1"
                                                        (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                                        *ngIf="purchaseOrder.status == 3"
                                                        [(ngModel)]="purchaseOrder.purchaseStatus">
                                                        <option value="0" selected>No Status</option>
                                                        <option value="1">Ordered
                                                            <ng-container
                                                                *ngIf="purchaseOrder.purchaseStatus==1 || purchaseOrder.purchaseStatus==2 || 
                                                            purchaseOrder.purchaseStatus ==3 || purchaseOrder.purchaseStatus ==4">
                                                                <span class=" text-danger"> At: {{
                                                                    purchaseOrder.orderedAt| date:
                                                                    'MM/dd/yyyy'}}</span>
                                                            </ng-container>

                                                        </option>
                                                        <option value="2">Received
                                                            <ng-container
                                                                *ngIf="purchaseOrder.purchaseStatus==1 || purchaseOrder.purchaseStatus==2 || 
                                                            purchaseOrder.purchaseStatus ==3 || purchaseOrder.purchaseStatus ==4">
                                                                <span class=" text-danger"> At:{{
                                                                    purchaseOrder.receivedAt| date:
                                                                    'MM/dd/yyyy'}}</span>

                                                            </ng-container>


                                                        </option>

                                                        <option value="3">Returned
                                                            <ng-container
                                                                *ngIf="purchaseOrder.purchaseStatus==1 || purchaseOrder.purchaseStatus==2 || 
                                                            purchaseOrder.purchaseStatus ==3 || purchaseOrder.purchaseStatus ==4">
                                                                <span class="text-danger"> At:{{
                                                                    purchaseOrder.returnedAt| date:
                                                                    'MM/dd/yyyy'}}</span>
                                                            </ng-container>

                                                        </option>
                                                        <option value="4">Wrong Part
                                                            <ng-container *ngIf="purchaseOrder.purchaseStatus ==4">
                                                                <span class="text-danger"> At:{{
                                                                    purchaseOrder.updatedAt| date:
                                                                    'MM/dd/yyyy'}}</span>
                                                            </ng-container>


                                                        </option>
                                                    </select>
                                                </td>

                                                <!-- <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)">
                                                    <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                        -webkit-box-orient: vertical;
                        -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                         overflow: hidden;">
                                                        <ng-container *ngIf="purchaseOrder.purchaseStatus==1"> <br>
                                                            <span class="text-danger">Ordered At: {{
                                                                purchaseOrder.orderedAt| date:
                                                                'MM/dd/yyyy'}}</span>
                                                        </ng-container>
                                                        <ng-container *ngIf="purchaseOrder.purchaseStatus==2"> <br>
                                                            <span class="text-danger">Ordered At: {{
                                                                purchaseOrder.orderedAt| date:
                                                                'MM/dd/yyyy'}}</span> <br>
                                                            <span class="text-danger">Received At:{{
                                                                purchaseOrder.receivedAt| date:
                                                                'MM/dd/yyyy'}}</span>
                                                        </ng-container>
                                                        <ng-container *ngIf="purchaseOrder.purchaseStatus==3"> <br>
                                                            <span class="text-danger">Ordered At: {{
                                                                purchaseOrder.orderedAt| date:
                                                                'MM/dd/yyyy'}}</span> <br>
                                                            <span class="text-danger">Received At:{{
                                                                purchaseOrder.receivedAt| date:
                                                                'MM/dd/yyyy'}}</span> <br>
                                                            <span class="text-danger">Returned At:{{
                                                                purchaseOrder.returnedAt| date:
                                                                'MM/dd/yyyy'}}</span>
                                                        </ng-container>
                                                    </p>
                                                </td> -->
                                                <td class="text-center fs-13" title="Click to view details"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)"><select name="grade"
                                                        class="form-select h-48 border px-3 border-radius-8" size="1"
                                                        [(ngModel)]="purchaseOrder.grade">
                                                        <option value="undefined" selected>Select Grade
                                                        </option>
                                                        <option value="A">A</option>
                                                        <option value="B">B</option>
                                                        <option value="C">C</option>
                                                        <option value="Used">Used</option>
                                                        <option value="New">New</option>
                                                        <option value="Insurance">Insurance</option>
                                                    </select></td>


                                                <td class="text-center fs-13" title="Click to view details"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)">
                                                    <input placeholder="Enter Sale Price"
                                                        [(ngModel)]="purchaseOrder.salePrice" maxlength="50" type="text"
                                                        class="form-control h-40 border-radius-4 border" />

                                                </td>
                                                <td class="text-center fs-13" title="Click to view details"
                                                    (click)=" editPurchaseOrder(purchaseOrder, i)">
                                                    {{purchaseOrder.createdAt |
                                                    date: 'MM/dd/yyyy'}} </td>
                                                <td class="p-2 text-center v-align-middle ">

                                                    <ng-container *ngFor="let user of users;let i=index;">
                                                        <span *ngIf="user.id == purchaseOrder.userId">
                                                            {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                        </span>
                                                    </ng-container>

                                                    <!-- <select class="form-select h-48 px-3 border-radius-8 "
                            style=" appearance: none; background-image: url('');" disabled
                            [(ngModel)]="purchaseOrder.userId">
                            <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                              {{user.lastName}}</option>
                          </select> -->
                                                </td>
                                                <td class="text-center fs-13">
                                                    <div class="d-flex gap-2">
                                                        <button class="btn btn-outline-danger btn-sm"
                                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                                            *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                                            (click)="deletePurchaseOrder(purchaseOrder, i)">
                                                            <i class="fa fa-trash"></i>
                                                        </button>

                                                        <button class="btn btn-outline-danger btn-sm"
                                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                                            *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                                            (click)="savePurchaseOrder()">
                                                            <i class="fa fa-save"></i>
                                                        </button>

                                                        <button class="btn btn-outline-warning btn-sm"
                                                            *ngIf="purchaseOrder.status ==0" title="Submit for Approval"
                                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                            <i class="fa fa-arrow-right"></i>
                                                        </button>

                                                        <button class="btn btn-outline-warning btn-sm"
                                                            *ngIf="purchaseOrder.status ==2"
                                                            title="Re-Submit for Approval"
                                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                            <i class="fa fa-arrow-right"></i>
                                                        </button>

                                                        <button class="btn btn-outline-danger btn-sm"
                                                            *ngIf="purchaseOrder.status ==1" title="Reject It"
                                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                            <i class="fa fa-ban"></i>
                                                        </button>

                                                        <button class="btn btn-outline-success btn-sm"
                                                            *ngIf="purchaseOrder.status ==1" title="Approve It"
                                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                            <i class="fa fa-check-square"></i>
                                                        </button>

                                                        <button class="btn btn-outline-danger btn-sm"
                                                            *ngIf="purchaseOrder.status ==3" title="Un-Approve It"
                                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                                            <i class="fa fa-arrow-left"></i>
                                                        </button>

                                                    </div>
                                                </td>
                                            </tr>
                                        </ng-container>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Parts Tab -->
                    <div class="tab-pane" id="parts" role="tabpanel" aria-labelledby="parts-tab">
                        <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">
                            <h2
                                class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">
                                Vehicle
                                Parts for: <strong class="fw-700 text-primary" data-bs-toggle="modal"
                                    data-bs-target="#editVehicle" style="cursor: pointer;"
                                    title="Click to view details">{{vehicle.year}}
                                    {{vehicle.make}} {{vehicle.model}}
                                    {{vehicle.color}} ({{autopartsSearch.length}})</strong>
                                <div class="dropdown">
                                    <button
                                        class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold"
                                        type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                        aria-expanded="false">
                                        <span title="Total Parts Costs">${{getTotalPartCosts(vehicle.id)}}</span>
                                        <span>-</span>
                                        <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                                        <i class="fa fa-angle-down ms-2"></i>
                                    </button>
                                    <div class="dropdown-menu bg-light" style="min-width: 400px"
                                        aria-labelledby="dropdownMenuButton">
                                        <div class="row">
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">Items</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">Estimates</a>
                                                <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                                                <a class="dropdown-item fw-700">Est. - Parts</a>
                                                <a class="dropdown-item"></a>

                                                <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                                                <a class="dropdown-item">Management</a>
                                                <!-- <a class="dropdown-item">Sales Commission</a> -->
                                                <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700">Total Costs</a>
                                                <a class="dropdown-item fw-700">Gross</a>


                                            </div>
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">#</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}}
                                                    (${{vehicle.price}} +
                                                    ${{getTotalSupplements(vehicle)}})</a>
                                                <a
                                                    class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                                                    (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                                                <a class="dropdown-item"></a>


                                                <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                                                <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                                                    ({{this.company.managementRate * 100}}% of
                                                    ${{getVehicleRemaining(vehicle)}})</a>

                                                <a class="dropdown-item">${{getSaleTax(vehicle)}}
                                                    ({{this.company.taxRate * 100}}% of
                                                    {{getVehicleTotalEstimates(vehicle)}})</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle,
                                                    jobs)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </h2>
                            <div class="d-lg-flex align-items-center px-2 mt-2"
                                *ngIf="user.allowAddUpdateAutopart == true">
                                <button class="btn btn-success fs-13 px-3 py-2 mt-15-mob" title="Add Parts"
                                    *ngIf="this.vehicle.id> 0" (click)="addNewParts(); showAddNewPartModal()"><i
                                        class="fa fa-plus me-2"></i> Add Parts </button>
                            </div>
                        </div>
                        <div class="row" cdkDropList (cdkDropListDropped)="droppedAutoprts($event)">
                            <div class="mt-4 p-3 border bg-white border-radius-8 shadow">


                                <div
                                    class="table-container shadow border-radius-8 bg-white border w-100 d-box ss-table">
                                    <table class="table-bordered overflow-hidden border-radius-8 w-100">
                                        <thead>
                                            <tr class="bg-warning text-white v-align-middle">
                                                <th class="fs-14 text-center text-white mw-50"
                                                    (click)="sortListAutoparts('id')" title="Sort By Most Recent">
                                                    #
                                                </th>
                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('claimId')" title="Sort By Estimate Id">
                                                    EID-POID
                                                </th>
                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('id')" title="Sort By Most Recent">Image
                                                </th>

                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('title')" title="Sort By Parts Name">
                                                    Parts Name </th>
                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('partNumber')"
                                                    title="Sort By Parts Number"> Parts # </th>
                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('description')"
                                                    title="Sort By Description"> Description </th>

                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('vendorId')" title="Sort By Status">
                                                    Vendor </th>
                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('purchaseStatus')"
                                                    title="Sort By Status"> Status </th>
                                                <th class="fs-14 text-center text-white mw-80"
                                                    (click)="sortListAutoparts('grade')" title="Sort By Grade">
                                                    Grade
                                                </th>
                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('salePrice')" title="Sort By Price">
                                                    Price</th>
                                                <th class="fs-14 text-center text-white mw-100"
                                                    (click)="sortListAutoparts('createdAt')" title="Sort By Date"> <i
                                                        class="fa-solid fa-clock"></i></th>
                                                <th class="fs-14 text-center text-white mw-50"><i
                                                        class="fa-solid fa-user"></i></th>

                                                <th class="fs-14 text-center text-white mw-100">Action</th>
                                            </tr>
                                        </thead>
                                        <ng-container
                                            *ngFor="let autopart of autopartsSearch; let i = index;  let even=even">
                                            <tr id="{{vehicle.id}}" (click)="editAutopart(autopart, i)" title=""
                                                class="cursor-pointer"
                                                [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')">
                                                <td class="text-center fs-13"
                                                    title="Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()"
                                                    [cdkDragDisabled]="isMobile==true" cdkDrag> {{autopart.id}}
                                                </td>
                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                    <div class="fs-12 text-danger fw-700"
                                                        *ngIf="autopart.claimId > 0 && autopart.purchaseOrderId > 0">
                                                        <span title="Estimate Id">{{autopart.claimId}}</span>-<span
                                                            title="Purchase Order Id">{{autopart.purchaseOrderId}}</span>
                                                    </div>
                                                </td>
                                                <td class="text-center fs-13" (mouseover)="hover = vehicle"
                                                    (mouseleave)="hover = null"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                    <div class="overflow-hidden hover-img transition rounded-1 border">
                                                        <img *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                            src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                            height="40" width="100" alt="Image"
                                                            class="object-fill rounded-1 w-100" />
                                                    </div>
                                                </td>

                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                    <p class="fs-12 text-black opacity-75"
                                                        style="display: inline-block; word-break: break-word;">
                                                        {{autopart.title}}</p>
                                                </td>
                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                    <p class="fs-12 text-black opacity-75"
                                                        style="display: inline-block; word-break: break-word;">
                                                        {{autopart.partNumber}}</p>
                                                </td>
                                                <td class="text-center fs-13"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                    <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                          -webkit-box-orient: vertical;
                          -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                           overflow: hidden;"> {{autopart.description}}
                                                        <ng-container *ngIf="autopart.purchaseStatus==1"> <br>
                                                            <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                                date: 'MM/dd/yyyy'}}</span>
                                                        </ng-container>
                                                        <ng-container *ngIf="autopart.purchaseStatus==2"> <br>
                                                            <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                                date: 'MM/dd/yyyy'}}</span>
                                                            <br>
                                                            <span class="text-danger">Received At:{{
                                                                autopart.receivedAt| date:
                                                                'MM/dd/yyyy'}}</span>
                                                        </ng-container>
                                                        <ng-container *ngIf="autopart.purchaseStatus==3"> <br>
                                                            <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                                date: 'MM/dd/yyyy'}}</span>
                                                            <br>
                                                            <span class="text-danger">Received At:{{
                                                                autopart.receivedAt| date:
                                                                'MM/dd/yyyy'}}</span>
                                                            <br>
                                                            <span class="text-danger">Returned At:{{
                                                                autopart.returnedAt| date:
                                                                'MM/dd/yyyy'}}</span>
                                                        </ng-container>
                                                    </p>
                                                </td>
                                                <td title="Set Status" (click)=" editAutopart(autopart, i)"
                                                    class="text-center fs-13">
                                                    <select class="orm-select border-radius-4 border" name="vendor"
                                                        (change)="onChangeAutopartVentor($event, autopart)"
                                                        [(ngModel)]="autopart.vendorId"
                                                        [disabled]="user.allowAddUpdateAutopart == false"
                                                        #vendor="ngModel">
                                                        <option value="undefined" disabled selected>Select Vendor
                                                        </option>
                                                        <option [value]="vendor.id"
                                                            *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}
                                                        </option>
                                                    </select>
                                                </td>


                                                <td title="Set Status" (click)=" editAutopart(autopart, i)"
                                                    class="text-center fs-13"><select name="purchaseStatus"
                                                        class="form-select border-radius-4 border" size="1"
                                                        (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                        [(ngModel)]="autopart.purchaseStatus">
                                                        <option value="0" selected>No Status</option>
                                                        <option value="1">Ordered</option>
                                                        <option value="2">Received</option>
                                                        <option value="3">Returned</option>
                                                        <option value="4">Wrong Part</option>
                                                    </select></td>
                                                <td class="text-center fs-13" title="Click to view details"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()"><select
                                                        name="grade" style=" appearance: none;
                      background-image: url('');" class="form-select h-48 border px-3 border-radius-8" size="1"
                                                        disabled [(ngModel)]="autopart.grade">
                                                        <option value="undefined" disabled selected>Select Grade
                                                        </option>
                                                        <option value="A">A</option>
                                                        <option value="B">B</option>
                                                        <option value="C">C</option>
                                                        <option value="Used">Used</option>
                                                        <option value="New">New</option>
                                                        <option value="Insurance">Insurance</option>
                                                    </select></td>


                                                <td class="text-center fs-13" title="Click to view details"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                    ${{autopart.salePrice}}
                                                </td>
                                                <td class="text-center fs-13" title="Click to view details"
                                                    (click)=" editAutopart(autopart, i); showPartDetailsModal()">
                                                    {{autopart.createdAt |
                                                    date: 'MM/dd/yyyy'}} </td>
                                                <td class="p-2 text-center  v-align-middle">

                                                    <ng-container *ngIf="autopart.employeeId> 0">
                                                        <ng-container *ngFor="let employee of employees;let i=index;">
                                                            <span *ngIf="employee.id == autopart.employeeId"
                                                                class="text-danger"
                                                                title="created by employee [{{employee.firstName +  ' ' + employee.lastName}}]">
                                                                {{(employee.firstName + " " + employee.lastName) |
                                                                shortName:2}}
                                                            </span>
                                                        </ng-container>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.employeeId == 0">
                                                        <ng-container *ngFor="let user of users;let i=index;">
                                                            <span *ngIf="user.id == autopart.userId"
                                                                title="created by [{{user.firstName +  ' ' + user.lastName}}]">
                                                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                            </span>
                                                        </ng-container>
                                                    </ng-container>
                                                    <!-- <select class="form-select h-48 px-3 border-radius-8 "
                            style=" appearance: none; background-image: url('');" disabled
                            [(ngModel)]="autopart.userId">
                            <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                              {{user.lastName}}</option>
                          </select> -->
                                                </td>
                                                <td class="text-center fs-13">
                                                    <div class="d-flex gap-2">
                                                        <button class="btn btn-outline-danger btn-sm"
                                                            (click)="editAutopart(autopart, i)"
                                                            *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                            (click)="deleteAutopart(autopart, i)">
                                                            <i class="fa fa-trash"></i>
                                                        </button>
                                                        <button class="btn btn-outline-warning btn-sm"
                                                            (click)="editAutopart(autopart, i); showEditPartModal()"
                                                            *ngIf="this.user.allowAddUpdateAutopart == true"><i
                                                                class="fa fa-edit"></i> </button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </ng-container>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>


                    <!-- Job Tab -->
                    <div class="tab-pane" id="jobs" role="tabpanel" aria-labelledby="payments-tab">
                        <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4 d-block-mobile">
                            <h2
                                class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">
                                Vehicle
                                Jobs for: <strong class="text-primary fw-700" data-bs-toggle="modal"
                                    data-bs-target="#editVehicle" style="cursor: pointer;"
                                    title="Click to view details">{{vehicle.year}} {{vehicle.make}}
                                    {{vehicle.model}}
                                    {{vehicle.color}} ({{jobs.length}})</strong>
                                <div class="dropdown">
                                    <button
                                        class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold"
                                        type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                        aria-expanded="false">
                                        <span title="Total Job Costs">${{getTotalJobPrice(jobs)}}</span> <span>-</span>
                                        <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                                        <i class="fa fa-angle-down ms-2"></i>
                                    </button>
                                    <div class="dropdown-menu bg-light" style="min-width: 400px"
                                        aria-labelledby="dropdownMenuButton">
                                        <div class="row">
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">Items</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">Estimates</a>
                                                <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                                                <a class="dropdown-item fw-700">Est. - Parts</a>
                                                <a class="dropdown-item"></a>

                                                <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                                                <a class="dropdown-item">Management</a>
                                                <!-- <a class="dropdown-item">Sales Commission</a> -->
                                                <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700">Total Costs</a>
                                                <a class="dropdown-item fw-700">Gross</a>

                                                <!-- <a class="dropdown-item">After Tax</a> -->
                                            </div>
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">#</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}}
                                                    (${{vehicle.price}} +
                                                    ${{getTotalSupplements(vehicle)}})</a>
                                                <a
                                                    class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                                                    (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                                                <a class="dropdown-item"></a>


                                                <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                                                <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                                                    ({{this.company.managementRate * 100}}% of
                                                    ${{getVehicleRemaining(vehicle)}})</a>

                                                <a class="dropdown-item">${{getSaleTax(vehicle)}}
                                                    ({{this.company.taxRate * 100}}% of
                                                    {{getVehicleTotalEstimates(vehicle)}})</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle,
                                                    jobs)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                                            </div>
                                        </div>

                                    </div>
                                </div>


                            </h2>
                            <div class="d-lg-flex align-items-center px-2 mt-2 three-btns">


                                <div class="dropdown" *ngIf="user.allowAddService == true">
                                    <button class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4 dropdown-toggle"
                                        type="button" data-bs-toggle="dropdown" aria-expanded="false"
                                        title="Add A Job Order. Click To Select A Pre-defined Job Order"> Add Job
                                        Order<i class="fa fa-angle-down ms-2"></i>
                                    </button>
                                    <ul class="dropdown-menu p-0 border-0 shadow">
                                        <ng-container *ngFor="let service of services; let i=index">
                                            <li><a (click)="addVehicleJob(service)" class="dropdown-item p-3 fs-12"
                                                    href="javascript:;"><i
                                                        class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                                                    {{service.name}}</a></li>
                                        </ng-container>
                                    </ul>
                                </div>
                                <button (click)="fillCalendarVehicleJob()"
                                    class="h-40 fs-13 mt-2 btn btn-warning text-white px-4 border-radius-4 ms-3"><i
                                        class="fa fa-calendar me-2"></i> See Schedule</button>

                                <button (click)="findAllCurrentEmplyeeJobs()"
                                    class="h-40 fs-13 mt-2 btn btn-info text-white px-4 border-radius-4 ms-3"><i
                                        class="fa fa-list me-2"></i> List all Jobs</button>
                                <button (click)="getVehicleJobs2(this.vehicle.id)"
                                    class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                                        class="fa fa-rotate"></i></button>
                                <button title="Show all info" (click)="shallAllJobInfo = !shallAllJobInfo"
                                    *ngIf="jobs.length > 0"
                                    class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                                        class="fa fa-filter"></i></button>

                                <button title="Print Repair Order" (click)="printPage('print-content-jobs', 'jobs')"
                                    *ngIf="jobs.length > 0"
                                    class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                                        class="fa fa-print"></i></button>
                            </div>
                        </div>

                        <div class="row">
                            <div class="mt-4 p-3 border bg-white border-radius-8 shadow">

                                <div
                                    class="table-container shadow border-radius-8 bg-white border w-100 d-box ss-table">

                                    <table class="table-bordered overflow-hidden shadow  line-height-100 w-100"
                                        cdkDropList (cdkDropListDropped)="dropped($event)">
                                        <thead>

                                            <tr class="bg-info text-white">
                                                <th class="fs-12 text-center bg-info text-white" style="width:50px">#
                                                </th>
                                                <th class="fs-12 text-center bg-info text-white" style="width:50px">EID
                                                </th>
                                                <th class="fs-12 text-center bg-info text-white mw-100">Item</th>
                                                <th class="fs-12 text-center bg-info text-white"
                                                    style="min-width:150px">
                                                    Instruction
                                                </th>
                                                <th class="fs-12 text-center bg-info text-white mw-100"
                                                    style="max-width: 200px;">
                                                    Assigned
                                                    To</th>

                                                <th class="fs-12 text-center bg-info text-white mw-50"
                                                    style="max-width: 80px;"><i class="fa-solid fa-dollar-sign"></i>
                                                </th>
                                                <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                                <th class="fs-12 text-center bg-info text-white mw-100">Target</th>
                                                <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                                <th class="fs-12 text-center bg-info text-white mw-80 mxw-100 "
                                                    style="width:50px">Status
                                                </th>
                                                <th class="fs-12 text-center bg-info text-white mw-50"
                                                    title="Verifed By "><i class="fa-solid fa-user text-danger"></i>
                                                </th>
                                                <th class="fs-12 text-center bg-info text-white mw-50"><i
                                                        class="fa-solid fa-user"></i></th>
                                                <th class="fs-12 text-center bg-info text-white mw-100">Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <ng-container *ngFor="let job of jobs; let i=index">
                                                <tr (click)="getDetailsJob(job, i)" title="{{getJobTitle(job)}}">
                                                    <td class="text-center fs-12 v-align-middle"
                                                        [cdkDragDisabled]="isMobile==true" cdkDrag>
                                                        {{job.id}}
                                                    </td>
                                                    <td class="text-center fs-12 v-align-middle">
                                                        <span classs="text-danger fw-700" title="Clik to view detail"
                                                            *ngIf="job.claimId> 0">{{job.claimId}}</span>

                                                    </td>
                                                    <td class="text-center fs-12 v-align-middle">
                                                        <input placeholder="Enter Job Name" [(ngModel)]="job.name"
                                                            maxlength="50" (keyup.enter)="onEnter('job name',job)"
                                                            type="text" [disabled]="job.paidWeek> 0"
                                                            class="form-control h-40 border-radius-4 border" />
                                                    </td>
                                                    <td class="text-center fs-12 v-align-middle"><textarea type="text"
                                                            rows="1" [(ngModel)]="job.notes" class="form-control my-2"
                                                            maxlength="200" (keyup.enter)="onEnter('job notes',job)"
                                                            title="Job Instruction" [disabled]="job.paidWeek> 0"
                                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                                    </td>

                                                    <td class="text-center fs-12 v-align-middle"><select
                                                            class="form-select border-radius-4 h-40 border fs-12 "
                                                            [(ngModel)]="job.employeeId" #device
                                                            [disabled]="job.paidWeek> 0" style="height:30px;"
                                                            (change)="onChangeEmployee2Claim($event, device.value, job, claims)">
                                                            <option value="0" disabled selected>Select Employee</option>
                                                            <option [value]="employee.id"
                                                                [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                                                *ngFor="let employee of employees;let i=index;">
                                                                {{employee.firstName}}
                                                                ( {{employee.roleName}},{{employee.rolePrecentage}}%
                                                                <ng-container *ngIf="employee.commissionBased == true">
                                                                    - <span class="fw-700 text-danger">Commission
                                                                        Based</span>
                                                                </ng-container>)
                                                                [{{
                                                                employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                                                +
                                                                employee.jobCountsFinished}}]
                                                            </option>
                                                        </select></td>

                                                    <td class="text-center fs-12 v-align-middle"><input
                                                            placeholder="Enter Job Value" [(ngModel)]="job.price"
                                                            maxlength="50" class="fs-12"
                                                            (keyup.enter)="onEnter('job price',job)" type="number"
                                                            [disabled]="job.paidWeek> 0"
                                                            class="form-control border h-40 border-radius-4" />
                                                    </td>

                                                    <td class="text-center fs-12 v-align-middle"><input
                                                            *ngIf="job.employeeId > 0"
                                                            (change)="onChangeCalendar($event, job)"
                                                            max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                                            [disabled]="job.paidWeek> 0"
                                                            [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                                                            title="Target Date" type="date"
                                                            class="form-control border h-40 border-radius-4" /></td>

                                                    <td class="p-2 text-center v-align-middle">
                                                        <div class="form-check form-switch text-center">
                                                            <input class="form-check-input mt-0" type="checkbox"
                                                                role="switch" [disabled]="job.paidWeek> 0"
                                                                *ngIf="job.employeeId > 0 "
                                                                [checked]="isJobChecked(job)"
                                                                (change)="updateJobStatus(job)" />
                                                        </div>

                                                        <!-- <div class="form-check form-switch text-center">
                              <input class="form-check-input mt-0" type="checkbox" role="switch"
                                [disabled]="job.paidWeek> 0" *ngIf="job.employeeId > 0 " [checked]="isJobChecked(job)"
                                (change)="onEnter('done',job)" />
                            </div> -->
                                                    </td>
                                                    <td class="p-2 text-center  v-align-middle fs-12">

                                                        <ng-container *ngFor="let user of users;let i=index;">
                                                            <span class="text-danger"
                                                                *ngIf="user.id == job.userIdVerified"
                                                                title="Verified At {{job.verifiedAt | date: 'MM/dd/yyyy HH:mm'}}">
                                                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                            </span>
                                                        </ng-container>

                                                    </td>
                                                    <td class="p-2 text-center  v-align-middle fs-12">

                                                        <ng-container *ngFor="let user of users;let i=index;">
                                                            <span *ngIf="user.id == job.userId">
                                                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                            </span>
                                                        </ng-container>

                                                    </td>
                                                    <td class="text-center fs-12 v-align-middle">
                                                        <div
                                                            class="d-flex align-items-center justifyc-content-center gap-1">
                                                            <button class="btn btn-outline-danger btn-sm" title="Remove"
                                                                [disabled]="job.paidWeek> 0"
                                                                (click)="deleteVehicleJobClaim(null, job)"><i
                                                                    class="fa fa-trash"></i></button>
                                                            <button class="btn btn-outline-primary btn-sm" title="Save"
                                                                [disabled]="job.paidWeek> 0"
                                                                (click)="saveJobNotes(job)"><i
                                                                    class="fa fa-save"></i></button>

                                                            <!-- <button class="btn btn-outline-danger btn-sm" title="Verify"
                                [disabled]="job.status != 1 && job.paidWeek> 0 && job.verifiedAt != null "
                                (click)="verifyJob(job)"><i class="fa fa-check"></i></button> -->
                                                            <button class="btn btn-outline-dark btn-sm" title="Print"
                                                                (click)="setJobId(job.id)"
                                                                (click)="printPageJob('print-content-job', 'jobs', job)">
                                                                <i class="fa fa-print"></i> </button>

                                                            <ng-container *ngIf="job.startDate == null">
                                                                <button class="btn btn-success btn-sm"
                                                                    [disabled]="job.paidWeek> 0" title="Start Job"
                                                                    (click)="onEnter('comments',job)"><i
                                                                        class="fa fa-running"
                                                                        [ngClass]="{'text-danger':job.startDate != null}"></i></button>
                                                            </ng-container>

                                                            <!-- <button class="btn btn-outline-warning btn-sm"
                                *ngIf="job.comments == null || job.comments == '' " title="add commments"
                                [disabled]="job.paidWeek> 0" (click)="onEnter('job comments',job)"><i
                                  class="fa fa-plus"></i></button> -->

                                                            <button class="btn btn-outline-warning btn-sm"
                                                                title="add images" [disabled]="job.paidWeek> 0"
                                                                (click)="fileInput.click()"><i
                                                                    class="fa fa-camera"></i></button>

                                                            <input type='file' id="uploadButton"
                                                                class="form-control opacity-0 top-0 position-absolute"
                                                                accept="image/jpg, image/jpeg" #fileInput
                                                                (change)="onSelectFileEditorJobs($event, job)" multiple
                                                                (click)="fileInput.value = ''" />

                                                        </div>
                                                    </td>
                                                </tr>
                                                <!-- <tr class="v-align-middle fs-11"
                          *ngIf="job.comments != null && job.comments != '' && shallAllJobInfo ==true ">

                          <td><span *ngIf="job.notifiedAt != null">Notified At</span></td>
                          <td><span *ngIf="job.notifiedAt != null">{{job.notifiedAt | date:'MM/dd/yyyy HH:mm'}}</span>
                          </td>

                          <td colspan="8" class="text-center fs-12 v-align-middle opacity-75">
                            <div class="progress  mt-2 w-100">
                              <div class="progress-bar" role="progressbar" style="width: {{job.steps/100 | percent }}"
                                aria-valuemin="0" aria-valuemax="100">
                                {{job.stepDescriptionCumulative }} ({{job.steps/100 | percent}})</div>
                            </div>
                          </td>
                          <td>
                            <div class="d-flex mt-2 justify-content-end gap-1">

                              <input type='file' id="uploadButton" class="form-control opacity-0 top-0 w-25 end-0"
                                accept="image/jpg, image/jpeg" #fileInput (change)="onSelectFileEditorJobs($event, job)"
                                multiple (click)="fileInput.value = ''" />


                              <ng-container *ngIf="job.startDate == null">
                                <button class="btn btn-success btn-sm" [disabled]="job.paidWeek> 0"
                                  (click)="onEnter('comments',job)"><i class="fa fa-running"
                                    [ngClass]="{'text-danger':job.startDate != null}"></i></button>
                              </ng-container>
                              <ng-container *ngIf="job.startDate != null && job.comments != null">
                                <button class="btn btn-success btn-sm" [disabled]="job.paidWeek> 0"
                                  (click)="onEnter('comments',job)"><i class="fa fa-save"
                                    [ngClass]="{'text-danger':job.startDate != null}"></i></button>

                              </ng-container>


                              <ng-container *ngIf="shallShowDone(job)">
                                <button class="btn btn-success btn-sm" title="Done" [disabled]="job.paidWeek> 0 "
                                  (click)="onEnter('done',job)"><i class="fa flag-checkered"
                                    [ngClass]="{'text-danger':job.status == 1 }"></i> Done </button>
                              </ng-container>

                              <ng-container *ngIf="shallShowNofityManger(job)">
                                <button class="btn btn-success btn-sm" title="notify managers"
                                  (click)="notifyManager('Noitfy','text-warning fw-500',job)"><i class="fa fa-bell"
                                    [ngClass]="{'text-danger': job.notified == true, 'text-success': job.notified  == false}"></i>
                                  Notify Manager </button>
                              </ng-container>

                              <ng-container *ngIf="shallShowNVerified(job)">
                                <button class="btn btn-success text-white btn-sm" title="Verify this job"
                                  (click)="notifyManager('Verified','text-primary fw-700',job)">
                                  <i class="fa fa-check"
                                    [ngClass]="{'text-danger': job.verifiedAt != null, 'text-white': job.verifiedAt  == null}"></i>
                                  Verify </button>
                              </ng-container>


                              <button class="btn btn-warning text-white btn-sm" title="add images"
                                [disabled]="job.paidWeek> 0" (click)="fileInput.click()"><i class="fa fa-camera"></i>
                              </button>


                            </div>
                          </td>
                        </tr> -->
                                                <tr class="v-align-middle fs-11" *ngIf="shallAllJobInfo ==true ">
                                                    <!-- <td></td>
                          <td></td> -->
                                                    <td><span *ngIf="job.userIdVerified > 0">Verifed At</span></td>
                                                    <td><span *ngIf="job.userIdVerified > 0">{{job.verifiedAt |
                                                            date:'MM/dd/yyyy HH:mm'}}</span>
                                                    </td>
                                                    <td colspan="9" class="text-center fs-12 v-align-middle opacity-75">
                                                        <textarea type="text" rows="1" [(ngModel)]="job.comments"
                                                            class="form-control my-2" maxlength="2000"
                                                            placeHolder="Pleaes enter comments"
                                                            (keyup.enter)="onEnter('job comments',job)"
                                                            title="Job Comments" [disabled]="job.paidWeek> 0"
                                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                                    </td>

                                                    <!-- <td>
                            <div class="d-flex mt-2 justify-content-end gap-1">

                              <input type='file' id="uploadButton" class="form-control opacity-0 top-0 w-25 end-0"
                                accept="image/jpg, image/jpeg" #fileInput (change)="onSelectFileEditorJobs($event, job)"
                                multiple (click)="fileInput.value = ''" />


                              <ng-container *ngIf="job.startDate != null && job.comments != null">
                                <button class="btn btn-success btn-sm" [disabled]="job.paidWeek> 0"
                                  (click)="onEnter('comments',job)"><i class="fa fa-save"
                                    [ngClass]="{'text-danger':job.startDate != null}"></i></button>
                              </ng-container>


                              <button class="btn btn-success btn-sm" title="Done" [disabled]="job.paidWeek> 0 "
                                (click)="onEnter('done',job)"><i class="fa flag-checkered"
                                  [ngClass]="{'text-danger':job.status == 1 }"></i></button>


                              <ng-container *ngIf="shallShowNofityManger(job)">
                                <button class="btn btn-success btn-sm" title="notify managers"
                                  (click)="notifyManager('Noitfy','text-warning fw-500',job)"><i class="fa fa-bell"
                                    [ngClass]="{'text-danger': job.notified == true, 'text-success': job.notified  == false}"></i>
                                  Notify Manager </button>
                              </ng-container>

                              <ng-container *ngIf="shallShowNVerified(job)">
                                <button class="btn btn-success text-white btn-sm" title="Verify this job"
                                  (click)="notifyManager('Verified','text-primary fw-700',job)">
                                  <i class="fa fa-check"
                                    [ngClass]="{'text-danger': job.verifiedAt != null, 'text-white': job.verifiedAt  == null}"></i>
                                  Verify </button>
                              </ng-container>


                              <button class="btn btn-warning text-white btn-sm" title="add images"
                                [disabled]="job.paidWeek> 0" (click)="fileInput.click()"><i class="fa fa-camera"></i>
                              </button>


                            </div>
                          </td> -->
                                                </tr>
                                                <tr class="v-align-middle fs-11"
                                                    *ngIf="job.imageModels.length>0 && shallAllJobInfo== true">
                                                    <td></td>
                                                    <td></td>
                                                    <td colspan="9">
                                                        <div class="row overflow-x-auto overflow-y-hidden">
                                                            <div
                                                                class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-1">

                                                                <div *ngFor='let imageModel of job.imageModels; let i=index'
                                                                    [cdkDragDisabled]="isMobile==true" cdkDrag
                                                                    class="containerImage v-imgs float-start my-2 transition"
                                                                    style="cursor: pointer;">
                                                                    <div class="containerImage">

                                                                        <label class="top-left-0 w-100 fs-10 opacity-75"
                                                                            [ngClass]="{'text-white bg-primary':imageModel.employeeId> 0, 'text-white bg-secondary':imageModel.employeeId == 0}"
                                                                            for="title"> <span
                                                                                *ngIf="imageModel.employeeId > 0">{{getTopImageLabel(imageModel)
                                                                                |shortName}}</span>
                                                                            {{imageModel.createdAt | date: 'MM/dd/yyyy,
                                                                            HH:mm'}}</label>

                                                                        <img class="preview img-fluid img-thumbnail"
                                                                            width="100%"
                                                                            title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                                                            *ngIf="job.showInSearchImageId != imageModel.id"
                                                                            src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}"
                                                                            (click)="setImage2(i)"
                                                                            style="border: 3px solid #555;">
                                                                        <img class="preview img-fluid img-thumbnail"
                                                                            width="100%"
                                                                            title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}} "
                                                                            *ngIf="job.showInSearchImageId == imageModel.id"
                                                                            src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}"
                                                                            (click)="setImage2(i)"
                                                                            title="Show in search"
                                                                            style="border: 3px solid lightcoral;">
                                                                        <div class="bottom-right py-2"
                                                                            *ngIf="user.allowUpdateJobStatus == true">
                                                                            <button
                                                                                *ngIf="imageModel.id != job.showInSearchImageId"
                                                                                title="As index image during search"
                                                                                (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                                                                class="btn btn-outline-primary-abs me-3 mt-3 btn-sm"
                                                                                for="title"><i
                                                                                    class="bi-search"></i></button>
                                                                            <button
                                                                                (click)="deleteImageJob(job.id, imageModel.id)"
                                                                                data-toggle="tooltip"
                                                                                data-placement="top"
                                                                                title="Remove this image"
                                                                                class="btn btn-outline-danger mt-3 btn-sm"
                                                                                for="title"> <i class="bi-trash"></i>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                    </td>
                                                    <!-- <td colspan="8" class="text-center fs-12 v-align-middle opacity-75">
                            <div class="row">
                              <div class="d-flex px-2 py-1 mt-2 shadow d-flex align-items-stretch "
                                *ngFor='let imageModel of job.imageModels; let i=index'>
                                <div class="containerImage">
                
                                  <small class="top-left" for="title">
                                    {{imageModel.createdAt | date: "MM/dd/yyyy hh:mm"}}</small>
                
                                  <img class="img-fluid rounded-2 img-thumbnail my-1 object-fit-cover" height="100" width="100"
                                    src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}" />
                
                                  <div class="bottom-right py-3" *ngIf="user.allowUpdateJobStatus == true">
                                    <button *ngIf="imageModel.id != job.showInSearchImageId" title="As index image during search"
                                      (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                      class="btn btn-primary-abs me-3 mt-3 btn-sm" for="title">Set for Index</button>
                                    <button (click)="deleteImageJob(job.id, imageModel.id)" data-toggle="tooltip"
                                      data-placement="top" title="Remove this image" class="btn btn-danger mt-3 btn-sm" for="title"> <i
                                        class="bi-trash"></i>
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </td> -->


                                                </tr>
                                            </ng-container>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="mt-4 p-3 border bg-white border-radius-8 shadow">


                                <div class="table-container shadow border-radius-8 border w-100 d-box ss-table">
                                    <table class="table-bordered border-radius-8 w-100">
                                        <thead>
                                            <tr class="bg-info text-white v-align-middle">
                                                <th class="fs-14 text-center mxw-50" style="width:80px"> </th>
                                                <th class="fs-14 text-center mxw-100" style="max-width:100px"
                                                    (click)="navigateTo('employees')">
                                                    <i class="fa fa-user"></i>
                                                </th>
                                                <th class="fs-14 text-center mxw-50 " style="width:50px"> # </th>
                                                <th class="fs-14 text-center v-align-middle "> [ {{
                                                    this.employeeJobCarrier.length }} ] employees with total of [{{
                                                    totalJobCounts}}] jobs
                                                    <!--  <div class="btn-group btn-group-toggle" data-toggle="buttons">
                            <label class="btn btn-secondary">
                              <input type="radio" name="options" id="option1" autocomplete="off" checked> Finished
                            </label>
                            <label class="btn btn-secondary">
                              <input type="radio" name="options" id="option2" autocomplete="off"> Not Finished
                            </label>
                            <label class="btn btn-secondary">
                              <input type="radio" name="options" id="option3" autocomplete="off"> Both
                            </label>
                          </div> -->
                                                </th>
                                            </tr>
                                        </thead>
                                        <ng-container
                                            *ngFor="let employee of employeeJobCarrier; let i = index;  let even=even">
                                            <tr id="{{employee.id}}" title=""
                                                [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')">

                                                <td class="text-center fs-13" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails" title="Click to view details">
                                                    {{i+1}}
                                                </td>
                                                <td class="text-center fs-13" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails"
                                                    title="Click to view details text-capitalize ">
                                                    <a style="word-break:break-all"
                                                        target="_blank">{{(employee.firstName
                                                        + ' ' + employee.lastName)|
                                                        shortName:2}}</a>
                                                </td>
                                                <td class="fs-13 text-center fw-700" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails" title="Click to view details">
                                                    <span *ngIf="employee.jobs" title="number of jobs">{{
                                                        employee.jobs.length}}</span>/<span
                                                        title="number of vehicles">{{filterJobs(employee).length}}</span>
                                                </td>
                                                <!-- <td>Jobs</td> -->
                                                <td *ngIf="employee.jobs!.length >0">

                                                    <ng-container
                                                        *ngFor="let vehicle of filterJobs(employee); let i=index">
                                                        <div class="table-container w-100 d-box ss-table mt-1 mb-1">
                                                            <table class="table w-100 mb-1">
                                                                <thead>
                                                                    <tr>
                                                                        <td class="fs-14 text-center w-25">
                                                                            <a class="btn btn-light d-flex gap-2 align-items-center white-space my-1 border p-1 shadow "
                                                                                data-toggle="tooltip"
                                                                                data-placement="bottom"
                                                                                title="{{vehicle.customer.title}} {{vehicle.customer.firstName}} {{vehicle.customer.lastName }} "
                                                                                [style.background-color]="vehicle.id == currentIndex? '#EEE' : (true ? 'white' : 'white')"
                                                                                (click)="getDetail(vehicle, vehicle.id)">

                                                                                <span
                                                                                    [ngClass]="{'text-danger': vehicle.special ==true}"
                                                                                    title="{{vehicle.make}}"
                                                                                    class="car-{{ vehicle.make| lowercase }} fs-30"></span>

                                                                                <!-- <ng-container
                                          *ngIf="vehicle.make != 'Land Rover' && vehicle.make != 'Alfa Romeo' && vehicle.make != 'koda' && vehicle.make !='Rolls Royce'">
                                          <span title="{{vehicle.make}}"
                                            class="car-{{ vehicle.make| lowercase }} fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'Land Rover'">
                                          <span title="{{vehicle.make}}" class="car-land-rover fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'Rolls Royce'">
                                          <span title="{{vehicle.make}}" class="car-rolls-royce fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'Alfa Romeo'">
                                          <span title="{{vehicle.make}}" class="car-alfa-romeo fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'koda'">
                                          <span title="{{vehicle.make}}" class="car-skoda fs-30"></span>

                                        </ng-container> -->
                                                                                <span class="d-block text-start">
                                                                                    <strong
                                                                                        class="fs-12 fw-500 d-flex gap-2 align-items-center"
                                                                                        title="Click to view vehicle details"
                                                                                        data-bs-toggle="modal"
                                                                                        data-bs-target="#editVehicle"
                                                                                        (click)="this.showVehicleListing = false; getDetail(vehicle, vehicle.id)"
                                                                                        [style.color]="vehicle.id == currentIndex? 'black' : (true ? 'black' : 'black')">
                                                                                        <i class="fa-solid fa-square border border-radius-1"
                                                                                            style="color: {{vehicle.color}}"></i>
                                                                                        <small>{{
                                                                                            vehicle.year }} {{
                                                                                            vehicle.make }} {{
                                                                                            vehicle.model
                                                                                            }}</small></strong>
                                                                                    <strong
                                                                                        class="fw-700 fs-11 py-1 line-height-150 text-secondary"
                                                                                        [ngClass]="{'blink text-success': vehicle.jobsDone == true}">Jobs:
                                                                                        {{getJobStatusCount(vehicle,vehicle.jobs)}}/{{
                                                                                        vehicle.jobs.length
                                                                                        }}</strong>
                                                                                    <strong
                                                                                        class="badge badge-success ms-1"
                                                                                        (click)="changePaidStatus(vehicle, false)"
                                                                                        title="Paid"
                                                                                        *ngIf="vehicle.paid==true"><i
                                                                                            class="fa-solid fa-dollar-sign"></i></strong>
                                                                                </span>

                                                                            </a>
                                                                        </td>
                                                                        <td class="fs-14 text-center w-75">
                                                                            <a *ngFor="let job of vehicle.jobs2"
                                                                                title="{{getJobTitle(job)}}"
                                                                                class="btn btn-light d-flex gap-2 align-items-center white-space my-1 border p-1 shadow">
                                                                                <span class="d-block text-start">

                                                                                    <strong
                                                                                        class="fs-12 fw-500 d-flex gap-2 align-items-center overflow-hidden"
                                                                                        title="Click to view vehicle details"
                                                                                        data-bs-toggle="modal"
                                                                                        data-bs-target="#editVehicle"
                                                                                        (click)="this.showVehicleListing = false; getDetail(vehicle, vehicle.id)"
                                                                                        [style.color]="vehicle.id == currentIndex? 'black' : (true ? 'black' : 'black')">
                                                                                        <i *ngIf="job.status==1"
                                                                                            class="fa-solid fa-square border border-radius-1 text-success"></i>
                                                                                        <i *ngIf="job.status==0"
                                                                                            class="fa-solid fa-square border border-radius-1 text-danger"></i>
                                                                                        <small><span>{{job.id}}. </span>
                                                                                            <strong
                                                                                                class="badge badge-success ms-1"
                                                                                                *ngIf="job.paidWeek > 0"><i
                                                                                                    class="fa-solid fa-dollar-sign opacity-50"></i></strong>
                                                                                            {{ job.name }}
                                                                                        </small>:<small>{{
                                                                                            job.notes }} </small>
                                                                                        <span
                                                                                            class="text-danger">${{job.price}}</span><i
                                                                                            *ngIf="job.targetDate != null"
                                                                                            class="fas fa-bullseye opacity-50"></i><span>
                                                                                            {{job.targetDate | date:
                                                                                            'MM/dd/yyyy' }}</span>
                                                                                        <span>created <i
                                                                                                class="fa-solid fa-clock opacity-50"></i>{{job.createdAt
                                                                                            | date:
                                                                                            'MM/dd/yyyy'
                                                                                            }}</span>

                                                                                        <span>By <i
                                                                                                class="fa-solid fa-user opacity-50"></i>
                                                                                            <ng-container
                                                                                                *ngFor="let user of users;let i=index;">
                                                                                                <span
                                                                                                    *ngIf="user.id == job.userId">
                                                                                                    {{(user.firstName +
                                                                                                    " " + user.lastName)
                                                                                                    | shortName:2}}
                                                                                                </span>
                                                                                            </ng-container>

                                                                                        </span>


                                                                                    </strong>
                                                                                </span>
                                                                            </a>
                                                                        </td>
                                                                    </tr>
                                                                </thead>
                                                            </table>
                                                        </div>


                                                    </ng-container>
                                                </td>
                                                <td *ngIf="employee.jobs!.length==0"></td>
                                            </tr>

                                        </ng-container>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <br />
                        <br />
                    </div>


                    <!-- Payments Tab -->
                    <div class="tab-pane" id="payments" role="tabpanel" aria-labelledby="jobs-tab">
                        <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">

                            <h2
                                class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">
                                Vehicle
                                Payments for: <strong class="fw-700 text-primary" data-bs-toggle="modal"
                                    data-bs-target="#editVehicle" style="cursor: pointer;"
                                    title="Click to view details">{{vehicle.year}}
                                    {{vehicle.make}} {{vehicle.model}}
                                    {{vehicle.color}} ({{payments.length}})</strong>



                                <div class="dropdown">
                                    <button
                                        class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold"
                                        type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                        aria-expanded="false">
                                        <span title="Total Payments">${{getTotalPayments()}}</span> <span>-</span>
                                        <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                                        <i class="fa fa-angle-down ms-2"></i>
                                    </button>
                                    <div class="dropdown-menu bg-light" style="min-width: 400px"
                                        aria-labelledby="dropdownMenuButton">
                                        <div class="row">
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">Items</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">Estimates</a>
                                                <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                                                <a class="dropdown-item fw-700">Est. - Parts</a>
                                                <a class="dropdown-item"></a>

                                                <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                                                <a class="dropdown-item">Management</a>
                                                <!-- <a class="dropdown-item">Sales Commission</a> -->
                                                <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700">Total Costs</a>
                                                <a class="dropdown-item fw-700">Gross</a>

                                                <!-- <a class="dropdown-item">After Tax</a> -->
                                            </div>
                                            <div class="col-6 px-1">
                                                <a class="dropdown-item">#</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}}
                                                    (${{vehicle.price}} +
                                                    ${{getTotalSupplements(vehicle)}})</a>
                                                <a
                                                    class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                                                    (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                                                <a class="dropdown-item"></a>


                                                <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                                                <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                                                    ({{this.company.managementRate * 100}}% of
                                                    ${{getVehicleRemaining(vehicle)}})</a>
                                                <!-- <a class="dropdown-item text-danger">${{getSalesCommission(vehicle)}} (7% of
                          ${{vehicle.supplymentPrice}})</a> -->
                                                <a class="dropdown-item">${{getSaleTax(vehicle)}}
                                                    ({{this.company.taxRate * 100}}% of
                                                    {{getVehicleTotalEstimates(vehicle)}})</a>
                                                <div class="dropdown-divider"></div>

                                                <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle,
                                                    jobs)}}</a>
                                                <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                                            </div>
                                        </div>

                                    </div>

                                </div>
                            </h2>
                            <div class="d-lg-flex align-items-center px-2 mt-2">
                                <div class="dropdown" *ngIf="user.allowAddPayment == true">
                                    <button class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4 dropdown-toggle"
                                        type="button" data-bs-toggle="dropdown" aria-expanded="false">Add Payments <i
                                            class="fa fa-angle-down ms-2"></i></button>
                                    <ul class="dropdown-menu p-0 border-0 shadow">
                                        <ng-container *ngFor="let paymentType of paymentTypes; let i=index">
                                            <li><a (click)="addVehiclePayment(paymentType)"
                                                    class="dropdown-item p-3 fs-12" href="javascript:;"><i
                                                        class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                                                    {{paymentType.name}}</a></li>
                                        </ng-container>
                                    </ul>
                                </div>

                                <button title="Show all info" (click)="shallAllPaymentInfo = !shallAllPaymentInfo"
                                    *ngIf="payments.length > 0"
                                    class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                                        class="fa fa-filter"></i></button>

                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="mt-4 pt-1">
                                <div class="col-12 p-3 bg-white shadow border border-radius-8">

                                    <div class="table-responsive jobs-table bg-white border-radius-8 shadow" cdkDropList
                                        (cdkDropListDropped)="droppedPayment($event)">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr class="v-align-middle">
                                                    <!-- <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120" style="width: 150px;">Item Name</th> -->
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                                        style="width: 50px;">#
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                        style="width: 200px;">
                                                        Description
                                                    </th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100">
                                                        <i class="fa-solid fa-dollar-sign"></i>
                                                    </th>

                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                                                        style="width: 100px;">
                                                        Processed At
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                                                        title="Click to go to Configuration"
                                                        [routerLink]="'/payment-method'"
                                                        style="cursor:pointer; width: 150px;">Paid With</th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                                                        title="Click to go to Configuration"
                                                        [routerLink]="'/payment-status'"
                                                        style="cursor:pointer; width: 150px;">Pay Status</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100">
                                                        <i class="fa-solid fa-clock"></i>
                                                    </th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                        <i class="fa-solid fa-user"></i>
                                                    </th>
                                                    <th
                                                        class=" bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                        Verified By
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                                                        style="width: 100px;">
                                                        Verified At
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                        style="width:100px;">
                                                        Action
                                                    </th>
                                                </tr>


                                            </thead>
                                            <tbody>
                                                <ng-container *ngFor="let payment of payments; let i=index">
                                                    <tr class="alert-info"
                                                        title="Created at {{payment.createdAt| date: 'MM/dd/yyyy'}}"
                                                        (click)="setPaymentPaymentId(payment.id);getDetailsPayment(payment, i)"
                                                        [style.background-color]="payment.id == currentPaymentPaymentId? '#FFF3CD' : (true ? '#CFF4FC' : '#CFF4FC')">

                                                        <td class="fs-13 p-2 text-center v-align-middle"
                                                            title="Drag and drop index number to change the order"
                                                            [cdkDragDisabled]="isMobile==true" cdkDrag>{{i+1}}</td>

                                                        <td class="fs-13 p-2"><textarea [(ngModel)]="payment.name"
                                                                class="form-control"
                                                                [disabled]="user.allowAddPayment == false"
                                                                placeholder="Please Specify"
                                                                (keyup.enter)="onEnterPayment('Payment name',payment)"
                                                                rows="1"
                                                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                                                maxlength="200"
                                                                [disabled]="user.allowAddReceipt == false"></textarea>
                                                        </td>

                                                        <td class="fs-13 p-2"><input
                                                                (keyup.enter)="onEnterPayment('Payment amount',payment)"
                                                                [disabled]="user.allowAddPayment == false"
                                                                [(ngModel)]="payment.amount"
                                                                onKeyPress="if(this.value.length==10) return false"
                                                                pattern="[0-9]" type="number"
                                                                class="form-control form-control-sm h-40 border-radius-4" />
                                                        </td>

                                                        <td class="fs-13 p-2"><input trimText
                                                                class="form-control h-48 px-3 border-radius-8"
                                                                type="date" [disabled]="user.allowAddPayment == false"
                                                                placeholder="Enter Processing Date"
                                                                (change)="onChangeVehiclePaymentCalendar($event, payment)"
                                                                [ngModel]="payment.date |  date:'yyyy-MM-dd'" /></td>

                                                        <td class="fs-13 p-2">
                                                            <select class="form-select h-48 px-3 border-radius-8"
                                                                [disabled]="user.allowAddPayment == false"
                                                                (change)="onChangeVehiclePaymentMethod2($event, payment)"
                                                                [(ngModel)]="payment.paymentMethodId">
                                                                <option value="0" disabled selected>Select Payment
                                                                    Method</option>
                                                                <option [value]="paymentMethod.id"
                                                                    *ngFor="let paymentMethod of paymentMethods;let i=index;">
                                                                    {{paymentMethod.name}}</option>
                                                            </select>
                                                        </td>
                                                        <td class="fs-13 p-2">
                                                            <select class="form-select h-48 px-3 border-radius-8"
                                                                [disabled]="user.allowAddPayment == false"
                                                                (change)="onChangeVehiclePaymentStatus($event, payment)"
                                                                [(ngModel)]="payment.paymentStatusId">
                                                                <option value="0" disabled selected>Select Payment
                                                                    Status</option>
                                                                <option [value]="paymentStatus.id"
                                                                    *ngFor="let paymentStatus of paymentStatuss;let i=index;">
                                                                    {{paymentStatus.name}}</option>
                                                            </select>
                                                        </td>
                                                        <td class="fs-13 p-2  text-center v-align-middle">
                                                            {{payment.createdAt | date: 'MM/dd/yyyy'}}
                                                        </td>
                                                        <td class="fs-13 p-2 text-center v-align-middle">

                                                            <ng-container *ngFor="let user of users;let i=index;">
                                                                <span *ngIf="user.id == payment.userId">
                                                                    {{(user.firstName + " " + user.lastName) |
                                                                    shortName:2}}
                                                                </span>
                                                            </ng-container>


                                                        </td>
                                                        <td class="fs-13 p-2 text-center v-align-middle">

                                                            <ng-container *ngFor="let user of users;let i=index;">
                                                                <span *ngIf="user.id == payment.userIdVerified">
                                                                    {{(user.firstName + " " + user.lastName) |
                                                                    shortName:2}}
                                                                </span>
                                                            </ng-container>


                                                        </td>
                                                        <td class="fs-13 p-2">

                                                            <ng-container *ngIf="user.allowVerifyPayment == true ">
                                                                <input trimText
                                                                    class="form-control h-48 px-3 border-radius-8"
                                                                    type="date" placeholder="Enter Verified Date"
                                                                    (change)="onChangeVehiclePaymentCalendarVerified($event, payment)"
                                                                    [ngModel]="payment.dateVerified |  date:'yyyy-MM-dd'" />
                                                            </ng-container>
                                                            <ng-container *ngIf="user.allowVerifyPayment == false">
                                                                {{payment.dateVerified | date:
                                                                'MM/dd/yyyy' }}
                                                            </ng-container>

                                                        </td>

                                                        <td class="p-2 text-center v-align-middle">
                                                            <div
                                                                class="d-flex align-items-center justifyc-cntent-center gap-2">
                                                                <button class="btn btn-outline-danger btn-sm"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    title="Delete"
                                                                    (click)="deleteVehiclePayment(null, payment)"><i
                                                                        class="fa fa-trash"></i></button>
                                                                <button class="btn btn-outline-success btn-sm"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    title="Save" (click)="savePayment(payment)"><i
                                                                        class="fa fa-save"></i></button>

                                                                <button class="btn btn-outline-warning btn-sm"
                                                                    title="add images"
                                                                    [disabled]="user.allowAddPayment == false"
                                                                    (click)="fileInputPayment.click()"><i
                                                                        class="fa fa-camera"></i></button>

                                                                <input type='file' id="uploadButton"
                                                                    class="form-control opacity-0 top-0 position-absolute"
                                                                    accept="image/jpg, image/jpeg" #fileInputPayment
                                                                    (change)="onSelectFileEditorPayments($event)"
                                                                    multiple (click)="fileInput.value = ''" />
                                                            </div>
                                                        </td>
                                                    </tr>
                                                    <tr class="v-align-middle fs-11"
                                                        *ngIf="shallAllPaymentInfo== true || ( payment.imageModels &&  payment!.imageModels!.length  > 0)"
                                                        (click)="getDetailsPayment(payment, i)">
                                                        <td></td>
                                                        <!-- <td></td> -->
                                                        <td colspan="10">
                                                            <div class="row overflow-x-auto overflow-y-hidden">
                                                                <div
                                                                    class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-1">

                                                                    <div *ngFor='let imageModel of payment.imageModels; let i=index'
                                                                        class="containerImage v-imgs float-start my-2 transition"
                                                                        style="cursor: pointer;">
                                                                        <div class="containerImage">

                                                                            <label class="top-left" for="title">
                                                                                {{imageModel.createdAt | date:
                                                                                'MM/dd/yyyy
                                                                                HH:mm:ss'}}</label>

                                                                            <img class="preview img-fluid img-thumbnail"
                                                                                width="100%"
                                                                                title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                                                                *ngIf="payment.showInSearchImageId != imageModel.id"
                                                                                src="{{baseUrlResizeImagePayments + '/' + imageModel.id}}"
                                                                                (click)="getDetailsPayment(payment, i);setImage4(imageModel)"
                                                                                style="border: 3px solid #555;">
                                                                            <img class="preview img-fluid img-thumbnail"
                                                                                width="100%"
                                                                                title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}} "
                                                                                *ngIf="payment.showInSearchImageId == imageModel.id"
                                                                                src="{{baseUrlResizeImagePayments + '/' + imageModel.id}}"
                                                                                (click)="getDetailsPayment(payment, i);setImage4(imageModel)"
                                                                                title="Show in search"
                                                                                style="border: 3px solid lightcoral;">
                                                                            <div class="bottom-right py-2"
                                                                                *ngIf="user.allowAddPayment == true">
                                                                                <!-- <button *ngIf="imageModel.id != job.showInSearchImageId"
                                        title="As index image during search"
                                        (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                        class="btn btn-outline-primary-abs me-3 mt-3 btn-sm" for="title"><i
                                          class="bi-search"></i></button> -->
                                                                                <button
                                                                                    (click)="deleteImagePayment(payment.id, imageModel.id)"
                                                                                    data-toggle="tooltip"
                                                                                    data-placement="top"
                                                                                    title="Remove this image"
                                                                                    class="btn btn-outline-danger mt-3 btn-sm"
                                                                                    for="title"> <i
                                                                                        class="bi-trash"></i>
                                                                                </button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-12 col-md-12 col-sm-12 px-0 py-3"
                                                                *ngIf="selectedImage4 != null && selectedImage4 > 0 && payment.id ==  imageModelSelected.paymentId &&  payment.showInSearchImageId != selectedImage4">
                                                                <div class="bg-white rounded-3 border p-3 h-100">
                                                                    <div class="containerImage"
                                                                        *ngIf="payment.imageModels!.length > 0"> <img
                                                                            class="image w-100 img-fluid img-thumbnail"
                                                                            src="{{baseUrlResizeImagePaymentGetImages + '/' + selectedImage4}}"
                                                                            alt="Image" />
                                                                        <img *ngIf="selectedImage4 != null && selectedImage4 > 0 &&  payment.showInSearchImageId == selectedImage4"
                                                                            style="max-height:500px;"
                                                                            class="img-fluid rounded-2 img-thumbnail my-2 object-fit-cover w-100"
                                                                            src="{{baseUrlResizeImagePaymentGetImages + '/' + selectedImage4}}"
                                                                            alt="Image" />
                                                                        <!-- <label *ngIf="selectedImage4 == payment.showInSearchImageId" class="top-left"
                                      for="title">
                                      Will Show this in listing</label> -->
                                                                        <div class="top-right py-3">
                                                                            <button title="Close"
                                                                                (click)="selectedImage4 =0"
                                                                                class="btn btn-primary-abs me-3 mt-3 btn-sm"
                                                                                for="title">Close</button>
                                                                            <!-- <button *ngIf="selectedImage != selectedVehicle.showInSearchImageId"
                                        title="As index image during search"
                                        (click)="setImageForSearch(selectedVehicle.id, selectedImage)"
                                        class="btn btn-primary-abs me-3 mt-3 btn-sm" for="title">Set for Index</button> -->
                                                                            <!-- <button (click)="deleteImage2(selectedVehicle.id, selectedImage4)"
                                        data-toggle="tooltip" data-placement="top" title="Remove this image"
                                        class="btn btn-danger mt-3 btn-sm" for="title">
                                        <i class="bi-trash"></i>
                                      </button> -->
                                                                        </div>
                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </td>
                                                        <!-- <td colspan="8" class="text-center fs-12 v-align-middle opacity-75">
                            <div class="row">
                              <div class="d-flex px-2 py-1 mt-2 shadow d-flex align-items-stretch "
                                *ngFor='let imageModel of job.imageModels; let i=index'>
                                <div class="containerImage">
                
                                  <small class="top-left" for="title">
                                    {{imageModel.createdAt | date: "MM/dd/yyyy hh:mm"}}</small>
                
                                  <img class="img-fluid rounded-2 img-thumbnail my-1 object-fit-cover" height="100" width="100"
                                    src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}" />
                
                                  <div class="bottom-right py-3" *ngIf="user.allowUpdateJobStatus == true">
                                    <button *ngIf="imageModel.id != job.showInSearchImageId" title="As index image during search"
                                      (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                      class="btn btn-primary-abs me-3 mt-3 btn-sm" for="title">Set for Index</button>
                                    <button (click)="deleteImageJob(job.id, imageModel.id)" data-toggle="tooltip"
                                      data-placement="top" title="Remove this image" class="btn btn-danger mt-3 btn-sm" for="title"> <i
                                        class="bi-trash"></i>
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </td> -->


                                                    </tr>
                                                </ng-container>
                                            </tbody>
                                        </table>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-8">

                            </div>
                            <div class="col-lg-3 col-md-12"></div>
                            <div class="col-lg-3 col-md-4 px-1" *ngIf="getTotalPayments() > 0">
                                <ul>
                                    <li class="d-flex justify-content-between my-4"><strong
                                            class="fs-15">Subtotal:</strong>
                                        <p class="fs-15 text-black opacity-75 px-1 fw-700">${{getTotalPayments()}}</p>
                                    </li>
                                    <li class="d-flex justify-content-between my-4"><strong class="fs-15">Tax
                                            ({{company.taxRate
                                            *100}}%):</strong>
                                        <p class="fs-15 text-black opacity-75 px-1 fw-700">${{getTaxPayments() }}</p>
                                    </li>
                                    <li
                                        class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                        <strong class="fs-15">Payments:</strong>
                                        <p class="fs-15 px-1 fw-700">${{getTotalPaymentWithTax()}}</p>
                                    </li>


                                </ul>
                            </div>
                        </div>

                    </div>

                    <!-- Invoices Tab -->
                    <div class="tab-pane" id="invoices" role="tabpanel" aria-labelledby="invoices-tab">
                        <div class="d-flex align-items-center v-align-middle justify-content-start pt-5">
                            <h2 class="heading-color fw-700 text-uppercase pt-3 px-2 fs-16 pb-3">Vehicle Receipt Items
                                For: <strong class="text-primary fw-700" data-bs-toggle="modal"
                                    data-bs-target="#editVehicle" style="cursor: pointer;"
                                    title="Click to view details">{{vehicle.year}}
                                    {{vehicle.make}}
                                    {{vehicle.model}} {{vehicle.color}} ({{receipts.length}}) </strong>
                            </h2>
                            <div class="dropdown">
                                <button class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold"
                                    type="button" id="dropdownMenuButton" data-bs-toggle="dropdown"
                                    aria-expanded="false">
                                    <span title="Total Receipt">${{getTotal()}}</span> <span>-</span>
                                    <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                                    <i class="fa fa-angle-down ms-2"></i>
                                </button>
                                <div class="dropdown-menu bg-light" style="min-width: 400px"
                                    aria-labelledby="dropdownMenuButton">
                                    <div class="row">
                                        <div class="col-6 px-1">
                                            <a class="dropdown-item">Items</a>
                                            <div class="dropdown-divider"></div>

                                            <a class="dropdown-item">Estimates</a>
                                            <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                                            <a class="dropdown-item fw-700">Est. - Parts</a>
                                            <a class="dropdown-item"></a>

                                            <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                                            <a class="dropdown-item">Management</a>
                                            <!-- <a class="dropdown-item">Sales Commission</a> -->
                                            <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                                            <div class="dropdown-divider"></div>

                                            <a class="dropdown-item fw-700">Total Costs</a>
                                            <a class="dropdown-item fw-700">Gross</a>

                                            <!-- <a class="dropdown-item">After Tax</a> -->
                                        </div>
                                        <div class="col-6 px-1">
                                            <a class="dropdown-item">#</a>
                                            <div class="dropdown-divider"></div>

                                            <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}}
                                                (${{vehicle.price}} +
                                                ${{getTotalSupplements(vehicle)}})</a>
                                            <a class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                                            <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                                                (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                                            <a class="dropdown-item"></a>


                                            <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                                            <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                                                ({{this.company.managementRate * 100}}% of
                                                ${{getVehicleRemaining(vehicle)}})</a>
                                            <!-- <a class="dropdown-item text-danger">${{getSalesCommission(vehicle)}} (7% of
                          ${{vehicle.supplymentPrice}})</a> -->
                                            <a class="dropdown-item">${{getSaleTax(vehicle)}} ({{this.company.taxRate *
                                                100}}% of
                                                {{getVehicleTotalEstimates(vehicle)}})</a>
                                            <div class="dropdown-divider"></div>

                                            <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle,
                                                jobs)}}</a>
                                            <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                        <div class="d-lg-flex align-items-center justify-content-between px-1 mt-3">
                            <div class="d-flex align-items-center gap-3 w-80 v-receipt">
                                <select class="form-select h-48 px-3 border-radius-8"
                                    [(ngModel)]="vehicle.paymentMethod" #paymentMethod title="Payment Methods"
                                    (change)="onChangeVehiclePaymentMethod($event, paymentMethod.value)">
                                    <option value="0" disabled selected>Select Payment Method</option>
                                    <option [value]="paymentMethod.id"
                                        *ngFor="let paymentMethod of paymentMethods;let i=index;">
                                        {{paymentMethod.name}}</option>
                                </select>
                                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="disclaimerId"
                                    #optionDisclaimerId title="Disclaimers" (change)="onChangeDisclaimer($event)">
                                    <option value="0" disabled selected>Select Disclaimer</option>
                                    <option [value]="disclaimer.id" *ngFor="let disclaimer of disclaimers;let i=index;">
                                        {{disclaimer.name}} <span *ngIf="disclaimer.isDefault ==true">(default)</span>
                                    </option>
                                </select>
                                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="warrantyId"
                                    #optionWarrantyId title="Warranties" (change)="OnChangeWarranty($event)">
                                    <option value="0" disabled selected>Select Warranty</option>
                                    <option [value]="warranty.id" [selected]="warranty.isDefault == true"
                                        *ngFor="let warranty of warranties;let i=index;">
                                        {{warranty.name}} <span *ngIf="warranty.isDefault ==true">(default)</span>
                                    </option>
                                </select>
                                <div class="form-check form-switch d-flex ms-3 mw-150">
                                    <input class="form-check-input mt-0" type="checkbox" role="switch" id="tax"
                                        title="Apply Tax or No Tax" (change)="onChangeNoTax($event)" />
                                    <label class="form-check-label fa-13 mt-1 ms-4" for="tax">No Tax</label>
                                </div>
                            </div>
                            <div class="add-r">
                                <button *ngIf="user.allowAddReceipt == true"
                                    class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4" type="button"
                                    (click)="createReceipt()"><i class="fa fa-plus me-2"></i> Add Receipt Item</button>
                                <button [disabled]="receipts.length == 0"
                                    (click)="printPage('print-content-receipt', 'Receipt')"
                                    class="h-40 fs-13 mt-2 btn btn-secondary-abs px-4 border-radius-4 ms-md-3"><i
                                        class="fa fa-print me-2"></i> Print Receipt</button>

                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="mt-4 pt-1">
                                <div class="col-12 p-3 bg-white shadow border border-radius-8">

                                    <div class="table-responsive jobs-table bg-white border-radius-8 shadow" cdkDropList
                                        (cdkDropListDropped)="droppedReceipt($event)">
                                        <table class="table table-bordered border-radius-8 w-100">
                                            <thead>
                                                <tr>

                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                                        style="width: 50px;">#
                                                    </th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">
                                                        Item</th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                                        style="width: 50px;">EID
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                        title="Click to go to Configuration"
                                                        [routerLink]="'/item-types'"
                                                        style="cursor:pointer; width:150px">Item Type</th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                                                        style="width: 50px;">
                                                        Quantity</th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                        style="width:100px"><i class="fa-solid fa-dollar-sign"></i></th>

                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                                        style="width: 100px;">Subtotal</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                        <i class="fa-solid fa-clock"></i>
                                                    </th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                        <i class="fa-solid fa-user"></i>
                                                    </th>
                                                    <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                                        style="width:100px;">
                                                        Action
                                                    </th>
                                                </tr>


                                            </thead>
                                            <tbody>
                                                <tr class="alert-info" *ngFor="let receipt of receipts; let i=index"
                                                    (click)="setReceiptId(receipt.id)"
                                                    [style.background-color]="receipt.id == currentReceiptId? '#FFF3CD' : (true ? '#CFF4FC' : '#CFF4FC')">

                                                    <td class="fs-13 p-2 text-center v-align-middle"
                                                        [cdkDragDisabled]="isMobile==true" cdkDrag
                                                        title="Drag and drop index number to change the order">
                                                        {{i+1}}
                                                    </td>
                                                    <td class="fs-13 p-2"
                                                        [attr.title]="{'Please specify item information':receipt.notes == ''|| receipt.notes == null }">
                                                        <textarea [(ngModel)]="receipt.notes" class="form-control"
                                                            [ngClass]="{'blink border-danger': receipt.notes == ''|| receipt.notes == null }"
                                                            placeholder="Please Specify"
                                                            (keyup.enter)="onEnterReceipt('notes',receipt)" rows="1"
                                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                                            maxlength="200"
                                                            [disabled]="user.allowAddReceipt == false"></textarea>
                                                    </td>
                                                    <td class="fs-13 p-2 fw-500 text-center v-align-middle"
                                                        title="Click to view estimate item">
                                                        <span *ngIf="receipt.claimId > 0"
                                                            (click)="openTab('claims-tab')">{{receipt.claimId}}</span>
                                                    </td>
                                                    <td class="p-2 text-center">
                                                        <select class="form-select h-48 px-3 border-radius-8"
                                                            [disabled]="user.allowAddReceipt == false"
                                                            [(ngModel)]="receipt.itemType"
                                                            (change)="onEnterReceipt('item type',receipt)">
                                                            <option value="0" disabled selected>Select Type</option>
                                                            <option value="0" *ngIf="receipt.itemType > 0">Un-select
                                                                Type</option>
                                                            <option [value]="itemType.id"
                                                                *ngFor="let itemType of itemTypes;let i=index;">
                                                                {{itemType.name}}
                                                            </option>
                                                        </select>
                                                    </td>
                                                    <td class="fs-13 p-2"><input
                                                            (keyup.enter)="onEnterReceipt('quantity',receipt)"
                                                            [(ngModel)]="receipt.quantity"
                                                            onKeyPress="if(this.value.length==10) return false"
                                                            pattern="[0-9]" type="number"
                                                            class="form-control form-control-sm h-40 border-radius-4" />
                                                    </td>
                                                    <td class="fs-13 p-2"><input
                                                            (keyup.enter)="onEnterReceipt('amount',receipt)"
                                                            [(ngModel)]="receipt.amount"
                                                            onKeyPress="if(this.value.length==10) return false"
                                                            pattern="[0-9]" type="number"
                                                            class="form-control form-control-sm h-40 border-radius-4" />
                                                    </td>

                                                    <td class="fs-13 p-2 text-center v-align-middle">
                                                        ${{getReceiptSubTotal(receipt)}}</td>
                                                    <td class="fs-13 p-2 text-center v-align-middle">
                                                        {{receipt.createdAt | date: 'MM/dd/yyyy HH:mm'}}
                                                    </td>
                                                    <td class="fs-13 p-2 text-center  v-align-middle">
                                                        <ng-container *ngFor="let user of users;let i=index;">
                                                            <span *ngIf="user.id == receipt.userId">
                                                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                            </span>
                                                        </ng-container>


                                                    </td>
                                                    <td class="p-2 text-center">
                                                        <div
                                                            class="d-flex align-items-center justifyc-cntent-center gap-2">
                                                            <button class="btn btn-outline-danger btn-sm"
                                                                [disabled]="user.allowAddReceipt == false"
                                                                title="Delete"
                                                                (click)="deleteVehicleReceipt(null, receipt)"><i
                                                                    class="fa fa-trash"></i></button>
                                                            <button class="btn btn-outline-success btn-sm"
                                                                [disabled]="user.allowAddReceipt == false" title="Save"
                                                                (click)="onEnterReceipt('update', receipt)"><i
                                                                    class="fa fa-save"></i></button>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-lg-6 col-md-8">
                                <div *ngIf="getSubtotal() > 0">
                                    <h3 class="fs-20 fw-700 my-3">Payment Method</h3>
                                    <ng-container *ngFor="let paymentMethod of this.paymentMethods">
                                        <p class="fs-14" *ngIf="paymentMethod.id==vehicle.paymentMethod">
                                            {{paymentMethod.name}}</p>
                                    </ng-container>
                                </div>
                                <h3 class="fs-20 fw-700 my-4 pt-3" *ngIf="warrantyText != ''">Warranties</h3>
                                <p [innerHtml]=" warrantyText" *ngIf="warrantyText != ''"
                                    class="wave fs-13 line-height-130">
                                </p>
                                <h3 class="fs-20 fw-700 my-4 pt-3">Terms &amp; Conditions</h3>
                                <p [innerHtml]="disclaimerText" *ngIf="disclaimerText != ''"
                                    class="wave fs-13 line-height-130"></p>
                            </div>
                            <div class="col-lg-3 col-md-12"></div>
                            <div class="col-lg-3 col-md-4" *ngIf="getSubtotal() > 0">
                                <ul>
                                    <li class="d-flex justify-content-between my-4"><strong
                                            class="fs-15">Subtotal:</strong>
                                        <p class="fs-15 text-black px-1 fw-700">${{getSubtotal()}}</p>
                                    </li>
                                    <li class="d-flex justify-content-between my-4"><strong class="fs-15">Tax
                                            ({{company.taxRate
                                            *100}}%):</strong>
                                        <p class="fs-15 text-black  px-1 fw-700">${{getTax() }}</p>
                                    </li>
                                    <li
                                        class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">
                                        <strong class="fs-15">Total:</strong>
                                        <p class="fs-15 px-1">${{getTotal()}}</p>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <br />
                        <br />
                    </div>

                    <!-- History Tab -->
                    <div class="tab-pane" id="history" role="tabpanel" aria-labelledby="history-tab">
                        <div class="d-lg-flex align-items-center justify-content-between px-1 mt-3">
                            <h2 class="heading-color fw-700 text-uppercase pt-5 fs-16 pb-3">Vehicle Histories for:
                                <strong class="text-primary fw-700" title="Click to view details">{{vehicle.year}}
                                    {{vehicle.make}}
                                    {{vehicle.model}} {{vehicle.color}} ({{vehicleHistories.length}})</strong>
                            </h2>

                            <div class="add-r">
                                <button class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4" type="button"
                                    (click)="getVehicleHistory(vehicle.id)"><i class="fa fa-list me-2"></i> Get Change
                                    Histories</button>

                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="mt-4 pt-1">
                                <div class="col-12 p-3 bg-white shadow border border-radius-8">
                                    <div class="table-responsive border shadow border-radius-8">
                                        <table class="table table-bordered w-100">

                                            <tbody>

                                                <tr class="bg-navy text-white">
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                        #</th>

                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-200">
                                                        Time</th>


                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                                                        Type</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">
                                                        Description</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">
                                                        On</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">
                                                        Image(?)</th>

                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mxw-200">
                                                        Value</th>
                                                    <th
                                                        class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100">
                                                        User</th>


                                                </tr>
                                                <tr *ngFor="let vehicleHistory of vehicleHistories; let i=index"
                                                    [ngClass]="{'bg-info': vehicleHistory.employeeId > 0}"
                                                    class="v-align-middle text-center">
                                                    <td class="fs-14 text-center"><span
                                                            title="vehicleHistory.id = [{{vehicleHistory.id}}]">{{i+1}}</span>
                                                    </td>

                                                    <td class="fs-14 text-center">{{vehicleHistory.createdAt | date:
                                                        'MM/dd/yyyy, HH:mm'}}
                                                    </td>


                                                    <td class="fs-14 text-center"><i
                                                            class="{{vehicleHistory.iconClassString}} {{vehicleHistory.colorClassString}}"></i>
                                                    </td>
                                                    <td class="fs-14 text-center">{{vehicleHistory.name}}</td>

                                                    <td class="fs-14 text-center"><i
                                                            class="{{vehicleHistory.iconName}}"></i></td>
                                                    <td class="fs-14 text-center"> <ng-container
                                                            *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==1">
                                                            <img src="{{baseUrlResizeImage + '/' + vehicleHistory.objectKey}}"
                                                                height="40" alt="Image"
                                                                class="object-fill rounded-1 w-100" />
                                                        </ng-container>
                                                        <ng-container
                                                            *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==2">
                                                            <img src="{{baseUrlResizeImageParts + '/' + vehicleHistory.objectKey}}"
                                                                height="40" alt="Image"
                                                                class="object-fill rounded-1 w-100" />
                                                        </ng-container>
                                                        <ng-container
                                                            *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==3">
                                                            <img src="{{baseUrlResizeImageJobs + '/' + vehicleHistory.objectKey}}"
                                                                height="40" alt="Image"
                                                                class="object-fill rounded-1 w-100" />
                                                        </ng-container>
                                                        <ng-container
                                                            *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==5">
                                                            <img src="{{baseUrlResizeImagePayments + '/' + vehicleHistory.objectKey}}"
                                                                height="40" alt="Image"
                                                                class="object-fill rounded-1 w-100" />
                                                        </ng-container>
                                                    </td>

                                                    <td class="fs-14 text-center" style="word-break: break-word;">
                                                        {{vehicleHistory.value}}
                                                        <ng-container *ngIf="vehicleHistory.employeeId > 0">
                                                            <span> By </span><span class="fw-500 text-danger">
                                                                [{{getEmployeeName(vehicleHistory.employeeId) |
                                                                shortName }}]</span>
                                                        </ng-container>

                                                    </td>
                                                    <td class="fs-14 text-center">
                                                        <ng-container *ngIf="vehicleHistory.employeeId > 0">
                                                            <span
                                                                class="fw-500 text-danger">{{getEmployeeName(vehicleHistory.employeeId)|
                                                                shortName
                                                                }}</span>
                                                        </ng-container>
                                                        <ng-container *ngIf="vehicleHistory.employeeId == 0">
                                                            {{vehicleHistory.userName | shortName}}
                                                        </ng-container>
                                                    </td>


                                                </tr>

                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br />
                        <br />
                    </div>
                </div>
            </div>
        </div>

        <!-- Print Styles -->
        <style>
            @media print {

                .btn,
                .card-header,
                .card-footer {
                    display: none !important;
                }

                .table {
                    font-size: 12px;
                }

                .badge {
                    color: #000 !important;
                    background-color: #fff !important;
                    border: 1px solid #000 !important;
                }
            }
        </style>