<div class="container-fluid">
  <section class="content-header">
    <div class="container-fluid">
      <div class="row mb-2">
        <div class="col-sm-6">
          <div class="modal fade" id="staticBackdropLive" data-bs-backdrop="static" data-bs-keyboard="false"
            tabindex="-1" aria-labelledby="staticBackdropLiveLabel" aria-hidden="true" style="display: none;">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="staticBackdropLiveLabel">Repair Order</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"> </button>
                </div>
                <div class="modal-body">
                  <div id="print-content">
                    <div id="componentID" class="container-fluid">
                      <div class="container-fluid">
                        <div id="componentID2" class="container-fluid">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                                <h3 class="fs-20 fw-300 line-height-150">{{this.company.name}}, Inc.<br />
                                  <span class="fs-13" [innerHtml]="company.slogan"></span>
                                </h3>
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-4">
                              <p class="fs-15 d-block my-3">Repair Order</p>
                              <ng-container *ngFor="let employee of this.employees">
                                <ng-container *ngIf="employee.id==this.currentEmplyeeId">
                                  <h3 class="fs-20 fw-700 my-3">{{employee.firstName}} {{employee.lastName}}</h3>
                                  <p class="fs-15 d-block my-3"> {{employee.phone}}</p>
                                  <br>
                                  <ng-container *ngFor="let role of this.employeeRoles">
                                    <ng-container *ngIf="role.id==employee.roleId">
                                      <p class="fs-15 d-block my-3">{{role.name}} </p>
                                      <br>
                                    </ng-container>
                                  </ng-container>
                                </ng-container>
                              </ng-container>

                            </div>
                            <div class="col-md-6 col-sm-6 mb-4 text-end">
                              <p class="fs-15 d-block my-3">Repair Order</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                <div [innerHtml]="company.slogan"></div>
                              </h3>
                              <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                              <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                {{this.company.email}}</p>
                              <p class="fs-15 d-block my-3 fw-700">Repair Order for Vehicle #{{vehicleJob.id}}</p>
                              <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                  class="text-danger">{{vehicleJob.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped">
                                <thead class="bg-navy">
                                  <tr class="bg-navy">
                                    <th class="bg-navy mw-100 fs-14 text-white py-3"> Item</th>
                                    <th class="bg-navy mw-100 fs-14 text-white py-3"> Info</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Vehicle</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.year}} {{vehicleJob.make}}
                                      {{vehicleJob.model}}
                                      {{vehicleJob.color}}</td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Specification</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.description}}</td>
                                  </tr>
                                  <tr *ngIf="vehicleJob.vin != ''">
                                    <td class="fs-13 py-3"><strong>VIN</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.vin}} </td>
                                  </tr>
                                  <tr *ngIf="vehicleJob.plate != ''">
                                    <td class="fs-13 py-3"><strong>License Plate</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.plate}} </td>
                                  </tr>
                                  <tr *ngIf="vehicleJob.priorDamage != ''">
                                    <td class="fs-13 py-3"><strong>Prior Damanages</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.priorDamage}} </td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-13 py-3" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Work Request</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.workRequest}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row" *ngIf="vehicleJob.jobs.length >0">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped">
                                <thead class="bg-navy">
                                  <tr class="bg-navy">
                                    <th class="bg-navy mw-100 fs-14 text-white py-3"> #</th>
                                    <th class="bg-navy mw-130 fs-14 text-white py-3"> Job Item</th>
                                    <th class="bg-navy mw-130 fs-14 text-white py-3"> Instructions</th>
                                    <th class="bg-navy mw-100 fs-14 text-white py-3"> Deadline</th>
                                    <th class="bg-navy mw-100 fs-14 text-white py-3"> Status</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let job of vehicleJob.jobs; let i=index">
                                    <td class="fs-13 py-3"> {{job.id}}</td>
                                    <td class="fs-13 py-3"> {{job.name}}</td>
                                    <td class="fs-13 py-3"> {{job.notes}}</td>
                                    <td class="fs-13 py-3"> {{job.targetDate | date: 'MM/dd/yyyy'}}</td>
                                    <ng-container *ngIf="job.status ==0">
                                      <td class="fs-13 py-3"> Not Completed</td>
                                    </ng-container>
                                    <ng-container *ngIf="job.status ==1">
                                      <td class="fs-13 py-3"> Completed</td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                          <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="print-content-job">
                    <div id="componentID" class="container-fluid">
                      <div class="container-fluid">
                        <div id="componentID2" class="container-fluid">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3"></div>

                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Printed
                                on Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-4">
                              <p class="fs-15 d-block my-3"> </p>


                            </div>
                            <div class="col-md-6 col-sm-6 mb-4 text-end">
                              <p class="fs-15 d-block my-3"></p>
                              <h2 class="fs-17, fw-700">JOB ORDER # {{this.job.id}}</h2>


                              <p class="fs-15 d-block my-3">Issued By: <strong>{{user.firstName}}
                                  {{user.lastName}}</strong> <br>
                              </p>

                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive tt">
                              <table class="table table-bordered" style="border:2px solid">

                                <tbody>
                                  <tr style="border:2px solid">
                                    <td class="fs-17 py-3"><strong>Vehicle</strong></td>
                                    <td class="fs-17 py-3 "><strong>{{vehicleJob.year}} {{vehicleJob.make}}
                                        {{vehicleJob.model}}
                                        {{vehicleJob.color}} </strong></td>
                                  </tr>

                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-13 py-3" *ngIf="jobRequestType.id == vehicleJob.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Work Request</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.workRequest}} </td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Vehicle Due day</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.targetDate | date: 'MM/dd/yyyy'}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row" *ngIf="this.job.id> 0">
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <div class="col-12 table-responsive tt">
                              <table class="table table-bordered" style="border:2px solid">

                                <tbody>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Job # </strong></td>
                                    <td class="fs-13 py-3 fw-700"> {{this.job.id}}</td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Job Name</strong></td>
                                    <td class="fs-13 py-3"> {{this.job.name}}</td>
                                  </tr>
                                  <tr style="border:2px solid; min-height: 100px;">
                                    <td class="fs-13 py-3"><strong>Description</strong></td>
                                    <td class="fs-13 py-3"> {{this.job.notes}}</td>
                                  </tr>
                                  <tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3" style="background-color:lightgray">
                                      <strong>Technician</strong>
                                    </td>
                                    <td class="fs-13 py-3"><ng-container *ngFor="let employee of this.employees">
                                        <ng-container *ngIf="employee.id==job.employeeId">
                                          <ng-container *ngFor="let role of this.employeeRoles">
                                            <ng-container *ngIf="role.id==employee.roleId">
                                              <strong class="capitalized">{{employee.firstName}}
                                                {{employee.lastName}}</strong> <small> {{role.name}}</small> <br>
                                            </ng-container>
                                          </ng-container>
                                        </ng-container>
                                      </ng-container></td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Hours</strong></td>
                                    <td class="fs-13 py-3"> {{this.job.hours}}</td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Value $</strong></td>
                                    <td class="fs-13 py-3"> {{this.job.price}}</td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Start Date</strong></td>
                                    <td class="fs-13 py-3"> {{this.job.startDate | date: 'MM/dd/yyyy'}}</td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Target</strong></td>
                                    <td class="fs-13 py-3"> {{this.job.targetDate | date: 'MM/dd/yyyy'}}</td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Finish Date</strong></td>
                                    <td class="fs-13 py-3"> {{this.job.endDate | date: 'MM/dd/yyyy'}}</td>
                                  </tr>
                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Status</strong></td>
                                    <ng-container *ngIf="this.job.status ==0">
                                      <td class="fs-13 py-3"> Not Completed</td>
                                    </ng-container>
                                    <ng-container *ngIf="this.job.status ==1">
                                      <td class="fs-13 py-3"> Completed</td>
                                    </ng-container>
                                  </tr>

                                  <tr style="border:2px solid">
                                    <td class="fs-13 py-3"><strong>Authorized By </strong></td>
                                    <td class="fs-13 py-3"></td>
                                  </tr>

                                </tbody>
                              </table>
                            </div>
                          </div>
                          <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                          <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="print-content-jobs">
                    <div id="componentID" class="container-fluid">
                      <div class="container-fluid">
                        <div id="componentID2" class="container-fluid">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                                <h3 class="fs-20 fw-300 line-height-150">{{this.company.name}}, Inc.<br />
                                  <span class="fs-13" [innerHtml]="company.slogan"></span>
                                </h3>
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <!-- <div class="col-md-6 col-sm-6 mb-4">
                              <p class="fs-15 d-block my-3">Repair Order</p>
                              <ng-container *ngFor="let employee of this.employees">
                                <ng-container *ngIf="employee.id==this.currentEmplyeeId">
                                  <h3 class="fs-20 fw-700 my-3">{{employee.firstName}} {{employee.lastName}}</h3>
                                  <p class="fs-15 d-block my-3"> {{employee.phone}}</p>
                                  <br>
                                  <ng-container *ngFor="let role of this.employeeRoles">
                                    <ng-container *ngIf="role.id==employee.roleId">
                                      <p class="fs-15 d-block my-3">{{role.name}} </p>
                                      <br>
                                    </ng-container>
                                  </ng-container>
                                </ng-container>
                              </ng-container>

                            </div> -->
                            <!-- <div class="col-md-6 col-sm-6 mb-4 text-end">
                              <p class="fs-15 d-block my-3">Repair Order [{{this.job.id}}]</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                <div [innerHtml]="company.slogan"></div>
                              </h3>
                              <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                              <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                {{this.company.email}}</p>
                              <p class="fs-15 d-block my-3 fw-700">Repair Order for Vehicle #{{vehicleJob.id}}</p>
                              <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                  class="text-danger">{{vehicleJob.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                            </div> -->
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive tt">
                              <table class="table table-striped">
                                <thead class="bg-navy">
                                  <tr class="bg-navy">
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> Item</th>
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> Info</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Vehicle</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.year}} {{vehicleJob.make}}
                                      {{vehicleJob.model}}
                                      {{vehicleJob.color}}</td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Specification</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.description}}</td>
                                  </tr>
                                  <tr *ngIf="vehicleJob.vin != ''">
                                    <td class="fs-13 py-3"><strong>VIN</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.vin}} </td>
                                  </tr>
                                  <tr *ngIf="vehicleJob.plate != ''">
                                    <td class="fs-13 py-3"><strong>License Plate</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.plate}} </td>
                                  </tr>
                                  <tr *ngIf="vehicleJob.priorDamage != ''">
                                    <td class="fs-13 py-3"><strong>Prior Damanages</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.priorDamage}} </td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-13 py-3" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Work Request</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.workRequest}} </td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Since</strong></td>
                                    <td class="fs-13 py-3"> {{vehicleJob.createdAt | date}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row" *ngIf="this.jobs.length >0">
                            <div class="col-12 table-responsive tt">
                              <table class="table table-striped">
                                <thead class="bg-navy">
                                  <tr class="bg-navy">
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> #</th>
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> Job Item</th>
                                    <th class="bg-navy mw-130 fs-14 text-black py-3"> Instructions</th>
                                    <th class="bg-navy mw-130 fs-14 text-black py-3"> Assigned To</th>
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> Hours</th>
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> Value $</th>
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> Deadline</th>
                                    <th class="bg-navy mw-100 fs-14 text-black py-3"> Status</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let job of this.jobs; let i=index">
                                    <td class="fs-13 py-3"> {{job.id}}</td>
                                    <td class="fs-13 py-3"> {{job.name}}</td>
                                    <td class="fs-13 py-3"> {{job.notes}}</td>
                                    <ng-container *ngFor="let employee of this.employees">
                                      <ng-container *ngIf="employee.id==job.employeeId">
                                        <ng-container *ngFor="let role of this.employeeRoles">
                                          <ng-container *ngIf="role.id==employee.roleId">
                                            <td class="fs-13 py-3"> {{employee.firstName}}
                                              {{employee.lastName}} <br>
                                              <small>{{role.name}}</small>
                                            </td>
                                          </ng-container>
                                        </ng-container>
                                      </ng-container>
                                    </ng-container>
                                    <td class="fs-13 py-3"><span *ngIf="job.hours > 0">{{job.hours}}</span></td>
                                    <td class="fs-13 py-3"> {{job.price}}</td>
                                    <td class="fs-13 py-3"> {{job.targetDate | date: 'MM/dd/yyyy'}}</td>
                                    <ng-container *ngIf="job.status ==0">
                                      <td class="fs-13 py-3"> Not Completed</td>
                                    </ng-container>
                                    <ng-container *ngIf="job.status ==1">
                                      <td class="fs-13 py-3"> Completed</td>
                                    </ng-container>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                          <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="print-content-estimate" style="background-color:white">
                    <div id="componentID" class="container-fluid" style="background-color:white">
                      <div class="container-fluid" style="background-color:white">
                        <div id="componentID2" class="container-fluid" style="background-color:white">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-dark pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-1">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-2">
                              <p class="fs-15 d-block my-1">Estimate To</p>
                              <h3 class="fs-20 fw-700 my-1">{{this.vehicle.customer.title}}
                                {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                              <p class="fs-17 d-block my-1 line-height-150">
                                {{this.vehicle.customer.street}},
                                {{this.vehicle.customer.city}}, <br />
                                {{this.vehicle.customer.zip}},
                                {{this.vehicle.customer.state}}.</p>
                              <p class="fs-15 d-block my-1"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                            </div>
                            <div class="col-md-6 col-sm-6 mb-2 text-end">
                              <p class="fs-15 d-block my-1">Estimate From</p>
                              <h3 class="fs-20 fw-700 my-1">{{this.company.name}}<br />
                              </h3>
                              <p class="fs-17 d-block my-1 line-height-150">
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-17 d-block my-1">{{formatPhoneNumber(this.company.phone)}}</p>

                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped">
                                <tbody>
                                  <tr>
                                    <td class="fs-15"><strong>Vehicle</strong></td>
                                    <td class="fs-15"> {{vehicle.year}}
                                      {{vehicle.make}}
                                      {{vehicle.model}}
                                      {{vehicle.color}}</td>
                                    <td class="fs-15"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-15" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>

                                    <td class="fs-15"><strong>Mileage Out</strong></td>
                                    <td class="fs-15"> {{vehicle.miles}}</td>
                                  </tr>

                                  <tr>
                                    <td class="fs-15"><strong>Work Request</strong></td>
                                    <td class="fs-15" colspan="5"> {{vehicle.workRequest}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row" *ngIf="claims.length >0">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped w-100">
                                <thead>
                                  <tr class="bg-white">
                                    <th class="mw-50 fs-14 fw-700 text-black py-3"> #</th>

                                    <th class="mw-150 fs-14 fw-700 text-black py-3"> Description</th>
                                    <th class="mw-150 fs-14 fw-700 text-black py-3"> Type</th>
                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Quantity</th>
                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Amount</th>

                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Subtotal</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let claim of claims; let i=index">
                                    <td class="fs-13 py-3">{{i +1}}</td>


                                    <td class="fs-13 py-3"> {{claim.notes}}</td>
                                    <td class="fs-13 py-3">
                                      <ng-container *ngFor="let itemType of this.itemTypes">
                                        <ng-container *ngIf="itemType.id == claim.itemType">
                                          <span>{{itemType.name}}</span>
                                        </ng-container>
                                      </ng-container>
                                    </td>
                                    <td class="fs-13 py-3">{{claim.quantity }}</td>
                                    <td class="fs-13 py-3">${{claim.amount }}</td>

                                    <td class="fs-13 py-3">${{getClaimSubTotal(claim) }}</td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-lg-6 col-md-8 col-sm-8">
                              <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                    class="text-danger">{{currentDate|
                                    date}}</span></small> </div>
                              <ng-container *ngFor="let paymentMethod of this.paymentMethods">
                                <p class="lead" *ngIf="paymentMethod.id==vehicle.paymentMethod"> Paid By
                                  {{paymentMethod.name}} </p>
                              </ng-container>
                            </div>
                            <div class="col-lg-3 col-md-12 hide-sm"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4">
                              <ul>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-18">Subtotal:</strong>
                                  <p class="fs-18 text-black opacity-75">${{getSubtotalClaims()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-18">Tax
                                    ({{company.taxRate
                                    *100}}%):</strong>
                                  <p class="fs-15 text-black opacity-75">${{getTaxClaim() }}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Total Estimates: </strong>
                                  <p class="fs-18 fw-700">${{getTotalClaims()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Total Payments: </strong>
                                  <p class="fs-18 fw-700">${{getTotalPayments()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Balance: </strong>
                                  <p class="fs-18 fw-700">${{getTotalBalance()}}</p>
                                </li>
                              </ul>
                            </div>
                            <div class="col-12 mt-5">
                              <div [innerHtml]="warrantyText"></div>
                              <br>
                              <div [innerHtml]="disclaimerText"></div>
                              <div class="ps-3 pe-3 pb-3 pt-5">
                                <div class="d-flex align-items-end justify-content-between">
                                  <div class="d-flex gap-2">
                                    <p>Signature</p>
                                    <span>_________________________________</span>
                                  </div>
                                  <div class="d-flex gap-2 mt-30-mob">
                                    <p>Date</p>
                                    <span>_________________________________</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="print-ai-estimate" style="background-color:white">
                    <div id="componentID" class="container-fluid" style="background-color:white">
                      <div class="container-fluid" style="background-color:white">
                        <div id="componentID2" class="container-fluid" style="background-color:white">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-dark pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-1">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-2">
                              <p class="fs-15 d-block my-1">Estimate To</p>
                              <h3 class="fs-20 fw-700 my-1">{{this.vehicle.customer.title}}
                                {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                              <p class="fs-17 d-block my-1 line-height-150">
                                {{this.vehicle.customer.street}},
                                {{this.vehicle.customer.city}}, <br />
                                {{this.vehicle.customer.zip}},
                                {{this.vehicle.customer.state}}.</p>
                              <p class="fs-15 d-block my-1"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                            </div>
                            <div class="col-md-6 col-sm-6 mb-2 text-end">
                              <p class="fs-15 d-block my-1">Estimate From</p>
                              <h3 class="fs-20 fw-700 my-1">{{this.company.name}}<br />
                              </h3>
                              <p class="fs-17 d-block my-1 line-height-150">
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-17 d-block my-1">{{formatPhoneNumber(this.company.phone)}}</p>

                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped">
                                <tbody>
                                  <tr>
                                    <td class="fs-15"><strong>Vehicle</strong></td>
                                    <td class="fs-15"> {{vehicle.year}}
                                      {{vehicle.make}}
                                      {{vehicle.model}}
                                      {{vehicle.color}}</td>
                                    <td class="fs-15"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-15" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>

                                    <td class="fs-15"><strong>Mileage Out</strong></td>
                                    <td class="fs-15"> {{vehicle.miles}}</td>
                                  </tr>

                                  <tr>
                                    <td class="fs-15"><strong>Work Request</strong></td>
                                    <td class="fs-15" colspan="5"> {{vehicle.workRequest}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row mt-1">
                            <div class="mt-4 pt-1 px-0">
                              <table class="col-12 w-100 px-1 bg-white border-radius-8">
                                <tr class="text-center h-40 bg-secondary text-white">
                                  <th class="text-center v-align-middle mw-50"> # </th>
                                  <th class="text-center v-align-middle mw-50"> Ind </th>
                                  <th class="text-center v-align-middle  mw-100"> Oper </th>
                                  <th class="text-center v-align-middle"> Description </th>
                                  <th class="text-center v-align-middle" *ngIf="showEmployees == false"> Part Number
                                  </th>
                                  <th class="text-center v-align-middle" *ngIf="showEmployees == false"> Qty </th>
                                  <th class="text-center v-align-middle" *ngIf="showEmployees == false"> Ext.
                                    Price $
                                  </th>
                                  <th class="text-center v-align-middle mw-50"> Labor </th>
                                  <th class="text-center v-align-middle mw-50" *ngIf="showEmployees == true"><i
                                      class="fa-solid fa-home"></i> </th>
                                  <th class="text-center v-align-middle mw-50" *ngIf="showEmployees == true"><i
                                      class="fa-solid fa-dollar-sign"></i></th>
                                  <!-- <th class="text-center v-align-middle mw-50" *ngIf="showEmployees == false"> Paint
                                  </th> -->

                                </tr>
                                <ng-container *ngFor="let claim of estimateResponse.estimates; let i=index">
                                  <tr>
                                    <td class="text-center v-align-middle h-40 ">
                                      {{claim.index}}</td>
                                    <td colspan="9" class="v-align-middle h-40 fw-700 px-1">
                                      {{claim.notes}}</td>
                                  </tr>
                                  <tr *ngFor="let part of claim.autoparts; let j=index ">
                                    <td class="text-center v-align-middle">{{part.index}}</td>
                                    <td class="text-left v-align-middle">*</td>
                                    <td class="text-center v-align-middle">Repl</td>
                                    <td class="text-left v-align-middle text-primary">{{part.title}}</td>
                                    <td class="text-center v-align-middle">{{part.partNumber}}</td>
                                    <td class="text-center v-align-middle">1</td>
                                    <td class="text-right v-align-middle">{{part.price}}.00</td>
                                    <td class="text-right v-align-middle"></td>
                                    <!-- <td class="text-center v-align-middle">0.0</td> -->
                                  </tr>
                                  <tr *ngFor="let job of claim.jobs; let k=index ">
                                    <td class="text-center v-align-middle">{{job.index}}</td>
                                    <td class="text-left v-align-middle">**</td>
                                    <td class="text-center v-align-middle">
                                      <ng-container *ngFor="let jobOrderType of this.jobOrderTypes">
                                        <span *ngIf="job.jobRequestType == jobOrderType.id">{{jobOrderType.code}}</span>
                                      </ng-container>
                                    </td>
                                    <td class="text-left v-align-middle">{{job.notes}}</td>
                                    <td class="text-center v-align-middle"></td>
                                    <td class="text-center v-align-middle">1</td>
                                    <td class="text-right v-align-middle">{{job.price}}.00</td>
                                    <td class="text-right v-align-middle">{{job.hours}}</td>
                                  </tr>
                                  <tr>
                                    <td colspan="10">
                                      <hr>
                                    </td>
                                  </tr>
                                </ng-container>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-lg-6 col-md-8"></div>
                            <div class="col-lg-1 col-md-12"></div>
                            <div class="col-lg-5 col-md-4 p-0">
                              <ul>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-15">ESTIMATE
                                    TOTALS</strong>
                                </li>
                                <li *ngFor="let receipt of estimateResponse.receipts"
                                  class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                  <strong class="fs-15">{{receipt.notes}}:</strong>
                                  <p class="fs-15 px-1">${{receipt.amount}}</p>
                                </li>
                                <li
                                  class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                                  <strong class="fs-15">Total:</strong>
                                  <p class="fs-15 px-1">${{getReceiptTotal()}}</p>
                                </li>

                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- <div id="print-content-estimate" style="background-color:white">
                    <div id="componentID" class="container-fluid" style="background-color:white">
                      <div class="container-fluid" style="background-color:white">
                        <div id="componentID2" class="container-fluid" style="background-color:white">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                             
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-4">
                              <p class="fs-15 d-block my-3">Estimate To</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.vehicle.customer.title}}
                                {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                              <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p>
                              <p class="fs-15 d-block my-4 line-height-150" style="word-break: break-word;">
                                {{this.vehicle.customer.street}},
                                {{this.vehicle.customer.city}}, <br />
                                {{this.vehicle.customer.zip}},
                                {{this.vehicle.customer.state}}.</p>
                              <p class="fs-15 d-block my-3"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                            </div>
                            <div class="col-md-6 col-sm-6 mb-4 text-end">
                              <p class="fs-15 d-block my-3 pb-3">Estimate From</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                <small class="fs-15" [innerHtml]="company.slogan"></small>
                              </h3>
                              <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                              <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                {{this.company.email}}</p>
                              <p class="fs-15 d-block my-3 fw-700">Receipt for Vehicle #{{this.vehicle.id}}</p>
                              <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                  class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped">
                                <thead>
                                  <tr class="bg-white">
                                    <th class="mw-100 fs-14 fw-700 text-black py-3"> Item</th>
                                    <th class="mw-100 fs-14 fw-700 text-black py-3"> Info</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Vehicle</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.year}}
                                      {{vehicle.make}}
                                      {{vehicle.model}}
                                      {{vehicle.color}}</td>
                                  </tr>
                                  <tr *ngIf="vehicle.description != ''">
                                    <td class="fs-13 py-3"><strong>Specification</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.description}}</td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Mileage In</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.miles}}</td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-13 py-3" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Work Request</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.workRequest}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row" *ngIf="claims.length >0">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped w-100">
                                <thead>
                                  <tr class="bg-white">
                                    <th class="mw-50 fs-14 fw-700 text-black py-3"> #</th>
                                  
                                    <th class="mw-150 fs-14 fw-700 text-black py-3"> Description</th>
                                    <th class="mw-150 fs-14 fw-700 text-black py-3"> Type</th>
                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Quantity</th>
                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Amount</th>

                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Subtotal</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let claim of claims; let i=index">
                                    <td class="fs-13 py-3">{{i +1}}</td>
                                  
                                    <td class="fs-13 py-3">
                                      <ng-container *ngFor="let itemType of this.itemTypes">
                                        <ng-container *ngIf="itemType.id == claim.itemType">
                                          <span>{{itemType.name}}</span>
                                        </ng-container>
                                      </ng-container>
                                    </td>
                                    <td class="fs-13 py-3"> {{claim.notes}}</td>
                                    <td class="fs-13 py-3">{{claim.quantity }}</td>
                                    <td class="fs-13 py-3">${{claim.amount }}</td>

                                    <td class="fs-13 py-3">${{getClaimSubTotal(claim) }}</td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-lg-6 col-md-8 col-sm-8">
                              <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                    class="text-danger">{{currentDate|
                                    date}}</span></small> </div>
                              <ng-container *ngFor="let paymentMethod of this.paymentMethods">
                                <p class="lead" *ngIf="paymentMethod.id==vehicle.paymentMethod"> Paid By
                                  {{paymentMethod.name}} </p>
                              </ng-container>
                            </div>
                            <div class="col-lg-3 col-md-12 hide-sm"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4">
                              <ul>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-18">Subtotal:</strong>
                                  <p class="fs-18 text-black opacity-75">${{getSubtotalClaims()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-18">Tax
                                    ({{company.taxRate
                                    *100}}%):</strong>
                                  <p class="fs-15 text-black opacity-75">${{getTaxClaim() }}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Total Estimates: </strong>
                                  <p class="fs-18 fw-700">${{getTotalClaims()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Total Payments: </strong>
                                  <p class="fs-18 fw-700">${{getTotalPayments()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Balance: </strong>
                                  <p class="fs-18 fw-700">${{getTotalBalance()}}</p>
                                </li>
                              </ul>
                            </div>
                            <div class="col-12 mt-5">
                              <div [innerHtml]="warrantyText"></div>
                              <br>
                              <div [innerHtml]="disclaimerText"></div>
                              <div class="ps-3 pe-3 pb-3 pt-5">
                                <div class="d-flex align-items-end justify-content-between">
                                  <div class="d-flex gap-2">
                                    <p>Signature</p>
                                    <span>_________________________________</span>
                                  </div>
                                  <div class="d-flex gap-2 mt-30-mob">
                                    <p>Date</p>
                                    <span>_________________________________</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div> -->
                  <div id="print-content-estimate-invoice" style="background-color:white">
                    <div id="componentID" class="container-fluid" style="background-color:white">
                      <div class="container-fluid" style="background-color:white">
                        <div id="componentID2" class="container-fluid" style="background-color:white">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-4">
                              <p class="fs-15 d-block my-3">Estimate To</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.vehicle.customer.title}}
                                {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                              <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p>
                              <p class="fs-15 d-block my-4 line-height-150" style="word-break: break-word;">
                                {{this.vehicle.customer.street}},
                                {{this.vehicle.customer.city}}, <br />
                                {{this.vehicle.customer.zip}},
                                {{this.vehicle.customer.state}}.</p>
                              <p class="fs-15 d-block my-3"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>
                            </div>
                            <div class="col-md-6 col-sm-6 mb-4 text-end">
                              <p class="fs-15 d-block my-3 pb-3">Estimate From</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.company.name}}<br />
                                <small class="fs-15" [innerHtml]="company.slogan"></small>
                              </h3>
                              <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                              <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                {{this.company.email}}</p>
                              <p class="fs-15 d-block my-3 fw-700">Receipt for Vehicle #{{this.vehicle.id}}</p>
                              <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                  class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped">
                                <thead>
                                  <tr class="bg-white">
                                    <th class="mw-100 fs-14 fw-700 text-black py-3"> Item</th>
                                    <th class="mw-100 fs-14 fw-700 text-black py-3"> Info</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Vehicle</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.year}}
                                      {{vehicle.make}}
                                      {{vehicle.model}}
                                      {{vehicle.color}}</td>
                                  </tr>
                                  <tr *ngIf="vehicle.description != ''">
                                    <td class="fs-13 py-3"><strong>Specification</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.description}}</td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Mileage In</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.miles}}</td>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-13 py-3" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>
                                  </tr>
                                  <tr>
                                    <td class="fs-13 py-3"><strong>Work Request</strong></td>
                                    <td class="fs-13 py-3"> {{vehicle.workRequest}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row" *ngIf="filterClaims(1).length >0">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped w-100">
                                <thead>
                                  <tr class="bg-white">
                                    <th class="mw-50 fs-14 fw-700 text-black py-3"> #</th>
                                    <th class="mw-150 fs-14 fw-700 text-black py-3"> Description</th>
                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Type</th>
                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Quantity</th>
                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Amount</th>

                                    <th class="mw-80 fs-14 fw-700 text-black py-3"> Subtotal</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let claim of filterClaims(1); let i=index">
                                    <td class="fs-13 py-3">{{i +1}}</td>
                                    <td class="fs-13 py-3"> {{claim.notes}}</td>
                                    <td class="fs-13 py-3">
                                      <ng-container *ngFor="let itemType of this.itemTypes">
                                        <ng-container *ngIf="itemType.id == claim.itemType">
                                          <span>{{itemType.name}}</span>
                                        </ng-container>
                                      </ng-container>
                                    </td>
                                    <td class="fs-13 py-3">{{claim.quantity }}</td>
                                    <td class="fs-13 py-3">${{claim.amount }}</td>
                                    <td class="fs-13 py-3">${{getClaimSubTotal(claim) }}</td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-lg-6 col-md-8 col-sm-8">
                              <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                    class="text-danger">{{currentDate|
                                    date}}</span></small> </div>
                              <ng-container *ngFor="let paymentMethod of this.paymentMethods">
                                <p class="lead" *ngIf="paymentMethod.id==vehicle.paymentMethod"> Paid By
                                  {{paymentMethod.name}} </p>
                              </ng-container>
                            </div>
                            <div class="col-lg-3 col-md-12 hide-sm"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4">
                              <ul>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-18">Subtotal:</strong>
                                  <p class="fs-18 text-black opacity-75">${{getSubtotalClaimsLocked()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-18">Tax
                                    ({{company.taxRate
                                    *100}}%):</strong>
                                  <p class="fs-15 text-black opacity-75">${{getTaxClaimLocked() }}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Total Estimates: </strong>
                                  <p class="fs-18 fw-700">${{getTotalClaimsLocked()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Total Payments: </strong>
                                  <p class="fs-18 fw-700">${{getTotalPayments()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-18 fw-700">Balance: </strong>
                                  <p class="fs-18 fw-700">${{getTotalBalanceLocked()}}</p>
                                </li>
                              </ul>
                            </div>
                            <div class="col-12 mt-5">
                              <div [innerHtml]="warrantyText"></div>
                              <br>
                              <div [innerHtml]="disclaimerText"></div>
                              <div class="ps-3 pe-3 pb-3 pt-5">
                                <div class="d-flex align-items-end justify-content-between">
                                  <div class="d-flex gap-2">
                                    <p>Signature</p>
                                    <span>_________________________________</span>
                                  </div>
                                  <div class="d-flex gap-2 mt-30-mob">
                                    <p>Date</p>
                                    <span>_________________________________</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="print-content-receipt" style="background-color:white">
                    <div id="componentID" class="container-fluid" style="background-color:white">
                      <div class="container-fluid" style="background-color:white">
                        <div id="componentID2" class="container-fluid" style="background-color:white">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                                <!-- <h3 class="fs-20 fw-300 line-height-150">{{this.company.name}}, Inc.<br />
                                  <small class="fs-15" [innerHtml]="company.slogan"></small>
                                </h3> -->
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-dark pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-1">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-2">
                              <p class="fs-15 d-block my-1">Invoice To</p>
                              <h3 class="fs-20 fw-700 my-1">{{this.vehicle.customer.title}}
                                {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                              <!-- <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p> -->
                              <p class="fs-17 d-block my-1 line-height-150">
                                {{this.vehicle.customer.street}},
                                {{this.vehicle.customer.city}}, <br />
                                {{this.vehicle.customer.zip}},
                                {{this.vehicle.customer.state}}.</p>
                              <p class="fs-15 d-block my-1"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                            </div>
                            <div class="col-md-6 col-sm-6 mb-2 text-end">
                              <p class="fs-15 d-block my-1">Invoice From</p>
                              <h3 class="fs-20 fw-700 my-1">{{this.company.name}}<br />
                                <!-- <small class="fs-15" [innerHtml]="company.slogan"></small> -->
                              </h3>
                              <p class="fs-17 d-block my-1 line-height-150">
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-17 d-block my-1">{{formatPhoneNumber(this.company.phone)}}</p>
                              <!-- <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                {{this.company.email}}</p> -->
                              <!-- <p class="fs-15 d-block my-3 fw-700">Receipt for Vehicle #{{this.vehicle.id}}</p>
                              <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                  class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p> -->
                            </div>
                          </div>
                          <div class="row mt-3">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped">
                                <!-- <thead>
                                  <tr class="bg-white">
                                    <th class="mw-100 fs-14 fw-700 text-black">
                                      Item</th>
                                    <th class="mw-100 fs-14 fw-700 text-black">
                                      Info</th>
                                  </tr>
                                </thead> -->
                                <tbody>
                                  <tr>
                                    <td class="fs-15"><strong>Vehicle</strong></td>
                                    <td class="fs-15"> {{vehicle.year}}
                                      {{vehicle.make}}
                                      {{vehicle.model}}
                                      {{vehicle.color}}</td>
                                    <td class="fs-15"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-15" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>

                                    <td class="fs-15"><strong>Mileage Out</strong></td>
                                    <td class="fs-15"> {{vehicle.miles}}</td>

                                    <!-- <td class="fs-13"><strong>Specification</strong></td>
                                    <td class="fs-13"> {{vehicle.description}}</td> -->
                                  </tr>
                                  <!-- <tr *ngIf="vehicle.description != ''">
                                    <td class="fs-13"><strong>Specification</strong></td>
                                    <td class="fs-13"> {{vehicle.description}}</td>
                                  </tr> -->
                                  <tr>
                                    <!-- <td class="fs-13"><strong>Mileage Out</strong></td>
                                    <td class="fs-13"> {{vehicle.miles}}</td> -->
                                    <td class="fs-15"><strong>Work Request</strong></td>
                                    <td class="fs-15" colspan="5"> {{vehicle.workRequest}} </td>
                                  </tr>
                                  <!-- <tr>
                                    <td class="fs-13"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td class="fs-13" *ngIf="jobRequestType.id == vehicle.jobRequestType">
                                        {{jobRequestType.name}} </td>
                                    </ng-container>
                                  </tr> -->
                                  <!-- <tr>
                                    <td class="fs-13"><strong>Work Request</strong></td>
                                    <td class="fs-13"> {{vehicle.workRequest}} </td>
                                  </tr> -->
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row" *ngIf="receipts.length >0">
                            <div class="col-12 table-responsive">
                              <table class="table table-striped w-100">
                                <thead>
                                  <tr class="bg-white">
                                    <th class="mw-50 fs-16 fw-700 text-black"> #</th>
                                    <!-- <th class="mw-150 fs-14 fw-700 text-black py-3"> Item</th> -->
                                    <th class="mw-150 fs-16 fw-700 text-black"> Description</th>
                                    <th class="mw-150 fs-16 fw-700 text-black"> Type</th>
                                    <th class="mw-80 fs-16 fw-700 text-black"> Quantity</th>
                                    <th class="mw-80 fs-16 fw-700 text-black"> Amount</th>

                                    <th class="mw-80 fs-16 fw-700 text-black"> Subtotal</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr *ngFor="let receipt of receipts; let i=index">
                                    <td class="fs-15">{{i +1}}</td>
                                    <!-- <td class="fs-13">{{receipt.name}}</td> -->
                                    <td class="fs-15"> {{receipt.notes}}</td>
                                    <td class="fs-15">
                                      <ng-container *ngFor="let itemType of this.itemTypes">
                                        <ng-container *ngIf="itemType.id == receipt.itemType">
                                          <span>{{itemType.name}}</span>
                                        </ng-container>
                                      </ng-container>
                                    </td>
                                    <td class="fs-15">{{receipt.quantity }}</td>
                                    <td class="fs-15">${{receipt.amount }}</td>

                                    <td class="fs-15">${{getReceiptSubTotal(receipt) }}</td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-lg-6 col-md-8 col-sm-8">
                              <div> <small class="fw-bold d-block pt-2">Amount Due: <span
                                    class="text-danger">{{currentDate|
                                    date}}</span></small> </div>
                              <ng-container *ngFor="let paymentMethod of this.paymentMethods">
                                <p class="lead" *ngIf="paymentMethod.id==vehicle.paymentMethod"> Paid By
                                  {{paymentMethod.name}} </p>
                              </ng-container>
                            </div>
                            <div class="col-lg-3 col-md-12 hide-sm"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4">
                              <ul>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-20">Subtotal:</strong>
                                  <p class="fs-20 text-black opacity-75 fw-700">${{getSubtotal()}}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4"><strong class="fs-20">Tax
                                    ({{company.taxRate
                                    *100}}%):</strong>
                                  <p class="fs-20 text-black opacity-75 fw-7--">${{getTax() }}</p>
                                </li>
                                <li class="d-flex justify-content-between my-4 fw-700 text-black">
                                  <strong class="fs-20 fw-700">Total: </strong>
                                  <p class="fs-20 text-black opacity-75 fw-700">${{getTotal()}}</p>
                                </li>
                              </ul>
                            </div>
                            <div class="col-12 mt-5">
                              <div [innerHtml]="warrantyText"></div>
                              <br>
                              <div [innerHtml]="disclaimerText"></div>
                              <div class="ps-3 pe-3 pb-3 pt-5">
                                <div class="d-flex align-items-end justify-content-between">
                                  <div class="d-flex gap-2">
                                    <p>Signature</p>
                                    <span>_________________________________</span>
                                  </div>
                                  <div class="d-flex gap-2 mt-30-mob">
                                    <p>Date</p>
                                    <span>_________________________________</span>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="print-content-vehicle">
                    <div id="componentID" class="container-fluid">
                      <div class="container-fluid">
                        <div id="componentID2" class="container-fluid">
                          <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                                <h3 class="fs-20 fw-300 line-height-150">{{this.company.name}}, Inc.<br />
                                  <span class="fs-13" [innerHtml]="company.slogan"></span>
                                </h3>
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-4">
                              <p class="fs-15 d-block my-3">Invoice To</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.vehicle.customer.title}}
                                {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                              <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p>
                              <p class="fs-15 d-block my-4 line-height-150" style="word-break: break-word;">
                                {{this.vehicle.customer.street}},
                                {{this.vehicle.customer.city}}, <br />
                                {{this.vehicle.customer.zip}},
                                {{this.vehicle.customer.state}}.</p>
                              <p class="fs-15 d-block my-3"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                            </div>
                            <div class="col-md-6 col-sm-6 mb-4 text-end">
                              <p class="fs-15 d-block my-3">Invoice From</p>
                              <h3 class="fs-20 fw-700 my-3 pb-3">{{this.company.name}}<br />
                                <div [innerHtml]="company.slogan"></div>
                              </h3>
                              <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                              <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                {{this.company.email}}</p>
                              <p class="fs-15 d-block my-3 fw-700">ork Request for Vehicle #{{this.vehicle.id}}</p>
                              <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                  class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-12 table-responsive tt">
                              <table class="table table-bordered border-radius-8 overflow-hidden">
                                <thead>
                                  <tr class="bg-navy">
                                    <th style="background-color: rgb(13, 173, 226);"> Item</th>
                                    <th style="background-color: rgb(13, 173, 226);"> Info</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Vehicle</strong></td>
                                    <td style="border: 1px solid lightgray;"> {{vehicle.year}}
                                      {{vehicle.make}}
                                      {{vehicle.model}}
                                      {{vehicle.color}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Specification</strong></td>
                                    <td style="border: 1px solid lightgray;word-break:break-all">
                                      {{vehicle.description}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>VIN</strong></td>
                                    <td style="border: 1px solid lightgray;"> {{vehicle.vin}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td style="border: 1px solid lightgray;"
                                        *ngIf="jobRequestType.id == vehicle.jobRequestType"> {{jobRequestType.name}}
                                      </td>
                                    </ng-container>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Work Request</strong></td>
                                    <td style="border: 1px solid lightgray;word-break:break-all">
                                      {{vehicle.workRequest}} </td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Prior Damage</strong></td>
                                    <td style="border: 1px solid lightgray;word-break:break-all">
                                      {{vehicle.priorDamage}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p> </p>
                            </div>
                            <div class="col-6">
                              <p> </p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p> </p>
                            </div>
                            <div class="col-6">
                              <p> </p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p> </p>
                            </div>
                            <div class="col-6">
                              <p> </p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6"></div>
                            <div class="col-2 text-right">
                              <label>Signature:</label>
                            </div>
                            <div class="col-4"> _________________________________ </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p></p>
                            </div>
                            <div class="col-6">
                              <p></p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6"></div>
                            <div class="col-2 text-right">
                              <label>Date:</label>
                            </div>
                            <div class="col-4"> _________________________________ </div>
                          </div>
                          <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                          <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div id="print-content-vehicle-QRCode">
                    <div id="componentID" class="container-fluid">
                      <div class="container-fluid">
                        <div id="componentID2" class="container-fluid">
                          <div class="row">
                            <div class="col-12 mt-3">
                              <qrcode [qrdata]="url" id="qrcode" [width]="150" title="Scan it with your phone"
                                [errorCorrectionLevel]="'M'"></qrcode>
                            </div>
                          </div>
                          <!-- <div class="row">
                            <div class="col-lg-5 col-md-6 col-sm-6 mt-3">
                              <div class="d-flex align-items-center gap-3"> <img [src]="company.iconString"
                                  class="img-fluid rounded" alt="Company Logo" width="120" />
                                <h3 class="fs-20 fw-300 line-height-150">{{this.company.name}}, Inc.<br />
                                  <span class="fs-13" [innerHtml]="company.slogan"></span>
                                </h3>
                              </div>
                            </div>
                            <div class="col-lg-4 col-md-2 col-sm-2"></div>
                            <div class="col-lg-3 col-md-4 col-sm-4 mt-3"> <span
                                class="d-block bg-navy pt-3 pe-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">Date:
                                {{currentDate|date}}</span> </div>
                            <div class="col-12 mt-3">
                              <hr />
                            </div>
                            <div class="col-md-6 col-sm-6 mb-4">
                              <p class="fs-15 d-block my-3">Invoice To</p>
                              <h3 class="fs-20 fw-700 my-3">{{this.vehicle.customer.title}}
                                {{this.vehicle.customer.firstName}} {{this.vehicle.customer.lastName}} </h3>
                              <p class="fs-15 d-block my-3">{{this.vehicle.customer.email}}</p>
                              <p class="fs-15 d-block my-4 line-height-150" style="word-break: break-word;">
                                {{this.vehicle.customer.street}},
                                {{this.vehicle.customer.city}}, <br />
                                {{this.vehicle.customer.zip}},
                                {{this.vehicle.customer.state}}.</p>
                              <p class="fs-15 d-block my-3"> {{formatPhoneNumber(this.vehicle.customer.phone)}}</p>

                            </div>
                            <div class="col-md-6 col-sm-6 mb-4 text-end">
                              <p class="fs-15 d-block my-3">Invoice From</p>
                              <h3 class="fs-20 fw-700 my-3 pb-3">{{this.company.name}}<br />
                                <div [innerHtml]="company.slogan"></div>
                              </h3>
                              <p class="fs-15 d-block my-3 line-height-150">{{formatPhoneNumber(this.company.phone)}} -
                                {{this.company.street}}, {{this.company.city}}, {{this.company.zip}},
                                {{this.company.state}}.</p>
                              <p class="fs-15 d-block my-3 fw-700">{{formatPhoneNumber(this.company.phone)}}</p>
                              <p class="fs-15 d-block mb-3 mt-4 text-primary-abs" style="word-break: break-word;">
                                {{this.company.email}}</p>
                              <p class="fs-15 d-block my-3 fw-700">ork Request for Vehicle #{{this.vehicle.id}}</p>
                              <p class="fs-15 d-block my-3 fw-700"><b>Due Day:</b> <span
                                  class="text-danger">{{vehicle.targetDate| date: 'MM/dd/yyyy'}}</span></p>
                            </div>
                          </div> -->
                          <div class="row">
                            <div class="col-12 table-responsive tt">
                              <table class="table table-bordered border-radius-8 overflow-hidden">
                                <thead>
                                  <tr class="bg-navy">
                                    <th style="background-color: rgb(13, 173, 226);"> Item</th>
                                    <th style="background-color: rgb(13, 173, 226);"> Info</th>
                                  </tr>
                                </thead>
                                <tbody>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Vehicle</strong></td>
                                    <td style="border: 1px solid lightgray;"> {{vehicle.year}}
                                      {{vehicle.make}}
                                      {{vehicle.model}}
                                      {{vehicle.color}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Specification</strong></td>
                                    <td style="border: 1px solid lightgray;word-break:break-all">
                                      {{vehicle.description}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>VIN</strong></td>
                                    <td style="border: 1px solid lightgray;"> {{vehicle.vin}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>url</strong></td>
                                    <td style="border: 1px solid lightgray;"> {{vehicle.url}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Token</strong></td>
                                    <td style="border: 1px solid lightgray;"> {{vehicle.token}}</td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Job Type</strong></td>
                                    <ng-container *ngFor="let jobRequestType of this.jobRequestTypes">
                                      <td style="border: 1px solid lightgray;"
                                        *ngIf="jobRequestType.id == vehicle.jobRequestType"> {{jobRequestType.name}}
                                      </td>
                                    </ng-container>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Work Request</strong></td>
                                    <td style="border: 1px solid lightgray;word-break:break-all">
                                      {{vehicle.workRequest}} </td>
                                  </tr>
                                  <tr>
                                    <td style="border: 1px solid lightgray;"><strong>Prior Damage</strong></td>
                                    <td style="border: 1px solid lightgray;word-break:break-all">
                                      {{vehicle.priorDamage}} </td>
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p> </p>
                            </div>
                            <div class="col-6">
                              <p> </p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p> </p>
                            </div>
                            <div class="col-6">
                              <p> </p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p> </p>
                            </div>
                            <div class="col-6">
                              <p> </p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6"></div>
                            <div class="col-2 text-right">
                              <label>Signature:</label>
                            </div>
                            <div class="col-4"> _________________________________ </div>
                          </div>
                          <div class="row">
                            <div class="col-6">
                              <p></p>
                            </div>
                            <div class="col-6">
                              <p></p>
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-6"></div>
                            <div class="col-2 text-right">
                              <label>Date:</label>
                            </div>
                            <div class="col-4"> _________________________________ </div>
                          </div>
                          <p class="col-lg-7 col-md-7 col-sm-7 col-xs-7"></p>
                          <p class="col-lg-5 col-md-5 col-sm-5 col-xs-5"></p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- /.container-fluid -->
  </section>
</div>
<div>
  <div class="row nogot">
    <div class="my-fluid-col main-content col">
      <div class="row px-2 position-sticky common-bar-top">
        <nav class="navbar navbar-expand  border-radius-8 d-flex justify-content-between"
          style="background-color: #253052;">
          <button class="btn btn-outline-secondary" title="toggle reminders" (click)="toggleClass()"><i
              class="fa fa-bars text-secondary"></i></button>
          <ul class="navbar-nav d-flex align-items-center gap-5">
            <li class="search-bar">
              <div class="position-relative">
                <input type="text" class="form-control bg-light height-40 border-0" [(ngModel)]="searchInputArchived"
                  (input)="onSearchChange($event)"
                  placeholder="Search make or model or name for archived vehicles ..." />
                <div class="position-absolute end-0 top-0 mt-3 me-3">

                  <a (click)="searchVehicleArchived(9, 0, this.pageSize)"
                    title="Search archived vehicles with customer's last name" class="text-muted"><i
                      class="fa fa-search"></i></a>
                </div>
              </div>
            </li>
            <li class="nav-item dropdown">
              <div class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"> <a href="javascript:;"
                  class="notification position-relative"><i class="fa fa-bell text-white opacity-50 fs-20"></i>
                  <span *ngIf="notes.length > 0"
                    class="position-absolute top-0 start-100 translate-middle bg-danger rounded-circle text-white text-white text-center line-height-200">
                    {{notes.length}}</span>
                </a>
              </div>
              <div class="dropdown-menu p-0 border-0 shadow border-radius-8 overflow-hidden w-100 notification-box">

                <div class="d-flex align-items-center justify-content-between p-4 border-bottom"> <strong
                    class="fs-14">Notifications <span class="text-muted">({{notes.length}})</span></strong> <a
                    class="fs-12" (click)="clearAllNotiifcaitons()">Clear All Notifications</a> </div>
                <div class="notice-scroller">
                  <!-- <ng-container *ngFor="let note of notes; let i=index">
                    <ng-container *ngIf="note.jobId > 0 ">
                      <div class="w-100 d-block">
                        <div class="d-flex gap-3 align-items-center p-4 border-bottom">
                        
                          <span title="{{note.make}}" [ngClass]="note.color"
                            class="car-{{ note.make| lowercase }} fs-36 text-primary-abs text-center"></span>
                          <span class="text-muted pe-4">
                            <div class="fs-13"> 
                              <i class="fa-solid fa-square border border-radius-1"
                                style="color: {{note.colorVehicle}}"></i>

                              <b class="text-dark">{{ note.year }} {{ note.make }} {{ note.model }} </b>
                            </div>
                            <small class="fs-12"><strong class="fw-700 fs-11 py-1 line-height-150 text-secondary">
                                <span class="text-white opacity-50">{{note.creatorShortName}}</span><span
                                  class="text-white opacity-50">:
                                </span>
                                <span class="fs-10 fw-700 text-white ">{{note.jobId}} </span>
                                <span class="fs-10 fw-700 text-uppercase" [ngClass]="note.color"> {{note.type}} </span>
                                <span class="fs-10 fw-700 text-white "> {{note.jobName}}</span>
                              </strong></small>
                          </span>
                        </div>
                      </div>
                    </ng-container>
                  </ng-container> -->

                  <ng-container *ngFor="let note of notes;">
                    <ng-container *ngIf="note.jobId > 0 ">
                      <!-- <ng-container *ngFor="let vehicle of vehicles; let i=index">
                        <ng-container *ngIf="note.jobId == vehicle.id "> -->
                      <div
                        class="btn d-flex bg-navy text-white gap-2 align-items-center white-space my-1 border shadow ms-1 me-1 mt-1"
                        title="job: {{note.jobId}} {{note.jobName}} is {{note.type}}"
                        [ngClass]="{'border-success': note.type=='Done','border-primary': note.type !='Done'}">
                        <span title="{{note.make}}" [ngClass]="note.color"
                          class="car-{{ note.make| lowercase }} fs-32"></span>

                        <span class="d-block text-start">
                          <strong class="fs-12 fw-500 d-flex gap-2 align-items-center"
                            title="Click to view vehicle details">
                            <span class="fa-solid fa-square border border-radius-1"
                              style="color: {{note.colorVehicle}}"></span>
                            <small>
                              {{ note.year }} {{ note.make }} {{ note.model }} </small></strong>
                          <strong class="fw-700 fs-10 py-1 line-height-150 text-secondary">
                            <span class="text-white opacity-50">{{note.creatorShortName}}</span><span
                              class="text-white opacity-50">:
                            </span>
                            <span class="fs-10 fw-700 text-white ">{{note.jobId}} </span>
                            <span class="fs-10 fw-700 text-uppercase" [ngClass]="note.color"> {{note.type}} </span>
                            <span class="fs-10 fw-700 text-white "> {{note.jobName}}</span>
                          </strong>
                        </span>
                      </div>

                      <div
                        class="d-flex gap-2  justify-content-between  align-items-center white-space my-1 border shadow ms-1 py-1 me-1 mb-1 mt-1">
                        <small class="fs-10 date mt-2 opacity-75">
                          {{note.createdAt| date: 'MM/dd/yyyy HH:mm' }}</small>
                        <div>
                          <button class="btn btn-sm btn-warning btn-xs text-white" data-bs-toggle="modal"
                            data-bs-target="#editVehicle" (click)="getDetailFromNote(note.vehicleId, 0)">
                            <span *ngIf=" note.jobId > 0" title="View vehicle detail" class="fa fa-car"></span>
                          </button>
                          &nbsp;
                          <button class="btn btn-sm btn-warning text-white btn-xs"
                            (click)="setJobNotifiedAndPrintWithJobId(note.jobId)">
                            <span *ngIf=" note.jobId > 0" title="Print Job Order" class="fa fa-print"></span>
                          </button>
                          &nbsp;
                          <button class="btn btn-sm btn-danger btn-xs mr-1" title="Remove"
                            (click)="deleteNote(note)"><span class="fa fa-trash"></span></button>
                        </div>
                      </div>
                      <!-- </ng-container>
                      </ng-container> -->
                    </ng-container>
                  </ng-container>
                </div>
                <a class="text-center mx-auto pt-3 fs-12 d-block border-top">See all
                  notifications</a>
              </div>
            </li>
            <li class="nav-item dropdown">
              <div class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                <div class="d-flex align-items-center gap-3"> <img width="40" height="40" class="border-radius-4"
                    *ngIf="company.icon != null && company.icon.length > 0"
                    [src]="'data:image/jpeg;base64,'+ company.icon" />
                  <div class="user-details"> <strong class="fs-14 mb-1 d-block text-white">{{user.firstName}}
                      {{user.lastName}}</strong> <small
                      class="fs-13 text-dark- opacity-50 text-white">{{this.company.name}}</small> </div>
                  <i class="fa fa-angle-down opacity-50 bg-white"></i>
                </div>
              </div>
              <div class="dropdown-menu p-0 border-0 shadow border-radius-8 overflow-hidden w-100 mt-3">
                <ul class="d-flex flex-column">
                  <li class="d-block p-0"><a routerLink="/users" class="dropdown-item p-3 fs-12"><i
                        class="fa fa-users text-primary-abs fs-15 me-2 ms-1"></i> Manage Users</a></li>
                  <li class="d-block p-0">
                    <button data-bs-toggle="modal" data-bs-target="#myAccount" class="dropdown-item p-3 fs-12"><i
                        class="fa fa-user text-primary-abs fs-15 me-2 ms-1"></i> My
                      Account</button>
                  </li>
                  <li class="d-block p-0">
                    <button data-bs-toggle="modal" data-bs-target="#resetPassword" class="dropdown-item p-3 fs-12"><i
                        class="fa fa-key text-primary-abs fs-15 me-2 ms-1"></i> Reset
                      Password</button>
                  </li>
                  <li class="d-block p-0"><a routerLink="/login" class="dropdown-item p-3 fs-12" (click)="logout()"><i
                        class="fa fa-power-off text-primary-abs fs-15 me-2 ms-1"></i> Logout</a></li>
                </ul>
              </div>
            </li>
          </ul>
        </nav>
      </div>
      <div class="row py-3 mt-4 vehicles-overview" *ngIf="showVehicleListing && this.showColumnInfo== true">
        <div class="p-4 border-top">
          <div class="table-container shadow border-radius-8 border w-100 d-box ss-table">
            <table class="table-bordered overflow-hidden border-radius-8  w-100" *ngIf="columnInfos.length >0"
              cdkDropList (cdkDropListDropped)="droppedColumnInfo($event)">
              <thead>
                <tr>
                  <th class="fs-14 text-center" style="min-width: 50px;" title="Index">#</th>
                  <!-- <th class="fs-14 text-center" style="min-width: 100px;" title="Name">Field name</th> -->
                  <th class="fs-14 text-center" style="min-width: 100px;" title="Descriptoin">Column Descriptoin</th>
                  <th class="fs-14 text-center" style="min-width: 100px;" title="Enable/Disable Column">Enabled</th>
                  <th class="fs-14 text-center" style="min-width: 100px; max-width:150px" title="Table Header">Header
                  </th>
                  <th class="fs-14 text-center" style="min-width: 100px; max-width:150px" title="Header Color">Text
                    Color
                  </th>
                  <th class="fs-14 text-center" style="min-width: 100px;" title="Column Min-Width">Min-Width (px)</th>
                  <th class="fs-14 text-center" style="min-width: 150px;" title="Header Tooltip">Header Tooltip</th>
                  <th class="fs-14 text-center" style="min-width: 50px;" title="Action">Action</th>
                </tr>
              </thead>

              <tr *ngFor="let columnInfo of this.columnInfos; let i=index"
                title="Drag and Drop the Index To Arrange Orders">
                <td class="fs-14 text-center" [cdkDragDisabled]="isMobile==true" cdkDrag>
                  {{i+1}}</td>


                <td class="fs-14 text-center" title="Description">
                  {{columnInfo.comments}}</td>

                <td class="fs-14 text-center" title="Enabled">
                  <button class="alert alert-success p-2 border-0 text-success fs-11 rounded-8 m-0"
                    *ngIf="columnInfo.enabled==true" title="Enabled, click to disable"
                    (click)="saveColumnInfoEnabled(columnInfo, false)">YES</button>
                  <button class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                    *ngIf="columnInfo.enabled==false" title="Disabled, click to enable"
                    (click)="saveColumnInfoEnabled(columnInfo, true)">NO</button>

                </td>

                <td class="fs-14 text-center" title="Header" style="min-width: 100px; max-width:150px">

                  <input style="min-width: 100px" type="text" maxlength="20"
                    class="form-control height-40 border-0 w-100" [(ngModel)]="columnInfo.header"
                    title="Enter to save, max 20 chars" (keyup.enter)="saveColumnInfo(columnInfo)"
                    placeholder="Header ..." />

                </td>

                <td class="fs-14 text-center" title="Header Text Color">
                  <select class="form-select h-48 px-3 border-radius-8 text-capitalize text-shadow text-white"
                    style="background-color: {{columnInfo.color}}" (change)="saveColumnInfo(columnInfo)"
                    [(ngModel)]="columnInfo.color" placeholder="Color">
                    <option value="undefined" disabled selected>Select Color</option>
                    <option style="background-color: {{color}}" *ngFor="let color of optionsColor;let i=index;">
                      {{color}}</option>
                  </select>
                </td>
                <td class="fs-14 text-center">
                  <input type="range" class="form-range" title="{{columnInfo.width}} px" min="10" max="200" step="10"
                    (change)="saveColumnInfo(columnInfo)" [(ngModel)]="columnInfo.width">

                </td>

                <td class="fs-14 text-center" title="Tooltip" style="min-width: 100px; max-width:150px">

                  <input style="min-width: 100px;" type="text" maxlength="30"
                    class="form-control height-40 border-0 w-100" [(ngModel)]="columnInfo.tooltip"
                    title="Enter to save, max 30 chars" (keyup.enter)="saveColumnInfo(columnInfo)"
                    placeholder="Tooltip ..." />

                </td>

                <td class="fs-14 text-center" title="Update">
                  <button class="btn btn-primary btn-sm" title="Save" [disabled]="columnInfo.id==0"
                    (click)="saveColumnInfo(columnInfo)"><i class="fa fa-save"></i></button>
                </td>
              </tr>

            </table>
          </div>
        </div>
      </div>
      <div class="row py-3 mt-4 vehicles-overview"
        *ngIf="showVehicleListing && this.showColumnInfo== false && this.overviewTypeId== 0">
        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-6 px-2 my-2" style="cursor: pointer;"
          *ngFor="let groupBy of statusOverview; let i=index"
          (click)="applyStatusfilter(groupBy.status); activeIndex = i" data-bs-toggle="tooltip"
          data-bs-title="Click to view details" title="Click to view details">
          <div class="filters-boxes d-flex w-100 border-radius-8 gap-3 bg-white shadow-sm align-items-center px-3"
            [ngClass]="{'active': activeIndex === i}"> <i
              class="fa-solid fa-{{icons[i % icons.length]}} fs-4 text-center {{textColors[i % textColors.length]}} {{backgroundColors[i % backgroundColors.length]}} rounded-circle"></i>
            <span class="text-start"> <span class="fs-13 text-dark opacity50"
                *ngIf="isInStatuss(groupBy.status) == false ">Without
                Status</span>
              <ng-container *ngFor="let status of statuss; let j=index"> <span class="fs-13  opacity50"
                  style="display: inline-block; word-break: break-word;" title="{{status.comments}}"
                  *ngIf="groupBy.status > 0 && status.id == groupBy.status && status.name != '' "
                  style="color:{{status.color}}">{{status.name}}</span>
              </ng-container>
              <strong class="d-block fs-20 fw-700 mt-2">{{groupBy.count}} <small class="opacity-75 fs-13"
                  *ngIf="groupBy.totals > 0">
                  {{groupBy.totals | currency:'USD':'symbol':'1.0-0' }} </small></strong> </span>
          </div>
        </div>
        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-6 px-2 my-2" style="cursor: pointer;"
          (click)="applyStatusfilter('All'); activeIndex=null" data-bs-toggle="tooltip"
          data-bs-title="Click to view details" title="Click to view details">
          <div class="filters-boxes d-flex w-100 border-radius-8 gap-3 bg-white shadow-sm align-items-center px-3"
            [ngClass]="{'active': activeIndex === null}"> <i
              class="fa-solid fa-{{icons[0]}} fs-4 text-center {{textColors[0]}} {{backgroundColors[0]}} rounded-circle"></i>
            <span class="text-start">
              <span class="fs-13 fw-700 opacity50" style="display: inline-block; word-break: break-word;"
                title="All Vehicles" style="color:red">All Vehicles</span>
              <strong class="d-block fs-20 fw-700 mt-2">{{vehiclesOriginal.length}}</strong> </span>
          </div>
        </div>
      </div>
      <div class="row py-3 mt-4 vehicles-overview"
        *ngIf="showVehicleListing && this.showColumnInfo== false && this.overviewTypeId== 1">
        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-6 px-2 my-2" style="cursor: pointer;"
          *ngFor="let groupBy of paymentStatusOverview; let i=index"
          (click)="applyPaymentStatusfilter(groupBy.status); activeIndex = i" data-bs-toggle="tooltip"
          data-bs-title="Click to view details" title="Click to view details">
          <div class="filters-boxes d-flex w-100 border-radius-8 gap-3 bg-white shadow-sm align-items-center px-3"
            [ngClass]="{'active': activeIndex === i}"> <i
              class="fa-solid fa-{{icons[i % icons.length]}} fs-4 text-center {{textColors[i % textColors.length]}} {{backgroundColors[i % backgroundColors.length]}} rounded-circle"></i>
            <span class="text-start"> <span class="fs-13 text-dark opacity50"
                *ngIf="isInJobRequestTypes(groupBy.status) == false ">Without
                Payment Status Type</span>
              <ng-container *ngFor="let jobRequestType of jobRequestTypes; let j=index"> <span class="fs-13  opacity50"
                  style="display: inline-block; word-break: break-word;" title="{{jobRequestType.comments}}"
                  *ngIf="groupBy.status > 0 && jobRequestType.id == groupBy.status && jobRequestType.name != '' ">{{jobRequestType.name}}</span>
              </ng-container>
              <strong class="d-block fs-20 fw-700 mt-2">{{groupBy.count}} <small class="opacity-75 fs-13"
                  *ngIf="groupBy.totals > 0">
                  {{groupBy.totals | currency:'USD':'symbol':'1.0-0' }} </small></strong> </span>
          </div>
        </div>
        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-6 px-2 my-2" style="cursor: pointer;"
          (click)="applyPaymentStatusfilter('All'); activeIndex=null" data-bs-toggle="tooltip"
          data-bs-title="Click to view details" title="Click to view details">
          <div class="filters-boxes d-flex w-100 border-radius-8 gap-3 bg-white shadow-sm align-items-center px-3"
            [ngClass]="{'active': activeIndex === null}"> <i
              class="fa-solid fa-{{icons[0]}} fs-4 text-center {{textColors[0]}} {{backgroundColors[0]}} rounded-circle"></i>
            <span class="text-start">
              <span class="fs-13 fw-700 opacity50" style="display: inline-block; word-break: break-word;"
                title="All Vehicles" style="color:red">All Vehicles</span>
              <strong class="d-block fs-20 fw-700 mt-2">{{vehiclesOriginal.length}}</strong> </span>
          </div>
        </div>
      </div>

      <div class="row py-3 mt-4 vehicles-overview"
        *ngIf="showVehicleListing && this.showColumnInfo== false && this.overviewTypeId== 2">
        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-6 px-2 my-2" style="cursor: pointer;"
          *ngFor="let groupBy of assignedToOverview; let i=index"
          (click)="applyAssignedTofilter(groupBy.status); activeIndex = i" data-bs-toggle="tooltip"
          data-bs-title="Click to view details" title="Click to view details">
          <div class="filters-boxes d-flex w-100 border-radius-8 gap-3 bg-white shadow-sm align-items-center px-3"
            [ngClass]="{'active': activeIndex === i}"> <i
              class="fa-solid fa-{{icons[i % icons.length]}} fs-4 text-center {{textColors[i % textColors.length]}} {{backgroundColors[i % backgroundColors.length]}} rounded-circle"></i>
            <span class="text-start"> <span class="fs-13 text-dark opacity50"
                *ngIf="isInEmployees(groupBy.status) == false ">No Assigned
              </span>
              <ng-container *ngFor="let status of employees; let j=index"> <span class="fs-13  opacity50"
                  style="display: inline-block; word-break: break-word;" title="{{status.firstName}}
                  {{status.lastName}}"
                  *ngIf="groupBy.status > 0 && status.id == groupBy.status && status.firstName != '' ">{{status.firstName}}
                  {{status.lastName}}</span>
              </ng-container>
              <strong class="d-block fs-20 fw-700 mt-2">{{groupBy.count}} <small class="opacity-75 fs-13"
                  *ngIf="groupBy.totals > 0">
                  {{groupBy.totals | currency:'USD':'symbol':'1.0-0' }} </small></strong> </span>
          </div>
        </div>
        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-6 px-2 my-2" style="cursor: pointer;"
          (click)="applyAssignedTofilter('All'); activeIndex=null" data-bs-toggle="tooltip"
          data-bs-title="Click to view details" title="Click to view details">
          <div class="filters-boxes d-flex w-100 border-radius-8 gap-3 bg-white shadow-sm align-items-center px-3"
            [ngClass]="{'active': activeIndex === null}"> <i
              class="fa-solid fa-{{icons[0]}} fs-4 text-center {{textColors[0]}} {{backgroundColors[0]}} rounded-circle"></i>
            <span class="text-start">
              <span class="fs-13 fw-700 opacity50" style="display: inline-block; word-break: break-word;"
                title="All Vehicles" style="color:red">All Vehicles</span>
              <strong class="d-block fs-20 fw-700 mt-2">{{vehiclesOriginal.length}}</strong> </span>
          </div>
        </div>
      </div>

      <div class="row py-3 mt-4 vehicles-overview"
        *ngIf="showVehicleListing && this.showColumnInfo== false && this.overviewTypeId== 3">
        <div class="col-xl-2 col-lg-2 col-md-3 col-sm-6 px-2 my-2" *ngFor="let groupBy of locationOverview; let i=index"
          (click)="applyLocationfilter(groupBy.status); activeIndex = i">
          <div class="filters-boxes d-flex w-100 border-radius-8 gap-3 bg-white shadow-sm align-items-center px-3"
            [ngClass]="{'active': activeIndex === i}"> <i
              class="fa-solid fa-{{icons[i % icons.length]}} fs-4 text-center {{textColors[i % textColors.length]}} {{backgroundColors[i % backgroundColors.length]}} rounded-circle"></i>
            <span class="text-start"> <span class="fs-13 text-dark opacity50"
                *ngIf="groupBy.status==0 || isInLocations(groupBy.status) == false">Without Location</span>
              <ng-container *ngFor="let status of locations; let j=index"> <span class="fs-13 text-dark opacity50"
                  style="display: inline-block; word-break: break-word;"
                  *ngIf="status.id == groupBy.status">{{status.name}}</span> </ng-container>
              <strong class="d-block fs-20 fw-700 mt-2">{{groupBy.count}}</strong> </span>
          </div>
        </div>
      </div>

      <div class="row px-2 mb-5 vehicles-overview" *ngIf="showVehicleListing">
        <div class="col-md-12 px-0">
          <div class="bg-white border-radius-8 shadow">
            <div class="d-md-flex align-items-center justify-content-between px-4" style="background-color:#253052">
              <div class="py-4 d-flex gap-2 align-items-center" *ngIf="showAccordian==true"> <strong
                  class="fs-18 text-white">Overview Vehicles <span class="fs-14 fw-400 text-white"
                    *ngIf="vehicles.length > 0">
                    ({{this.searchCount}}) </span></strong>
                <div class="d-flex rounded-1 overflow-hidden">
                  <button (click)="reloadFromServer()" title="Reload from server" data-bs-toggle="tooltip"
                    data-bs-title="Reload from server" class="btn rounded-0 bg-white"><i
                      class="fa fa-rotate"></i></button>
                  <button (click)="this.isMobile =!this.isMobile" title="Disble/Enable Drag & Drop"
                    data-bs-toggle="tooltip" data-bs-title="Disble/Enable Drag & Drop" class="btn rounded-0 bg-white"><i
                      class="fa fa-window-close"></i></button>

                  <button data-bs-toggle="tooltip" data-bs-title="Show production overview" (click)="showOverview(0)"
                    title="Show Production Overview" class="btn rounded-0 bg-white"><i class="fa fa-truck"></i></button>

                  <button data-bs-toggle="tooltip" data-bs-title="Show Payment Status overview" (click)="showOverview(1)"
                    title="Show Payment Status Overview" class="btn rounded-0 bg-white"><i class="fa fa-dollar text-danger bg-green"></i></button>

                  <button data-bs-toggle="tooltip" data-bs-title="Show Assigned To overview" (click)="showOverview(2)"
                    title="Show Assigned To Overview" class="btn rounded-0 bg-white"><i class="fa fa-user"></i></button>

                  <button (click)="showOverview(3)" data-bs-toggle="tooltip"
                    data-bs-title="Show vehicle parking overview" title="Show Vehicle Parking Overview"
                    class="btn rounded-0 bg-white"><i class="fa fa-parking"></i></button>

                  <button (click)="this.showColumnInfo =  !this.showColumnInfo" data-bs-toggle="tooltip"
                    data-bs-title="Show Column Settings" title="Show Column Settings" class="btn rounded-0 bg-white"><i
                      class="fa fa-gears"></i></button>

                  <button *ngIf="this.showPanalNumber != 0" (click)="showPanel(0)" data-bs-toggle="tooltip"
                    data-bs-title="Show List View" title="Show List View" class="btn rounded-0 bg-white"><i
                      class="fa fa-list"></i></button>
                  <button *ngIf="this.showPanalNumber != 1" (click)="showPanel(1)" data-bs-toggle="tooltip"
                    data-bs-title="Show Schedule" title="Show Schedule" class="btn rounded-0 bg-white"><i
                      class="fa fa-calendar-days"></i></button>
                  <button *ngIf="this.showPanalNumber !=2 " (click)="showPanel(2)" data-bs-toggle="tooltip"
                    data-bs-title="Show Grid View" title="Show Grid View" class="btn rounded-0 bg-white"><i
                      class="fa fa-border-all"></i></button>
                  <!-- <button *ngIf="this.showPanalNumber !=3 " (click)="showPanel(3)" data-bs-toggle="tooltip"
                    data-bs-title="Show Employee Jobs" title="Show Employee Jobs" class="btn rounded-0 bg-white"><i
                      class="fa fa-user-tie"></i></button> -->

                  <button *ngIf="this.showPanalNumber !=4 " (click)="showPanel(4)" data-bs-toggle="tooltip"
                    data-bs-title="Show Vehicle Status" title="Show Vehicle Status" class="btn rounded-0 bg-white"><i
                      class="fa fa-truck"></i></button>

                  <button *ngIf="this.showPanalNumber !=5 "
                    (click)="showPanel(5);getChangeOverview(user.companyId);getChangeOverviewUser(user.companyId)"
                    data-bs-toggle="tooltip" data-bs-title="Show Vehicle Change Chart" title="Show Vehicle Change Chart"
                    class="btn rounded-0 bg-white"><i class="fa fa-bar-chart"></i></button>
                  <button (click)="searchVehicleArchived(9, 0, this.pageSize)" data-bs-toggle="tooltip"
                    data-bs-title="Full Screen Mode" title="Exit Full Screen Mode" class="btn rounded-0 bg-white"><i
                      class="fa fa-window-close"></i></button>
                  <button (click)="openFullscreen()" data-bs-toggle="tooltip" data-bs-title="Full Screen Mode"
                    title="Full Screen Mode" class="btn rounded-0 bg-white"><i class="fas fa-expand"></i></button>
                </div>
              </div>
              <div class="position-relative">
                <input type="text" class="form-control bg-light height-40 border-0" id="searchInput"
                  title="Press Enter after search input or press search button .." [(ngModel)]="searchInput"
                  placeholder="Search vehicles ..." (keyup.enter)="onSearchInput(searchInput)" />
                <div class=" position-absolute end-0 top-0 mt-3"> <a (click)="onSearchInput(searchInput)"
                    class="text-muted me-3" data-toggle="tooltip" data-bs-title="Search vehicles "><i
                      class="fa fa-search"></i></a>

                </div>
              </div>
              <a *ngIf="user.allowAddAndUpdateVehicle == true" routerLink="/add-new-vehicle"
                class="btn btn-primary fs-13 px-3 py-2"><i class="fa fa-plus me-2"></i> New Job</a>
            </div>
            <div class="p-4 border-top" *ngIf="this.showPanalNumber == 0">
              <ng-container *ngIf="this.showCardLayout == false">
                <div class="table-container shadow border-radius-8 border w-100 d-box ss-table">
                  <table class="table-bordered overflow-hidden border-radius-8  w-100" *ngIf="vehicles.length >0"
                    cdkDropList (cdkDropListDropped)="droppedVehicle($event)">
                    <thead>
                      <tr>
                        <th class="fs-14 text-center" style="min-width: 20px;" (click)="sortList('id')"
                          title="Click to Sort By Arraival Date">
                          <!--  -->
                          <span>#</span>
                        </th>
                        <ng-container *ngFor="let columnInfo of this.columnInfos">
                          <th class="fs-14 text-center" style="min-width: {{columnInfo.width}}px;"
                            (click)="sortList(columnInfo.fieldName)" *ngIf="columnInfo.enabled==true"
                            title="Click to Sort By {{columnInfo.tooltip}}">
                            <!--  -->
                            <span style="color:{{columnInfo.color}}">{{columnInfo.header}}</span>
                          </th>
                        </ng-container>
                      </tr>
                    </thead>

                    <ng-container
                      *ngFor="let vehicle of vehicles| paginate: { itemsPerPage: this.pageSize,currentPage: currantPageNumber , totalItems: searchCount}; let i = index;  let even=even">
                      <tr id="{{vehicle.id}}" (click)="setDetail(vehicle, i)" style="cursor: pointer;"
                        title="{{vehicle.customer.title}} {{vehicle.customer.firstName}} {{vehicle.customer.lastName}}"
                        [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')">
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                          title="Click to view details; Drag and drop the index number to change orders"
                          [style.background-color]="i == cindex? '#CFF4FC' : (true ? 'white' : 'white')"
                          (click)="toggleDivs(); getDetail(vehicle, i)" [cdkDragDisabled]="isMobile==true" cdkDrag>
                          <ng-container *ngIf="vehicle.pdfFiles.length > 0">
                            <div class="position-relative">
                              <i class="fa-solid fa-file-pdf fa-2x"></i>
                              <span *ngIf="vehicle.pdfFiles.length > 1" title="{{vehicle.pdfFiles.length}} pdf files"
                                class="badge position-absolute top-0 end-0 translate-middle badge-pill bg-danger">{{vehicle.pdfFiles.length}}</span>
                            </div>
                          </ng-container>
                          <ng-container *ngIf="vehicle.pdfFiles.length == 0">
                            {{i+1}}
                          </ng-container>

                        </td>
                        <ng-container *ngFor="let columnInfo of this.columnInfos">
                          <ng-container *ngIf="columnInfo.enabled==true">
                            <ng-container *ngIf="columnInfo.fieldName == 'id'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                (mouseover)="hover = vehicle" (mouseleave)="hover = null" title="Click to view details"
                                (click)="toggleDivs(); getDetail(vehicle, i)">
                                <div
                                  class="overflow-hidden hover-img transition rounded-1 border inline-block position-relative">
                                  <img *ngIf="vehicle.imageModels.length> 0 && vehicle.showInSearchImageId > 0"
                                    src="{{baseUrlResizeImage + '/' + vehicle.showInSearchImageId}}" height="40"
                                    alt="Image" class="object-fill rounded-1 w-100" />

                                  <span *ngIf="vehicle.imageModels.length>1"
                                    title="{{vehicle.imageModels.length}} images/photos"
                                    class="badge position-absolute top-3 end-12 translate-middle badge-pill bg-danger"
                                    style="top:8px; left:10px">
                                    {{vehicle.imageModels.length}}</span>
                                </div>
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'createdAt'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{vehicle.createdAt | date: 'MM/dd'}} </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'updatedAt'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                <span>{{vehicle.updatedAt | date: 'MM/dd'}}</span>
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'lastUpdateObjectName'">
                              <td class="text-center fs-13 v-align-middle" data-bs-toggle="modal"
                                data-bs-target="#editVehicle" title="{{vehicle.lastVehicleHistory?.name }}"
                                (click)="toggleDivs(); getDetail(vehicle, i)">

                                <ng-container
                                  *ngIf="vehicle.lastUpdateIconName == null || vehicle.lastUpdateObjectName==null">
                                  <i title="No Update" class="fa-solid fa-bell-slash"></i>
                                </ng-container>

                                <ng-container
                                  *ngIf="vehicle.lastUpdateIconName && vehicle.lastUpdateIconName != '' && vehicle.lastUpdateIconName !=vehicle.lastVehicleHistory.name">
                                  <i class="{{vehicle.lastUpdateIconName }}"></i>
                                </ng-container>
                                <ng-container
                                  *ngIf="vehicle.lastUpdateIconName && vehicle.lastUpdateIconName ==vehicle.lastVehicleHistory.name">
                                  {{vehicle.lastUpdateObjectName }}
                                </ng-container>

                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'year'">

                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="{{vehicle.customer.title}} {{vehicle.customer.firstName}} {{vehicle.customer.lastName}}"
                                (click)="toggleDivs(); getDetail(vehicle, i)">{{vehicle.year}}</td>

                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'make'">
                              <td class="text-center fs-24" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">

                                <span [ngClass]="{'text-danger  fw-700': vehicle.special ==true}"
                                  title="{{vehicle.make}}" class="car-{{ vehicle.make| lowercase }}"></span>


                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'model'">

                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{vehicle.model}}
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'vin'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{vehicle.vin}}
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'vip'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                <span *ngIf="vehicle.special == true" style="color:red" class="fs-700">WIP</span>
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'insuranceCompany'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{vehicle.insuranceCompany}}
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'loanerCarName'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{vehicle.loanerCarName}}
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'daysInShop'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{vehicle.daysInShop}}
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'comments'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">

                                <p class="fs-12 text-black opacity-75" style="display: -webkit-box;
                                -webkit-box-orient: vertical;
                                -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                 overflow: hidden;">
                                  {{vehicle.comments}}</p>
                              </td>
                            </ng-container>


                            <ng-container *ngIf="columnInfo.fieldName == 'color'">
                              <td class="text-center fs-13 text-shadow" data-bs-toggle="modal"
                                data-bs-target="#editVehicle" title="Click to view details"
                                (click)="toggleDivs(); getDetail(vehicle, i)">
                                <i class="fa-solid fa-square" title="{{vehicle.color}}"
                                  style="color: {{vehicle.color}}"></i>
                              </td>

                            </ng-container>


                            <ng-container *ngIf="columnInfo.fieldName == 'price'">
                              <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#editVehicle"
                                title="Click to view details" (click)="toggleDivs(); getDetail(vehicle, i)">
                                ${{vehicle.price}}<span *ngIf=" getTotalSupplements(vehicle)> 0"
                                  title="Supplement total">
                                  ${{getTotalSupplements(vehicle)}}</span>
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'customer'">
                              <td class="text-center fs-13 text-capitalize" data-bs-toggle="modal"
                                data-bs-target="#editVehicle" title="{{formatPhoneNumber(vehicle.customer.phone)}}"
                                (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{vehicle.customer.firstName}} {{vehicle.customer.lastName}}
                              </td>
                            </ng-container>


                            <ng-container *ngIf="columnInfo.fieldName == 'phone'">
                              <td class="text-center fs-13 text-capitalize" data-bs-toggle="modal"
                                data-bs-target="#editVehicle" title="Click to view details"
                                (click)="toggleDivs(); getDetail(vehicle, i)">
                                {{formatPhoneNumber2(vehicle.customer.phone)}}
                              </td>
                            </ng-container>


                            <ng-container *ngIf="columnInfo.fieldName == 'jobRequestType'">
                              <td><select class="form-select border-radius-4 border"
                                  [(ngModel)]="vehicle.jobRequestType" placeholder="Job Requst Type" #jobRequestType
                                  (change)="onChangeJobRequestTypeOverview($event, jobRequestType.value)">
                                  <option *ngFor="let jobRequestType of jobRequestTypes let i=index"
                                    value="{{jobRequestType.id}}">{{jobRequestType.name}} </option>
                                </select></td>

                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'status'">
                              <td><select class="form-select border-radius-4 border" [(ngModel)]="vehicle.status"
                                  placeholder="status" #device [disabled]="user.allowUpdateVehicleStatus == false"
                                  (change)="onChangeStatusOverview($event, device.value)">
                                  <option [style.color]="option.color" *ngFor="let option of statuss; let i=index"
                                    value="{{option.id}}">{{option.name}}
                                  </option>
                                </select></td>

                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'approvalStatus'">
                              <td> <select class="orm-select border-radius-4 border"
                                  [disabled]="user.allowUpdateVehicleStatus == false"
                                  (change)="onChangeApprovalStatus($event, approvalStatus.value)" #approvalStatus
                                  [(ngModel)]="vehicle.approvalStatus" placeholder="Approval Status">
                                  <!-- <option value="0" disabled selected>Select Approval Status</option> -->
                                  <option [value]="approvalStatus.id"
                                    *ngFor="let approvalStatus of approvalStatuss;let i=index;">{{approvalStatus.name}}
                                  </option>
                                </select>
                              </td>

                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'serviceManager'">

                              <td><select class="form-select border-radius-4 border"
                                  [(ngModel)]="vehicle.serviceManager" placeholder="status" #serviceManager
                                  [disabled]="user.allowUpdateVehicleStatus == false"
                                  (change)="onChangeServiceManager($event, serviceManager.value)">
                                  <option *ngFor="let employee of employees; let i=index" value="{{employee.id}}">
                                    {{employee.firstName}} {{employee.lastName}}</option>
                                </select></td>

                            </ng-container>


                            <ng-container *ngIf="columnInfo.fieldName == 'assignedTo'">

                              <td><select class="form-select border-radius-4 border" [(ngModel)]="vehicle.assignedTo"
                                  placeholder="status" #assignedTo [disabled]="user.allowUpdateVehicleStatus == false"
                                  (change)="onChangeAssignedToOverView($event, assignedTo.value)">
                                  <option *ngFor="let employee of employees; let i=index" value="{{employee.id}}">
                                    {{employee.firstName}} {{employee.lastName}}</option>
                                </select></td>

                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'keyLocation'">
                              <td><select class="form-select border-radius-4 border" [(ngModel)]="vehicle.keyLocation"
                                  placeholder="Key Location" #keyLocation
                                  [disabled]="user.allowUpdateVehicleStatus == false"
                                  (change)="onChangeKeyLocation($event, keyLocation.value)">
                                  <option *ngFor="let keyLocation of keyLocations; let i=index"
                                    value="{{keyLocation.id}}">
                                    {{keyLocation.name}} </option>
                                </select></td>

                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'paid'">

                              <td class="text-center"><button
                                  class="alert alert-success p-2 border-0 text-success fs-11 rounded-8 m-0"
                                  *ngIf="vehicle.paid==true" [disabled]="user.allowAddPayment == false" title="Paid"
                                  (click)="changePaidStatus(vehicle, false)">Y</button>
                                <button class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                                  *ngIf="vehicle.paid==false" [disabled]="user.allowAddPayment == false"
                                  title="Not Paid" (click)="changePaidStatus(vehicle, true)">N</button>
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'targetDateCountDown'">

                              <td class="text-center"><ng-container
                                  *ngIf="vehicle.targetDate != null && vehicle.targetDateCountDown >= 0"> <span
                                    class="alert alert-secondary p-2 border-0 text-dark fs-11 rounded-8 m-0"
                                    title="{{vehicle?.targetDate | date: 'MM/dd/yyyy'}}">{{vehicle.targetDateCountDown}}</span>
                                </ng-container>
                                <ng-container *ngIf="vehicle.targetDate != null && vehicle.targetDateCountDown < 0">
                                  <span class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                                    title="{{vehicle?.targetDate | date: 'MM/dd/yyyy'}}">{{vehicle.targetDateCountDown}}</span>
                                </ng-container>
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'rentalCountDown'">

                              <td class="text-center"><ng-container *ngIf="vehicle.loanerCarName != null && vehicle?.loanerCarName !='' &&
                              vehicle.rentalDate != null && vehicle.rentalCountDown >= 0 ">
                                  <span class="alert alert-secondary p-2 border-0 text-dark fs-11 rounded-8 m-0"
                                    title="{{vehicle?.loanerCarName}} {{vehicle?.rentalDate | date: 'MM/dd/yyyy'}}">{{vehicle.rentalCountDown}}</span>
                                </ng-container>
                                <ng-container
                                  *ngIf="vehicle.loanerCarName != null && vehicle?.loanerCarName !='' && vehicle.rentalDate !=null && vehicle.rentalCountDown < 0 ">
                                  <span class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                                    title="{{vehicle?.loanerCarName}} {{vehicle?.rentalDate | date: 'MM/dd/yyyy'}}">{{vehicle.rentalCountDown}}</span>
                                </ng-container>
                              </td>
                            </ng-container>

                            <ng-container *ngIf="columnInfo.fieldName == 'location'">

                              <td><select class="form-select border-radius-4 border" [(ngModel)]="vehicle.location"
                                  placeholder="location" #deviceLocation
                                  (change)="onChangeLocation($event, deviceLocation.value)">
                                  <option *ngFor="let option of locations; let i=index" value="{{option.id}}">
                                    {{option.name}}
                                  </option>
                                </select></td>

                            </ng-container>
                          </ng-container>
                        </ng-container>

                      </tr>
                    </ng-container>
                  </table>
                </div>
              </ng-container>

              <ng-container *ngIf="this.showCardLayout == true">
                <div class="parts-box bg-white border-radius-8 py-4 px-3 mt-4 shadow-sm m-box"
                  [style.background-color]="i == cindex? '#1580da' : (even ? '#EEE' : '#EEE')"
                  *ngFor="let autopart of vehicles; let i = index;  let even=even">
                  <div class="row mx-n2" id="gridView">
                    <div class="col-lg-4" id="{{autopart.id}}"
                      [style.border-color]="i == cindex? '#1580da' : (even ? '#EEE' : '#EEE')"
                      *ngFor="let vehicle of vehicles| paginate: { itemsPerPage: this.pageSize,currentPage: currantPageNumber , totalItems: searchCount}; let i = index;  let even=even">
                      <div class="parts-box bg-white border-radius-8 py-4 px-3 mt-4 shadow-sm position-relative"> <img
                          class="img-fluid w-100 border-radius-8" *ngIf="vehicle.showInSearchImageId !=0"
                          src="{{baseUrlResizeImage + '/' + vehicle.showInSearchImageId}}" alt="Image" />
                        <h2 class="fs-18 fw-700 py-2 line-height-150" *ngIf="currentUser"> {{ vehicle.year }} - {{
                          vehicle.make }} - {{ vehicle.model }} - {{ vehicle.color}} </h2>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">{{
                          vehicle.description }}</p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">{{
                          vehicle.workRequest }}</p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">Job Request Type:
                          <select class="form-select mt-2" [(ngModel)]="vehicle.jobRequestType"
                            placeholder="Job Requst Type" #jobRequestType
                            (change)="onChangeJobRequestType($event, jobRequestType.value)">
                            <option *ngFor="let jobRequestType of jobRequestTypes let i=index"
                              value="{{jobRequestType.id}}">{{jobRequestType.name}} </option>
                          </select>
                        </p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">Status:
                          <select class="form-select mt-2" [(ngModel)]="vehicle.status" placeholder="status" #device
                            [disabled]="user.allowUpdateVehicleStatus == false"
                            (change)="onChangeStatus($event, device.value)">
                            <option *ngFor="let option of statuss; let i=index" value="{{option.id}}">{{option.name}}
                            </option>
                          </select>
                        </p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">Assigned To:
                          <select class="form-select mt-2" [(ngModel)]="vehicle.assignedTo" placeholder="status"
                            #assignedTo [disabled]="user.allowUpdateVehicleStatus == false"
                            (change)="onChangeAssignedTo($event, assignedTo.value)">
                            <option *ngFor="let employee of employees; let i=index" value="{{employee.id}}">
                              {{employee.firstName}} {{employee.lastName}}</option>
                          </select>
                        </p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">Key Location:
                          <select class="form-select mt-2" [(ngModel)]="vehicle.keyLocation" placeholder="Key Location"
                            #keyLocation [disabled]="user.allowUpdateVehicleStatus == false"
                            (change)="onChangeKeyLocation($event, keyLocation.value)">
                            <option *ngFor="let employee of employees; let i=index" value="{{employee.id}}">
                              {{employee.firstName}} {{employee.lastName}}</option>
                          </select>
                        </p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">
                          <button class="alert alert-success p-2 border-0 text-success fs-11 rounded-8 m-0"
                            *ngIf="vehicle.paid==true" [disabled]="user.allowAddPayment == false"
                            (click)="changePaidStatus(vehicle, false)">PAID</button>
                          <button class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                            *ngIf="vehicle.paid==false" [disabled]="user.allowAddPayment == false"
                            (click)="changePaidStatus(vehicle, true)">UNPAID</button>
                        </p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">{{
                          vehicle.createdAt | date: 'MM/dd/yyyy' }}</p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">Due Day:
                          <ng-container *ngIf="vehicle.targetDate != null && vehicle.targetDateCountDown >= 0"> <span
                              class="alert alert-secondary p-2 border-0 text-dark fs-11 rounded-8 m-0"
                              title="{{vehicle?.targetDate | date: 'MM/dd/yyyy'}}">{{vehicle.targetDateCountDown}}</span>
                          </ng-container>
                          <ng-container *ngIf="vehicle.targetDate != null && vehicle.targetDateCountDown < 0"> <span
                              class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                              title="{{vehicle?.targetDate | date: 'MM/dd/yyyy'}}">{{vehicle.targetDateCountDown}}</span>
                          </ng-container>
                        </p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">Rental Due Day:
                          <ng-container *ngIf="
                        vehicle.rentalDate != null && vehicle.rentalCountDown >= 0 "> <span
                              class="alert alert-secondary p-2 border-0 text-dark fs-11 rounded-8 m-0"
                              title="{{vehicle?.loanerCarName}} {{vehicle?.rentalDate | date: 'MM/dd/yyyy'}}">{{vehicle.rentalCountDown}}</span>
                          </ng-container>
                          <ng-container *ngIf=" vehicle.rentalDate !=null && vehicle.rentalCountDown < 0 "> <span
                              class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                              title="{{vehicle?.loanerCarName}} {{vehicle?.rentalDate | date: 'MM/dd/yyyy'}}">{{vehicle.rentalCountDown}}</span>
                          </ng-container>
                        </p>
                        <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                          style="word-break: break-word;">Vehicle Location:
                          <select class="form-select border-radius-4" [(ngModel)]="vehicle.location"
                            placeholder="location" #deviceLocation
                            (change)="onChangeLocation($event, deviceLocation.value)">
                            <option *ngFor="let option of locations; let i=index" value="{{option.id}}">{{option.name}}
                            </option>
                          </select>
                        </p>
                        <h3
                          class="fs-16 fw-700 text-white bg-navy py-2 px-4 mt-4 rounded-end-5 position-absolute bottom-0 start-0 mb-4">
                          ${{vehicle.price}}</h3>
                        <div class="d-flex align-items-center gap-2 justify-content-end mt-4">
                          <button class="btn btn-outline-primary btn-sm mt-2" data-bs-toggle="modal"
                            data-bs-target="#editVehicle" (click)="getDetail(vehicle, i)">Details</button>
                          <button class="btn btn-outline-warning btn-sm mt-2" title="Archieve "
                            (click)="archiveVehicle(vehicle)" *ngIf="this.currentUser != null && this.user != null && 
                            this.user.allowAddAndUpdateVehicle==true && 
                            this.user.allowArchiveVehicle==true
                         && this.vehicle.companyId == this.user.companyId">Archive</button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </ng-container>
              <div class="d-flex align-items-center justify-content-between my-4 table-bottom">
                <div class="d-flex align-items-center gap-3 my-2 justify-content-end"> <span>Showing</span>
                  <select class="form-select px-3 mw-130" [(ngModel)]="pageSize" title="Page Size"
                    (change)="searchVehicle(this.searchType, 0, pageSize); rememberMe()">
                    <option>10</option>
                    <option>20</option>
                    <option>30</option>
                    <option>40</option>
                    <option>50</option>
                    <option>60</option>
                    <option>70</option>
                    <option>80</option>
                    <option>90</option>
                    <option>100</option>
                    <option>200</option>
                    <option>300</option>
                  </select>
                  <span class="white-space">of {{this.searchCount}} entries</span>
                  <div class="ps-2">
                    <input type="checkbox" class="ms-1 mt-n2 form-check-input" title="Remember My Page Size"
                      [checked]="this.pageSize !=20 " (change)="rememberMe()" />

                  </div>
                </div>
                <nav class="paginations my-2" *ngIf="this.searchType != 9">
                  <ul class="pagination d-flex align-items-center gap-3">
                    <pagination-controls previousLabel="Prev" nextLabel="Next" [maxSize]=10
                      (pageChange)="searchVehicle(this.searchType,$event, pageSize)"> </pagination-controls>


                  </ul>
                </nav>

                <nav class="paginations my-2" *ngIf="this.searchType == 9">
                  <ul class="pagination d-flex align-items-center gap-3">
                    <pagination-controls previousLabel="Prev" nextLabel="Next" [maxSize]=10
                      (pageChange)="searchVehicleArchived(this.searchType,$event, pageSize)"> </pagination-controls>

                  </ul>
                </nav>

              </div>
            </div>
            <div class="p-4 border-top" *ngIf="this.showPanalNumber == 3 ">
              <h2 class="heading-color fw-700 text-uppercase fs-18 pb-3">Employee Jobs overviews</h2>
              <div class="row mx-negative align-items-stretch ">
                <div class="col-lg-2 col-md-3 mb-4" data-bs-toggle="modal" data-bs-target="#editEmployees"
                  *ngFor="let employee of employees; let i=index; let even=even"
                  (click)="getMyJobsIndex(employee.id, i)">
                  <div class="bg-white shadow-sm border-radius-8 p-4 cursor-pointer h-100" title="Click to view details"
                    [style.border]="i == cindexEmployees? '1px solid #1580da' : (even ? '1px solid #FFF' : '1px solid #EEE')">
                    <div class="d-flex gap-3 align-items-center">
                      <!-- <i class="fa fa-user-gear fa-1x heading-color"></i> -->
                      <div>
                        <strong class="fs-16 fw-bold d-block">{{ i+1}}. {{employee.firstName | titlecase}}
                          {{employee.lastName | titlecase}}</strong>
                        <span class="fs-14 d-block mt-2"><ng-container *ngFor="let employeeRole of employeeRoles"> <span
                              *ngIf="employeeRole.id == employee.roleId"> {{employeeRole.name}}</span>
                          </ng-container></span>
                      </div>
                    </div>
                    <ul class="d-block mt-2">
                      <li class="d-flex gap-2 align-items-center py-2">
                        <span class="fs-14">Unfinished :</span> <b
                          class="bg-warning fs-14 text-white p-1 rounded-1 d-block">{{ employee.jobCountsUnfinished
                          }}</b>
                      </li>
                      <li class="d-flex gap-2 align-items-center py-2">
                        <span class="fs-14">Finished :</span> <b
                          class="bg-success fs-14 text-white p-1 rounded-1 d-block">{{ employee.jobCountsFinished }}</b>
                      </li>
                      <li class="d-flex gap-2 align-items-center py-2">
                        <span class="fs-14">Total :</span> <b class="bg-navy fs-14 text-white p-1 rounded-1 d-block">{{
                          employee.jobCountsFinished +
                          employee.jobCountsUnfinished }}</b>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <h2 class="heading-color fw-700 text-uppercase pt-5 fs-18 pb-4" *ngIf="isH2Visible">Vehicle Jobs</h2>
                <div class="form-check pt-md-4 mt-md-2">
                  <input type="checkbox" id="unfinished" class="form-check-input mt-0" [(ngModel)]="filterOff"
                    title="To view finished or unfinished jobs" (change)="filterVehicleJobs()" />
                  <label class="form-check-label" for="unfinished">Unfinished Job Only</label>
                </div>
              </div>
              <div class="row mx-n3 align-items-stretch">
                <ng-container *ngFor="let vehicle of vehiclesJob; let i=index; let even=even">
                  <div class="col-lg-3 col-md-4 mb-4" *ngIf="vehicle.shallDisplay == true"
                    (click)="getDetail(vehicle, i )">
                    <div class="bg-white border-radius-4 px-3 py-1 h-100 border">
                      <div class="d-sm-flex gap-3">

                        <div class="py-3">
                          <h3 class="fs-6 fw-bold text-primary-abs line-height-150"> {{vehicle.year}} - {{vehicle.make}}
                            - {{vehicle.model}} - {{vehicle.color}}</h3>
                          <div class="d-flex gap-2 my-2 align-items-center" style="word-break: break-word;"> <strong
                              class="fs-13">Request
                              Type:</strong> <span class="fs-12 opacity-75 text-black"><ng-container
                                *ngFor="let jobRequestType of jobRequestTypes; let i=index"><ng-container
                                  *ngIf="vehicle.jobRequestType==jobRequestType.id">{{jobRequestType.name}}</ng-container></ng-container></span>
                          </div>
                          <div class="d-flex gap-2 my-2 align-items-center" style="word-break: break-word;"> <strong
                              class="fs-13">Status:</strong>
                            <span class="fs-12 opacity-75 text-black"><ng-container
                                *ngFor="let option of statuss; let i=index"> <span
                                  *ngIf="vehicle.status==option.id">{{option.name}}</span> </ng-container></span>
                          </div>
                          <div class="d-flex gap-2 my-2 align-items-center" style="word-break: break-word;"> <strong
                              class="fs-13">Been:</strong> <span class="fs-12 opacity-75 text-black">
                              {{vehicle.daysInShop}} Days </span> </div>
                          <div class="d-flex gap-2 my-2 align-items-center"> <strong class="fs-13">Description:</strong>
                            <span class="fs-12 opacity-75 text-black" style="word-break: break-word;">
                              {{vehicle.description}}</span>
                          </div>
                        </div>
                      </div>
                      <hr class="mt-1" />
                      <div class="bg-light rounded-2 p-3 my-3" *ngFor="let job of vehicle.jobs; let j=index">
                        <ng-container *ngIf="job.status==1 && filterOff == false">
                          <div class="d-flex gap-2 my-2"> <a href="javascript:;"
                              class="text-decoration-none text-primary-abs" (click)="setJobId(job.id)"
                              [ngClass]="{'ps-0': !(job.employeeId > 0 && job.targetDate != null)}"
                              [class.active]="job.id == currentJobId"> <strong class="fs-14 d-block">{{job.id}} -
                                {{job.name}}: </strong> <span
                                class="fs-12 opacity-75 text-black py-2 d-block">{{job.notes}}</span> </a> </div>
                          <div class="d-flex gap-2 my-2" style="word-break: break-word;"> <a href="javascript:;"
                              class="text-decoration-none fs-12 form-check text-primary-abs my-2"
                              (click)="setJobId(job.id)">
                              <input type="checkbox" class="form-check-input my-0" [checked]="isJobChecked(job)"
                                [disabled]="user.allowUpdateJobStatus == false"
                                *ngIf="job.employeeId > 0 && job.targetDate != null" (change)="updateJobStatus(job)">
                              by {{job.targetDate | date: 'MM/dd/yyyy'}} <span
                                class="alert alert-success p-2 border-0 text-success fs-11 rounded-8 m-0"
                                style="word-break: break-word;" *ngIf="job.paidWeek > 0">PAID on Week [ {{
                                job.paidWeek}} ]</span> </a> </div>
                        </ng-container>
                        <ng-container *ngIf="job.status==0">
                          <a href="javascript:;" class="text-decoration-none text-primary-abs"
                            (click)="setJobId(job.id)" [class.active]="job.id == currentJobId"> <strong
                              class="fs-14 d-block">{{job.id}} -
                              {{job.name}}: </strong> <span
                              class="fs-12 opacity-75 text-black py-2 d-block">{{job.notes}}</span> </a>
                          <a href="javascript:;" style="word-break: break-word;"
                            class="text-decoration-none fs-12 form-check text-primary-abs my-2"
                            [ngClass]="{'ps-0': !(job.employeeId > 0 && job.targetDate != null)}"
                            (click)="setJobId(job.id)">
                            <input type="checkbox" class="form-check-input my-0" [checked]="isJobChecked(job)"
                              [disabled]="user.allowUpdateJobStatus == false"
                              *ngIf="job.employeeId > 0 && job.targetDate != null" (change)="updateJobStatus(job)">
                            by {{job.targetDate | date: 'MM/dd/yyyy'}}
                            <span class="alert alert-success p-2 border-0 text-success fs-11 rounded-8 m-0"
                              style="word-break: break-word;" *ngIf="job.paidWeek > 0">PAID on Week [ {{ job.paidWeek}}
                              ]</span>
                          </a>

                        </ng-container>
                      </div>
                    </div>
                  </div>
                </ng-container>
                <h2 class="heading-color fw-700 text-uppercase pt-5 fs-18 pb-3">Schedules (show unfinished jobs)</h2>
                <full-calendar [options]="calendarOptionsJob1">
                  <ng-template #eventContent let-arg> <span class="tooltipTest"
                      id="{{arg.event.extendedProps['jobRequestType']}} at {{arg.event.extendedProps['location']}} been {{arg.event.extendedProps['days']}} days">{{arg.event.title}}<br>
                      <small>{{arg.event.extendedProps['description']}}</small> </span> </ng-template>
                </full-calendar>
              </div>
            </div>
            <div class="p-4 border-top" *ngIf="this.showPanalNumber == 4 ">
              <div class="table-container shadow border-radius-8 border w-100 d-box ss-table" cdkDropList
                (cdkDropListDropped)="droppedStatus($event)">
                <table class="table-bordered border-radius-8 w-100"
                  *ngIf="statuss2.length > 0 && vehiclesOriginal.length> 0" cdkDropListGroup>
                  <thead>
                    <tr>
                      <th class="fs-14 text-center">index</th>
                      <th class="fs-14 text-center mw-100" title="Click to navigagte to Job Status Setting"
                        (click)="navigateTo('job-status')">Status</th>
                      <th class="fs-14 text-center ">
                        #
                      </th>
                      <th class="fs-14 text-center " title="Sorted by vehicle make">Vehicles [ {{
                        this.vehiclesOriginal.length }} ]</th>

                    </tr>
                  </thead>
                  <ng-container *ngFor="let status of statuss2; let i = index;  let even=even">
                    <tr id="{{status.id}}" title=""
                      [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')"
                      [cdkDragDisabled]="isMobile==true" cdkDrag>

                      <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                        title="Click to view details">
                        {{i+1}}
                      </td>
                      <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                        title="Click to view details">
                        <strong *ngIf="status.color != null" [style.color]="status.color">{{status.name}}</strong>
                        <strong *ngIf="status.color == null">{{status.name}}</strong>
                      </td>
                      <td class="fs-13 mw-50 mxw-100" data-bs-toggle="modal" data-bs-target="#partDetails"
                        title="Click to view details">
                        {{ status.vehicles?.length}}
                      </td>
                      <td *ngIf="status.vehicles!.length == 0" cdkDropList
                        (cdkDropListDropped)="droppedStatus3($event, status.id)"></td>
                      <td *ngIf="status.vehicles!.length >0">
                        <div class="d-flex flex-wrap gap-1" cdkDropList
                          (cdkDropListDropped)="droppedStatus3($event, status.id)">
                          <a href="javascript:;"
                            class="btn btn-light d-flex gap-2 align-items-center white-space my-1 border p-1 shadow"
                            [cdkDragData]="i" data-toggle="tooltip" data-placement="bottom"
                            title="{{vehicle.customer.title}} {{vehicle.customer.firstName}} {{vehicle.customer.lastName }} "
                            [style.background-color]="vehicle.id == currentIndex? '#EEE' : (true ? 'white' : 'white')"
                            cdkDropListOrientation="horizontal" (click)="getDetail(vehicle, vehicle.id)"
                            *ngFor=" let vehicle of  status.vehicles; let i=index" [cdkDragDisabled]="isMobile==true"
                            cdkDrag>
                            <span class="example-custom-placeholder" *cdkDragPlaceholder></span>

                            <span [ngClass]="{'text-danger': vehicle.special ==true}" title="{{vehicle.make}}"
                              class="car-{{ vehicle.make| lowercase }} fs-30"></span>

                            <!-- <ng-container *ngIf="vehicle.make != 'Land Rover' && vehicle.make != 'Alfa Romeo'
                              && vehicle.make != 'koda' && vehicle.make !='Rolls Royce'">
                              <span title="{{vehicle.make}}" class="car-{{ vehicle.make| lowercase }} fs-30"></span>
                            </ng-container>

                            <ng-container *ngIf="vehicle.make == 'Land Rover'">
                              <span title="{{vehicle.make}}" class="car-land-rover fs-30"></span>
                            </ng-container>

                            <ng-container *ngIf="vehicle.make == 'Rolls Royce'">
                              <span title="{{vehicle.make}}" class="car-rolls-royce fs-30"></span>
                            </ng-container>

                            <ng-container *ngIf="vehicle.make == 'Alfa Romeo'">
                              <span title="{{vehicle.make}}" class="car-alfa-romeo fs-30"></span>
                            </ng-container>

                            <ng-container *ngIf="vehicle.make == 'koda'">
                              <span title="{{vehicle.make}}" class="car-skoda fs-30"></span> 
                            </ng-container>-->


                            <span class="d-block text-start">
                              <strong class="fs-12 fw-500 d-flex gap-2 align-items-center"
                                title="Click to view vehicle details" data-bs-toggle="modal"
                                data-bs-target="#editVehicle"
                                (click)="this.showVehicleListing = false; getDetail(vehicle, vehicle.id)"
                                [style.color]="vehicle.id == currentIndex? 'black' : (true ? 'black' : 'black')">
                                <i class="fa-solid fa-square border border-radius-1"
                                  style="color: {{vehicle.color}}"></i>
                                <small>{{
                                  vehicle.year }} {{ vehicle.make }} {{ vehicle.model }}</small></strong>
                              <strong class="fw-700 fs-11 py-1 line-height-150 text-secondary"
                                [ngClass]="{'blink text-danger': vehicle.jobsDone == true}">Jobs:
                                {{getJobStatusCount(vehicle,vehicle.jobs)}}/{{ vehicle.jobs.length }}</strong>
                              <strong class="badge badge-success ms-1" (click)="changePaidStatus(vehicle, false)"
                                title="Paid" *ngIf="vehicle.paid==true"><i class="fa-solid fa-dollar-sign"></i></strong>
                            </span>
                          </a>


                        </div>

                      </td>
                    </tr>

                  </ng-container>
                </table>
              </div>
            </div>
            <div class="p-4 border-top" *ngIf="this.showPanalNumber == 5">
              <div class="col-12 mt-4">
                <div class="bg-white border-radius-8 shadow">
                  <canvas baseChart [type]="'bar'" [data]="lineVehicleChartDataStatusUser" class="p-4 w-100 border-top"
                    [options]="lineChartOptionsVehicleStatusUser" [legend]="lineChartLegend"></canvas>
                </div>
              </div>
              <div class="col-12 mt-4">
                <div class="bg-white border-radius-8 shadow">
                  <canvas baseChart [type]="'bar'" [data]="lineVehicleChartDataStatus" class="p-4 w-100 border-top"
                    [options]="lineChartOptionsVehicleStatus" [legend]="lineChartLegend"></canvas>
                  <div class="input-group mb-4">
                    <ng-container *ngFor="let vehicle of vehiclesStatus; let i=index; let even=even">
                      <!-- <ng-container *ngIf="this.vehicle.id>0"> -->
                      <div class="table-container shadow-sm border-radius-8 border w-100 mx-4 mt-4"
                        data-bs-toggle="modal" data-bs-target="#editVehicle" (click)="getDetail(vehicle, 0 )">
                        <table title="Click to view vehicle detail "
                          class="table-bordered table-striped table-sm overflow-hidden border-radius-8 line-height-130 w-100">
                          <tr>
                            <th class="fs-13 w-25 bg-light">Year</th>
                            <td class="fs-13 w-25">{{vehicle.year}}</td>
                            <th class="fs-13 w-25 bg-light">Make</th>
                            <td class="fs-13 w-25">{{vehicle.make}}</td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Model</th>
                            <td class="fs-13 w-25">{{vehicle.model}}</td>
                            <th class="fs-13 w-25 bg-light">Color</th>
                            <td class="fs-13 w-25">{{vehicle.color}}</td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Description</th>
                            <td class="fs-13 w-75" colspan="3">{{vehicle.description}}</td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Customer Fist/Last Name</th>
                            <td class="fs-13 w-25">{{vehicle.customer.title}} {{vehicle.customer.firstName}}
                              {{vehicle.customer.lastName}}</td>
                            <th class="fs-13 w-25 bg-light">Phone</th>
                            <td class="fs-13 w-25">{{formatPhoneNumber(vehicle.customer.phone)}}</td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Job Request</th>
                            <td class="fs-13 w-25"><ng-container
                                *ngFor="let jobRequestType of jobRequestTypes; let i=index"><ng-container
                                  *ngIf="vehicle.jobRequestType==jobRequestType.id"><strong>
                                    {{jobRequestType.name}}</strong></ng-container></ng-container></td>
                            <th class="fs-13 w-25 bg-light">Work Request</th>
                            <td class="fs-13 w-25">{{vehicle.workRequest}}</td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Vehicle Status</th>
                            <td class="fs-13 w-25"><ng-container *ngFor="let option of statuss; let i=index"><strong
                                  *ngIf="vehicle.status==option.id">{{option.name}}</strong></ng-container></td>
                            <th class="fs-13 w-25 bg-light">Parking Location</th>
                            <td class="fs-13 w-25"><ng-container *ngFor="let location of locations; let i=index"><label
                                  *ngIf="vehicle.location==location.id">{{location.name}}</label></ng-container></td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Approval Status</th>
                            <td class="fs-13 w-25"><ng-container
                                *ngFor="let approvalStatus of approvalStatuss; let i=index"><label
                                  *ngIf="vehicle.approvalStatus==approvalStatus.id">{{approvalStatus.name}}</label></ng-container>
                            </td>
                            <th class="fs-13 w-25 bg-light">Paid Status</th>
                            <td class="fs-13 w-25">
                              <strong class="badge badge-success" *ngIf="vehicle.paid==true"
                                (click)="changePaidStatus(vehicle, false)">Paid</strong>
                              <strong class="badge badge-danger" *ngIf="vehicle.paid==false"
                                (click)="changePaidStatus(vehicle, true)">Not Paid</strong>
                            </td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Rental Expires</th>
                            <td class="fs-13 w-25">{{vehicle.rentalDate | date}} </td>
                            <th class="fs-13 w-25 bg-light">Target Date</th>
                            <td class="fs-13 w-25">{{vehicle.targetDate | date}} </td>
                          </tr>
                          <tr>
                            <th class="fs-13 w-25 bg-light">Been</th>
                            <td class="fs-13 w-75" colspan="3">{{vehicle.daysInShop}} Days</td>
                          </tr>
                        </table>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
            <div class="p-4 border-top" *ngIf="this.showPanalNumber == 1 ">
              <div class="table-container shadow border-radius-8 border w-100">

                <full-calendar [options]="calendarOptions">
                  <ng-template #eventContent let-arg> <span class="tooltipTest"
                      id="{{arg.event.extendedProps['jobRequestType']}} at {{arg.event.extendedProps['location']}} been {{arg.event.extendedProps['days']}} days">{{arg.event.title}}<br>
                      <small>{{arg.event.extendedProps['description']}}</small> </span> </ng-template>
                </full-calendar>
                <br />
                <br />
              </div>
            </div>
            <div class="p-4 border-top" *ngIf="this.showPanalNumber == 2 ">
              <div class="table-container shadow border-radius-8 border w-100">
                <div class="row mx-n2" id="gridView">
                  <div class="col-lg-4" [style.border-color]="i == cindex? '#1580da' : (even ? '#EEE' : '#EEE')"
                    *ngFor="let vehicle of vehicles| paginate: { itemsPerPage: this.pageSize,currentPage: currantPageNumber , totalItems: searchCount}; let i = index;  let even=even">
                    <div class="parts-box bg-white border-radius-8 py-4 px-3 mt-4 shadow-sm position-relative"> <img
                        class="img-fluid w-100 border-radius-8" *ngIf="vehicle.showInSearchImageId !=0"
                        src="{{baseUrlResizeImage + '/' + vehicle.showInSearchImageId}}" alt="Image" />
                      <h2 class="fs-18 fw-700 py-2 line-height-150" *ngIf="currentUser"> {{ vehicle.year }} - {{
                        vehicle.make }} - {{ vehicle.model }} - {{ vehicle.color}} </h2>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        {{
                        vehicle.description }}</p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        {{
                        vehicle.workRequest }}</p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        Job Request Type:
                        <select class="form-select mt-2" [(ngModel)]="vehicle.jobRequestType"
                          placeholder="Job Requst Type" #jobRequestType
                          (change)="onChangeJobRequestType($event, jobRequestType.value)">
                          <option *ngFor="let jobRequestType of jobRequestTypes let i=index"
                            value="{{jobRequestType.id}}">{{jobRequestType.name}} </option>
                        </select>
                      </p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        Status:
                        <select class="form-select mt-2" [(ngModel)]="vehicle.status" placeholder="status" #device
                          [disabled]="user.allowUpdateVehicleStatus == false"
                          (change)="onChangeStatus($event, device.value)">
                          <option *ngFor="let option of statuss; let i=index" value="{{option.id}}">{{option.name}}
                          </option>
                        </select>
                      </p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        Assigned To:
                        <select class="form-select mt-2" [(ngModel)]="vehicle.assignedTo" placeholder="status"
                          #assignedTo [disabled]="user.allowUpdateVehicleStatus == false"
                          (change)="onChangeAssignedTo($event, assignedTo.value)">
                          <option *ngFor="let employee of employees; let i=index" value="{{employee.id}}">
                            {{employee.firstName}} {{employee.lastName}}</option>
                        </select>
                      </p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        Key Location:
                        <select class="form-select mt-2" [(ngModel)]="vehicle.keyLocation" placeholder="Key Location"
                          #keyLocation [disabled]="user.allowUpdateVehicleStatus == false"
                          (change)="onChangeKeyLocation($event, keyLocation.value)">
                          <option *ngFor="let employee of employees; let i=index" value="{{employee.id}}">
                            {{employee.firstName}} {{employee.lastName}}</option>
                        </select>
                      </p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        <button class="alert alert-success p-2 border-0 text-success fs-11 rounded-8 m-0"
                          *ngIf="vehicle.paid==true" [disabled]="user.allowAddPayment == false"
                          (click)="changePaidStatus(vehicle, false)">PAID</button>
                        <button class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                          *ngIf="vehicle.paid==false" [disabled]="user.allowAddPayment == false"
                          (click)="changePaidStatus(vehicle, true)">UNPAID</button>
                      </p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        {{
                        vehicle.createdAt | date: 'MM/dd/yyyy' }}</p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        Due Day:
                        <ng-container *ngIf="vehicle.targetDate != null && vehicle.targetDateCountDown >= 0"> <span
                            class="alert alert-secondary p-2 border-0 text-dark fs-11 rounded-8 m-0"
                            title="{{vehicle?.targetDate | date: 'MM/dd/yyyy'}}">{{vehicle.targetDateCountDown}}</span>
                        </ng-container>
                        <ng-container *ngIf="vehicle.targetDate != null && vehicle.targetDateCountDown < 0"> <span
                            class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                            title="{{vehicle?.targetDate | date: 'MM/dd/yyyy'}}">{{vehicle.targetDateCountDown}}</span>
                        </ng-container>
                      </p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        Rental Due Day:
                        <ng-container *ngIf="
                        vehicle.rentalDate != null && vehicle.rentalCountDown >= 0 "> <span
                            class="alert alert-secondary p-2 border-0 text-dark fs-11 rounded-8 m-0"
                            title="{{vehicle?.loanerCarName}} {{vehicle?.rentalDate | date: 'MM/dd/yyyy'}}">{{vehicle.rentalCountDown}}</span>
                        </ng-container>
                        <ng-container *ngIf=" vehicle.rentalDate !=null && vehicle.rentalCountDown < 0 "> <span
                            class="alert alert-danger p-2 border-0 text-danger fs-11 rounded-8 m-0"
                            title="{{vehicle?.loanerCarName}} {{vehicle?.rentalDate | date: 'MM/dd/yyyy'}}">{{vehicle.rentalCountDown}}</span>
                        </ng-container>
                      </p>
                      <p class="fs-12 opacity-75 text-dark d-block pt-3 line-height-130"
                        style="word-break: break-word;">
                        Vehicle Location:
                        <select class="form-select border-radius-4" [(ngModel)]="vehicle.location"
                          placeholder="location" #deviceLocation
                          (change)="onChangeLocation($event, deviceLocation.value)">
                          <option *ngFor="let option of locations; let i=index" value="{{option.id}}">{{option.name}}
                          </option>
                        </select>
                      </p>
                      <h3
                        class="fs-16 fw-700 text-white bg-navy py-2 px-4 mt-4 rounded-end-5 position-absolute bottom-0 start-0 mb-4">
                        ${{vehicle.price}}</h3>
                      <div class="d-flex align-items-center gap-2 justify-content-end mt-4">
                        <button class="btn btn-outline-primary btn-sm mt-2" data-bs-toggle="modal"
                          data-bs-target="#editVehicle" (click)="getDetail(vehicle, i)">Details</button>
                        <button class="btn btn-outline-warning btn-sm mt-2" title="Archieve "
                          (click)="archiveVehicle(vehicle)" *ngIf="this.currentUser != null && this.user != null && 
                          this.user.allowAddAndUpdateVehicle==true && 
                            this.user.allowArchiveVehicle==true
                         && this.vehicle.companyId == this.user.companyId">Archive</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-flex align-items-center justify-content-between my-4 table-bottom">
                <div class="d-flex align-items-center gap-3 my-2"> <span>Showing</span>
                  <select class="form-select px-3" [(ngModel)]="pageSize" title="Page Size"
                    (change)="searchVehicle(this.searchType, 0, pageSize)">
                    <option>10</option>
                    <option>20</option>
                    <option>30</option>
                    <option>40</option>
                    <option>50</option>
                    <option>60</option>
                    <option>70</option>
                    <option>80</option>
                    <option>90</option>
                    <option>100</option>
                    <option>200</option>
                    <option>300</option>
                  </select>
                  <span>of {{this.searchCount}} entries</span>
                  <input type="checkbox" class="ms-2" title="Remember My Page Size" [checked]="this.pageSize !=20 "
                    (change)="rememberMe()" />
                </div>
                <nav class="paginations my-2">
                  <ul class="pagination d-flex align-items-center gap-3">
                    <pagination-controls previousLabel="Prev" nextLabel="Next" [maxSize]=10
                      (pageChange)="searchVehicle(this.searchType,$event, pageSize)"> </pagination-controls>


                  </ul>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
      <section class="vehicles-jobs mt-5 pt-3" *ngIf="!showVehicleListing">

        <ul class="nav nav-pills my-3 mx-2" id="pills-tab" role="tablist" *ngIf="currentUser">
          <li class="nav-item me-3" role="presentation">
            <button class="nav-link bg-success p-3 rounded-pill fs-12 text-uppercase text-white fw-bold shadow"
              (click)="toggleDivs()" type="button" role="tab" aria-controls="overview-tabs" aria-selected="true"><i
                class="fa fa-home fa-2x"></i>
              Home</button>
          </li>

          <li class="nav-item me-3" role="presentation">
            <button class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="ai-tab"
              data-bs-toggle="pill" data-bs-target="#ai-tabs" type="button" role="tab" aria-controls="ai-damages"
              aria-selected="false"><i class="fa fa-circle me-1"></i> AI Assistants
            </button>
          </li>

          <li class="nav-item me-3" role="presentation">
            <button class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="claims-tab"
              data-bs-toggle="pill" data-bs-target="#claims-tabs" type="button" role="tab"
              aria-controls="claims-damages" aria-selected="false"><i class="fa fa-circle me-1"></i> Estimates
              ({{claims.length}})</button>
          </li>

          <li class="nav-item me-3" role="presentation">
            <button class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="purchase-orders-tab"
              data-bs-toggle="pill" data-bs-target="#purchase-orders-tabs" type="button" role="tab"
              aria-controls="purchase-orders-damages" aria-selected="false"><i class="fa fa-circle me-1"></i> Purchase
              Orders
              ({{purchaseOrders.length}})</button>
          </li>

          <li class="nav-item me-3" role="presentation">
            <button class="nav-link  active py-3 px-4 rounded-pill fs-12 text-uppercase fw-bold shadow"
              id="autoparts-tab" data-bs-toggle="pill" data-bs-target="#autoparts-tabs" type="button" role="tab"
              aria-controls="autoparts-tabs" aria-selected="false"><i class="fa fa-circle me-1"></i> Parts
              ({{autopartsSearch.length}})</button>
          </li>
          <li class="nav-item me-3" role="presentation">
            <button class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="payments-tab"
              data-bs-toggle="pill" data-bs-target="#payment-tabs" type="button" role="tab" aria-controls="payment-tabs"
              aria-selected="false"><i class="fa fa-circle me-1"></i> Payments
              ({{payments.length}})</button>
          </li>
          <li class="nav-item me-3" role="presentation">
            <button (click)="calendarKicker(); fillCalendarVehicleJob();"
              class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="jobs-tab" data-bs-toggle="pill"
              data-bs-target="#jobs-damages" type="button" role="tab" aria-controls="jobs-damages"
              (click)="findAllCurrentEmplyeeJobs()" aria-selected="false"><i class="fa fa-circle me-1"></i> Jobs
              ({{jobCompletedCount}}/{{jobs.length}})</button>
          </li>
          <li class="nav-item me-3" role="presentation">
            <button class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="receipts-tab"
              data-bs-toggle="pill" data-bs-target="#receipt-damages" type="button" role="tab"
              aria-controls="receipt-damages" aria-selected="false"><i class="fa fa-circle me-1"></i> Counter Invoice
              ({{receipts.length}})</button>
          </li>
          <li class="nav-item me-3" role="presentation">
            <button class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="histories-tab"
              data-bs-toggle="pill" data-bs-target="#histories-damages" type="button" role="tab"
              (click)="getVehicleHistory(vehicle.id)" aria-controls="histories-tab"
              title="Click to get change histories" aria-selected="false"><i class="fa fa-circle me-1"></i> Histories
              ({{vehicleHistories.length}})</button>
          </li>
          <li class="nav-item me-3" role="presentation">
            <button (click)="calendarKicker(); fillCalendar();"
              class="nav-link p-3 rounded-pill fs-12 text-uppercase fw-bold shadow" id="schedule-damage"
              data-bs-toggle="pill" data-bs-target="#schedule-damages" type="button" role="tab"
              aria-controls="schedule-damages" aria-selected="false"><i class="fa fa-circle me-1"></i>
              Schedule</button>
          </li>
        </ul>
        <div class="tab-content px-1" id="nav-tabContent">

          <div class="tab-pane fade show" id="ai-tabs" role="tabpanel" #taggroup aria-labelledby="ai-damages-tab">
            <h2 class="heading-color fw-700 text-uppercase pt-5 fs-16 pb-3">AI Estimates for: <strong
                class="text-primary fw-700" data-bs-toggle="modal" data-bs-target="#editVehicle"
                style="cursor: pointer;" title="Click to view details">{{vehicle.year}}
                {{vehicle.make}}
                {{vehicle.model}} {{vehicle.color}}</strong>
              <!-- <span class="text-danger" title="Total estimates">
                [${{getTotalClaims()}}]</span>
              - <span class="text-danger" title="Total payments">[${{getTotalPayments()}}] </span>
              = <span class="text-danger" title="Balance">[${{getTotalBalance()}}]
              </span> -->
            </h2>
            <!-- <div class="d-lg-flex align-items-center justify-content-between px-1 mt-3">
              <div class="d-flex align-items-center gap-3 w-50 v-receipt">
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.paymentMethod" #paymentMethod
                  title="Payment Methods" (change)="onChangeVehiclePaymentMethod($event, paymentMethod.value)">
                  <option value="0" disabled selected>Select Payment Method</option>
                  <option [value]="paymentMethod.id" *ngFor="let paymentMethod of paymentMethods;let i=index;">
                    {{paymentMethod.name}}</option>
                </select>
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="disclaimerId" #optionDisclaimerId
                  title="Disclaimers" (change)="setDisclaimerText(optionDisclaimerId.value)">
                  <option value="0" disabled selected>Select Disclaimer</option>
                  <option [value]="disclaimer.id" *ngFor="let disclaimer of disclaimers;let i=index;">
                    {{disclaimer.name}} <span *ngIf="disclaimer.isDefault ==true">(default)</span></option>
                </select>
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="warrantyId" #optionWarrantyId
                  title="Warranties" (change)="setWarrantyText(optionWarrantyId.value)">
                  <option value="0" disabled selected>Select Warranty</option>
                  <option [value]="warranty.id" [selected]="warranty.isDefault == true"
                    *ngFor="let warranty of warranties;let i=index;">
                    {{warranty.name}} <span *ngIf="warranty.isDefault ==true">(default)</span></option>
                </select>
                <div class="form-check form-switch d-flex ms-3 mw-150">
                  <input class="form-check-input mt-0" type="checkbox" role="switch" id="tax"
                    title="Apply Tax or No Tax" (change)="onChangeNoTax($event)" />
                  <label class="form-check-label fa-13 mt-1 ms-4" for="tax">No Tax</label>
                </div>
              </div>
              <div class="add-r">


                <div class="dropdown h-40 fs-13 mt-2 btn btn-primary px-1 border-radius-4 ms-md-2"
                  *ngIf="user.allowAddUpdateEstimate == true">
                  <button class="dropdown-toggle btn-primary" type="button" data-bs-toggle="dropdown"
                    aria-expanded="false"><i class="fa fa-plus me-2"></i> Add Item
                    <i class="fa fa-angle-down ms-2"></i></button>
                  <ul class="dropdown-menu p-0 border-0">
                    <ng-container *ngFor="let itemType of itemTypes; let i=index">
                      <li><a (click)="createClaimClaim(itemType);" class="dropdown-item p-3 fs-12"
                          href="javascript:;"><i class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                          {{itemType.name}}
                          <ng-container *ngIf="itemType.createPurchaseOrder == true">
                            <span class="fw-700 text-primary opacity-50"> <i
                                class="fa-solid fa-cart-shopping"></i></span>
                          </ng-container>
                          <ng-container *ngIf="itemType.createJobOrder == true">
                            <span class="fw-700 text-info"> <i class="fa-solid fa-user"></i> </span>
                          </ng-container>
                        </a></li>
                    </ng-container>
                  </ul>
                </div>

                <div class="dropdown h-40 fs-13 mt-2 btn btn-primary px-1 border-radius-4 ms-md-2"
                  *ngIf="user.allowAddPayment == true">
                  <button class="dropdown-toggle btn-primary" type="button" data-bs-toggle="dropdown"
                    aria-expanded="false"><i class="fa fa-plus me-2"></i> Add Payment
                    <i class="fa fa-angle-down ms-2"></i></button>
                  <ul class="dropdown-menu p-0 border-0">
                    <ng-container *ngFor="let paymentType of paymentTypes; let i=index">
                      <li><a (click)="addVehiclePayment(paymentType); scrollToSection('payments')"
                          class="dropdown-item p-3 fs-12" href="javascript:;"><i
                            class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                          {{paymentType.name}}</a></li>
                    </ng-container>
                  </ul>
                </div>
                <button *ngIf="hasPOorJO() == true" title="Show Estimate items only toggle"
                  (click)="this.showEstimatesOnly =!showEstimatesOnly"
                  class="h-40 fs-13 mt-2 btn btn-warning border-radius-4 ms-md-2"><i
                    class="fa fa-toggle-on  me-2  fa-2x"></i></button>

                <button *ngIf="filterClaims(0).length > 0" [disabled]="user.allowLockEstimate == false"
                  (click)="lockAllEstimates(1)" title="Lock all estimates"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                    class="fa fa-lock me-2"></i>({{filterClaims(0).length}})</button>
                <button *ngIf="filterClaims(1).length > 0" [disabled]="user.allowLockEstimate == false"
                  (click)="lockAllEstimates(0)" title="Unlock all estimates"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                    class="fa fa-lock-open me-2"></i>({{filterClaims(1).length}})</button>

                <button *ngIf="claims.length > 0" (click)="printPage('print-content-estimate', 'Estimates')"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                    class="fa fa-print me-2"></i> Print Estimate ({{claims.length}})</button>


              </div>
            </div> -->
            <div class="border bg-white border-radius-8 shadow mt-4">
              <div class="row">
                <div class="mt-2 pt-1">
                  <div class="d-lg-flex justify-content-between px-1 mt-3">
                    <textarea rows="8" class="col-10" [(ngModel)]="vehicle.workRequest"></textarea>
                    <div class="col-2">
                      <button class="h-40 w-100 fs-13 btn btn-secondary-abs border-radius-4 ms-md-2"
                        [disabled]="disenabledGetAiEstimate" (click)="getAiEstimate()">
                        <i *ngIf="!disenabledGetAiEstimate" class="fa fa-check-square me-2"></i>
                        <i *ngIf="disenabledGetAiEstimate" class="fa fa-circle-o-notch fa-spin me-2"
                          style="animation-duration: 0.8s;"></i>
                        <span *ngIf="!disenabledGetAiEstimate">Get Estimates</span>
                        <span *ngIf="disenabledGetAiEstimate">Waiting for AI Response</span>
                        <span *ngIf="aiImages.length > 0 && !disenabledGetAiEstimate">({{aiImages.length}})</span>
                      </button>
                      <button *ngIf="estimateResponse.estimates != null && estimateResponse.estimates.length > 0"
                        class="h-40 w-100 fs-13 btn btn-secondary-abs border-radius-4 ms-md-2 mt-1"
                        (click)="printPage('print-ai-estimate', 'Estimates')"><i class="fa fa-print me-2"></i> Print
                        Estimates <span *ngIf="aiImages.length > 0"></span></button>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row mt-1" *ngIf="estimateResponse.message != null && estimateResponse.message !=''">
                <div class="pt-1">
                  <div class="col-12 p-1">
                    <div class="form-group">
                      <div class="form-group">
                        <div class="alert alert-danger fs-13" role="alert">
                          {{ estimateResponse.message }}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="row overflow-x-auto overflow-y-hidden">
                <div class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-4">
                  <div *ngFor='let imageModel of vehicle.imageModels; let i=index'
                    class="containerImage v-imgs float-start my-2 transition" style="cursor: pointer;">

                    <ng-container *ngFor="let docType of this.docTypes">

                      <ng-container *ngIf="docType.name !='Not Sorted'">
                        <label class="top-left-8 badge" for="title" *ngIf="imageModel.docType == docType.id"
                          style="color:{{docType.color}}">
                          {{docType.name}} </label>
                      </ng-container>
                    </ng-container>

                    <img class="preview img-fluid img-thumbnail" width="100%"
                      title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}} Click to attach this image"
                      *ngIf="isInAiImageArray(imageModel.id) == false"
                      src="{{baseUrlResizeImage + '/' + imageModel.id}}" (click)="addToAiImageArray(imageModel.id)"
                      style="border: 3px solid #555;">
                    <img class="preview img-fluid img-thumbnail" width="100%"
                      title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}} Click to remove from request"
                      *ngIf="isInAiImageArray(imageModel.id) == true" src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                      (click)="addToAiImageArray(imageModel.id)" title="Show in search"
                      style="border: 3px solid lightcoral;">
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-1">
              <div class="mt-4 pt-1 px-0">
                <table class="col-12 w-100 px-1 border bg-white border-radius-8 shadow">
                  <tr class="text-center h-40 bg-secondary text-white">
                    <th class="text-center v-align-middle mw-50"> # </th>
                    <th class="text-center v-align-middle mw-50"> Ind </th>
                    <th class="text-center v-align-middle  mw-100"> Oper </th>
                    <th class="text-center v-align-middle"> Description </th>
                    <th class="text-center v-align-middle" *ngIf="showEmployees == false"> Part Number
                    </th>
                    <th class="text-center v-align-middle" *ngIf="showEmployees == false"> Qty </th>
                    <th class="text-center v-align-middle" *ngIf="showEmployees == false"> Ext.
                      Price $
                    </th>
                    <th class="text-center v-align-middle mw-50"> Labor </th>
                    <th class="text-center v-align-middle mw-50" *ngIf="showEmployees == true"><i
                        class="fa-solid fa-home"></i> </th>
                    <th class="text-center v-align-middle mw-50" *ngIf="showEmployees == true"><i
                        class="fa-solid fa-dollar-sign"></i></th>
                    <th class="text-center v-align-middle mw-50" *ngIf="showEmployees == false"> Action
                    </th>

                  </tr>
                  <ng-container *ngFor="let claim of estimateResponse.estimates; let i=index">
                    <tr (click)="setDetailClaimAi(claim, claim.index)"
                      [style.background-color]="claim.index == indexAi ? 'lightyellow' : (true ? 'white' : 'white')">
                      <td class="text-center v-align-middle h-40 ">
                        {{claim.index}}</td>
                      <td colspan="7" class="v-align-middle h-40 fw-700 px-1">
                        {{claim.notes}}</td>
                      <td class="text-center v-align-middle">
                        <button class="btn btn-secondary btn-sm" [disabled]="claim.id > 0" title="Add Estimate"
                          (click)="addClaimFromAi(claim)"><i class="fa fa-plus"></i></button>
                      </td>
                    </tr>
                    <tr *ngFor="let part of claim.autoparts; let j=index "
                      [style.background-color]="part.index == indexAi ? 'lightyellow' : (true ? 'white' : 'white')"
                      (click)="setDetailAutopartAi(part, part.index)">
                      <td class="text-center v-align-middle">{{part.index}}</td>
                      <td class="text-left v-align-middle">*</td>
                      <td class="text-center v-align-middle">Repl</td>
                      <td class="text-left v-align-middle text-primary">{{part.title}}</td>
                      <td class="text-center v-align-middle">
                        <a *ngIf="part.partNumber != null && part.partNumber !=''" target="_blank"
                          href='https://google.com/search?q={{part.partNumber}}'>
                          {{part.partNumber}}
                        </a>
                      </td>
                      <td class="text-center v-align-middle">1</td>
                      <td class="text-right v-align-middle">{{part.price}}.00</td>
                      <td class="text-right v-align-middle"></td>
                      <td class="text-center v-align-middle">
                        <button class="btn btn-warning btn-sm" [disabled]="part.id > 0" title="Add Parts"
                          (click)="addAutopartFromAi( part)"><i class="fa fa-plus"></i></button>
                      </td>
                    </tr>
                    <tr *ngFor="let job of claim.jobs; let k=index " (click)="setDetailJobAi(job, job.index)"
                      [style.background-color]="job.index == indexAi ? 'lightyellow' : (true ? 'white' : 'white')">
                      <td class="text-center v-align-middle">{{job.index}}</td>
                      <td class="text-left v-align-middle">**</td>
                      <td class="text-center v-align-middle">
                        <ng-container *ngFor="let jobOrderType of this.jobOrderTypes">
                          <span *ngIf="job.jobRequestType == jobOrderType.id"
                            title="{{jobOrderType.description}}">{{jobOrderType.code}}</span>
                        </ng-container>
                      </td>
                      <td class="text-left v-align-middle">{{job.notes}}</td>
                      <td class="text-center v-align-middle"></td>
                      <td class="text-center v-align-middle">1</td>
                      <td class="text-right v-align-middle">{{job.price}}.00</td>
                      <td class="text-right v-align-middle">{{job.hours}}</td>
                      <td class="text-center v-align-middle">
                        <button class="btn btn-info btn-sm" title="Add Job Order" [disabled]="job.id > 0"
                          (click)="addJobFromAi(job)"><i class="fa fa-plus"></i></button>
                      </td>
                    </tr>
                    <tr>
                      <td colspan="10">
                        <hr>
                      </td>
                    </tr>
                  </ng-container>
                </table>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-8"></div>
              <div class="col-lg-1 col-md-12"></div>
              <div class="col-lg-5 col-md-4 p-0">
                <ul>
                  <li class="d-flex justify-content-between my-4"><strong class="fs-15">ESTIMATE TOTALS</strong>
                  </li>
                  <li *ngFor="let receipt of estimateResponse.receipts"
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">{{receipt.notes}}:</strong>
                    <p class="fs-15 px-1">${{receipt.amount}}</p>
                  </li>
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">Total:</strong>
                    <p class="fs-15 px-1">${{getReceiptTotal()}}</p>
                  </li>

                </ul>
              </div>
            </div>
            <div class="row mt-4">
              <div class="mt-4 pt-1">
                <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                  <div class="table-responsive jobs-table bg-white border-radius-8 shadow" cdkDropList
                    (cdkDropListDropped)="droppedClaim($event)">
                    <table class="table table-bordered table-sm">
                      <thead>
                        <tr>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                            style="width: 50px;">#</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                            title="Click to go to Configuration" [routerLink]="'/item-types'"
                            style="width:120px; cursor: pointer; ">Item Type</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Estimate Item
                            Description
                          </th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                            style="width: 50px;">
                            Quantity</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                            style="width:100px"><i class="fa-solid fa-dollar-sign"></i></th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width: 100px;">Subtotal</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width: 120px;"><i class="fa-solid fa-clock"></i>
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width: 120px;">Locked <i class="fa-solid fa-clock"></i></th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                              class="fa-solid fa-user"></i></th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle" style="width:100px;">
                            Action</th>
                        </tr>


                      </thead>
                      <tbody>
                        <ng-container *ngFor="let claim of estimateResponse.estimates; let i=index">
                          <tr (click)="setClaimId(claim.id)" class="shadow"
                            [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                            <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                              title="Drag and drop index number to change the order" [cdkDragDisabled]="isMobile==true"
                              cdkDrag>
                              {{claim.index}}</td>
                            <td class="p-2 text-center">
                              <select class="form-select h-48 px-3 border-radius-8 "
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                (change)="onEnterClaimClaim('item type',claim)" [(ngModel)]="claim.itemType">
                                <option value="0" disabled selected>Select Type</option>
                                <option value="0" *ngIf="claim.itemType>0">Un-select Type</option>
                                <option [value]="itemType.id" *ngFor="let itemType of itemTypes;let i=index;">
                                  {{itemType.name}}
                                </option>
                              </select>
                            </td>
                            <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes" class="form-control"
                                [ngClass]="{'blink border-danger': claim.notes == ''|| claim.notes == null }"
                                placeholder="Please Specify" (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                maxlength="200"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea></td>

                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('quantity',claim)"
                                [(ngModel)]="claim.quantity"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>
                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('amount',claim)"
                                [(ngModel)]="claim.amount"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>

                            <td class="fs-13 p-2 text-center v-align-middle">${{getClaimSubTotal(claim)}}</td>
                            <td class="fs-13 p-2 text-center v-align-middle">
                              {{claim.createdAt | date: 'MM/dd/yyyy'}}
                            </td>
                            <td class="fs-13  p-2 text-center v-align-middle"><span
                                *ngIf="claim.status==1">{{claim.lockedAt |
                                date: 'MM/dd/yyyy' }}</span></td>
                            <td class="p-2 text-center  v-align-middle">


                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == claim.userId">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>



                            </td>
                            <td class="p-2 text-center">
                              <div class="d-flex align-items-center justifyc-cntent-center gap-1">
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==1"
                                  [disabled]="user.allowUnlockEstimate == false" title="Unlock this estimate item"
                                  (click)="lockClaim('unlock', claim)"><i class="fa fa-lock-open"></i></button>
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==0"
                                  [disabled]="user.allowLockEstimate == false" title="Lock this estimate item"
                                  (click)="lockClaim('lock', claim)"><i class="fa fa-lock"></i></button>
                                <button class="btn btn-outline-danger btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status ==1" title="Delete"
                                  (click)="deleteVehicleClaim(null, claim)"><i class="fa fa-trash"></i></button>
                                <button class="btn btn-outline-success btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1" title="Save"
                                  (click)="onEnterClaimClaim('update', claim)"><i class="fa fa-save"></i></button>

                                <button class="btn btn-navy bg-navy text-white btn-sm"
                                  *ngIf="showEstimatesOnly == false && claim.createPurchaseOrder == true && claim.notes !=''"
                                  data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                                  [disabled]="user.allowAddUpdatePurchaseOrder == false " title="Add Purchase Order"
                                  (click)="addPurchaseOrderToClaim( claim)"><i class="fa fa-plus"></i></button>

                                <button class="btn btn-info btn-sm"
                                  *ngIf="showEstimatesOnly == false && claim.createJobOrder == true && claim.notes !=''"
                                  [disabled]="user.allowAddService == false" title="Add Job Order"
                                  (click)="addJobToClaim( claim)"><i class="fa fa-plus"></i></button>


                              </div>
                            </td>
                          </tr>


                        </ng-container>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>


            <br />
            <br />
          </div>

          <div class="tab-pane fade show" id="claims-tabs" role="tabpanel" #taggroup
            aria-labelledby="claims-damages-tab">
            <h2 class="heading-color fw-700 text-uppercase pt-5 fs-16 pb-3">Vehicle Estimates for: <strong
                class="text-primary fw-700" data-bs-toggle="modal" data-bs-target="#editVehicle"
                style="cursor: pointer;" title="Click to view details">{{vehicle.year}}
                {{vehicle.make}}
                {{vehicle.model}} {{vehicle.color}} ({{ claims.length}})</strong><span class="text-danger"
                title="Total estimates">
                [${{getTotalClaims()}}]</span>
              - <span class="text-danger" title="Total payments">[${{getTotalPayments()}}] </span>
              = <span class="text-danger" title="Balance">[${{getTotalBalance()}}]</span>
            </h2>
            <div class="d-lg-flex align-items-center justify-content-between px-1 mt-3">
              <div class="d-flex align-items-center gap-3 w-50 v-receipt">
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.paymentMethod" #paymentMethod
                  title="Payment Methods" (change)="onChangeVehiclePaymentMethod($event, paymentMethod.value)">
                  <option value="0" disabled selected>Select Payment Method</option>
                  <option [value]="paymentMethod.id" *ngFor="let paymentMethod of paymentMethods;let i=index;">
                    {{paymentMethod.name}}</option>
                </select>
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="disclaimerId" #optionDisclaimerId
                  title="Disclaimers" (change)="setDisclaimerText(optionDisclaimerId.value)">
                  <option value="0" disabled selected>Select Disclaimer</option>
                  <option [value]="disclaimer.id" *ngFor="let disclaimer of disclaimers;let i=index;">
                    {{disclaimer.name}} <span *ngIf="disclaimer.isDefault ==true">(default)</span></option>
                </select>
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="warrantyId" #optionWarrantyId
                  title="Warranties" (change)="setWarrantyText(optionWarrantyId.value)">
                  <option value="0" disabled selected>Select Warranty</option>
                  <option [value]="warranty.id" [selected]="warranty.isDefault == true"
                    *ngFor="let warranty of warranties;let i=index;">
                    {{warranty.name}} <span *ngIf="warranty.isDefault ==true">(default)</span></option>
                </select>
                <div class="form-check form-switch d-flex ms-3 mw-150">
                  <input class="form-check-input mt-0" type="checkbox" role="switch" id="tax"
                    title="Apply Tax or No Tax" (change)="onChangeNoTax($event)" />
                  <label class="form-check-label fa-13 mt-1 ms-4" for="tax">No Tax</label>
                </div>
              </div>
              <div class="add-r">


                <div class="dropdown h-40 fs-13 mt-2 btn btn-primary px-1 border-radius-4 ms-md-2"
                  *ngIf="user.allowAddUpdateEstimate == true">
                  <button class="dropdown-toggle btn-primary" type="button" data-bs-toggle="dropdown"
                    aria-expanded="false"><i class="fa fa-plus me-2"></i> Add Item
                    <i class="fa fa-angle-down ms-2"></i></button>
                  <ul class="dropdown-menu p-0 border-0">
                    <ng-container *ngFor="let itemType of itemTypes; let i=index">
                      <li><a (click)="createClaimClaim(itemType);" class="dropdown-item p-3 fs-12"
                          href="javascript:;"><i class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                          {{itemType.name}}
                          <ng-container *ngIf="itemType.createPurchaseOrder == true">
                            <span class="fw-700 text-primary opacity-50"> <i
                                class="fa-solid fa-cart-shopping"></i></span>
                          </ng-container>
                          <ng-container *ngIf="itemType.createJobOrder == true">
                            <span class="fw-700 text-info"> <i class="fa-solid fa-user"></i> </span>
                          </ng-container>
                        </a></li>
                    </ng-container>
                  </ul>
                </div>

                <div class="dropdown h-40 fs-13 mt-2 btn btn-primary px-1 border-radius-4 ms-md-2"
                  *ngIf="user.allowAddPayment == true">
                  <button class="dropdown-toggle btn-primary" type="button" data-bs-toggle="dropdown"
                    aria-expanded="false"><i class="fa fa-plus me-2"></i> Add Payment
                    <i class="fa fa-angle-down ms-2"></i></button>
                  <ul class="dropdown-menu p-0 border-0">
                    <ng-container *ngFor="let paymentType of paymentTypes; let i=index">
                      <li><a (click)="addVehiclePayment(paymentType); scrollToSection('payments')"
                          class="dropdown-item p-3 fs-12" href="javascript:;"><i
                            class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                          {{paymentType.name}}</a></li>
                    </ng-container>
                  </ul>
                </div>
                <button *ngIf="hasPOorJO() == true" title="Show Estimate items only toggle"
                  (click)="this.showEstimatesOnly =!showEstimatesOnly"
                  class="h-40 fs-13 mt-2 btn btn-warning border-radius-4 ms-md-2"><i
                    class="fa fa-toggle-on  me-2  fa-2x"></i></button>

                <button *ngIf="filterClaims(0).length > 0" [disabled]="user.allowLockEstimate == false"
                  (click)="lockAllEstimates(1)" title="Lock all estimates"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                    class="fa fa-lock me-2"></i>({{filterClaims(0).length}})</button>
                <button *ngIf="filterClaims(1).length > 0" [disabled]="user.allowLockEstimate == false"
                  (click)="lockAllEstimates(0)" title="Unlock all estimates"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                    class="fa fa-lock-open me-2"></i>({{filterClaims(1).length}})</button>

                <button *ngIf="claims.length > 0" (click)="printPage('print-content-estimate', 'Estimates')"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                    class="fa fa-print me-2"></i> Print Estimate ({{claims.length}})</button>
                <!-- <button *ngIf="filterClaims(1).length > 0"
                  (click)="printPage('print-content-estimate-invoice', 'Final Invoice')"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-1 border-radius-4 ms-md-2"><i
                    class="fa fa-print me-2"></i> Print Invoice ({{filterClaims(1).length }})</button> -->

              </div>
            </div>
            <div class="row mt-4">
              <div class="mt-4 pt-1">
                <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                  <div class="table-responsive jobs-table bg-white border-radius-8 shadow" cdkDropList
                    (cdkDropListDropped)="droppedClaim($event)">
                    <table class="table table-bordered table-sm">
                      <thead>
                        <tr>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                            style="width: 50px;">#</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                            title="Click to go to Configuration" [routerLink]="'/item-types'"
                            style="width:120px; cursor: pointer; ">Item Type</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Estimate Item
                            Description
                          </th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                            style="width: 50px;">
                            Quantity</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                            style="width:100px"><i class="fa-solid fa-dollar-sign"></i></th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width: 100px;">Subtotal</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width: 120px;"><i class="fa-solid fa-clock"></i>
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width: 120px;">Locked <i class="fa-solid fa-clock"></i></th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                              class="fa-solid fa-user"></i></th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle" style="width:100px;">
                            Action</th>
                        </tr>


                      </thead>
                      <tbody>
                        <ng-container *ngFor="let claim of claims; let i=index">
                          <tr (click)="setClaimId(claim.id)" class="shadow"
                            [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                            <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                              title="Drag and drop index number to change the order" [cdkDragDisabled]="isMobile==true"
                              cdkDrag>
                              {{claim.id}}</td>
                            <td class="p-2 text-center">
                              <select class="form-select h-48 px-3 border-radius-8 "
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                (change)="onEnterClaimClaim('item type',claim)" [(ngModel)]="claim.itemType">
                                <option value="0" disabled selected>Select Type</option>
                                <option value="0" *ngIf="claim.itemType>0">Un-select Type</option>
                                <option [value]="itemType.id" *ngFor="let itemType of itemTypes;let i=index;">
                                  {{itemType.name}}
                                </option>
                              </select>
                            </td>
                            <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes" class="form-control"
                                [ngClass]="{'blink border-danger': claim.notes == ''|| claim.notes == null }"
                                placeholder="Please Specify" (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                maxlength="200"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea></td>

                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('quantity',claim)"
                                [(ngModel)]="claim.quantity"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>
                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('amount',claim)"
                                [(ngModel)]="claim.amount"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>

                            <td class="fs-13 p-2 text-center v-align-middle">${{getClaimSubTotal(claim)}}</td>
                            <td class="fs-13 p-2 text-center v-align-middle">
                              {{claim.createdAt | date: 'MM/dd/yyyy'}}
                            </td>
                            <td class="fs-13  p-2 text-center v-align-middle"><span
                                *ngIf="claim.status==1">{{claim.lockedAt |
                                date: 'MM/dd/yyyy' }}</span></td>
                            <td class="p-2 text-center  v-align-middle">


                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == claim.userId">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>



                            </td>
                            <td class="p-2 text-center">
                              <div class="d-flex align-items-center justifyc-cntent-center gap-1">
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==1"
                                  [disabled]="user.allowUnlockEstimate == false" title="Unlock this estimate item"
                                  (click)="lockClaim('unlock', claim)"><i class="fa fa-lock-open"></i></button>
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==0"
                                  [disabled]="user.allowLockEstimate == false" title="Lock this estimate item"
                                  (click)="lockClaim('lock', claim)"><i class="fa fa-lock"></i></button>
                                <button class="btn btn-outline-danger btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status ==1" title="Delete"
                                  (click)="deleteVehicleClaim(null, claim)"><i class="fa fa-trash"></i></button>
                                <button class="btn btn-outline-success btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1" title="Save"
                                  (click)="onEnterClaimClaim('update', claim)"><i class="fa fa-save"></i></button>

                                <button class="btn btn-navy bg-navy text-white btn-sm"
                                  *ngIf="showEstimatesOnly == false && claim.createPurchaseOrder == true && claim.notes !=''"
                                  data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                                  [disabled]="user.allowAddUpdatePurchaseOrder == false " title="Add Purchase Order"
                                  (click)="addPurchaseOrderToClaim( claim)"><i class="fa fa-plus"></i></button>

                                <button class="btn btn-info btn-sm"
                                  *ngIf="showEstimatesOnly == false && claim.createJobOrder == true && claim.notes !=''"
                                  [disabled]="user.allowAddService == false" title="Add Job Order"
                                  (click)="addJobToClaim( claim)"><i class="fa fa-plus"></i></button>


                              </div>
                            </td>
                          </tr>

                          <ng-container
                            *ngIf="showEstimatesOnly == false && claim.createPurchaseOrder == true && claim.purchaseOrders.length> 0 ">
                            <tr>
                              <!-- <td></td> -->
                              <td class="text-center fs-14 v-align-middle opacity-50"><i
                                  class="fa-solid fa-cart-shopping"></i></td>
                              <td colspan="9" cdkDropList
                                (cdkDropListDropped)="droppedPurchaseOrdersClaim($event, claim)">

                                <table class="table-bordered table-sm shadow overflow-hidden  line-height-100 w-100"
                                  *ngIf="claim.purchaseOrders.length >0">
                                  <thead>
                                    <tr>
                                      <th class="fs-12 text-center bg-navy text-white mw-50"
                                        (click)="sortListPurchseOrdersClaim('id',claim.purchaseOrders)"
                                        title="Sort By Most Recent">
                                        PO #
                                      </th>


                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('title',claim.purchaseOrders)"
                                        title="Sort By Item Name"> PO Item Name </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('partNumber',claim.purchaseOrders)"
                                        title="Sort By Parts Number"> Parts #
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-150"
                                        (click)="sortListPurchseOrdersClaim('description',claim.purchaseOrders)"
                                        title="Sort By Description">
                                        Description </th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('vendorId',claim.purchaseOrders)"
                                        title="Sort By Most Recent">Vender</th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('status',claim.purchaseOrders)"
                                        title="Sort By Status">Approval</th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('purchaseStatus',claim.purchaseOrders)"
                                        title="Sort By Status">Status
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('grade',claim.purchaseOrders)"
                                        title="Sort By Grade">
                                        Grade
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('salePrice',claim.purchaseOrders)"
                                        title="Sort By Price"><i class="fa-solid fa-dollar-sign"></i></th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('createdAt',claim.purchaseOrders)"
                                        title="Sort By Date"><i class="fa-solid fa-clock"></i></th>
                                      <th class="fs-12 text-center bg-navy text-white mw-50"><i
                                          class="fa-solid fa-user"></i>
                                      </th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100">Action</th>
                                    </tr>
                                  </thead>
                                  <ng-container
                                    *ngFor="let purchaseOrder of claim.purchaseOrders; let i = index;  let even=even">
                                    <tr id="{{vehicle.id}}" (click)="editPurchaseOrder(purchaseOrder, i)" title=""
                                      style="cursor: pointer;"
                                      [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        [cdkDragDisabled]="isMobile==true" cdkDrag>
                                        {{purchaseOrder.id}}
                                      </td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75"
                                          style="display: inline-block; word-break: break-word;">
                                          {{purchaseOrder.title}}</p>
                                      </td>
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75"
                                          style="display: inline-block; word-break: break-word;">
                                          {{purchaseOrder.partNumber}}</p>
                                      </td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                -webkit-box-orient: vertical;
                                -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                 overflow: hidden;"> {{purchaseOrder.description}}
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==1"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==2"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==3"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Returned At:{{ purchaseOrder.returnedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                        </p>
                                      </td>

                                      <td class="p-2 text-center  v-align-middle fs-12">

                                        <select class="form-select h-48 px-3 border-radius-8 fs-12"
                                          data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                                          style="height:30px; appearance: none; background-image: url('');" disabled
                                          [(ngModel)]="purchaseOrder.vendorId">
                                          <option [value]=" vendor.id" *ngFor="let vendor of vendors;let i=index;">
                                            {{vendor.name}}
                                          </option>
                                        </select>
                                      </td>

                                      <td title="Set Approval Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        class="text-center fs-12 v-align-middle">
                                        <select name="status" class="form-select border-radius-4 border fs-12" size="1"
                                          disabled style="height:30px; appearance: none; background-image: url('');"
                                          [(ngModel)]="purchaseOrder.status">
                                          <option value="0" selected>Not Submitted</option>
                                          <option value="1" style="color:green">For Approval</option>
                                          <option value="2" style="color:red">Rejected</option>
                                          <option value="3" style="color:blue">Approved</option>
                                        </select>
                                      </td>

                                      <td title="Set Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        class="text-center fs-12 v-align-middle">
                                        <select name="purchaseStatus" class="form-select border-radius-4 border fs-12"
                                          style="height:30px;" size="1"
                                          (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                          *ngIf="purchaseOrder.status == 3" [(ngModel)]="purchaseOrder.purchaseStatus">
                                          <option value="0" selected>No Status</option>
                                          <option value="1">Ordered</option>
                                          <option value="2">Received</option>
                                          <option value="3">Returned</option>
                                          <option value="4">Wrong Part</option>
                                        </select>
                                      </td>
                                      <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)"><select name="grade"
                                          style="height:30px; appearance: none; background-image: url('');"
                                          class="form-select h-48 border px-3 border-radius-8 fs-12" size="1" disabled
                                          [(ngModel)]="purchaseOrder.grade">
                                          <option value="undefined" disabled selected>Select Grade</option>
                                          <option value="A">A</option>
                                          <option value="B">B</option>
                                          <option value="C">C</option>
                                          <option value="Used">Used</option>
                                          <option value="New">New</option>
                                          <option value="Insurance">Insurance</option>
                                        </select></td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        ${{purchaseOrder.salePrice}}
                                      </td>
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        {{purchaseOrder.createdAt |
                                        date: 'MM/dd/yyyy'}} </td>
                                      <td class="p-2 text-center  v-align-middle fs-12">
                                        <ng-container *ngFor="let user of users;let i=index;">
                                          <span *ngIf="user.id == purchaseOrder.userId">
                                            {{(user.firstName + " " + user.lastName) | shortName:2}}
                                          </span>
                                        </ng-container>


                                      </td>
                                      <td class="text-center fs-12 v-align-middle">
                                        <div class="d-flex gap-1">
                                          <button class="btn btn-outline-danger btn-sm"
                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                            *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                            (click)="deletePurchaseOrderClaim(purchaseOrder, i, claim)">
                                            <i class="fa fa-trash"></i>
                                          </button>

                                          <button class="btn btn-outline-warning btn-sm"
                                            *ngIf="purchaseOrder.status ==0" title="Submit for Approval"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-right"></i>
                                          </button>

                                          <button class="btn btn-outline-warning btn-sm"
                                            *ngIf="purchaseOrder.status ==2" title="Re-Submit for Approval"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-right"></i>
                                          </button>

                                          <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==1"
                                            title="Reject It"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-ban"></i>
                                          </button>

                                          <button class="btn btn-outline-success btn-sm"
                                            *ngIf="purchaseOrder.status ==1" title="Approve It"
                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-check-square"></i>
                                          </button>

                                          <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==3"
                                            title="Un-Approve It"
                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-left"></i>
                                          </button>

                                          <button class="btn btn-warning btn-sm"
                                            *ngIf="purchaseOrder.status == 3 && purchaseOrder.purchaseStatus ==1"
                                            [disabled]="user.allowAddUpdateAutopart == false" title="Add Parts"
                                            data-bs-toggle="modal" data-bs-target="#editPart"
                                            (click)="addAutopartToPurchaseOrder( claim, purchaseOrder)"><i
                                              class="fa fa-plus"></i></button>

                                        </div>
                                      </td>
                                    </tr>

                                    <ng-container
                                      *ngIf="showEstimatesOnly == false && purchaseOrder.autoparts.length> 0 ">
                                      <tr>
                                        <!-- <td></td> -->
                                        <td class="text-center fs-14 v-align-middle opacity-50"><i
                                            class="fa-solid fa-tools"></i>
                                        </td>
                                        <td colspan="11" cdkDropList
                                          (cdkDropListDropped)="droppedAutoprtsPurchaseOrder($event, purchaseOrder)">


                                          <table
                                            class="table-bordered table-sm overflow-hidden shadow line-height-100 w-100">
                                            <thead>
                                              <tr class="fs-12 text-center bg-warning v-align-middle text-white mw-50">
                                                <th class="fs-12 text-center  mw-50"
                                                  (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                  title="Sort By Most Recent">
                                                  #
                                                </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                  title="Sort By Most Recent">Image</th>

                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('title', purchaseOrder)"
                                                  title="Sort By Parts Name"> Name </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)=" sortListAutopartsPurchaseOrder('partNumber', purchaseOrder)"
                                                  title="Sort By Parts Number"> Parts # </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)=" sortListAutopartsPurchaseOrder('description', purchaseOrder)"
                                                  title="Sort By Description"> Desc </th>


                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('purchaseStatus', purchaseOrder)"
                                                  title="Sort By Status"> Status </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('grade', purchaseOrder)"
                                                  title="Sort By Grade">
                                                  Grade
                                                </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('salePrice', purchaseOrder)"
                                                  title="Sort By Price"> Price</th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('createdAt', purchaseOrder)"
                                                  title="Sort By Date"> Created <i class="fa-solid fa-clock"></i></th>
                                                <th class="fs-14 text-center mw-50"><i class="fa-solid fa-user"></i>
                                                </th>
                                                <th class="fs-12 text-center  mw-100">Action</th>
                                              </tr>
                                            </thead>
                                            <ng-container
                                              *ngFor="let autopart of purchaseOrder.autoparts; let i = index;  let even=even">
                                              <tr id="{{vehicle.id}}" (click)="editAutopart(autopart, i)" title=""
                                                class="cursor-pointer"
                                                [style.background-color]="i == cindexAutpartPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)"
                                                  [cdkDragDisabled]="isMobile==true" cdkDrag> {{autopart.id}}
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" (mouseover)="hover = vehicle"
                                                  (mouseleave)="hover = null"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <div class="overflow-hidden hover-img transition rounded-1 border">
                                                    <img
                                                      *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                      src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                      height="40" width="100" alt="Image"
                                                      class="object-fill rounded-1 w-100" />
                                                  </div>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75"
                                                    style="display: inline-block; word-break: break-word;">
                                                    {{autopart.title}}</p>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75"
                                                    style="display: inline-block; word-break: break-word;">
                                                    {{autopart.partNumber}}</p>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                              -webkit-box-orient: vertical;
                                              -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                               overflow: hidden;"> {{autopart.description}}
                                                    <ng-container *ngIf="autopart.purchaseStatus==1"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==2"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==3"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==4"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                  </p>
                                                </td>

                                                <td title="Set Status" (click)=" editAutopart(autopart, i)"
                                                  class="text-center fs-12 v-align-middle"><select name="purchaseStatus"
                                                    class="form-select border-radius-4 border fs-12" size="1"
                                                    (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                    [(ngModel)]="autopart.purchaseStatus">
                                                    <option value="0" selected>No Status</option>
                                                    <option value="1">Ordered</option>
                                                    <option value="2">Received</option>
                                                    <option value="3">Returned</option>
                                                    <option value="4">Wrong Part</option>
                                                  </select></td>
                                                <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"><select name="grade" style=" appearance: none;
                                          background-image: url('');"
                                                    class="form-select border px-3 border-radius-8 fs-12" size="1"
                                                    disabled [(ngModel)]="autopart.grade">
                                                    <option value="undefined" disabled selected>Select Grade</option>
                                                    <option value="A">A</option>
                                                    <option value="B">B</option>
                                                    <option value="C">C</option>
                                                    <option value="Used">Used</option>
                                                    <option value="New">New</option>
                                                    <option value="Insurance">Insurance</option>
                                                  </select></td>


                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"> ${{autopart.salePrice}}
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"> {{autopart.createdAt |
                                                  date: 'MM/dd/yyyy'}} </td>
                                                <td class="p-2 text-center fs-12  v-align-middle">
                                                  <ng-container *ngFor="let user of users;let i=index;">
                                                    <span *ngIf="user.id == autopart.userId">
                                                      {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                    </span>
                                                  </ng-container>

                                                </td>
                                                <td class="text-center fs-12 v-align-middle">
                                                  <div class="d-flex gap-2">
                                                    <button class="btn btn-outline-danger btn-sm"
                                                      (click)="editAutopart(autopart, i)"
                                                      *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                      (click)="deleteAutopartPurchaseOrder(autopart, i, purchaseOrder)">
                                                      <i class="fa fa-trash"></i>
                                                    </button>
                                                    <button class="btn btn-outline-warning btn-sm"
                                                      (click)="editAutopart(autopart, i)"
                                                      *ngIf="this.user.allowAddUpdateAutopart == true"
                                                      data-bs-toggle="modal" data-bs-target="#editPart"><i
                                                        class="fa fa-edit"></i> </button>
                                                  </div>
                                                </td>
                                              </tr>
                                            </ng-container>
                                          </table>



                                        </td>
                                      </tr>
                                    </ng-container>

                                  </ng-container>
                                </table>

                              </td>
                            </tr>
                          </ng-container>

                          <ng-container
                            *ngIf="showEstimatesOnly == false && claim.createJobOrder == true && claim.jobs.length> 0">
                            <tr>
                              <!-- <td></td> -->
                              <td class="text-center fs-14 v-align-middle opacity-50"><i class="fas fa-user"></i></td>
                              <td colspan="9">
                                <ng-container>
                                  <table class="table-bordered table-sm overflow-hidden shadow  line-height-100 w-100"
                                    cdkDropList (cdkDropListDropped)="droppedJobsClaim($event, claim)">
                                    <thead>

                                      <tr>
                                        <th class="fs-12 text-center bg-info text-white" style="width:50px">JO #</th>
                                        <th class="fs-12 text-center bg-info text-white mw-100">Job Order Name</th>
                                        <th class="fs-12 text-center bg-info text-white" style="min-width:150px">
                                          Instruction
                                        </th>
                                        <th class="fs-12 text-center bg-info text-white mw-100" style="width:100px">
                                          Assigned
                                          To</th>
                                        <th class="fs-12 text-center bg-info text-white" style="width:100px">$
                                        </th>
                                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                        <th class="fs-12 text-center bg-info text-white mw-100">Target</th>
                                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                        <th class="fs-12 text-center bg-info text-white " style="width:50px">Status
                                        </th>
                                        <th class="fs-12 text-center bg-info text-white mw-50"><i
                                            class="fa-solid fa-user"></i></th>
                                        <th class="fs-12 text-center bg-info text-white mw-100">Action</th>
                                      </tr>
                                    </thead>
                                    <tbody>

                                      <tr (click)="setJobId(job.id)" *ngFor="let job of claim.jobs; let i=index">
                                        <td class="text-center fs-12 v-align-middle" [cdkDragDisabled]="isMobile==true"
                                          cdkDrag>
                                          {{job.id}}
                                        </td>
                                        <td class="text-center fs-12 v-align-middle">
                                          <input placeholder="Enter Job Name" [(ngModel)]="job.name" maxlength="50"
                                            (keyup.enter)="onEnter('job name',job)" type="text"
                                            [disabled]="job.paidWeek> 0"
                                            class="form-control h-40 border-radius-4 border" />
                                        </td>
                                        <td class="text-center fs-12 v-align-middle"><textarea type="text" rows="1"
                                            [(ngModel)]="job.notes" class="form-control my-2" maxlength="200"
                                            (keyup.enter)="onEnter('job notes',job)" title="Job Instruction"
                                            [disabled]="job.paidWeek> 0"
                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                        </td>

                                        <td class="text-center fs-12 v-align-middle"><select
                                            class="form-select border-radius-4 h-40 border fs-12 "
                                            [(ngModel)]="job.employeeId" #device [disabled]="job.paidWeek> 0"
                                            style="height:30px;"
                                            (change)="onChangeEmployee2Claim($event, device.value, job, claim)">
                                            <option value="0" disabled selected>Select Employee</option>
                                            <option [value]="employee.id"
                                              [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                              *ngFor="let employee of employees;let i=index;">{{employee.firstName}}
                                              {{employee.lastName}}
                                              ( {{employee.roleName}},{{employee.rolePrecentage}}% <ng-container
                                                *ngIf="employee.commissionBased == true">
                                                - <span class="fw-700 text-danger">Commission Based</span>
                                              </ng-container>)
                                              [{{
                                              employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                              +
                                              employee.jobCountsFinished}}]
                                            </option>
                                          </select></td>
                                        <td class="text-center fs-12 v-align-middle"><input
                                            placeholder="Enter Job Value" [(ngModel)]="job.price" maxlength="50"
                                            class="fs-12" (keyup.enter)="onEnter('job price',job)" type="number"
                                            [disabled]="job.paidWeek> 0"
                                            class="form-control border h-40 border-radius-4" />
                                        </td>

                                        <td class="text-center fs-12 v-align-middle"><input *ngIf="job.employeeId > 0"
                                            (change)="onChangeCalendar($event, job)"
                                            max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                            [disabled]="job.paidWeek> 0" [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                                            title="Target Date" type="date"
                                            class="form-control border h-40 border-radius-4" /></td>

                                        <td class="p-2 text-center v-align-middle">
                                          <div class="form-check text-center pt-2">
                                            <input trimText class="form-check-input mx-auto mt-0" type="checkbox"
                                              [disabled]="job.paidWeek> 0"
                                              *ngIf="job.employeeId > 0 && job.targetDate != null"
                                              [checked]="isJobChecked(job)" (change)="updateJobStatus(job)" />
                                          </div>
                                        </td>
                                        <td class="p-2 text-center  v-align-middle fs-12">
                                          <ng-container *ngFor="let user of users;let i=index;">
                                            <span *ngIf="user.id == job.userId">
                                              {{(user.firstName + " " + user.lastName) | shortName:2}}
                                            </span>
                                          </ng-container>


                                        </td>
                                        <td class="text-center fs-12 v-align-middle">
                                          <div class="d-flex align-items-center justifyc-ntent-center gap-1">
                                            <button class="btn btn-outline-danger btn-sm" title="Remove"
                                              [disabled]="job.paidWeek> 0" (click)="deleteVehicleJobClaim(null, job)"><i
                                                class="fa fa-trash"></i></button>
                                            <button class="btn btn-outline-primary btn-sm" title="Save"
                                              [disabled]="job.paidWeek> 0" (click)="saveJobNotes(job)"><i
                                                class="fa fa-save"></i></button>
                                            <button class="btn btn-outline-dark btn-sm" title="Print"
                                              (click)="setJobId(job.id)"
                                              (click)="printPageJob('print-content-job', 'jobs', job)">
                                              <i class="fa fa-print"></i>
                                            </button>
                                          </div>
                                        </td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </ng-container>

                              </td>
                            </tr>


                          </ng-container>

                        </ng-container>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-8">
                <div *ngIf="getSubtotalClaims() > 0">

                </div>
                <h3 class="fs-20 fw-700 my-4 pt-3" *ngIf="warrantyText != ''">Warranties</h3>
                <p [innerHtml]=" warrantyText" *ngIf="warrantyText != ''" class="wave fs-13 line-height-130">
                </p>
                <h3 class="fs-20 fw-700 my-4 pt-3">Terms &amp; Conditions</h3>
                <p [innerHtml]="disclaimerText" *ngIf="disclaimerText != ''" class="wave fs-13 line-height-130"></p>
              </div>
              <div class="col-lg-3 col-md-12"></div>
              <div class="col-lg-3 col-md-4" *ngIf="getSubtotalClaims() > 0">
                <ul>
                  <li class="d-flex justify-content-between my-4"><strong class="fs-15">Subtotal:</strong>
                    <p class="fs-15 text-black opacity-75 px-1">${{getSubtotalClaims()}}</p>
                  </li>
                  <li class="d-flex justify-content-between my-4"><strong class="fs-15">Tax ({{company.taxRate
                      *100}}%):</strong>
                    <p class="fs-15 text-black opacity-75 px-1">${{getTaxClaim() }}</p>
                  </li>
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">Estimates:</strong>
                    <p class="fs-15 px-1">${{getTotalClaims()}}</p>
                  </li>
                  <li *ngIf="filterClaims(1).length > 0"
                    class="d-flex justify-content-between d-block bg-success  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">Estimates(Locked):</strong>
                    <p class="fs-15 px-1">${{getTotalClaimsLocked()}}</p>
                  </li>
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">Total Payments:</strong>
                    <p class="fs-15 px-1">${{getTotalPayments()}}</p>
                  </li>
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">Balance:</strong>
                    <p class="fs-15 px-1">${{getTotalBalance()}}</p>
                  </li>
                  <li *ngIf="filterClaims(1).length > 0"
                    class="d-flex justify-content-between d-block bg-success  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">Balance(Locked):</strong>
                    <p class="fs-15 px-1">${{getTotalBalanceLocked()}}</p>
                  </li>
                </ul>
              </div>
            </div>

            <section id="payments">
              <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">
                <strong class="heading-color fw-700 text-uppercase px-2 pt-4 fs-16" data-bs-toggle="modal"
                  data-bs-target="#editVehicle" title="Click to view details"
                  style="display: inline-block; word-break: break-word;">Payments for: <strong
                    class="text-primary fw-700">{{vehicle.year}}
                    {{vehicle.make}}
                    {{vehicle.model}} {{vehicle.color}} ({{payments.length}}) <span class="text-danger"
                      title="Total estimates">
                      [${{getTotalClaims()}}]</span>
                    - <span class="text-danger" title="Total payments">[${{getTotalPayments()}}] </span>
                    = <span class="text-danger" title="Balance">[${{getTotalBalance()}}]</span>
                  </strong>
                </strong>
                <div class="d-lg-flex align-items-center px-2 mt-2">

                  <div class="dropdown" *ngIf="user.allowAddPayment == true">
                    <button class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4 dropdown-toggle" type="button"
                      data-bs-toggle="dropdown" aria-expanded="false">Add Payment <i
                        class="fa fa-angle-down ms-2"></i></button>
                    <ul class="dropdown-menu p-0 border-0 shadow">
                      <ng-container *ngFor="let paymentType of paymentTypes; let i=index">
                        <li><a (click)="addVehiclePayment(paymentType)" class="dropdown-item p-3 fs-12"
                            href="javascript:;"><i class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                            {{paymentType.name}}</a></li>
                      </ng-container>
                    </ul>
                  </div>

                </div>
              </div>

              <div class="row mt-4">
                <div class="mt-4 pt-1">
                  <div class="col-12 p-3 bg-white shadow border border-radius-8">

                    <div class="table-responsive jobs-table bg-white border-radius-8 shadow" cdkDropList
                      (cdkDropListDropped)="droppedPayment($event)">
                      <table class="table table-bordered">
                        <thead>
                          <tr class="v-align-middle">

                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                              style="width: 50px;">#
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                              style="width: 200px;">
                              Description
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"><i
                                class="fa-solid fa-dollar-sign"></i></th>

                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                              style="width: 100px;">
                              Processed At
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                              title="Click to go to Configuration" [routerLink]="'/payment-method'"
                              style="cursor:pointer; width: 150px;">Paid With</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                              title="Click to go to Configuration" [routerLink]="'/payment-status'"
                              style="cursor:pointer; width: 150px;">Pay Status</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">
                              <i class="fa-solid fa-clock"></i>
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                                class="fa-solid fa-user"></i>
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">Verified By
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                              style="width: 100px;">
                              Verified At
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                              style="width:100px;">
                              Action
                            </th>
                          </tr>


                        </thead>
                        <tbody>
                          <tr class="alert-info" *ngFor="let payment of payments; let i=index"
                            title="Created at {{payment.createdAt| date: 'MM/dd/yyyy'}}"
                            (click)="setPaymentPaymentId(payment.id)"
                            [style.background-color]="payment.id == currentPaymentPaymentId? '#FFF3CD' : (true ? '#CFF4FC' : '#CFF4FC')">

                            <td class="fs-13 p-2 text-center v-align-middle"
                              title="Drag and drop index number to change the order" [cdkDragDisabled]="isMobile==true"
                              cdkDrag>{{i+1}}</td>

                            <td class="fs-13 p-2"><textarea [(ngModel)]="payment.name" class="form-control"
                                [disabled]="user.allowAddPayment == false" placeholder="Please Specify"
                                (keyup.enter)="onEnterPayment('Payment name',payment)" rows="1"
                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                maxlength="200" [disabled]="user.allowAddReceipt == false"></textarea></td>

                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterPayment('Payment amount',payment)"
                                [disabled]="user.allowAddPayment == false" [(ngModel)]="payment.amount"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>

                            <td class="fs-13 p-2"><input trimText class="form-control h-48 px-3 border-radius-8"
                                type="date" [disabled]="user.allowAddPayment == false"
                                placeholder="Enter Processing Date"
                                (change)="onChangeVehiclePaymentCalendar($event, payment)"
                                [ngModel]="payment.date |  date:'yyyy-MM-dd'" /></td>

                            <td class="fs-13 p-2">
                              <select class="form-select h-48 px-3 border-radius-8"
                                [disabled]="user.allowAddPayment == false"
                                (change)="onChangeVehiclePaymentMethod2($event, payment)"
                                [(ngModel)]="payment.paymentMethodId">
                                <option value="0" disabled selected>Select Payment Method</option>
                                <option [value]="paymentMethod.id"
                                  *ngFor="let paymentMethod of paymentMethods;let i=index;">
                                  {{paymentMethod.name}}</option>
                              </select>
                            </td>
                            <td class="fs-13 p-2">
                              <select class="form-select h-48 px-3 border-radius-8"
                                [disabled]="user.allowAddPayment == false"
                                (change)="onChangeVehiclePaymentStatus($event, payment)"
                                [(ngModel)]="payment.paymentStatusId">
                                <option value="0" disabled selected>Select Payment Status</option>
                                <option [value]="paymentStatus.id"
                                  *ngFor="let paymentStatus of paymentStatuss;let i=index;">
                                  {{paymentStatus.name}}</option>
                              </select>
                            </td>
                            <td class="fs-13 p-2  text-center v-align-middle">{{payment.createdAt | date:
                              'MM/dd/yyyy'}}
                            </td>
                            <td class="fs-13 p-2 text-center v-align-middle">
                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == payment.userId">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>
                              <!-- <select class="form-select h-48 px-3 border-radius-8" disabled
                                style=" appearance: none; background-image: url('');" [(ngModel)]="payment.userId">
                                <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                                  {{user.lastName}}</option>
                              </select> -->
                            </td>
                            <td class="fs-13 p-2 text-center v-align-middle">
                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == payment.userIdVerified">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>
                              <!-- <select class="form-select h-48 px-3 border-radius-8" disabled
                                style=" appearance: none; background-image: url('');"
                                [(ngModel)]="payment.userIdVerified">
                                <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                                  {{user.lastName}}</option>
                              </select> -->
                            </td>
                            <td class="fs-13 p-2">

                              <ng-container *ngIf="user.allowVerifyPayment == true ">
                                <input trimText class="form-control h-48 px-3 border-radius-8" type="date"
                                  placeholder="Enter Verified Date"
                                  (change)="onChangeVehiclePaymentCalendarVerified($event, payment)"
                                  [ngModel]="payment.dateVerified |  date:'yyyy-MM-dd'" />
                              </ng-container>
                              <ng-container *ngIf="user.allowVerifyPayment == false"> {{payment.dateVerified | date:
                                'MM/dd/yyyy' }}
                              </ng-container>

                            </td>

                            <td class="p-2 text-center v-align-middle">
                              <div class="d-flex align-items-center justifyc-cntent-center gap-2">
                                <button class="btn btn-outline-danger btn-sm" [disabled]="user.allowAddPayment == false"
                                  title="Delete" (click)="deleteVehiclePayment(null, payment)"><i
                                    class="fa fa-trash"></i></button>
                                <button class="btn btn-outline-success btn-sm"
                                  [disabled]="user.allowAddPayment == false" title="Save"
                                  (click)="savePayment(payment)"><i class="fa fa-save"></i></button>
                              </div>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                  </div>
                </div>
              </div>
            </section>

            <br />
            <br />
          </div>

          <div class="tab-pane fade show" id="purchase-orders-tabs" role="tabpanel" #taggroup
            aria-labelledby="purchase-orders-tabs">
            <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">
              <h2 class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">Vehicle
                Purchase Orders for: <strong class="fw-700 text-primary" data-bs-toggle="modal" style="cursor: pointer;"
                  data-bs-target="#editVehicle" title="Click to view details">{{vehicle.year}}
                  {{vehicle.make}} {{vehicle.model}}
                  {{vehicle.color}} ({{purchaseOrders.length}})</strong>
                <div class="dropdown">
                  <button class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold" type="button"
                    id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <span title="Total Purchase Orders">${{getTotalPurchaseOrders()}}</span> <span>-</span>
                    <span title="Total Parts Costs">${{getTotalPartCosts(vehicle.id)}}</span> <span>-</span>
                    <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                    <i class="fa fa-angle-down ms-2"></i>
                  </button>
                  <div class="dropdown-menu bg-light" style="min-width: 400px" aria-labelledby="dropdownMenuButton">
                    <div class="row">
                      <div class="col-6 px-1">
                        <a class="dropdown-item">Items</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">Estimates</a>
                        <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                        <a class="dropdown-item fw-700">Est. - Parts</a>
                        <a class="dropdown-item"></a>

                        <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                        <a class="dropdown-item">Management</a>

                        <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700">Total Costs</a>
                        <a class="dropdown-item fw-700">Gross</a>


                      </div>
                      <div class="col-6 px-1">
                        <a class="dropdown-item">#</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}} (${{vehicle.price}} +
                          ${{getTotalSupplements(vehicle)}})</a>
                        <a class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                          (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                        <a class="dropdown-item"></a>


                        <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                        <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                          ({{this.company.managementRate * 100}}% of
                          ${{getVehicleRemaining(vehicle)}})</a>

                        <a class="dropdown-item">${{getSaleTax(vehicle)}} ({{this.company.taxRate * 100}}% of
                          {{getVehicleTotalEstimates(vehicle)}})</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle, jobs)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                      </div>
                    </div>

                  </div>
                </div>
              </h2>
              <div class="d-lg-flex align-items-center px-2 mt-2" *ngIf="user.allowAddUpdatePurchaseOrder == true">
                <button class="btn btn-success fs-13 px-3 py-2 mt-15-mob" data-bs-toggle="modal" title="Add Parts"
                  *ngIf="this.vehicle.id> 0" data-bs-target="#addNewPurchaseOrder"
                  (click)="createNewPurchaseOrder(true)"><i class="fa fa-plus me-2"></i> Add Purchase Order </button>
              </div>
            </div>
            <div class="row" cdkDropList (cdkDropListDropped)="droppedPurchaseOrders($event)">
              <div class="col-12 mt-4 pt-1 p-3 border border-radius-8 bg-white shadow">
                <div class="table-container shadow border-radius-8 bg-white border">
                  <table class="table table-bordered">
                    <thead>
                      <tr class="bg-navy text-white v-align-middle ">
                        <th class="fs-14 text-center mw-50" style="max-width:80px" (click)="sortListPurchseOrders('id')"
                          title="Sort By Most Recent">
                          #
                        </th>
                        <th class="fs-14 text-center mw-50" style="max-width:80px"
                          (click)="sortListPurchseOrders('claimId')" title="Sort By Estimate Id">
                          EID
                        </th>

                        <th class="fs-14 text-center mw-100" (click)="sortListPurchseOrders('title')"
                          title="Sort By Parts Name"> Item Name </th>
                        <th class="fs-14 text-center mw-100" (click)="sortListPurchseOrders('partNumber')"
                          title="Sort By Parts Number"> Parts # </th>
                        <th class="fs-14 text-center mw-150" (click)="sortListPurchseOrders('description')"
                          title="Sort By Description"> Description </th>

                        <th class="fs-14 text-center mw-150" (click)="sortListPurchseOrders('vendorId')"
                          title="Sort By Most Recent">Vender</th>

                        <th class="fs-14 text-center mw-150" (click)="sortListPurchseOrders('status')"
                          title="Sort By Status">Approval Status</th>

                        <th class="fs-14 text-center mw-100" style="width:100px"
                          (click)="sortListPurchseOrders('purchaseStatus')" title="Sort By Status">Order Status</th>
                        <th class="fs-14 text-center mw-100" style="width:100px"
                          (click)="sortListPurchseOrders('grade')" title="Sort By Grade">
                          Grade
                        </th>
                        <th class="fs-14 text-center mw-100" style="width:100px"
                          (click)="sortListPurchseOrders('salePrice')" title="Sort By Price"><i
                            class="fa-solid fa-dollar-sign"></i></th>
                        <th class="fs-14 text-center mw-100" (click)="sortListPurchseOrders('createdAt')"
                          title="Sort By Date"><i class="fa-solid fa-clock"></i></th>
                        <th class="fs-14 text-center mw-50"><i class="fa-solid fa-user"></i></th>

                        <th class="fs-14 text-center mw-100">Action</th>
                      </tr>
                    </thead>
                    <ng-container *ngFor="let purchaseOrder of purchaseOrders; let i = index;  let even=even">
                      <tr id="{{vehicle.id}}" (click)="editPurchaseOrder(purchaseOrder, i)" title=""
                        style="cursor: pointer;" class="v-align-middle"
                        [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                          title="Drag and drop index number to change the order"
                          (click)=" editPurchaseOrder(purchaseOrder, i)" [cdkDragDisabled]="isMobile==true" cdkDrag>
                          {{purchaseOrder.id}}
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                          <p class="fs-12 text-danger fw-700" *ngIf="purchaseOrder.claimId > 0">
                            {{purchaseOrder.claimId}}</p>
                        </td>


                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                          <p class="fs-12 text-black opacity-75" style="display: inline-block; word-break: break-word;">
                            {{purchaseOrder.title}}</p>
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                          <p class="fs-12 text-black opacity-75" style="display: inline-block; word-break: break-word;">
                            {{purchaseOrder.partNumber}}</p>
                        </td>


                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                          <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                        -webkit-box-orient: vertical;
                        -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                         overflow: hidden;"> {{purchaseOrder.description}}
                            <ng-container *ngIf="purchaseOrder.purchaseStatus==1"> <br>
                              <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt| date:
                                'MM/dd/yyyy'}}</span>
                            </ng-container>
                            <ng-container *ngIf="purchaseOrder.purchaseStatus==2"> <br>
                              <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt| date:
                                'MM/dd/yyyy'}}</span> <br>
                              <span class="text-danger">Received At:{{ purchaseOrder.receivedAt| date:
                                'MM/dd/yyyy'}}</span>
                            </ng-container>
                            <ng-container *ngIf="purchaseOrder.purchaseStatus==3"> <br>
                              <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt| date:
                                'MM/dd/yyyy'}}</span> <br>
                              <span class="text-danger">Received At:{{ purchaseOrder.receivedAt| date:
                                'MM/dd/yyyy'}}</span> <br>
                              <span class="text-danger">Returned At:{{ purchaseOrder.returnedAt| date:
                                'MM/dd/yyyy'}}</span>
                            </ng-container>
                          </p>
                        </td>

                        <td class="p-2 text-center  v-align-middle">

                          <select class="form-select h-48 px-3 border-radius-8 " data-bs-toggle="modal"
                            data-bs-target="#addNewPurchaseOrder" style=" appearance: none; background-image: url('');"
                            disabled [(ngModel)]="purchaseOrder.vendorId">
                            <option [value]=" vendor.id" *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}
                            </option>
                          </select>
                        </td>

                        <td title="Set Approval Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                          class="text-center fs-13">
                          <select name="status" class="form-select border-radius-4 border" size="1" disabled
                            style=" appearance: none; background-image: url('');" [(ngModel)]="purchaseOrder.status">
                            <option value="0" selected>Not Submitted</option>
                            <option value="1" style="color:green">For Approval</option>
                            <option value="2" style="color:red">Rejected</option>
                            <option value="3" style="color:blue">Approved</option>
                          </select>
                        </td>

                        <td title="Set Status" (click)=" editPurchaseOrder(purchaseOrder, i)" class="text-center fs-13">
                          <select name="purchaseStatus" class="form-select border-radius-4 border" size="1"
                            (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                            *ngIf="purchaseOrder.status == 3" [(ngModel)]="purchaseOrder.purchaseStatus">
                            <option value="0" selected>No Status</option>
                            <option value="1">Ordered</option>
                            <option value="2">Received</option>
                            <option value="3">Returned</option>
                            <option value="4">Wrong Part</option>
                          </select>
                        </td>
                        <td data-bs-toggle="modal" class="text-center fs-13" data-bs-target="#addNewPurchaseOrder"
                          title="Click to view details" (click)=" editPurchaseOrder(purchaseOrder, i)"><select
                            name="grade" style=" appearance: none; background-image: url('');"
                            class="form-select h-48 border px-3 border-radius-8" size="1" disabled
                            [(ngModel)]="purchaseOrder.grade">
                            <option value="undefined" disabled selected>Select Grade</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="Used">Used</option>
                            <option value="New">New</option>
                            <option value="Insurance">Insurance</option>
                          </select></td>


                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                          title="Click to view details" (click)=" editPurchaseOrder(purchaseOrder, i)">
                          ${{purchaseOrder.salePrice}}
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                          title="Click to view details" (click)=" editPurchaseOrder(purchaseOrder, i)">
                          {{purchaseOrder.createdAt |
                          date: 'MM/dd/yyyy'}} </td>
                        <td class="p-2 text-center v-align-middle ">

                          <ng-container *ngFor="let user of users;let i=index;">
                            <span *ngIf="user.id == purchaseOrder.userId">
                              {{(user.firstName + " " + user.lastName) | shortName:2}}
                            </span>
                          </ng-container>

                          <!-- <select class="form-select h-48 px-3 border-radius-8 "
                            style=" appearance: none; background-image: url('');" disabled
                            [(ngModel)]="purchaseOrder.userId">
                            <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                              {{user.lastName}}</option>
                          </select> -->
                        </td>
                        <td class="text-center fs-13">
                          <div class="d-flex gap-2">
                            <button class="btn btn-outline-danger btn-sm" (click)="editPurchaseOrder(purchaseOrder, i)"
                              *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                              (click)="deletePurchaseOrder(purchaseOrder, i)">
                              <i class="fa fa-trash"></i>
                            </button>

                            <button class="btn btn-outline-warning btn-sm" *ngIf="purchaseOrder.status ==0"
                              title="Submit for Approval"
                              (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                              <i class="fa fa-arrow-right"></i>
                            </button>

                            <button class="btn btn-outline-warning btn-sm" *ngIf="purchaseOrder.status ==2"
                              title="Re-Submit for Approval"
                              (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                              <i class="fa fa-arrow-right"></i>
                            </button>

                            <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==1"
                              title="Reject It" (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                              <i class="fa fa-ban"></i>
                            </button>

                            <button class="btn btn-outline-success btn-sm" *ngIf="purchaseOrder.status ==1"
                              title="Approve It" (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                              <i class="fa fa-check-square"></i>
                            </button>

                            <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==3"
                              title="Un-Approve It"
                              (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                              <i class="fa fa-arrow-left"></i>
                            </button>

                          </div>
                        </td>
                      </tr>
                    </ng-container>
                  </table>
                </div>
              </div>
            </div>
          </div>

          <div class="tab-pane fade show active" id="autoparts-tabs" role="tabpanel" #taggroup
            aria-labelledby="autoparts-tabs-tab">
            <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">
              <h2 class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">Vehicle
                Parts for: <strong class="fw-700 text-primary" data-bs-toggle="modal" data-bs-target="#editVehicle"
                  style="cursor: pointer;" title="Click to view details">{{vehicle.year}}
                  {{vehicle.make}} {{vehicle.model}}
                  {{vehicle.color}} ({{autopartsSearch.length}})</strong>
                <div class="dropdown">
                  <button class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold" type="button"
                    id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <span title="Total Parts Costs">${{getTotalPartCosts(vehicle.id)}}</span> <span>-</span>
                    <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                    <i class="fa fa-angle-down ms-2"></i>
                  </button>
                  <div class="dropdown-menu bg-light" style="min-width: 400px" aria-labelledby="dropdownMenuButton">
                    <div class="row">
                      <div class="col-6 px-1">
                        <a class="dropdown-item">Items</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">Estimates</a>
                        <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                        <a class="dropdown-item fw-700">Est. - Parts</a>
                        <a class="dropdown-item"></a>

                        <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                        <a class="dropdown-item">Management</a>
                        <!-- <a class="dropdown-item">Sales Commission</a> -->
                        <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700">Total Costs</a>
                        <a class="dropdown-item fw-700">Gross</a>


                      </div>
                      <div class="col-6 px-1">
                        <a class="dropdown-item">#</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}} (${{vehicle.price}} +
                          ${{getTotalSupplements(vehicle)}})</a>
                        <a class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                          (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                        <a class="dropdown-item"></a>


                        <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                        <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                          ({{this.company.managementRate * 100}}% of
                          ${{getVehicleRemaining(vehicle)}})</a>

                        <a class="dropdown-item">${{getSaleTax(vehicle)}} ({{this.company.taxRate * 100}}% of
                          {{getVehicleTotalEstimates(vehicle)}})</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle, jobs)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                      </div>
                    </div>

                  </div>
                </div>
              </h2>
              <div class="d-lg-flex align-items-center px-2 mt-2" *ngIf="user.allowAddUpdateAutopart == true">
                <button class="btn btn-success fs-13 px-3 py-2 mt-15-mob" data-bs-toggle="modal" title="Add Parts"
                  *ngIf="this.vehicle.id> 0" data-bs-target="#addNewPart" (click)="addNewParts()"><i
                    class="fa fa-plus me-2"></i> Add Parts </button>
              </div>
            </div>
            <div class="row" cdkDropList (cdkDropListDropped)="droppedAutoprts($event)">
              <div class="mt-4 p-3 border bg-white border-radius-8 shadow">


                <div class="table-container shadow border-radius-8 bg-white border w-100 d-box ss-table">
                  <table class="table-bordered overflow-hidden border-radius-8 w-100">
                    <thead>
                      <tr class="bg-warning text-white v-align-middle">
                        <th class="fs-14 text-center text-white mw-50" (click)="sortListAutoparts('id')"
                          title="Sort By Most Recent">
                          #
                        </th>
                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('claimId')"
                          title="Sort By Estimate Id">
                          EID-POID
                        </th>
                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('id')"
                          title="Sort By Most Recent">Image</th>

                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('title')"
                          title="Sort By Parts Name"> Parts Name </th>
                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('partNumber')"
                          title="Sort By Parts Number"> Parts # </th>
                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('description')"
                          title="Sort By Description"> Description </th>

                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('vendorId')"
                          title="Sort By Status"> Vendor </th>
                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('purchaseStatus')"
                          title="Sort By Status"> Status </th>
                        <th class="fs-14 text-center text-white mw-80" (click)="sortListAutoparts('grade')"
                          title="Sort By Grade">
                          Grade
                        </th>
                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('salePrice')"
                          title="Sort By Price"> Price</th>
                        <th class="fs-14 text-center text-white mw-100" (click)="sortListAutoparts('createdAt')"
                          title="Sort By Date"> <i class="fa-solid fa-clock"></i></th>
                        <th class="fs-14 text-center text-white mw-50"><i class="fa-solid fa-user"></i></th>

                        <th class="fs-14 text-center text-white mw-100">Action</th>
                      </tr>
                    </thead>
                    <ng-container *ngFor="let autopart of autopartsSearch; let i = index;  let even=even">
                      <tr id="{{vehicle.id}}" (click)="editAutopart(autopart, i)" title="" class="cursor-pointer"
                        [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')">
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Drag and drop index number to change the order" (click)=" editAutopart(autopart, i)"
                          [cdkDragDisabled]="isMobile==true" cdkDrag> {{autopart.id}}
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editAutopart(autopart, i)">
                          <div class="fs-12 text-danger fw-700"
                            *ngIf="autopart.claimId > 0 && autopart.purchaseOrderId > 0">
                            <span title="Estimate Id">{{autopart.claimId}}</span>-<span
                              title="Purchase Order Id">{{autopart.purchaseOrderId}}</span>
                          </div>
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          (mouseover)="hover = vehicle" (mouseleave)="hover = null"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editAutopart(autopart, i)">
                          <div class="overflow-hidden hover-img transition rounded-1 border"> <img
                              *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                              src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}" height="40"
                              width="100" alt="Image" class="object-fill rounded-1 w-100" /> </div>
                        </td>

                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editAutopart(autopart, i)">
                          <p class="fs-12 text-black opacity-75" style="display: inline-block; word-break: break-word;">
                            {{autopart.title}}</p>
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editAutopart(autopart, i)">
                          <p class="fs-12 text-black opacity-75" style="display: inline-block; word-break: break-word;">
                            {{autopart.partNumber}}</p>
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details. Drag and drop index number to change the order"
                          (click)=" editAutopart(autopart, i)">
                          <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                          -webkit-box-orient: vertical;
                          -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                           overflow: hidden;"> {{autopart.description}}
                            <ng-container *ngIf="autopart.purchaseStatus==1"> <br>
                              <span class="text-danger">Ordered At: {{ autopart.orderedAt| date: 'MM/dd/yyyy'}}</span>
                            </ng-container>
                            <ng-container *ngIf="autopart.purchaseStatus==2"> <br>
                              <span class="text-danger">Ordered At: {{ autopart.orderedAt| date: 'MM/dd/yyyy'}}</span>
                              <br>
                              <span class="text-danger">Received At:{{ autopart.receivedAt| date:
                                'MM/dd/yyyy'}}</span>
                            </ng-container>
                            <ng-container *ngIf="autopart.purchaseStatus==3"> <br>
                              <span class="text-danger">Ordered At: {{ autopart.orderedAt| date: 'MM/dd/yyyy'}}</span>
                              <br>
                              <span class="text-danger">Received At:{{ autopart.receivedAt| date:
                                'MM/dd/yyyy'}}</span>
                              <br>
                              <span class="text-danger">Returned At:{{ autopart.returnedAt| date:
                                'MM/dd/yyyy'}}</span>
                            </ng-container>
                          </p>
                        </td>
                        <td title="Set Status" (click)=" editAutopart(autopart, i)" class="text-center fs-13">
                          <select class="orm-select border-radius-4 border" name="vendor"
                            (change)="onChangeAutopartVentor($event, autopart)" [(ngModel)]="autopart.vendorId"
                            [disabled]="user.allowAddUpdateAutopart == false" #vendor="ngModel">
                            <option value="undefined" disabled selected>Select Vendor</option>
                            <option [value]="vendor.id" *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}
                            </option>
                          </select>
                        </td>


                        <td title="Set Status" (click)=" editAutopart(autopart, i)" class="text-center fs-13"><select
                            name="purchaseStatus" class="form-select border-radius-4 border" size="1"
                            (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                            [(ngModel)]="autopart.purchaseStatus">
                            <option value="0" selected>No Status</option>
                            <option value="1">Ordered</option>
                            <option value="2">Received</option>
                            <option value="3">Returned</option>
                            <option value="4">Wrong Part</option>
                          </select></td>
                        <td data-bs-toggle="modal" class="text-center fs-13" data-bs-target="#partDetails"
                          title="Click to view details" (click)=" editAutopart(autopart, i)"><select name="grade" style=" appearance: none;
                      background-image: url('');" class="form-select h-48 border px-3 border-radius-8" size="1"
                            disabled [(ngModel)]="autopart.grade">
                            <option value="undefined" disabled selected>Select Grade</option>
                            <option value="A">A</option>
                            <option value="B">B</option>
                            <option value="C">C</option>
                            <option value="Used">Used</option>
                            <option value="New">New</option>
                            <option value="Insurance">Insurance</option>
                          </select></td>


                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details" (click)=" editAutopart(autopart, i)"> ${{autopart.salePrice}}
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details" (click)=" editAutopart(autopart, i)"> {{autopart.createdAt |
                          date: 'MM/dd/yyyy'}} </td>
                        <td class="p-2 text-center  v-align-middle">

                          <ng-container *ngIf="autopart.employeeId> 0">
                            <ng-container *ngFor="let employee of employees;let i=index;">
                              <span *ngIf="employee.id == autopart.employeeId" class="text-danger"
                                title="created by employee [{{employee.firstName +  ' ' + employee.lastName}}]">
                                {{(employee.firstName + " " + employee.lastName) | shortName:2}}
                              </span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="autopart.employeeId == 0">
                            <ng-container *ngFor="let user of users;let i=index;">
                              <span *ngIf="user.id == autopart.userId"
                                title="created by [{{user.firstName +  ' ' + user.lastName}}]">
                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                              </span>
                            </ng-container>
                          </ng-container>
                          <!-- <select class="form-select h-48 px-3 border-radius-8 "
                            style=" appearance: none; background-image: url('');" disabled
                            [(ngModel)]="autopart.userId">
                            <option [value]="user.id" *ngFor="let user of users;let i=index;">{{user.firstName}}
                              {{user.lastName}}</option>
                          </select> -->
                        </td>
                        <td class="text-center fs-13">
                          <div class="d-flex gap-2">
                            <button class="btn btn-outline-danger btn-sm" (click)="editAutopart(autopart, i)"
                              *ngIf=" this.user.allowAddUpdateAutopart == true" (click)="deleteAutopart(autopart, i)">
                              <i class="fa fa-trash"></i>
                            </button>
                            <button class="btn btn-outline-warning btn-sm" (click)="editAutopart(autopart, i)"
                              *ngIf="this.user.allowAddUpdateAutopart == true" data-bs-toggle="modal"
                              data-bs-target="#editPart"><i class="fa fa-edit"></i> </button>
                          </div>
                        </td>
                      </tr>
                    </ng-container>
                  </table>
                </div>
              </div>
            </div>
          </div>
          <div class="tab-pane fade show " id="payment-tabs" role="tabpanel" #taggroup
            aria-labelledby="payment-tabs-tab">
            <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4">

              <h2 class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">Vehicle
                Payments for: <strong class="fw-700 text-primary" data-bs-toggle="modal" data-bs-target="#editVehicle"
                  style="cursor: pointer;" title="Click to view details">{{vehicle.year}}
                  {{vehicle.make}} {{vehicle.model}}
                  {{vehicle.color}} ({{payments.length}})</strong>



                <div class="dropdown">
                  <button class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold" type="button"
                    id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <span title="Total Payments">${{getTotalPayments()}}</span> <span>-</span>
                    <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                    <i class="fa fa-angle-down ms-2"></i>
                  </button>
                  <div class="dropdown-menu bg-light" style="min-width: 400px" aria-labelledby="dropdownMenuButton">
                    <div class="row">
                      <div class="col-6 px-1">
                        <a class="dropdown-item">Items</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">Estimates</a>
                        <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                        <a class="dropdown-item fw-700">Est. - Parts</a>
                        <a class="dropdown-item"></a>

                        <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                        <a class="dropdown-item">Management</a>
                        <!-- <a class="dropdown-item">Sales Commission</a> -->
                        <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700">Total Costs</a>
                        <a class="dropdown-item fw-700">Gross</a>

                        <!-- <a class="dropdown-item">After Tax</a> -->
                      </div>
                      <div class="col-6 px-1">
                        <a class="dropdown-item">#</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}} (${{vehicle.price}} +
                          ${{getTotalSupplements(vehicle)}})</a>
                        <a class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                          (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                        <a class="dropdown-item"></a>


                        <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                        <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                          ({{this.company.managementRate * 100}}% of
                          ${{getVehicleRemaining(vehicle)}})</a>
                        <!-- <a class="dropdown-item text-danger">${{getSalesCommission(vehicle)}} (7% of
                          ${{vehicle.supplymentPrice}})</a> -->
                        <a class="dropdown-item">${{getSaleTax(vehicle)}} ({{this.company.taxRate * 100}}% of
                          {{getVehicleTotalEstimates(vehicle)}})</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle, jobs)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                      </div>
                    </div>

                  </div>

                </div>
              </h2>
              <div class="d-lg-flex align-items-center px-2 mt-2">
                <div class="dropdown" *ngIf="user.allowAddPayment == true">
                  <button class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4 dropdown-toggle" type="button"
                    data-bs-toggle="dropdown" aria-expanded="false">Add Payments <i
                      class="fa fa-angle-down ms-2"></i></button>
                  <ul class="dropdown-menu p-0 border-0 shadow">
                    <ng-container *ngFor="let paymentType of paymentTypes; let i=index">
                      <li><a (click)="addVehiclePayment(paymentType)" class="dropdown-item p-3 fs-12"
                          href="javascript:;"><i class="fa fa-check fs-11 me-2 text-primary-abs"></i>
                          {{paymentType.name}}</a></li>
                    </ng-container>
                  </ul>
                </div>

                <button title="Show all info" (click)="shallAllPaymentInfo = !shallAllPaymentInfo"
                  *ngIf="payments.length > 0"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                    class="fa fa-filter"></i></button>

              </div>
            </div>
            <div class="row mt-4">
              <div class="mt-4 pt-1">
                <div class="col-12 p-3 bg-white shadow border border-radius-8">

                  <div class="table-responsive jobs-table bg-white border-radius-8 shadow" cdkDropList
                    (cdkDropListDropped)="droppedPayment($event)">
                    <table class="table table-bordered">
                      <thead>
                        <tr class="v-align-middle">
                          <!-- <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120" style="width: 150px;">Item Name</th> -->
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                            style="width: 50px;">#
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                            style="width: 200px;">
                            Description
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"><i
                              class="fa-solid fa-dollar-sign"></i></th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                            style="width: 100px;">
                            Processed At
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                            title="Click to go to Configuration" [routerLink]="'/payment-method'"
                            style="cursor:pointer; width: 150px;">Paid With</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-150"
                            title="Click to go to Configuration" [routerLink]="'/payment-status'"
                            style="cursor:pointer; width: 150px;">Pay Status</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100">
                            <i class="fa-solid fa-clock"></i>
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                              class="fa-solid fa-user"></i>
                          </th>
                          <th class=" bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">Verified By
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle  "
                            style="width: 100px;">
                            Verified At
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle" style="width:100px;">
                            Action
                          </th>
                        </tr>


                      </thead>
                      <tbody>
                        <ng-container *ngFor="let payment of payments; let i=index">
                          <tr class="alert-info" title="Created at {{payment.createdAt| date: 'MM/dd/yyyy'}}"
                            (click)="setPaymentPaymentId(payment.id);getDetailsPayment(payment, i)"
                            [style.background-color]="payment.id == currentPaymentPaymentId? '#FFF3CD' : (true ? '#CFF4FC' : '#CFF4FC')">

                            <td class="fs-13 p-2 text-center v-align-middle"
                              title="Drag and drop index number to change the order" [cdkDragDisabled]="isMobile==true"
                              cdkDrag>{{i+1}}</td>

                            <td class="fs-13 p-2"><textarea [(ngModel)]="payment.name" class="form-control"
                                [disabled]="user.allowAddPayment == false" placeholder="Please Specify"
                                (keyup.enter)="onEnterPayment('Payment name',payment)" rows="1"
                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                maxlength="200" [disabled]="user.allowAddReceipt == false"></textarea></td>

                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterPayment('Payment amount',payment)"
                                [disabled]="user.allowAddPayment == false" [(ngModel)]="payment.amount"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>

                            <td class="fs-13 p-2"><input trimText class="form-control h-48 px-3 border-radius-8"
                                type="date" [disabled]="user.allowAddPayment == false"
                                placeholder="Enter Processing Date"
                                (change)="onChangeVehiclePaymentCalendar($event, payment)"
                                [ngModel]="payment.date |  date:'yyyy-MM-dd'" /></td>

                            <td class="fs-13 p-2">
                              <select class="form-select h-48 px-3 border-radius-8"
                                [disabled]="user.allowAddPayment == false"
                                (change)="onChangeVehiclePaymentMethod2($event, payment)"
                                [(ngModel)]="payment.paymentMethodId">
                                <option value="0" disabled selected>Select Payment Method</option>
                                <option [value]="paymentMethod.id"
                                  *ngFor="let paymentMethod of paymentMethods;let i=index;">
                                  {{paymentMethod.name}}</option>
                              </select>
                            </td>
                            <td class="fs-13 p-2">
                              <select class="form-select h-48 px-3 border-radius-8"
                                [disabled]="user.allowAddPayment == false"
                                (change)="onChangeVehiclePaymentStatus($event, payment)"
                                [(ngModel)]="payment.paymentStatusId">
                                <option value="0" disabled selected>Select Payment Status</option>
                                <option [value]="paymentStatus.id"
                                  *ngFor="let paymentStatus of paymentStatuss;let i=index;">
                                  {{paymentStatus.name}}</option>
                              </select>
                            </td>
                            <td class="fs-13 p-2  text-center v-align-middle">{{payment.createdAt | date: 'MM/dd/yyyy'}}
                            </td>
                            <td class="fs-13 p-2 text-center v-align-middle">

                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == payment.userId">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>


                            </td>
                            <td class="fs-13 p-2 text-center v-align-middle">

                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == payment.userIdVerified">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>


                            </td>
                            <td class="fs-13 p-2">

                              <ng-container *ngIf="user.allowVerifyPayment == true ">
                                <input trimText class="form-control h-48 px-3 border-radius-8" type="date"
                                  placeholder="Enter Verified Date"
                                  (change)="onChangeVehiclePaymentCalendarVerified($event, payment)"
                                  [ngModel]="payment.dateVerified |  date:'yyyy-MM-dd'" />
                              </ng-container>
                              <ng-container *ngIf="user.allowVerifyPayment == false"> {{payment.dateVerified | date:
                                'MM/dd/yyyy' }}
                              </ng-container>

                            </td>

                            <td class="p-2 text-center v-align-middle">
                              <div class="d-flex align-items-center justifyc-cntent-center gap-2">
                                <button class="btn btn-outline-danger btn-sm" [disabled]="user.allowAddPayment == false"
                                  title="Delete" (click)="deleteVehiclePayment(null, payment)"><i
                                    class="fa fa-trash"></i></button>
                                <button class="btn btn-outline-success btn-sm"
                                  [disabled]="user.allowAddPayment == false" title="Save"
                                  (click)="savePayment(payment)"><i class="fa fa-save"></i></button>

                                <button class="btn btn-outline-warning btn-sm" title="add images"
                                  [disabled]="user.allowAddPayment == false" (click)="fileInputPayment.click()"><i
                                    class="fa fa-camera"></i></button>

                                <input type='file' id="uploadButton"
                                  class="form-control opacity-0 top-0 position-absolute" accept="image/jpg, image/jpeg"
                                  #fileInputPayment (change)="onSelectFileEditorPayments($event)" multiple
                                  (click)="fileInput.value = ''" />
                              </div>
                            </td>
                          </tr>
                          <tr class="v-align-middle fs-11"
                            *ngIf="shallAllPaymentInfo== true || ( payment.imageModels &&  payment!.imageModels!.length  > 0)"
                            (click)="getDetailsPayment(payment, i)">
                            <td></td>
                            <!-- <td></td> -->
                            <td colspan="10">
                              <div class="row overflow-x-auto overflow-y-hidden">
                                <div
                                  class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-1">

                                  <div *ngFor='let imageModel of payment.imageModels; let i=index'
                                    class="containerImage v-imgs float-start my-2 transition" style="cursor: pointer;">
                                    <div class="containerImage">

                                      <label class="top-left" for="title">
                                        {{imageModel?.createdAt | date: 'MM/dd/yyyy
                                        HH:mm:ss'}}</label>

                                      <img class="preview img-fluid img-thumbnail" width="100%"
                                        title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                        *ngIf="payment.showInSearchImageId != imageModel.id"
                                        src="{{baseUrlResizeImagePayments + '/' + imageModel.id}}"
                                        (click)="getDetailsPayment(payment, i);setImage4(imageModel)"
                                        style="border: 3px solid #555;">
                                      <img class="preview img-fluid img-thumbnail" width="100%"
                                        title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}} "
                                        *ngIf="payment.showInSearchImageId == imageModel.id"
                                        src="{{baseUrlResizeImagePayments + '/' + imageModel.id}}"
                                        (click)="getDetailsPayment(payment, i);setImage4(imageModel)"
                                        title="Show in search" style="border: 3px solid lightcoral;">
                                      <div class="bottom-right py-2" *ngIf="user.allowAddPayment == true">
                                        <!-- <button *ngIf="imageModel.id != job.showInSearchImageId"
                                        title="As index image during search"
                                        (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                        class="btn btn-outline-primary-abs me-3 mt-3 btn-sm" for="title"><i
                                          class="bi-search"></i></button> -->
                                        <button (click)="deleteImagePayment(payment.id, imageModel.id)"
                                          data-toggle="tooltip" data-placement="top" title="Remove this image"
                                          class="btn btn-outline-danger mt-3 btn-sm" for="title"> <i
                                            class="bi-trash"></i>
                                        </button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="col-lg-12 col-md-12 col-sm-12 px-0 py-3"
                                *ngIf="selectedImage4 != null && selectedImage4 > 0 && payment.id ==  imageModelSelected.paymentId &&  payment.showInSearchImageId != selectedImage4">
                                <div class="bg-white rounded-3 border p-3 h-100">
                                  <div class="containerImage" *ngIf="payment?.imageModels!.length > 0"> <img
                                      class="image w-100 img-fluid img-thumbnail"
                                      src="{{baseUrlResizeImagePaymentGetImages + '/' + selectedImage4}}" alt="Image" />
                                    <img
                                      *ngIf="selectedImage4 != null && selectedImage4 > 0 &&  payment.showInSearchImageId == selectedImage4"
                                      style="max-height:500px;"
                                      class="img-fluid rounded-2 img-thumbnail my-2 object-fit-cover w-100"
                                      src="{{baseUrlResizeImagePaymentGetImages + '/' + selectedImage4}}" alt="Image" />
                                    <!-- <label *ngIf="selectedImage4 == payment.showInSearchImageId" class="top-left"
                                      for="title">
                                      Will Show this in listing</label> -->
                                    <div class="top-right py-3">
                                      <button title="Close" (click)="selectedImage4 =0"
                                        class="btn btn-primary-abs me-3 mt-3 btn-sm" for="title">Close</button>
                                      <!-- <button *ngIf="selectedImage != selectedVehicle.showInSearchImageId"
                                        title="As index image during search"
                                        (click)="setImageForSearch(selectedVehicle.id, selectedImage)"
                                        class="btn btn-primary-abs me-3 mt-3 btn-sm" for="title">Set for Index</button> -->
                                      <!-- <button (click)="deleteImage2(selectedVehicle.id, selectedImage4)"
                                        data-toggle="tooltip" data-placement="top" title="Remove this image"
                                        class="btn btn-danger mt-3 btn-sm" for="title">
                                        <i class="bi-trash"></i>
                                      </button> -->
                                    </div>
                                  </div>

                                </div>
                              </div>
                            </td>
                            <!-- <td colspan="8" class="text-center fs-12 v-align-middle opacity-75">
                            <div class="row">
                              <div class="d-flex px-2 py-1 mt-2 shadow d-flex align-items-stretch "
                                *ngFor='let imageModel of job.imageModels; let i=index'>
                                <div class="containerImage">
                
                                  <small class="top-left" for="title">
                                    {{imageModel?.createdAt | date: "MM/dd/yyyy hh:mm"}}</small>
                
                                  <img class="img-fluid rounded-2 img-thumbnail my-1 object-fit-cover" height="100" width="100"
                                    src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}" />
                
                                  <div class="bottom-right py-3" *ngIf="user.allowUpdateJobStatus == true">
                                    <button *ngIf="imageModel.id != job.showInSearchImageId" title="As index image during search"
                                      (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                      class="btn btn-primary-abs me-3 mt-3 btn-sm" for="title">Set for Index</button>
                                    <button (click)="deleteImageJob(job.id, imageModel.id)" data-toggle="tooltip"
                                      data-placement="top" title="Remove this image" class="btn btn-danger mt-3 btn-sm" for="title"> <i
                                        class="bi-trash"></i>
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </td> -->


                          </tr>
                        </ng-container>
                      </tbody>
                    </table>
                  </div>

                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-8">

              </div>
              <div class="col-lg-3 col-md-12"></div>
              <div class="col-lg-3 col-md-4 px-1" *ngIf="getTotalPayments() > 0">
                <ul>
                  <li class="d-flex justify-content-between my-4"><strong class="fs-15">Subtotal:</strong>
                    <p class="fs-15 text-black opacity-75 px-1 fw-700">${{getTotalPayments()}}</p>
                  </li>
                  <li class="d-flex justify-content-between my-4"><strong class="fs-15">Tax ({{company.taxRate
                      *100}}%):</strong>
                    <p class="fs-15 text-black opacity-75 px-1 fw-700">${{getTaxPayments() }}</p>
                  </li>
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill m-1">
                    <strong class="fs-15">Payments:</strong>
                    <p class="fs-15 px-1 fw-700">${{getTotalPaymentWithTax()}}</p>
                  </li>


                </ul>
              </div>
            </div>

          </div>
          <div class="tab-pane fade show" id="jobs-damages" role="tabpanel" #taggroup
            aria-labelledby="jobs-damages-tab">

            <div class="d-lg-flex align-items-center justify-content-between my-4 pt-4 d-block-mobile">
              <h2 class="heading-color align-items-center fw-700 text-uppercase px-2 pt-4 fs-16 d-flex gap-2">Vehicle
                Jobs for: <strong class="text-primary fw-700" data-bs-toggle="modal" data-bs-target="#editVehicle"
                  style="cursor: pointer;" title="Click to view details">{{vehicle.year}} {{vehicle.make}}
                  {{vehicle.model}}
                  {{vehicle.color}} ({{jobs.length}})</strong>
                <div class="dropdown">
                  <button class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold" type="button"
                    id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                    <span title="Total Job Costs">${{getTotalJobPrice(jobs)}}</span> <span>-</span>
                    <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                    <i class="fa fa-angle-down ms-2"></i>
                  </button>
                  <div class="dropdown-menu bg-light" style="min-width: 400px" aria-labelledby="dropdownMenuButton">
                    <div class="row">
                      <div class="col-6 px-1">
                        <a class="dropdown-item">Items</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">Estimates</a>
                        <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                        <a class="dropdown-item fw-700">Est. - Parts</a>
                        <a class="dropdown-item"></a>

                        <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                        <a class="dropdown-item">Management</a>
                        <!-- <a class="dropdown-item">Sales Commission</a> -->
                        <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700">Total Costs</a>
                        <a class="dropdown-item fw-700">Gross</a>

                        <!-- <a class="dropdown-item">After Tax</a> -->
                      </div>
                      <div class="col-6 px-1">
                        <a class="dropdown-item">#</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}} (${{vehicle.price}} +
                          ${{getTotalSupplements(vehicle)}})</a>
                        <a class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                          (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                        <a class="dropdown-item"></a>


                        <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                        <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                          ({{this.company.managementRate * 100}}% of
                          ${{getVehicleRemaining(vehicle)}})</a>

                        <a class="dropdown-item">${{getSaleTax(vehicle)}} ({{this.company.taxRate * 100}}% of
                          {{getVehicleTotalEstimates(vehicle)}})</a>
                        <div class="dropdown-divider"></div>

                        <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle, jobs)}}</a>
                        <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                      </div>
                    </div>

                  </div>
                </div>


              </h2>
              <div class="d-lg-flex align-items-center px-2 mt-2 three-btns">


                <div class="dropdown" *ngIf="user.allowAddService == true">
                  <button class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4 dropdown-toggle" type="button"
                    data-bs-toggle="dropdown" aria-expanded="false"
                    title="Add A Job Order. Click To Select A Pre-defined Job Order"> Add Job Order<i
                      class="fa fa-angle-down ms-2"></i>
                  </button>
                  <ul class="dropdown-menu p-0 border-0 shadow">
                    <ng-container *ngFor="let service of services; let i=index">
                      <li><a (click)="addVehicleJob(service)" class="dropdown-item p-3 fs-12" href="javascript:;"><i
                            class="fa fa-check fs-11 me-2 text-primary-abs"></i> {{service.name}}</a></li>
                    </ng-container>
                  </ul>
                </div>
                <button (click)="fillCalendarVehicleJob()"
                  class="h-40 fs-13 mt-2 btn btn-warning text-white px-4 border-radius-4 ms-3"><i
                    class="fa fa-calendar me-2"></i> See Schedule</button>

                <button (click)="findAllCurrentEmplyeeJobs()"
                  class="h-40 fs-13 mt-2 btn btn-info text-white px-4 border-radius-4 ms-3"><i
                    class="fa fa-list me-2"></i> List all Jobs</button>
                <button (click)="getVehicleJobs2(this.vehicle.id)"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                    class="fa fa-rotate"></i></button>
                <button title="Show all info" (click)="shallAllJobInfo = !shallAllJobInfo" *ngIf="jobs.length > 0"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                    class="fa fa-filter"></i></button>

                <button title="Print Repair Order" (click)="printPage('print-content-jobs', 'jobs')"
                  *ngIf="jobs.length > 0" class="h-40 fs-13 mt-2 btn btn-secondary-abs px-3 border-radius-4 ms-md-3"><i
                    class="fa fa-print"></i></button>
              </div>
            </div>

            <div class="row">
              <div class="mt-4 p-3 border bg-white border-radius-8 shadow">

                <div class="table-container shadow border-radius-8 bg-white border w-100 d-box ss-table">

                  <table class="table-bordered overflow-hidden shadow  line-height-100 w-100" cdkDropList
                    (cdkDropListDropped)="dropped($event)">
                    <thead>

                      <tr class="bg-info text-white">
                        <th class="fs-12 text-center bg-info text-white" style="width:50px">#</th>
                        <th class="fs-12 text-center bg-info text-white" style="width:50px">EID</th>
                        <th class="fs-12 text-center bg-info text-white mw-100">Item</th>
                        <th class="fs-12 text-center bg-info text-white" style="min-width:150px">
                          Instruction
                        </th>
                        <th class="fs-12 text-center bg-info text-white mw-100" style="max-width: 200px;">
                          Assigned
                          To</th>
                        <th class="fs-12 text-center bg-info text-white mw-50">Hours
                        </th>
                        <th class="fs-12 text-center bg-info text-white mw-50" style="max-width: 80px;"><i
                            class="fa-solid fa-dollar-sign"></i>
                        </th>
                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                        <th class="fs-12 text-center bg-info text-white mw-100">Target</th>
                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                        <th class="fs-12 text-center bg-info text-white mw-80 mxw-100 " style="width:50px">Status
                        </th>
                        <th class="fs-12 text-center bg-info text-white mw-50" title="Verifed By "><i
                            class="fa-solid fa-user text-danger"></i></th>
                        <th class="fs-12 text-center bg-info text-white mw-50"><i class="fa-solid fa-user"></i></th>
                        <th class="fs-12 text-center bg-info text-white mw-100">Action</th>
                      </tr>
                    </thead>
                    <tbody>
                      <ng-container *ngFor="let job of jobs; let i=index">
                        <tr (click)="getDetailsJob(job, i)" title="{{getJobTitle(job)}}">
                          <td class="text-center fs-12 v-align-middle" [cdkDragDisabled]="isMobile==true" cdkDrag>
                            {{job.id}}
                          </td>
                          <td class="text-center fs-12 v-align-middle">
                            <span classs="text-danger fw-700" title="Clik to view detail"
                              *ngIf="job.claimId> 0">{{job.claimId}}</span>

                          </td>
                          <td class="text-center fs-12 v-align-middle">
                            <input placeholder="Enter Job Name" [(ngModel)]="job.name" maxlength="50"
                              (keyup.enter)="onEnter('job name',job)" type="text" [disabled]="job.paidWeek> 0"
                              class="form-control h-40 border-radius-4 border" />
                          </td>
                          <td class="text-center fs-12 v-align-middle"><textarea type="text" rows="1"
                              [(ngModel)]="job.notes" class="form-control my-2" maxlength="200"
                              placeholder="Please specify" (keyup.enter)="onEnter('job notes',job)"
                              title="Job Instruction" [disabled]="job.paidWeek> 0"
                              oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                          </td>

                          <td class="text-center fs-12 v-align-middle"><select
                              class="form-select border-radius-4 h-40 border fs-12 " [(ngModel)]="job.employeeId"
                              #device [disabled]="job.paidWeek> 0" style="height:30px;"
                              (change)="onChangeEmployee2Claim($event, device.value, job, claim)">
                              <option value="0" disabled selected>Select Employee</option>
                              <option [value]="employee.id"
                                [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                *ngFor="let employee of employees;let i=index;">{{employee.firstName}}
                                ( {{employee.roleName}},
                                <span class="text-danger" *ngIf="employee.hourRate > 0 ">[ ${{employee.hourRate}}/hour]
                                </span>
                                <span class="text-danger" *ngIf="employee.hourRate == 0 ">[ {{employee.rolePrecentage}}%
                                  ]
                                </span>

                                <ng-container *ngIf="employee.commissionBased == true">
                                  - <span class="fw-700 text-danger">Commission Based</span>
                                </ng-container>)
                                [{{
                                employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                +
                                employee.jobCountsFinished}}]
                              </option>
                            </select></td>

                          <td class="text-center fs-12 v-align-middle"><input placeholder="Enter Time Requried"
                              *ngIf="(job.employeeId > 0 && shallDisplayHours(job) == true) || job.hours > 0"
                              [(ngModel)]="job.hours" maxlength="50" class="fs-12"
                              (change)="onChangeJobHour($event, job)" (keyup.enter)="onEnter('job hours',job)"
                              type="number" [disabled]="job.paidWeek> 0"
                              class="form-control border h-40 border-radius-4" />
                          </td>

                          <td class="text-center fs-12 v-align-middle"><input placeholder="Enter Job Value"
                              [(ngModel)]="job.price" maxlength="50" class="fs-12"
                              (keyup.enter)="onEnter('job price',job)" type="number" [disabled]="job.paidWeek> 0"
                              class="form-control border h-40 border-radius-4" />
                          </td>

                          <td class="text-center fs-12 v-align-middle"><input *ngIf="job.employeeId > 0"
                              (change)="onChangeCalendar($event, job)"
                              max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                              [disabled]="job.paidWeek> 0" [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                              title="Target Date" type="date" class="form-control border h-40 border-radius-4" /></td>

                          <td class="p-2 text-center v-align-middle">
                            <div class="form-check form-switch text-center">
                              <input class="form-check-input mt-0" type="checkbox" role="switch"
                                [disabled]="job.paidWeek> 0" *ngIf="job.employeeId > 0 " [checked]="isJobChecked(job)"
                                (change)="updateJobStatus(job)" />
                            </div>

                            <!-- <div class="form-check form-switch text-center">
                              <input class="form-check-input mt-0" type="checkbox" role="switch"
                                [disabled]="job.paidWeek> 0" *ngIf="job.employeeId > 0 " [checked]="isJobChecked(job)"
                                (change)="onEnter('done',job)" />
                            </div> -->
                          </td>
                          <td class="p-2 text-center  v-align-middle fs-12">

                            <ng-container *ngFor="let user of users;let i=index;">
                              <span class="text-danger" *ngIf="user.id == job.userIdVerified"
                                title="Verified At {{job.verifiedAt | date: 'MM/dd/yyyy HH:mm'}}">
                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                              </span>
                            </ng-container>

                          </td>
                          <td class="p-2 text-center  v-align-middle fs-12">

                            <ng-container *ngFor="let user of users;let i=index;">
                              <span *ngIf="user.id == job.userId">
                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                              </span>
                            </ng-container>

                          </td>
                          <td class="text-center fs-12 v-align-middle">
                            <div class="d-flex align-items-center justifyc-content-center gap-1">
                              <button class="btn btn-outline-danger btn-sm" title="Remove" [disabled]="job.paidWeek> 0"
                                (click)="deleteVehicleJobClaim(null, job)"><i class="fa fa-trash"></i></button>
                              <button class="btn btn-outline-primary btn-sm" title="Save" [disabled]="job.paidWeek> 0"
                                (click)="saveJobNotes(job)"><i class="fa fa-save"></i></button>

                              <!-- <button class="btn btn-outline-danger btn-sm" title="Verify"
                                [disabled]="job.status != 1 && job.paidWeek> 0 && job.verifiedAt != null "
                                (click)="verifyJob(job)"><i class="fa fa-check"></i></button> -->
                              <button class="btn btn-outline-dark btn-sm" title="Print" (click)="setJobId(job.id)"
                                (click)="printPageJob('print-content-job', 'jobs', job)">
                                <i class="fa fa-print"></i> </button>

                              <ng-container *ngIf="job.startDate == null">
                                <button class="btn btn-success btn-sm" [disabled]="job.paidWeek> 0" title="Start Job"
                                  (click)="onEnter('comments',job)"><i class="fa fa-running"
                                    [ngClass]="{'text-danger':job.startDate != null}"></i></button>
                              </ng-container>

                              <!-- <button class="btn btn-outline-warning btn-sm"
                                *ngIf="job.comments == null || job.comments == '' " title="add commments"
                                [disabled]="job.paidWeek> 0" (click)="onEnter('job comments',job)"><i
                                  class="fa fa-plus"></i></button> -->

                              <button class="btn btn-outline-warning btn-sm" title="add images"
                                [disabled]="job.paidWeek> 0" (click)="fileInput.click()"><i
                                  class="fa fa-camera"></i></button>

                              <input type='file' id="uploadButton"
                                class="form-control opacity-0 top-0 position-absolute" accept="image/jpg, image/jpeg"
                                #fileInput (change)="onSelectFileEditorJobs($event, job)" multiple
                                (click)="fileInput.value = ''" />

                            </div>
                          </td>
                        </tr>
                        <!-- <tr class="v-align-middle fs-11"
                          *ngIf="job.comments != null && job.comments != '' && shallAllJobInfo ==true ">

                          <td><span *ngIf="job.notifiedAt != null">Notified At</span></td>
                          <td><span *ngIf="job.notifiedAt != null">{{job.notifiedAt | date:'MM/dd/yyyy HH:mm'}}</span>
                          </td>

                          <td colspan="8" class="text-center fs-12 v-align-middle opacity-75">
                            <div class="progress  mt-2 w-100">
                              <div class="progress-bar" role="progressbar" style="width: {{job.steps/100 | percent }}"
                                aria-valuemin="0" aria-valuemax="100">
                                {{job.stepDescriptionCumulative }} ({{job.steps/100 | percent}})</div>
                            </div>
                          </td>
                          <td>
                            <div class="d-flex mt-2 justify-content-end gap-1">

                              <input type='file' id="uploadButton" class="form-control opacity-0 top-0 w-25 end-0"
                                accept="image/jpg, image/jpeg" #fileInput (change)="onSelectFileEditorJobs($event, job)"
                                multiple (click)="fileInput.value = ''" />


                              <ng-container *ngIf="job.startDate == null">
                                <button class="btn btn-success btn-sm" [disabled]="job.paidWeek> 0"
                                  (click)="onEnter('comments',job)"><i class="fa fa-running"
                                    [ngClass]="{'text-danger':job.startDate != null}"></i></button>
                              </ng-container>
                              <ng-container *ngIf="job.startDate != null && job.comments != null">
                                <button class="btn btn-success btn-sm" [disabled]="job.paidWeek> 0"
                                  (click)="onEnter('comments',job)"><i class="fa fa-save"
                                    [ngClass]="{'text-danger':job.startDate != null}"></i></button>

                              </ng-container>


                              <ng-container *ngIf="shallShowDone(job)">
                                <button class="btn btn-success btn-sm" title="Done" [disabled]="job.paidWeek> 0 "
                                  (click)="onEnter('done',job)"><i class="fa flag-checkered"
                                    [ngClass]="{'text-danger':job.status == 1 }"></i> Done </button>
                              </ng-container>

                              <ng-container *ngIf="shallShowNofityManger(job)">
                                <button class="btn btn-success btn-sm" title="notify managers"
                                  (click)="notifyManager('Noitfy','text-warning fw-500',job)"><i class="fa fa-bell"
                                    [ngClass]="{'text-danger': job.notified == true, 'text-success': job.notified  == false}"></i>
                                  Notify Manager </button>
                              </ng-container>

                              <ng-container *ngIf="shallShowNVerified(job)">
                                <button class="btn btn-success text-white btn-sm" title="Verify this job"
                                  (click)="notifyManager('Verified','text-primary fw-700',job)">
                                  <i class="fa fa-check"
                                    [ngClass]="{'text-danger': job.verifiedAt != null, 'text-white': job.verifiedAt  == null}"></i>
                                  Verify </button>
                              </ng-container>


                              <button class="btn btn-warning text-white btn-sm" title="add images"
                                [disabled]="job.paidWeek> 0" (click)="fileInput.click()"><i class="fa fa-camera"></i>
                              </button>


                            </div>
                          </td>
                        </tr> -->
                        <tr class="v-align-middle fs-11" *ngIf="shallAllJobInfo ==true ">
                          <!-- <td></td>
                          <td></td> -->
                          <td><span *ngIf="job.userIdVerified > 0">Verifed At</span></td>
                          <td><span *ngIf="job.userIdVerified > 0">{{job.verifiedAt | date:'MM/dd/yyyy HH:mm'}}</span>
                          </td>
                          <td colspan="9" class="text-center fs-12 v-align-middle opacity-75"><textarea type="text"
                              rows="1" [(ngModel)]="job.comments" class="form-control my-2" maxlength="2000"
                              placeHolder="Pleaes enter comments" (keyup.enter)="onEnter('job comments',job)"
                              title="Job Comments" [disabled]="job.paidWeek> 0"
                              oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                          </td>

                          <!-- <td>
                            <div class="d-flex mt-2 justify-content-end gap-1">

                              <input type='file' id="uploadButton" class="form-control opacity-0 top-0 w-25 end-0"
                                accept="image/jpg, image/jpeg" #fileInput (change)="onSelectFileEditorJobs($event, job)"
                                multiple (click)="fileInput.value = ''" />


                              <ng-container *ngIf="job.startDate != null && job.comments != null">
                                <button class="btn btn-success btn-sm" [disabled]="job.paidWeek> 0"
                                  (click)="onEnter('comments',job)"><i class="fa fa-save"
                                    [ngClass]="{'text-danger':job.startDate != null}"></i></button>
                              </ng-container>


                              <button class="btn btn-success btn-sm" title="Done" [disabled]="job.paidWeek> 0 "
                                (click)="onEnter('done',job)"><i class="fa flag-checkered"
                                  [ngClass]="{'text-danger':job.status == 1 }"></i></button>


                              <ng-container *ngIf="shallShowNofityManger(job)">
                                <button class="btn btn-success btn-sm" title="notify managers"
                                  (click)="notifyManager('Noitfy','text-warning fw-500',job)"><i class="fa fa-bell"
                                    [ngClass]="{'text-danger': job.notified == true, 'text-success': job.notified  == false}"></i>
                                  Notify Manager </button>
                              </ng-container>

                              <ng-container *ngIf="shallShowNVerified(job)">
                                <button class="btn btn-success text-white btn-sm" title="Verify this job"
                                  (click)="notifyManager('Verified','text-primary fw-700',job)">
                                  <i class="fa fa-check"
                                    [ngClass]="{'text-danger': job.verifiedAt != null, 'text-white': job.verifiedAt  == null}"></i>
                                  Verify </button>
                              </ng-container>


                              <button class="btn btn-warning text-white btn-sm" title="add images"
                                [disabled]="job.paidWeek> 0" (click)="fileInput.click()"><i class="fa fa-camera"></i>
                              </button>


                            </div>
                          </td> -->
                        </tr>
                        <tr class="v-align-middle fs-11" *ngIf="job.imageModels.length>0 && shallAllJobInfo== true">
                          <td></td>
                          <td></td>
                          <td colspan="9">
                            <div class="row overflow-x-auto overflow-y-hidden">
                              <div
                                class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-1">

                                <div *ngFor='let imageModel of job.imageModels; let i=index'
                                  [cdkDragDisabled]="isMobile==true" cdkDrag
                                  class="containerImage v-imgs float-start my-2 transition" style="cursor: pointer;">
                                  <div class="containerImage">

                                    <label class="top-left-0 w-100 fs-10 opacity-75"
                                      [ngClass]="{'text-white bg-primary':imageModel.employeeId> 0, 'text-white bg-secondary':imageModel.employeeId == 0}"
                                      for="title"> <span
                                        *ngIf="imageModel.employeeId > 0">{{getTopImageLabel(imageModel)
                                        |shortName}}</span>
                                      {{imageModel?.createdAt | date: 'MM/dd/yyyy, HH:mm'}}</label>

                                    <img class="preview img-fluid img-thumbnail" width="100%"
                                      title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                      *ngIf="job.showInSearchImageId != imageModel.id"
                                      src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}" (click)="setImage2(i)"
                                      style="border: 3px solid #555;">
                                    <img class="preview img-fluid img-thumbnail" width="100%"
                                      title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}} "
                                      *ngIf="job.showInSearchImageId == imageModel.id"
                                      src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}" (click)="setImage2(i)"
                                      title="Show in search" style="border: 3px solid lightcoral;">
                                    <div class="bottom-right py-2" *ngIf="user.allowUpdateJobStatus == true">
                                      <button *ngIf="imageModel.id != job.showInSearchImageId"
                                        title="As index image during search"
                                        (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                        class="btn btn-outline-primary-abs me-3 mt-3 btn-sm" for="title"><i
                                          class="bi-search"></i></button>
                                      <button (click)="deleteImageJob(job.id, imageModel.id)" data-toggle="tooltip"
                                        data-placement="top" title="Remove this image"
                                        class="btn btn-outline-danger mt-3 btn-sm" for="title"> <i class="bi-trash"></i>
                                      </button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>

                          </td>
                          <!-- <td colspan="8" class="text-center fs-12 v-align-middle opacity-75">
                            <div class="row">
                              <div class="d-flex px-2 py-1 mt-2 shadow d-flex align-items-stretch "
                                *ngFor='let imageModel of job.imageModels; let i=index'>
                                <div class="containerImage">
                
                                  <small class="top-left" for="title">
                                    {{imageModel?.createdAt | date: "MM/dd/yyyy hh:mm"}}</small>
                
                                  <img class="img-fluid rounded-2 img-thumbnail my-1 object-fit-cover" height="100" width="100"
                                    src="{{baseUrlResizeImageJobs + '/' + imageModel.id}}" />
                
                                  <div class="bottom-right py-3" *ngIf="user.allowUpdateJobStatus == true">
                                    <button *ngIf="imageModel.id != job.showInSearchImageId" title="As index image during search"
                                      (click)="setImageForSearchJobs(job.id, imageModel.id)"
                                      class="btn btn-primary-abs me-3 mt-3 btn-sm" for="title">Set for Index</button>
                                    <button (click)="deleteImageJob(job.id, imageModel.id)" data-toggle="tooltip"
                                      data-placement="top" title="Remove this image" class="btn btn-danger mt-3 btn-sm" for="title"> <i
                                        class="bi-trash"></i>
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </td> -->


                        </tr>
                      </ng-container>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="mt-4 p-3 border bg-white border-radius-8 shadow">


                <div class="table-container shadow border-radius-8 border w-100 d-box ss-table">
                  <table class="table-bordered border-radius-8 w-100">
                    <thead>
                      <tr class="bg-info text-white v-align-middle">
                        <th class="fs-14 text-center mxw-50" style="width:80px"> </th>
                        <th class="fs-14 text-center mxw-100" style="max-width:100px" (click)="navigateTo('employees')">
                          <i class="fa fa-user"></i>
                        </th>
                        <th class="fs-14 text-center mxw-50 " style="width:50px"> # </th>
                        <th class="fs-14 text-center v-align-middle "> [ {{
                          this.employeeJobCarrier.length }} ] employees with total of [{{ totalJobCounts}}] jobs
                          <!--  <div class="btn-group btn-group-toggle" data-toggle="buttons">
                            <label class="btn btn-secondary">
                              <input type="radio" name="options" id="option1" autocomplete="off" checked> Finished
                            </label>
                            <label class="btn btn-secondary">
                              <input type="radio" name="options" id="option2" autocomplete="off"> Not Finished
                            </label>
                            <label class="btn btn-secondary">
                              <input type="radio" name="options" id="option3" autocomplete="off"> Both
                            </label>
                          </div> -->
                        </th>
                      </tr>
                    </thead>
                    <ng-container *ngFor="let employee of employeeJobCarrier; let i = index;  let even=even">
                      <tr id="{{employee.id}}" title=""
                        [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')">

                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details">
                          {{i+1}}
                        </td>
                        <td class="text-center fs-13" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details text-capitalize ">
                          <a style="word-break:break-all" target="_blank">{{(employee.firstName
                            + ' ' + employee.lastName)|
                            shortName:2}}</a>
                        </td>
                        <td class="fs-13 text-center fw-700" data-bs-toggle="modal" data-bs-target="#partDetails"
                          title="Click to view details">
                          <span *ngIf="employee.jobs" title="number of jobs">{{ employee.jobs.length}}</span>/<span
                            title="number of vehicles">{{filterJobs(employee).length}}</span>
                        </td>
                        <!-- <td>Jobs</td> -->
                        <td *ngIf="employee.jobs!.length >0">

                          <ng-container *ngFor="let vehicle of filterJobs(employee); let i=index">
                            <div class="table-container w-100 d-box ss-table mt-1 mb-1">
                              <table class="table w-100 mb-1">
                                <thead>
                                  <tr>
                                    <td class="fs-14 text-center w-25">
                                      <a class="btn btn-light d-flex gap-2 align-items-center white-space my-1 border p-1 shadow "
                                        data-toggle="tooltip" data-placement="bottom"
                                        title="{{vehicle.customer.title}} {{vehicle.customer.firstName}} {{vehicle.customer.lastName }} "
                                        [style.background-color]="vehicle.id == currentIndex? '#EEE' : (true ? 'white' : 'white')"
                                        (click)="getDetail(vehicle, vehicle.id)">

                                        <span [ngClass]="{'text-danger': vehicle.special ==true}"
                                          title="{{vehicle.make}}"
                                          class="car-{{ vehicle.make| lowercase }} fs-30"></span>

                                        <!-- <ng-container
                                          *ngIf="vehicle.make != 'Land Rover' && vehicle.make != 'Alfa Romeo' && vehicle.make != 'koda' && vehicle.make !='Rolls Royce'">
                                          <span title="{{vehicle.make}}"
                                            class="car-{{ vehicle.make| lowercase }} fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'Land Rover'">
                                          <span title="{{vehicle.make}}" class="car-land-rover fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'Rolls Royce'">
                                          <span title="{{vehicle.make}}" class="car-rolls-royce fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'Alfa Romeo'">
                                          <span title="{{vehicle.make}}" class="car-alfa-romeo fs-30"></span>
                                        </ng-container>

                                        <ng-container *ngIf="vehicle.make == 'koda'">
                                          <span title="{{vehicle.make}}" class="car-skoda fs-30"></span>

                                        </ng-container> -->
                                        <span class="d-block text-start">
                                          <strong class="fs-12 fw-500 d-flex gap-2 align-items-center"
                                            title="Click to view vehicle details" data-bs-toggle="modal"
                                            data-bs-target="#editVehicle"
                                            (click)="this.showVehicleListing = false; getDetail(vehicle, vehicle.id)"
                                            [style.color]="vehicle.id == currentIndex? 'black' : (true ? 'black' : 'black')">
                                            <i class="fa-solid fa-square border border-radius-1"
                                              style="color: {{vehicle.color}}"></i>
                                            <small>{{
                                              vehicle.year }} {{ vehicle.make }} {{ vehicle.model }}</small></strong>
                                          <strong class="fw-700 fs-11 py-1 line-height-150 text-secondary"
                                            [ngClass]="{'blink text-success': vehicle.jobsDone == true}">Jobs:
                                            {{getJobStatusCount(vehicle,vehicle.jobs)}}/{{ vehicle.jobs.length
                                            }}</strong>
                                          <strong class="badge badge-success ms-1"
                                            (click)="changePaidStatus(vehicle, false)" title="Paid"
                                            *ngIf="vehicle.paid==true"><i class="fa-solid fa-dollar-sign"></i></strong>
                                        </span>

                                      </a>
                                    </td>
                                    <td class="fs-14 text-center w-75">
                                      <a *ngFor="let job of vehicle.jobs2" title="{{getJobTitle(job)}}"
                                        class="btn btn-light d-flex gap-2 align-items-center white-space my-1 border p-1 shadow">
                                        <span class="d-block text-start">

                                          <strong class="fs-12 fw-500 d-flex gap-2 align-items-center overflow-hidden"
                                            title="Click to view vehicle details" data-bs-toggle="modal"
                                            data-bs-target="#editVehicle"
                                            (click)="this.showVehicleListing = false; getDetail(vehicle, vehicle.id)"
                                            [style.color]="vehicle.id == currentIndex? 'black' : (true ? 'black' : 'black')">
                                            <i *ngIf="job.status==1"
                                              class="fa-solid fa-square border border-radius-1 text-success"></i>
                                            <i *ngIf="job.status==0"
                                              class="fa-solid fa-square border border-radius-1 text-danger"></i>
                                            <small><span>{{job.id}}. </span> <strong class="badge badge-success ms-1"
                                                *ngIf="job.paidWeek > 0"><i
                                                  class="fa-solid fa-dollar-sign opacity-50"></i></strong>
                                              {{ job.name }} </small>:<small>{{
                                              job.notes }} </small>
                                            <span *ngIf="job.hours > 0" class="text-primary">{{job.hours}}H </span>
                                            <span class="text-danger">${{job.price}}</span><i
                                              *ngIf="job.targetDate != null"
                                              class="fas fa-bullseye opacity-50"></i><span>
                                              {{job.targetDate | date: 'MM/dd/yyyy' }}</span> <span>created <i
                                                class="fa-solid fa-clock opacity-50"></i>{{job.createdAt | date:
                                              'MM/dd/yyyy'
                                              }}</span>

                                            <span>By <i class="fa-solid fa-user opacity-50"></i>
                                              <ng-container *ngFor="let user of users;let i=index;">
                                                <span *ngIf="user.id == job.userId">
                                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                </span>
                                              </ng-container>

                                            </span>


                                          </strong>
                                        </span>
                                      </a>
                                    </td>
                                  </tr>
                                </thead>
                              </table>
                            </div>


                          </ng-container>
                        </td>
                        <td *ngIf="employee.jobs!.length==0"></td>
                      </tr>

                    </ng-container>
                  </table>
                </div>
              </div>
            </div>

            <br />
            <br />
          </div>
          <div class="tab-pane fade show" id="receipt-damages" role="tabpanel" #taggroup
            aria-labelledby="receipt-damages-tab">
            <div class="d-flex align-items-center v-align-middle justify-content-start pt-5">
              <h2 class="heading-color fw-700 text-uppercase pt-3 px-2 fs-16 pb-3">Vehicle Receipt Items For: <strong
                  class="text-primary fw-700" data-bs-toggle="modal" data-bs-target="#editVehicle"
                  style="cursor: pointer;" title="Click to view details">{{vehicle.year}}
                  {{vehicle.make}}
                  {{vehicle.model}} {{vehicle.color}} ({{receipts.length}}) </strong>
              </h2>
              <div class="dropdown">
                <button class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold" type="button"
                  id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                  <span title="Total Receipt">${{getTotal()}}</span> <span>-</span>
                  <span title="Total Estimates">${{getVehicleTotalEstimates(vehicle)}}</span>
                  <i class="fa fa-angle-down ms-2"></i>
                </button>
                <div class="dropdown-menu bg-light" style="min-width: 400px" aria-labelledby="dropdownMenuButton">
                  <div class="row">
                    <div class="col-6 px-1">
                      <a class="dropdown-item">Items</a>
                      <div class="dropdown-divider"></div>

                      <a class="dropdown-item">Estimates</a>
                      <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                      <a class="dropdown-item fw-700">Est. - Parts</a>
                      <a class="dropdown-item"></a>

                      <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                      <a class="dropdown-item">Management</a>
                      <!-- <a class="dropdown-item">Sales Commission</a> -->
                      <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                      <div class="dropdown-divider"></div>

                      <a class="dropdown-item fw-700">Total Costs</a>
                      <a class="dropdown-item fw-700">Gross</a>

                      <!-- <a class="dropdown-item">After Tax</a> -->
                    </div>
                    <div class="col-6 px-1">
                      <a class="dropdown-item">#</a>
                      <div class="dropdown-divider"></div>

                      <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}} (${{vehicle.price}} +
                        ${{getTotalSupplements(vehicle)}})</a>
                      <a class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                      <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                        (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                      <a class="dropdown-item"></a>


                      <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                      <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                        ({{this.company.managementRate * 100}}% of
                        ${{getVehicleRemaining(vehicle)}})</a>
                      <!-- <a class="dropdown-item text-danger">${{getSalesCommission(vehicle)}} (7% of
                          ${{vehicle.supplymentPrice}})</a> -->
                      <a class="dropdown-item">${{getSaleTax(vehicle)}} ({{this.company.taxRate * 100}}% of
                        {{getVehicleTotalEstimates(vehicle)}})</a>
                      <div class="dropdown-divider"></div>

                      <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle, jobs)}}</a>
                      <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                    </div>
                  </div>

                </div>

              </div>
            </div>
            <div class="d-lg-flex align-items-center justify-content-between px-1 mt-3">
              <div class="d-flex align-items-center gap-3 w-80 v-receipt">
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.paymentMethod" #paymentMethod
                  title="Payment Methods" (change)="onChangeVehiclePaymentMethod($event, paymentMethod.value)">
                  <option value="0" disabled selected>Select Payment Method</option>
                  <option [value]="paymentMethod.id" *ngFor="let paymentMethod of paymentMethods;let i=index;">
                    {{paymentMethod.name}}</option>
                </select>
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="disclaimerId" #optionDisclaimerId
                  title="Disclaimers" (change)="onChangeDisclaimer($event)">
                  <option value="0" disabled selected>Select Disclaimer</option>
                  <option [value]="disclaimer.id" *ngFor="let disclaimer of disclaimers;let i=index;">
                    {{disclaimer.name}} <span *ngIf="disclaimer.isDefault ==true">(default)</span></option>
                </select>
                <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="warrantyId" #optionWarrantyId
                  title="Warranties" (change)="OnChangeWarranty($event)">
                  <option value="0" disabled selected>Select Warranty</option>
                  <option [value]="warranty.id" [selected]="warranty.isDefault == true"
                    *ngFor="let warranty of warranties;let i=index;">
                    {{warranty.name}} <span *ngIf="warranty.isDefault ==true">(default)</span></option>
                </select>
                <div class="form-check form-switch d-flex ms-3 mw-150">
                  <input class="form-check-input mt-0" type="checkbox" role="switch" id="tax"
                    title="Apply Tax or No Tax" (change)="onChangeNoTax($event)" />
                  <label class="form-check-label fa-13 mt-1 ms-4" for="tax">No Tax</label>
                </div>
              </div>
              <div class="add-r">
                <button *ngIf="user.allowAddReceipt == true"
                  class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4" type="button"
                  (click)="createReceipt()"><i class="fa fa-plus me-2"></i> Add Receipt Item</button>
                <button [disabled]="receipts.length == 0" (click)="printPage('print-content-receipt', 'Receipt')"
                  class="h-40 fs-13 mt-2 btn btn-secondary-abs px-4 border-radius-4 ms-md-3"><i
                    class="fa fa-print me-2"></i> Print Receipt</button>

              </div>
            </div>
            <div class="row mt-4">
              <div class="mt-4 pt-1">
                <div class="col-12 p-3 bg-white shadow border border-radius-8">

                  <div class="table-responsive jobs-table bg-white border-radius-8 shadow" cdkDropList
                    (cdkDropListDropped)="droppedReceipt($event)">
                    <table class="table table-bordered border-radius-8 w-100">
                      <thead>
                        <tr>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                            style="width: 50px;">#
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Item</th>
                          <th *ngIf="hasEID()== true"
                            class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                            style="width: 50px;">EID/AID
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                            title="Click to go to Configuration" [routerLink]="'/item-types'"
                            style="cursor:pointer; width:150px">Item Type</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                            style="width: 50px;">
                            Quantity</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width:100px"><i class="fa-solid fa-dollar-sign"></i></th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                            style="width: 100px;">Subtotal</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                              class="fa-solid fa-clock"></i>
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                              class="fa-solid fa-user"></i>
                          </th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle" style="width:100px;">
                            Action
                          </th>
                        </tr>


                      </thead>
                      <tbody>
                        <tr class="alert-info" *ngFor="let receipt of receipts; let i=index"
                          (click)="setReceiptId(receipt.id)"
                          [style.background-color]="receipt.id == currentReceiptId? '#FFF3CD' : (true ? '#CFF4FC' : '#CFF4FC')">

                          <td class="fs-13 p-2 text-center v-align-middle" [cdkDragDisabled]="isMobile==true" cdkDrag
                            title="Drag and drop index number to change the order">
                            {{i+1}}
                          </td>
                          <td class="fs-13 p-2"
                            [attr.title]="{'Please specify item information':receipt.notes == ''|| receipt.notes == null }">
                            <textarea [(ngModel)]="receipt.notes" class="form-control"
                              [ngClass]="{'blink border-danger': receipt.notes == ''|| receipt.notes == null }"
                              placeholder="Please Specify" (keyup.enter)="onEnterReceipt('notes',receipt)" rows="1"
                              oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                              maxlength="200" [disabled]="user.allowAddReceipt == false"></textarea>
                          </td>
                          <td *ngIf="hasEID()== true" class="fs-13 p-2 fw-500 text-center v-align-middle">
                            <span *ngIf="receipt.claimId > 0" title="Click to view estimate item"
                              (click)="openTab('claims-tab')">{{receipt.claimId}}</span>
                            <span *ngIf="receipt.autopartId > 0" title="Click to view auto parts detail"
                              (click)="openTab('autoparts-tab')">{{receipt.autopartId}}</span>
                          </td>
                          <td class="p-2 text-center">
                            <select class="form-select h-48 px-3 border-radius-8"
                              [disabled]="user.allowAddReceipt == false" [(ngModel)]="receipt.itemType"
                              (change)="onEnterReceipt('item type',receipt)">
                              <option value="0" disabled selected>Select Type</option>
                              <option value="0" *ngIf="receipt.itemType > 0">Un-select Type</option>
                              <option [value]="itemType.id" *ngFor="let itemType of itemTypes;let i=index;">
                                {{itemType.name}}
                              </option>
                            </select>
                          </td>
                          <td class="fs-13 p-2"><input (keyup.enter)="onEnterReceipt('quantity',receipt)"
                              [(ngModel)]="receipt.quantity" onKeyPress="if(this.value.length==10) return false"
                              pattern="[0-9]" type="number" class="form-control form-control-sm h-40 border-radius-4" />
                          </td>
                          <td class="fs-13 p-2"><input (keyup.enter)="onEnterReceipt('amount',receipt)"
                              [(ngModel)]="receipt.amount" onKeyPress="if(this.value.length==10) return false"
                              pattern="[0-9]" type="number" class="form-control form-control-sm h-40 border-radius-4" />
                          </td>

                          <td class="fs-13 p-2 text-center v-align-middle">${{getReceiptSubTotal(receipt)}}</td>
                          <td class="fs-13 p-2 text-center v-align-middle">
                            {{receipt.createdAt | date: 'MM/dd/yyyy HH:mm'}}
                          </td>
                          <td class="fs-13 p-2 text-center  v-align-middle">
                            <ng-container *ngFor="let user of users;let i=index;">
                              <span *ngIf="user.id == receipt.userId">
                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                              </span>
                            </ng-container>


                          </td>
                          <td class="p-2 text-center">
                            <div class="d-flex align-items-center justifyc-cntent-center gap-2">
                              <button class="btn btn-outline-danger btn-sm" [disabled]="user.allowAddReceipt == false"
                                title="Delete" (click)="deleteVehicleReceipt(null, receipt)"><i
                                  class="fa fa-trash"></i></button>
                              <button class="btn btn-outline-success btn-sm" [disabled]="user.allowAddReceipt == false"
                                title="Save" (click)="onEnterReceipt('update', receipt)"><i
                                  class="fa fa-save"></i></button>
                            </div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-6 col-md-8">
                <div *ngIf="getSubtotal() > 0">
                  <h3 class="fs-20 fw-700 my-3">Payment Method</h3>
                  <ng-container *ngFor="let paymentMethod of this.paymentMethods">
                    <p class="fs-14" *ngIf="paymentMethod.id==vehicle.paymentMethod">{{paymentMethod.name}}</p>
                  </ng-container>
                </div>
                <h3 class="fs-20 fw-700 my-4 pt-3" *ngIf="warrantyText != ''">Warranties</h3>
                <p [innerHtml]=" warrantyText" *ngIf="warrantyText != ''" class="wave fs-13 line-height-130">
                </p>
                <h3 class="fs-20 fw-700 my-4 pt-3">Terms &amp; Conditions</h3>
                <p [innerHtml]="disclaimerText" *ngIf="disclaimerText != ''" class="wave fs-13 line-height-130"></p>
              </div>
              <div class="col-lg-3 col-md-12"></div>
              <div class="col-lg-3 col-md-4" *ngIf="getSubtotal() > 0">
                <ul>
                  <li class="d-flex justify-content-between my-4"><strong class="fs-15">Subtotal:</strong>
                    <p class="fs-15 text-black px-1 fw-700">${{getSubtotal()}}</p>
                  </li>
                  <li class="d-flex justify-content-between my-4"><strong class="fs-15">Tax ({{company.taxRate
                      *100}}%):</strong>
                    <p class="fs-15 text-black  px-1 fw-700">${{getTax() }}</p>
                  </li>
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill my-2">
                    <strong class="fs-15">Total:</strong>
                    <p class="fs-15 px-1">${{getTotal()}}</p>
                  </li>
                  <!-- <li class="d-flex justify-content-between my-4 fw-700 text-black">
                    <strong class="fs-18 fw-700">Total Payments: </strong>
                    <p class="fs-18 fw-700">${{getTotalPayments()}}</p>
                  </li> -->
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill my-2">
                    <strong class="fs-15">Payments:</strong>
                    <p class="fs-15 px-1">${{getTotalPayments()}}</p>
                  </li>
                  <li
                    class="d-flex justify-content-between d-block bg-navy  pt-3 pb-3 ps-5 text-white fw-700 fs-16 left-pill">
                    <strong class="fs-15">Balance:</strong>
                    <p class="fs-15 px-1">${{getTotalBallance()}}</p>
                  </li>
                </ul>
              </div>
            </div>
            <br />
            <br />
          </div>
          <div class="tab-pane fade show" id="histories-damages" role="tabpanel" #taggroup
            aria-labelledby="histories-damages-tab">

            <div class="d-lg-flex align-items-center justify-content-between px-1 mt-3">
              <h2 class="heading-color fw-700 text-uppercase pt-5 fs-16 pb-3">Vehicle Histories for: <strong
                  class="text-primary fw-700" data-bs-toggle="modal" data-bs-target="#editVehicle"
                  title="Click to view details">{{vehicle.year}}
                  {{vehicle.make}}
                  {{vehicle.model}} {{vehicle.color}} ({{vehicleHistories.length}})</strong></h2>

              <div class="add-r">
                <button class="h-40 fs-13 mt-2 btn btn-primary px-4 border-radius-4" type="button"
                  (click)="getVehicleHistory(vehicle.id)"><i class="fa fa-list me-2"></i> Get Change
                  Histories</button>

              </div>
            </div>
            <div class="row mt-4">
              <div class="mt-4 pt-1">
                <div class="col-12 p-3 bg-white shadow border border-radius-8">
                  <div class="table-responsive border shadow border-radius-8">
                    <table class="table table-bordered w-100">

                      <tbody>

                        <tr class="bg-navy text-white">
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">#</th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-200">Time</th>


                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50">Type</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Description</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">On</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Image(?)</th>

                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mxw-200">Value</th>
                          <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100">User</th>


                        </tr>
                        <tr *ngFor="let vehicleHistory of vehicleHistories; let i=index"
                          [ngClass]="{'bg-info': vehicleHistory.employeeId > 0}" class="v-align-middle text-center">
                          <td class="fs-14 text-center"><span
                              title="vehicleHistory.id = [{{vehicleHistory.id}}]">{{i+1}}</span></td>

                          <td class="fs-14 text-center">{{vehicleHistory.createdAt | date: 'MM/dd/yyyy, HH:mm'}}
                          </td>


                          <td class="fs-14 text-center"><i
                              class="{{vehicleHistory.iconClassString}} {{vehicleHistory.colorClassString}}"></i></td>
                          <td class="fs-14 text-center">{{vehicleHistory.name}}</td>

                          <td class="fs-14 text-center"><i class="{{vehicleHistory.iconName}}"></i></td>
                          <td class="fs-14 text-center"> <ng-container
                              *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==1">
                              <img src="{{baseUrlResizeImage + '/' + vehicleHistory.objectKey}}" height="40" alt="Image"
                                class="object-fill rounded-1 w-100" />
                            </ng-container>
                            <ng-container *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==2">
                              <img src="{{baseUrlResizeImageParts + '/' + vehicleHistory.objectKey}}" height="40"
                                alt="Image" class="object-fill rounded-1 w-100" />
                            </ng-container>
                            <ng-container *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==3">
                              <img src="{{baseUrlResizeImageJobs + '/' + vehicleHistory.objectKey}}" height="40"
                                alt="Image" class="object-fill rounded-1 w-100" />
                            </ng-container>
                            <ng-container *ngIf="vehicleHistory.type !=2 && vehicleHistory.objectContextType ==5">
                              <img src="{{baseUrlResizeImagePayments + '/' + vehicleHistory.objectKey}}" height="40"
                                alt="Image" class="object-fill rounded-1 w-100" />
                            </ng-container>
                          </td>

                          <td class="fs-14 text-center" style="word-break: break-word;">
                            {{vehicleHistory.value}}
                            <ng-container *ngIf="vehicleHistory.employeeId > 0">
                              <span> By </span><span class="fw-500 text-danger">
                                [{{getEmployeeName(vehicleHistory.employeeId) | shortName }}]</span>
                            </ng-container>

                          </td>
                          <td class="fs-14 text-center">
                            <ng-container *ngIf="vehicleHistory.employeeId > 0">
                              <span class="fw-500 text-danger">{{getEmployeeName(vehicleHistory.employeeId)| shortName
                                }}</span>
                            </ng-container>
                            <ng-container *ngIf="vehicleHistory.employeeId == 0">
                              {{vehicleHistory.userName | shortName}}
                            </ng-container>
                          </td>


                        </tr>

                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <br />
            <br />
          </div>
          <div class="tab-pane fade show" id="schedule-damages" role="tabpanel" #taggroup
            aria-labelledby="schedule-damages-tab">
            <h2 class="heading-color fw-700 text-uppercase pt-5 fs-18 pb-3">Schedules</h2>
            <full-calendar [options]="calendarOptions">
              <ng-template #eventContent let-arg> <span class="tooltipTest"
                  id="{{arg.event.extendedProps['jobRequestType']}} at {{arg.event.extendedProps['location']}} been {{arg.event.extendedProps['days']}} days">{{arg.event.title}}<br>
                  <small>{{arg.event.extendedProps['description']}}</small> </span> </ng-template>
            </full-calendar>
            <br />
            <br />
          </div>
        </div>
      </section>
    </div>
  </div>


  <!-- <div class="carousel-item">
    <img src="..." alt="...">
    <div class="carousel-caption d-none d-md-block">
      <h5>...</h5>
      <p>...</p>
    </div>
  </div> -->

  <div *ngIf="currentUser !=null  && currentUser?.roles.includes('ROLE_ADMIN')" (click)="getAllUsers()">
    <select [(ngModel)]="user" (change)="resetUser(user)">
      <option *ngFor="let user of users" [ngValue]="user">{{user.username}} {{user.companyId}}</option>
    </select>
  </div>
  <div [ngStyle]="{'visibility':displayStyle2, 'opacity':displayStyle3}" class="modal fade" id="editVehicle"
    data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="editVehicleLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content border-radius-8">
        <div class="modal-header p-4">
          <h1 class="modal-title fs-20 fw-600 text-capitalize" id="editVehicleLabel">
            {{ vehicle.year }} {{
            vehicle.make
            }} {{vehicle.model }} <i class="fa-solid fa-square" title="{{vehicle.color}}"
              style="color: {{vehicle.color}}"></i> {{ vehicle.color }}</h1>

          <div class="d-flex justify-content-center">

            <button (click)="editModeVehicle =!editModeVehicle; refresh(); setStep(0)" title="Edit Details"
              class="btn rounded-0 btn-sm btn-secondary-abs">Edit Details</button>
            <button (click)="editModeVehicle = false; openTab('ai-tab')" data-bs-dismiss="modal" aria-label="Close"
              title="AI Estimate Assistants" class="btn rounded-0 btn-sm btn-secondary-abs">&nbsp;&nbsp;AI&nbsp;&nbsp;
            </button>
            <button (click)="editModeVehicle = false; openTab('claims-tab')" data-bs-dismiss="modal" aria-label="Close"
              title="Vehicle Claims" class="btn rounded-0 btn-sm btn-secondary-abs">Estimates
              ({{claims.length}})</button>
            <button (click)="editModeVehicle = false; openTab('purchase-orders-tab')" data-bs-dismiss="modal"
              aria-label="Close" title="Vehicle Purchase Orders" class="btn rounded-0 btn-sm btn-secondary-abs">Purchase
              Orders
              ({{purchaseOrders.length}})</button>
            <button (click)="editModeVehicle = false; openTab('autoparts-tab')" title="Vehicle Parts"
              data-bs-dismiss="modal" aria-label="Close" class="btn rounded-0 btn-sm btn-secondary-abs">Parts
              ({{autopartsSearch.length}})</button>

            <button (click)="editModeVehicle = false; openTab('jobs-tab')" title="Vehicle Job Orders"
              data-bs-dismiss="modal" aria-label="Close" class="btn rounded-0 btn-sm btn-secondary-abs">Jobs Orders
              ({{jobCompletedCount}}/{{jobs.length}})</button>

            <button (click)="editModeVehicle = false; openTab('payments-tab')" data-bs-dismiss="modal"
              aria-label="Close" title="Vehicle Payments" class="btn rounded-0 btn-sm btn-secondary-abs">Payments
              ({{payments.length}})</button>

            <button (click)="editModeVehicle = false; openTab('receipts-tab')" title="Vehicle Invoice Items"
              data-bs-dismiss="modal" aria-label="Close Form"
              class="btn rounded-0 btn-sm btn-secondary-abs">Invoices({{receipts.length}})</button>

            <button (click)="editModeVehicle = false; openTab('histories-tab'); getVehicleHistory(vehicle.id)"
              title="Vehicle Change Histories" data-bs-dismiss="modal" aria-label="Vehicle Histoiers"
              class="btn rounded-0 btn-sm btn-secondary-abs"><i class="fas fa-history fa-2x"></i></button>

            <button (click)="openUrl('vehicle2/'+ vehicle.token)" title="Vehicle Details"
              class="btn rounded-0 btn-sm btn-secondary-abs"><i class="fa fa-print fa-2x"></i></button>


            <button (click)="editModeVehicle = false;toggleDivs()" data-bs-dismiss="modal" aria-label="Close"
              title="Close This Form" class="btn rounded-0 btn-sm btn-secondary-abs"><i
                class="fa fa-window-close fa-2x"></i></button>

          </div>

        </div>
        <div class="modal-body py-4 px-2">
          <div class="row">
            <div class="col-12" id="{{vehicle?.id}}" #target_{{vehicle?.id}}
              *ngIf="vehicle.id> 0  && editModeVehicle==false">
              <div class="table-container2 shadow-sm border-radius-8 border w-100">
                <table class="table-bordered table-striped overflow-hidden border-radius-8 line-height-100 w-100">

                  <tr>
                    <th class="fs-13 w-25 bg-light">Customer</th>
                    <td class="fs-13 w-25" style="word-break: break-word;">{{vehicle.customer.title}}
                      {{vehicle.customer.firstName}}
                      {{vehicle.customer.lastName}} @ {{
                      formatPhoneNumber( vehicle.customer.phone) }}</td>
                    <th class="fs-13 w-25 bg-light">Address</th>
                    <td class="fs-13 w-25" style="word-break: break-word;">{{ vehicle.customer.street
                      }} {{ vehicle.customer.city }} {{ vehicle.customer.state }} {{ vehicle.customer.zip }} </td>
                  </tr>
                  <tr *ngIf="vehicle.description && vehicle.description != ''">
                    <th class="fs-13 w-25 bg-light">Description</th>
                    <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{vehicle.description}}</td>
                  </tr>
                  <tr>
                    <th class="fs-13 w-25 bg-light">Work Request(Repair Order)</th>
                    <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{ vehicle.workRequest }}</td>
                  </tr>
                  <tr>
                    <th class="fs-13 w-25 bg-light">Job Request</th>
                    <td class="fs-13 w-25"><ng-container *ngFor="let jobRequestType of jobRequestTypes; let i=index">
                        <ng-container *ngIf="vehicle.jobRequestType==jobRequestType.id"><strong>
                            {{jobRequestType.name}}</strong></ng-container>
                      </ng-container></td>
                    <th class="fs-13 w-25 bg-light">Claim Number</th>
                    <td class="fs-13 w-25">{{vehicle.claimNumber}}</td>
                  </tr>
                  <tr>
                    <th class="fs-13 w-25 bg-light">Vehicle Status</th>
                    <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                        *ngFor="let option of statuss; let i=index"><strong
                          *ngIf="vehicle.status==option.id">{{option.name}}</strong></ng-container></td>
                    <th class="fs-13 w-25 bg-light">Parking Location</th>
                    <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                        *ngFor="let location of locations; let i=index">
                        <label *ngIf="vehicle.location==location.id">{{location.name}}</label>
                      </ng-container></td>
                  </tr>
                  <tr>
                    <th class="fs-13 w-25 bg-light">Insurance Company</th>
                    <td class="fs-13 w-25" style="word-break: break-word;"><ng-container *ngIf="vehicle.insuranceCompany != null && vehicle.insuranceCompany !='' && 
                      ! vehicle.insuranceCompany.toLowerCase().includes('cash')">
                        <ng-container *ngFor=" let insurance of this.insurancers">
                          <ng-container *ngIf="insurance.name == vehicle.insuranceCompany"> {{
                            vehicle.insuranceCompany.toUpperCase() }} {{insurance.contactFirstName
                            }} {{ insurance.contactLastName}} - {{ insurance.phone }} </ng-container>
                        </ng-container>
                      </ng-container></td>
                    <th class="fs-13 w-25 bg-light">Amount</th>
                    <td class="fs-13 w-25">
                      <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle bg-danger text-white fs-14 fw-semibold"
                          type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                          <span title="Initial Estimates">${{vehicle.price}}</span> <span>-</span>
                          <span title="Supplement">${{getTotalSupplements(vehicle)}}</span>
                          <i class="fa fa-angle-down ms-2"></i>
                        </button>
                        <div class="dropdown-menu bg-light" style="min-width: 400px"
                          aria-labelledby="dropdownMenuButton">
                          <div class="row">
                            <div class="col-6 px-1">
                              <a class="dropdown-item">Items</a>
                              <div class="dropdown-divider"></div>

                              <a class="dropdown-item">Estimates</a>
                              <a class="dropdown-item">Parts ({{autopartsSearch.length}})</a>
                              <a class="dropdown-item fw-700">Est. - Parts</a>
                              <a class="dropdown-item"></a>

                              <a class="dropdown-item">Jobs ({{jobs.length}})</a>
                              <a class="dropdown-item">Management</a>
                              <!-- <a class="dropdown-item">Sales Commission</a> -->
                              <a class="dropdown-item">Tax ({{this.company.taxRate*100}}%)</a>
                              <div class="dropdown-divider"></div>

                              <a class="dropdown-item fw-700">Total Costs</a>
                              <a class="dropdown-item fw-700">Gross</a>

                            </div>
                            <div class="col-6 px-1">
                              <a class="dropdown-item">#</a>
                              <div class="dropdown-divider"></div>

                              <a class="dropdown-item">${{getVehicleTotalEstimates(vehicle)}} (${{vehicle.price}} +
                                ${{getTotalSupplements(vehicle)}})</a>
                              <a class="dropdown-item text-danger">${{getTotalPartCosts(vehicle.id)}}</a>
                              <a class="dropdown-item fw-700">${{getVehicleRemaining(vehicle)}}
                                (${{getVehicleTotalEstimates(vehicle)}}-${{getTotalPartCosts(vehicle.id)}})</a>
                              <a class="dropdown-item"></a>


                              <a class="dropdown-item text-danger">${{getTotalJobPrice(jobs)}}</a>
                              <a class="dropdown-item text-danger">${{getVehicleCostManagement(vehicle)}}
                                ({{this.company.managementRate * 100}}% of
                                ${{getVehicleRemaining(vehicle)}})</a>

                              <a class="dropdown-item">${{getSaleTax(vehicle)}} ({{this.company.taxRate * 100}}% of
                                {{getVehicleTotalEstimates(vehicle)}})</a>
                              <div class="dropdown-divider"></div>

                              <a class="dropdown-item fw-700 text-danger">${{getVehicleTotalCosts(vehicle, jobs)}}</a>
                              <a class="dropdown-item fw-700">${{getVehicleGross(vehicle, jobs)}}</a>


                            </div>
                          </div>

                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <th class="fs-13 w-25 bg-light">Approval Status</th>
                    <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                        *ngFor="let approvalStatus of approvalStatuss; let i=index">
                        <label *ngIf="vehicle.approvalStatus==approvalStatus.id">{{approvalStatus.name}}</label>
                      </ng-container></td>
                    <th class="fs-13 w-25 bg-light">Paid Status</th>
                    <td class="fs-13 w-25"><strong class="badge badge-success" *ngIf="vehicle.paid==true"
                        (click)="changePaidStatus(vehicle, false)">Paid</strong> <strong class="badge badge-danger"
                        *ngIf="vehicle.paid==false" (click)="changePaidStatus(vehicle, true)">Not Paid</strong></td>
                  </tr>
                  <tr *ngIf="vehicle.supplements.length> 0">
                    <th class="fs-13 w-25 bg-light">Supplements <span class="fs-13 fw-700 text-deanger"
                        *ngIf="vehicle.supplements.length> 0">(${{getTotalSupplements(vehicle)}}) </span></th>
                    <td class="fs-13 w-25" colspan="3">
                      <ng-container *ngFor="let supplement of vehicle.supplements; let i=index">
                        <span *ngIf="vehicle.supplements.length> 0">{{i+1}}</span>.<span> {{supplement.name}} <span
                            class="text-danger fw-700"> (${{supplement.price}})</span>:
                          <ng-container *ngIf="supplement.status > 0">
                            <ng-container *ngFor="let approvalStatus of approvalStatuss; let i=index">
                              <span class="text-primary" *ngIf="supplement.status==approvalStatus.id">
                                [{{approvalStatus.name}}]</span>
                            </ng-container>
                          </ng-container>
                          <ng-container *ngIf="supplement.status == 0">
                            <span>[has no status]</span>
                          </ng-container>
                          <br>
                        </span>
                      </ng-container>

                    </td>
                  </tr>
                  <tr>
                    <th class="fs-13 w-25 bg-light">Rental Info</th>
                    <td class="fs-13 w-25" style="word-break: break-word;">{{vehicle.rentalDate | date: 'MM/dd/yyyy'}}
                      <ng-container *ngIf="vehicle.loanerCarName != null && vehicle.loanerCarName !='' "> {{
                        vehicle.loanerCarName }}
                        - <span *ngIf="vehicle.rentalDate != null "
                          [ngClass]="{ 'text-danger fw-bold': vehicle.rentalCountDown < 0, 'text-black fw-bold': vehicle.rentalCountDown >= 0 }">{{vehicle.rentalCountDown}}
                          Days</span> </ng-container>
                    </td>
                    <th class="fs-13 w-25 bg-light">Target Date</th>
                    <td class="fs-13 w-25">{{ vehicle.targetDate |
                      date}} - <span
                        [ngClass]="{ 'text-danger fw-bold': vehicle.targetDateCountDown < 0, 'text-black fw-bold': vehicle.targetDateCountDown >= 0 }">{{vehicle.targetDateCountDown}}
                        Days</span><span> Been: </span><span class="text-danger">{{vehicle.daysInShop}} Days</span>

                    </td>
                  </tr>
                  <tr>
                    <th class="fs-13 w-25 bg-light">WIP (Work In Progress)</th>

                    <td class="fs-13 w-25" title="Click to set VIP"><strong class="badge badge-success"
                        *ngIf="vehicle.special == true" (click)="special(vehicle)">YES</strong> <strong
                        class="badge badge-danger" *ngIf="vehicle.special==false" (click)="special(vehicle)">NO</strong>
                    </td>


                    <th class="fs-13 w-25 bg-light fw-700">VIN</th>
                    <td class="fs-13 w-25 " colspan="1">
                      <div class="d-flex justify-content-between align-items-center">
                        <span>{{ vehicle.vin }}</span>
                        <div *ngIf="vehicle.vin != '' ">
                          <button class="btn btn-sm btn-outline-secondary" type="button" (click)="searchVin2()"> Decode
                          </button>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr *ngIf="vehicle.description2 && vehicle.description2 != ''">
                    <th class="fs-13 w-25 bg-light">VIN Decode Info</th>
                    <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{vehicle.description2}}</td>
                  </tr>

                  <tr *ngIf="vehicle.comments && vehicle.comments != ''">
                    <th class="fs-13 w-25 bg-light">Notes</th>
                    <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{ vehicle.comments }} </td>
                  </tr>

                  <tr *ngIf="vehicle.pdfFiles.length> 0">
                    <th class="fs-13 w-25 bg-light">Documents (in pdf)</th>
                    <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">
                      <div class="badge badge-secondary gap-3  m-1" style="cursor: pointer;"
                        *ngFor="let pdf of this.vehicle.pdfFiles" title="Click to view detail"
                        (click)="getPdf(pdf.token)">
                        <div class="d-flex align-items-start gap-3">
                          <i class="fa-solid fa-file-pdf fa-3x"></i>
                          <div class="user-details">
                            <strong class="fs-14 mb-1 d-block">{{pdf.fileName}} </strong>
                            <small class="fs-13 text-dark- opacity-50">
                              ( {{pdf.createdAt | date: 'KMM/dd/yyyy, HH:mm'}} )
                            </small>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>

                  <tr *ngIf="vehicle.pdfFiles.length > 0 && pdfSrc ">
                    <td class="fs-13 w-75" colspan="4">
                      <div class="mt-4 pt-1 position-relative">
                        <div class="containerImage" *ngIf="vehicle.pdfFiles.length > 0">
                          <embed *ngIf="pdfSrc" [src]="pdfSrc" type="application/pdf" width="100%" height="100%"
                            style="min-height:100vh;width:100%" />
                          <div class="bottom-right py-2">
                            <button *ngIf="pdfSrc" (click)="pdfSrc = null" data-toggle="tooltip" data-placement="top"
                              title="Close this pdf" class="btn btn-outline-primary me-3 mt-3 btn-sm" for="title">
                              Close
                            </button>
                            <button *ngIf="pdfSrc" (click)="deletePdf(currentToken)" data-toggle="tooltip"
                              data-placement="top" title="Remove this pdf"
                              class="btn btn-outline-primary me-3 mt-3 btn-sm" for="title"> <i class="bi-trash"></i>
                            </button>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td class="fs-13 w-75" colspan="4">
                      <div class="row overflow-x-auto overflow-y-hidden">
                        <div cdkDropList (cdkDropListDropped)="droppedVehicleImage($event)"
                          class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-4">
                          <qrcode [qrdata]="url" [width]="150" class="preview img-fluid img-thumbnail"
                            (click)="switchQrCode()" (click)="showDocTypedImageModels = !showDocTypedImageModels"
                            title="Scan it with your phone" [errorCorrectionLevel]="'M'"></qrcode>
                          <div *ngFor='let imageModel of vehicle.imageModels; let i=index'
                            [cdkDragDisabled]="isMobile==true" cdkDrag
                            class="containerImage v-imgs float-start my-2 transition" style="cursor: pointer;">

                            <ng-container *ngFor="let docType of this.docTypes">

                              <ng-container *ngIf="docType.name !='Not Sorted'">
                                <label class="top-left-8 badge" for="title" *ngIf="imageModel.docType == docType.id"
                                  style="color:{{docType.color}}">
                                  {{docType.name}} </label>
                              </ng-container>
                            </ng-container>

                            <img class="preview img-fluid img-thumbnail" width="100%"
                              title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}} Click to enlarge, Change doc type, or Drag and drop to arrange order"
                              *ngIf="vehicle.showInSearchImageId != imageModel.id"
                              src="{{baseUrlResizeImage + '/' + imageModel.id}}" (click)="setImage2(i)"
                              style="border: 3px solid #555;">
                            <img class="preview img-fluid img-thumbnail" width="100%"
                              title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}} Click to enlarge, Change doc type,  or Drag and drop to arrange order"
                              *ngIf="vehicle.showInSearchImageId == imageModel.id"
                              src="{{baseUrlResizeImage + '/' + imageModel.id}}" (click)="setImage2(i)"
                              title="Show in search" style="border: 3px solid lightcoral;">
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr *ngIf="showDocTypedImageModels==true">
                    <td colspan="4">
                      <div class="row pt-3">
                        <div class="col-12">
                          <div class="table-container shadow border-radius-8 border w-100 d-box ss-table" cdkDropList
                            (cdkDropListDropped)="droppedDocType($event)">
                            <table class="table-bordered border-radius-8 w-100"
                              *ngIf="docTypes.length > 0 && this.vehicle.imageModels?.length> 0" cdkDropListGroup>
                              <thead>
                                <tr>

                                  <th class="fs-14 text-center mxw-150" style="width:100px" data-bs-dismiss="modal"
                                    title="Click to navigagte to Document Type Setting"
                                    (click)="navigateTo('doc-types')">
                                    Doc Type</th>

                                  <th class="fs-14 text-center " title="Sorted by vehicle make">Images [ {{
                                    this.vehicle.imageModels?.length }} ] Ordered by created date</th>

                                </tr>
                              </thead>
                              <ng-container *ngFor="let docType of docTypes; let i = index;  let even=even">
                                <tr id="{{docType.id}}" title=""
                                  [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')"
                                  [cdkDragDisabled]="isMobile==true || docType.id==0 " cdkDrag>

                                  <td class="fs-15 text-center " title="Drag and drop to arrange orders">
                                    <strong *ngIf="docType.color != null" [style.color]="docType.color">{{docType.name}}
                                      <br *ngIf="docType.imageModels.length>0">
                                      <span *ngIf="docType.imageModels.length>0">( {{ docType.imageModels!.length}}
                                        )</span></strong>
                                    <strong *ngIf="docType.color == null">{{docType.name}} <br
                                        *ngIf="docType.imageModels.length>0">
                                      <span *ngIf="docType.imageModels.length>0">( {{ docType.imageModels!.length}}
                                        )</span></strong>
                                  </td>

                                  <td *ngIf="docType.imageModels && docType.imageModels!.length == 0" cdkDropList
                                    (cdkDropListDropped)="droppedDocType3($event, docType, docType.id)"></td>
                                  <td *ngIf="docType.imageModels && docType.imageModels!.length >0">
                                    <div class="d-flex flex-wrap gap-1" cdkDropList
                                      (cdkDropListDropped)="droppedDocType3($event, docType,docType.id)">

                                      <div
                                        class="containerImage btn btn-light images-lists gap-2 align-items-center white-space my-1 border p-1 shadow my-2 transition v-imgs"
                                        [style.background-color]="imageModel.id == indexImageModelDrop? '#EEE' : (true ? 'white' : 'white')"
                                        *ngFor=" let imageModel of  docType.imageModels; let i=index"
                                        title="Click to enlarge, or drag and drop to change doc type"
                                        cdkDropListOrientation="horizontal" [cdkDragDisabled]="isMobile==true" cdkDrag
                                        [cdkDragData]="i" (click)="  getDetailImageModel(imageModel,i)">
                                        <label class="top-left" for="title">
                                          {{imageModel.createdAt| date: 'MM/dd/yyyy' }}</label>
                                        <img class="preview img-fluid img-thumbnail" width="150" height="150"
                                          title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                          *ngIf="vehicle.showInSearchImageId != imageModel.id"
                                          src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                          style="border: 3px solid #555;">
                                        <img class="preview img-fluid img-thumbnail" width="150" height="150"
                                          title="{{imageModel.createdAt| date:   'MM/dd/yyyy, HH:mm'}}"
                                          *ngIf="vehicle.showInSearchImageId == imageModel.id"
                                          src="{{baseUrlResizeImage + '/' + imageModel.id}}" title="Show in search"
                                          style="border: 3px solid lightcoral;">

                                      </div>

                                    </div>

                                  </td>
                                </tr>

                              </ng-container>
                            </table>
                          </div>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <tr *ngIf="selectedImage2 > 0 ">
                    <td colspan="4">

                      <div class="mt-4 pt-1 position-relative w-100 h-100" *ngIf="selectedImage2 > 0 ">
                        <div class="containerImage" *ngIf="vehicle.imageModels.length > 0">
                          <img
                            *ngIf="selectedImage2 != null && selectedImage2!=0 &&  vehicle.showInSearchImageId != selectedImage2"
                            class="image w-100 img-fluid img-thumbnail" src="{{baseUrlImage + '/' + selectedImage2}}"
                            alt="Image" />
                          <img
                            *ngIf="selectedImage2 != null  && selectedImage2!=0 &&  vehicle.showInSearchImageId == selectedImage2"
                            class="image w-100 img-fluid img-thumbnail" src="{{baseUrlImage + '/' + selectedImage2}}"
                            alt="Image" />
                          <label *ngIf="selectedImage2 == vehicle.showInSearchImageId" class="top-left" for="title">
                            Will Show this in listing</label>

                          <label *ngIf="selectedImage2 != vehicle.showInSearchImageId" class="top-left" for="title">
                            Created At: {{imageModelSelected.createdAt | date: 'MM/dd/yyyy, HH:mm'}}</label>

                          <div class="top-right" *ngIf="selectedImage2 != null && selectedImage2 !=0">

                            <select class="btn btn-success fw-700 me-3 mt-3 btn-sm"
                              [(ngModel)]="imageModelSelected.docType" title="Type"
                              style="color: {{getDocTypeColor(imageModelSelected.docType)}}" placeholder="Doc Type"
                              #docType (change)="onChangeDocType($event)">
                              <option *ngFor="let docType of docTypes let i=index" value="{{docType.id}}"
                                class="bg-white fw-700" style="color:{{docType.color}}">
                                {{docType.name}} </option>
                            </select>

                            <button title="Close Image" (click)="selectedImage2 =0"
                              class="btn btn-primary me-3 mt-3 btn-sm" for="title">Close</button>
                            <button *ngIf="selectedImage2 != vehicle.showInSearchImageId"
                              title="As index image during search"
                              (click)="setImageForSearch2(vehicle.id, selectedImage2)"
                              class="btn btn-primary me-3 mt-3 btn-sm" for="title">Set for Index</button>
                            <button (click)="deleteImage2(vehicle.id, selectedImage2)" data-toggle="tooltip"
                              data-placement="top" title="Remove this image" class="btn btn-outline-danger mt-3 btn-sm"
                              for="title"> <i class="bi-trash"></i>
                            </button>
                          </div>


                        </div>
                      </div>
                    </td>
                  </tr>
                </table>
              </div>
              <div class="d-flex align-items-center gap-3 mt-5">
                <a *ngIf="vehicle.archived==false && vehicle.paid==true && 
                  user.allowAddAndUpdateVehicle == true && 
                            this.user.allowArchiveVehicle==true" (click)="archiveVehicle(vehicle)" href="javascript:;"
                  class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Archive
                  This Vehicle</a>

                <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                  (click)="printPage('print-content-vehicle','vehicle');" href="javascript:;"
                  class="btn btn-outline-dark h-45 px-4 rounded-2 fs-14 fw-600">Print</a>

                <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0" (click)="openVehicleUrl(vehicle.token)"
                  href="javascript:;" class="btn btn-outline-dark h-45 px-4 rounded-2 fs-14 fw-600">Print QR Code</a>

                <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0" title="WIP or Un-WIP"
                  (click)="special(vehicle); " href="javascript:;"
                  class="btn btn-outline-danger h-45 px-4 rounded-2 fs-14 fw-600">WIP</a>

                <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0 && vehicle.imageModels.length > 0"
                  title="Sort Images to different types" (click)="showDocTypedImageModels = !showDocTypedImageModels"
                  href="javascript:;" class="btn btn-outline-success h-45 px-4 rounded-2 fs-14 fw-600">Sort Images</a>

                <button name="btn" *ngIf="user.allowAddAndUpdateVehicle == true "
                  class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600" title="Upload pdf"
                  (click)="fileInputPdf.click()"><i class="fa fa-cloud-upload me-2"></i> Upload
                  PDF</button>
                <input type='file' accept="application/pdf"
                  class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute" #fileInputPdf
                  (change)="onSelectFileEditorPdf($event)" multiple (click)="fileInput.value = ''" />


                <button name="btn" *ngIf="user.allowAddAndUpdateVehicle == true"
                  class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600" (click)="fileInput.click()"><i
                    class="fa fa-cloud-upload me-2"></i> Upload
                  Images</button>

                <input type='file' accept="image/jpg, image/jpeg"
                  class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute" #fileInput
                  (change)="onSelectFileEditor($event)" multiple (click)="fileInput.value = ''" />

                <a *ngIf="vehicle.archived==false && user.allowAddAndUpdateVehicle == true"
                  (click)="editModeVehicle =!editModeVehicle; refresh(); setStep(0)" href="javascript:;"
                  class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Edit
                  Details</a> <a *ngIf="vehicle.archived==true" (click)="unArchive(vehicle)" href="javascript:;"
                  class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Un-Archive
                  This Vehicle</a>




              </div>

            </div>
            <div class="col-12 px-0">
              <div class="vehicle-form"
                *ngIf="vehicle.id> 0 && editModeVehicle==true && user.allowAddAndUpdateVehicle == true">
                <div class="row">
                  <div class="col-12">
                    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist" *ngIf="currentUser">
                      <li class="nav-item me-3" role="presentation">
                        <button (click)="setStep(3)"
                          class="nav-link active py-3 px-4 rounded-pill fs-13 text-uppercase shadow" id="info-tab"
                          data-bs-toggle="pill" data-bs-target="#info-tabs" type="button" role="tab"
                          aria-controls="info-tabs" aria-selected="true"><i class="fa fa-circle me-2"></i>
                          Information</button>
                      </li>
                      <li class="nav-item me-3" role="presentation">
                        <button (click)="setStep(4)" class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                          id="requests-tab" data-bs-toggle="pill" data-bs-target="#requests-tabs" type="button"
                          role="tab" aria-controls="requests-tabs" aria-selected="false"><i
                            class="fa fa-circle me-2"></i>Job
                          Order/Request</button>
                      </li>
                      <li class="nav-item me-3" role="presentation">
                        <button (click)="setStep(1)" class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                          id="prior-damage" data-bs-toggle="pill" data-bs-target="#prior-damages" type="button"
                          role="tab" aria-controls="prior-damages" aria-selected="false"><i
                            class="fa fa-circle me-2"></i> Prior
                          Damage</button>
                      </li>
                      <li class="nav-item me-3" role="presentation">
                        <button (click)="setStep(1)" class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                          id="image-modal" data-bs-toggle="pill" data-bs-target="#image-modals" type="button" role="tab"
                          aria-controls="image-modals" aria-selected="false"><i class="fa fa-circle me-2"></i> Images
                          [{{this.vehicle.imageModels.length}}]</button>
                      </li>
                      <li class="nav-item me-3" role="presentation">
                        <button (click)="setStep(1)" class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase shadow"
                          id="pdf-modal" data-bs-toggle="pill" data-bs-target="#pdf-modals" type="button" role="tab"
                          aria-controls="pdf-modals" aria-selected="false"><i class="fa fa-circle me-2"></i> Documents
                          [{{this.vehicle.pdfFiles.length}}]</button>
                      </li>
                    </ul>
                  </div>
                </div>
                <div class="tab-content" id="pills-tabContent">
                  <div #taggroup class="tab-pane fade show active" id="info-tabs" role="tabpanel"
                    aria-labelledby="info-tab" tabindex="0">
                    <div class="row pt-1">
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="year" class="form-label fs-14 fw-400 mb-3">Year</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.year"
                            placeholder="Year">
                            <option value="undefined" disabled selected>Select Year</option>
                            <option [value]="option" *ngFor="let option of optionsYear;let i=index;">{{option}}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="makeake" class="form-label fs-14 fw-400 mb-3">Make</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.make" #device
                            (change)="onChange($event, device.value)" placeholder="Make">
                            <option value="undefined" disabled selected>Select Make</option>
                            <option [value]="option" *ngFor="let option of optionsMake;let i=index;">{{option}}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="model" class="form-label fs-14 fw-400 mb-3">Model</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.model"
                            placeholder="Model">
                            <option value="undefined" disabled selected>Select Model</option>
                            <option [value]="option" *ngFor="let option of optionsModel;let i=index;">{{option}}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="color" class="form-label fs-14 fw-400 mb-3">Color</label>
                          <select class="form-select h-48 px-3 border-radius-8 text-capitalize text-shadow text-white"
                            style="background-color: {{vehicle.color}}" [(ngModel)]="vehicle.color" placeholder="Color">
                            <option value="undefined" disabled selected>Select Color</option>
                            <option style="background-color: {{color}}" *ngFor="let color of optionsColor;let i=index;">
                              {{color}}</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="miles" class="form-label fs-14 fw-400 mb-3">Miles</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                            placeholder="Enter Miles" maxlength="20" [(ngModel)]="vehicle.miles" />
                        </div>
                      </div>
                      <div class="col-md-12">
                        <div class="mt-4 pt-1">
                          <label for="Description" class="form-label fs-14 fw-400 mb-3">Description</label>
                          <textarea trimText style="line-height: 2;" class="form-control h-48 px-3 border-radius-8"
                            type="text" rows="2" placeholder="Enter Description" maxlength="255"
                            [(ngModel)]="vehicle.description"></textarea>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="plate" class="form-label fs-14 fw-400 mb-3">Plate</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                            placeholder="Enter Plate" maxlength="50" [(ngModel)]="vehicle.plate" />
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="vin" class="form-label fs-14 fw-400 mb-3">VIN</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                            placeholder="Enter VIN" maxlength="17" [(ngModel)]="vehicle.vin" />
                        </div>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="mt-4 pt-1">
                        <label for="notesComment" class="form-label fs-14 fw-400 mb-3">Notes / Comments</label>
                        <textarea trimText class="form-control h-48 px-3 border-radius-8" type="text" maxlength="2000"
                          rows="4" style="line-height: 2;" placeholder="Enter Notes / Comments"
                          [(ngModel)]="vehicle.comments"></textarea>
                      </div>
                    </div>
                  </div>
                  <div #taggroup class="tab-pane fade" id="requests-tabs" role="tabpanel" aria-labelledby="requests-tab"
                    tabindex="0">
                    <div class="row pt-1">
                      <div class="col-md-12">
                        <div class="mt-4 pt-1">
                          <label for="workRequest" class="form-label fs-14 fw-400 mb-3">Work Requests</label>
                          <textarea class="form-control px-3 border-radius-8 pt-3" rows="4"
                            placeHolder="Enter Work Request" maxlength="255"
                            [(ngModel)]="vehicle.workRequest"></textarea>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="jobRequestType" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/job-request-type'"
                            class="form-label fs-14 fw-400 mb-3">Job Request Type</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.jobRequestType"
                            placeholder="Job Request Type">
                            <option value="undefined" disabled selected>Select Job Request Type</option>
                            <option [value]="jobRequestType.id"
                              *ngFor="let jobRequestType of jobRequestTypes;let i=index;">{{jobRequestType.name}}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="claimNumber" class="form-label fs-14 fw-400 mb-3">Claim Number</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                            placeholder="Enter Claim Number" maxlength="200" [(ngModel)]="vehicle.claimNumber" />
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="price" class="form-label fs-14 fw-400 mb-3">Price</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="number"
                            placeholder="Enter Price" maxlength="10" onKeyPress="if(this.value.length==10) return false"
                            [(ngModel)]="vehicle.price" pattern="[0-9]" />
                        </div>
                      </div>

                      <div class="col-md-12">
                        <div class="mt-4 pt-1">
                          <label for="Supplements" class="form-label fs-14 fw-400 mb-3">Supplements
                            <span class="fs-14 fw-700 text-deanger"
                              *ngIf="vehicle.supplements.length> 0">${{getTotalSupplements(vehicle)}} </span>
                            <button (click)="createSupplyment(vehicle)" title="Add Supplement"
                              class="btn rounded-0 btn-sm btn-secondary-abs"><i class="fa fa-plus fa-1x"></i>Add
                              Supplement</button>
                          </label>
                          <div class="table-container shadow border-radius-8 border w-100">
                            <table class="table-bordered overflow-hidden border-radius-8 w-100"
                              *ngIf="vehicle.supplements.length >0">
                              <thead>
                                <tr>
                                  <th class="fs-14 text-center mw-50" style="width: 50px;"> #</th>
                                  <th class="fs-14 text-center w-auto" style="min-width: 50px; max-width:150px">
                                    Description</th>
                                  <!-- <th class="fs-14 text-center mw-100 w-auto"> Description</th> -->
                                  <th class="fs-14 text-center  mw-100" style="width: 100px;"> Price $</th>
                                  <th class="fs-14 text-center mw-100 w-auto"
                                    title="Approval Status, click to configure" (click)="navigateTo('approval-status')">
                                    Approval Status</th>
                                  <th class="fs-14 text-center mw-100 w-auto"> Updated <i class="fa-solid fa-clock"></i>
                                  </th>
                                  <th class="fs-14 text-center mw-100 w-auto"> Created <i class="fa-solid fa-clock"></i>
                                  </th>
                                  <th class="fs-14 text-center mw-100 w-auto"> Action</th>
                                </tr>
                                <tr *ngFor='let supplement of vehicle.supplements; let i=index'>
                                  <td class="text-center fs-13">{{i+1}}</td>
                                  <td class="text-center fs-13">
                                    <input trimText [ngClass]="{'blink': supplement.name=='Change Me' }"
                                      class="form-control h-48 px-3 border-radius-8" type="text"
                                      (key.enter)=" saveSupplyment(vehicle, supplement, 'name')"
                                      placeholder="Enter Name" maxlength="200" [(ngModel)]="supplement.name" />
                                  </td>

                                  <td class="text-center fs-13">
                                    <input trimText class="form-control h-48 px-3 border-radius-8" type="number"
                                      onKeyPress="if(this.value.length==10) return false" placeholder="Enter Price"
                                      (key.enter)=" saveSupplyment(vehicle, supplement, 'price')" maxlength="20"
                                      [(ngModel)]="supplement.price" />
                                  </td>

                                  <td class="text-center fs-13">
                                    <select class="form-select h-48 px-3 border-radius-8"
                                      (change)="saveSupplyment(vehicle, supplement, 'approval status')" #approvalStatus
                                      [(ngModel)]="supplement.status" placeholder="Approval Status">
                                      <option value="0" disabled selected>Select Approval Status</option>
                                      <option [value]="approvalStatus.id"
                                        *ngFor="let approvalStatus of approvalStatuss;let i=index;">
                                        {{approvalStatus.name}}
                                      </option>
                                    </select>
                                  </td>

                                  <td class="text-center fs-13">
                                    <input trimText class="form-control h-48 px-3 border-radius-8" type="date"
                                      placeholder="Supplement Date"
                                      (change)="onChangeSupplementDate($event, vehicle, supplement)"
                                      [ngModel]="supplement.updatedAt |  date:'yyyy-MM-dd'" />

                                  </td>
                                  <td class="text-center fs-13">
                                    {{ supplement.createdAt| date: 'MM/dd/yyyy'}}
                                  </td>
                                  <td class="text-center fs-13">
                                    <div class="d-flex gap-2">
                                      <button title="Remove this supplement" (click)="deleteSupplyment(supplement.id)"
                                        class="btn btn-outline-danger btn-sm" for="title"> <i class="bi-trash"></i>
                                      </button>
                                      <button title="Save this supplement"
                                        (click)="saveSupplyment(vehicle, supplement, 'update')"
                                        class="btn btn-outline-success btn-sm" for="title"> <i class="bi-save"></i>
                                      </button>
                                    </div>

                                  </td>
                                </tr>
                              </thead>
                            </table>
                          </div>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="arrivalMode" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/arrival-mode'"
                            class="form-label fs-14 fw-400 mb-3">Arrival Mode</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.inTakeWay"
                            placeholder="Arrival Mode">
                            <option value="0" disabled selected>Select Arrival Mode</option>
                            <option [value]="inTakeWay.id" *ngFor="let inTakeWay of inTakeWays;let i=index;">
                              {{inTakeWay.name}}</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="paymentMethod" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/payment-method'"
                            class="form-label fs-14 fw-400 mb-3">Payment Method</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.paymentMethod"
                            placeholder="Payment Method">
                            <option value="0" disabled selected>Select Payment Method</option>
                            <option [value]="paymentMethod.id"
                              *ngFor="let paymentMethod of paymentMethods;let i=index;">
                              {{paymentMethod.name}}</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="insuranceCompany" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/insurance-companies'"
                            class="form-label fs-14 fw-400 mb-3">Insurance
                            Company</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.insuranceCompany"
                            placeholder="Payment Method">
                            <option value="undefined" disabled selected>Select Insurance Company</option>
                            <option [value]="insurancer.name" *ngFor="let insurancer of insurancers;let i=index;">
                              {{insurancer.name}}</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="approvalStatus" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/approval-status'"
                            class="form-label fs-14 fw-400 mb-3">Approval Status</label>
                          <select class="form-select h-48 px-3 border-radius-8"
                            (change)="onChangeApprovalStatus($event, approvalStatus.value)" #approvalStatus
                            [(ngModel)]="vehicle.approvalStatus" placeholder="Approval Status">
                            <option value="0" disabled selected>Select Approval Status</option>
                            <option [value]="approvalStatus.id"
                              *ngFor="let approvalStatus of approvalStatuss;let i=index;">{{approvalStatus.name}}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="Parking" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/parking-location'"
                            class="form-label fs-14 fw-400 mb-3">Parking</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.location"
                            placeholder="Parking">
                            <option value="0" disabled selected>Select Parking</option>
                            <option [value]="location.id" *ngFor="let location of locations;let i=index;">
                              {{location.name}}</option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="rentalCompany" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/rental-companies'"
                            class="form-label fs-14 fw-400 mb-3">Rental Company</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.loanerCarName"
                            placeholder="Rental Company">
                            <option value="0" disabled selected>Select Rental Company</option>
                            <option [value]="rental.name" *ngFor="let rental of rentals;let i=index;">{{rental.name}}
                            </option>
                          </select>
                        </div>
                      </div>
                      <div class="col-md-4" *ngIf="vehicle.loanerCarName !=  null && vehicle.loanerCarName !=''">
                        <div class="mt-4 pt-1">
                          <label for="rentalDueDate" class="form-label fs-14 fw-400 mb-3">Rental Due Date</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="date"
                            placeholder="Rental Due Date" (change)="onChangeVehicleCalendarRental($event, vehicle)"
                            [ngModel]="vehicle.rentalDate |  date:'yyyy-MM-dd'" />
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="targetDate" class="form-label fs-14 fw-400 mb-3">Target Date</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="date"
                            placeholder="Target Date" [disabled]="user.allowChangeJobTargetDate == false"
                            (change)="onChangeVehicleCalendar($event, vehicle)"
                            [ngModel]="vehicle.targetDate |  date:'yyyy-MM-dd'" />
                        </div>
                      </div>
                      <div class="col-md-4"
                        *ngIf="vehicle.targetDateChangeReason != null && vehicle.targetDateChangeReason != '' ">
                        <div class="mt-4 pt-1">
                          <label for="reasonChnageDate" class="form-label fs-14 fw-400 mb-3">Reason for Target Date
                            Change</label>
                          <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                            placeholder="Reason for Target Date Change" disabled
                            [(ngModel)]="vehicle.targetDateChangeReason" />
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="mt-4 pt-1">
                          <label for="status" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                            title="Click to go to Configuration" [routerLink]="'/job-status'"
                            class="form-label fs-14 fw-400 mb-3">Status</label>
                          <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.status"
                            placeholder="status" #status [disabled]="user.allowUpdateVehicleStatus == false"
                            (change)="onChangeStatus($event, status.value)" placeholder="Status">
                            <option value="0" disabled selected>Select Status</option>
                            <option *ngFor="let option of statuss; let i=index" value="{{option.id}}">{{option.name}}
                            </option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div #taggroup class="tab-pane fade" id="prior-damages" role="tabpanel" aria-labelledby="prior-damage"
                    tabindex="0">
                    <div class="row pt-1">
                      <div class="col-md-12">
                        <div class="mt-4 pt-1">
                          <label for="priorDamages" class="form-label fs-14 fw-400 mb-3">Prior Damages
                            {{getPriorDamageWordCount()}} <small>Words (500 Max)</small></label>
                          <textarea class="form-control px-3 border-radius-8 pt-3" rows="4"
                            placeHolder="Enter Prior Damages" maxlength="500" [(ngModel)]="vehicle.priorDamage"
                            (keyup.enter)="onSavePriorDamage(vehicle)"></textarea>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div #taggroup class="tab-pane fade" id="image-modals" role="tabpanel" aria-labelledby="image-modals"
                    tabindex="0">

                    <div class="row pt-1">
                      <div class="col-md-12">
                        <div class="mt-4 pt-1">
                          <div class="row">
                            <div class="col-md-5 "> <strong class="fs-5 h-48">Please Upload Images:</strong> </div>
                            <div class="col-md-7 px-0">
                              <div class="position-relative">
                                <button name="btn" class="btn btn-secondary-abs py-3 px-0 w-100"
                                  (click)="fileInput.click()"><i class="fa fa-cloud-upload me-2"></i> Upload
                                  Images</button>
                                <input type='file' accept="image/jpg, image/jpeg"
                                  class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute"
                                  #fileInput (change)="onSelectFileEditor($event)" multiple
                                  (click)="fileInput.value = ''" />
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="row pt-3">
                      <div class="col-12">
                        <div class="table-container shadow border-radius-8 border w-100 d-box ss-table" cdkDropList
                          (cdkDropListDropped)="droppedDocType($event)">
                          <table class="table-bordered border-radius-8 w-100"
                            *ngIf="docTypes.length > 0 && this.vehicle.imageModels?.length> 0" cdkDropListGroup>
                            <thead>
                              <tr>

                                <th class="fs-14 text-center mxw-150" style="width:100px" data-bs-dismiss="modal"
                                  title="Click to navigagte to Document Type Setting" (click)="navigateTo('doc-types')">
                                  Doc Type</th>

                                <th class="fs-14 text-center " title="Sorted by vehicle make">Images [ {{
                                  this.vehicle.imageModels?.length }} ] Ordered by created date</th>

                              </tr>
                            </thead>
                            <ng-container *ngFor="let docType of docTypes; let i = index;  let even=even">
                              <tr id="{{docType.id}}" title=""
                                [style.background-color]="i == cindex? '#eef5fb' : (even ? 'white' : 'white')"
                                [cdkDragDisabled]="isMobile==true || docType.id==0 " cdkDrag>

                                <td class="fs-15 text-center " title="Drag and drop to arrange orders">
                                  <strong *ngIf="docType.color != null" [style.color]="docType.color">{{docType.name}}
                                    <br *ngIf="docType.imageModels.length>0">
                                    <span *ngIf="docType.imageModels.length>0">( {{ docType.imageModels!.length}}
                                      )</span></strong>
                                  <strong *ngIf="docType.color == null">{{docType.name}} <br
                                      *ngIf="docType.imageModels.length>0">
                                    <span *ngIf="docType.imageModels.length>0">( {{ docType.imageModels!.length}}
                                      )</span></strong>
                                </td>

                                <td *ngIf="docType.imageModels && docType.imageModels!.length == 0" cdkDropList
                                  (cdkDropListDropped)="droppedDocType3($event, docType, docType.id)"></td>
                                <td *ngIf="docType.imageModels && docType.imageModels!.length >0">
                                  <div class="d-flex flex-wrap gap-1" cdkDropList
                                    (cdkDropListDropped)="droppedDocType3($event, docType,docType.id)">

                                    <div
                                      class="containerImage btn btn-light images-lists gap-2 align-items-center white-space my-1 border p-1 shadow my-2 transition v-imgs"
                                      [style.background-color]="imageModel.id == indexImageModelDrop? '#EEE' : (true ? 'white' : 'white')"
                                      *ngFor=" let imageModel of  docType.imageModels; let i=index"
                                      title="Click to enlarge, or drag and drop to change doc type"
                                      cdkDropListOrientation="horizontal" [cdkDragDisabled]="isMobile==true" cdkDrag
                                      [cdkDragData]="i" (click)=" getDetailImageModel(imageModel,i)">
                                      <label class="top-left" for="title">
                                        {{imageModel.createdAt| date: 'MM/dd/yyyy' }}</label>
                                      <img class="preview img-fluid img-thumbnail" width="150" height="150"
                                        title="{{imageModel.createdAt| date:  'MM/dd/yyyy, HH:mm'}}"
                                        *ngIf="vehicle.showInSearchImageId != imageModel.id"
                                        src="{{baseUrlResizeImage + '/' + imageModel.id}}"
                                        style="border: 3px solid #555;">
                                      <img class="preview img-fluid img-thumbnail" width="150" height="150"
                                        title="{{imageModel.createdAt| date: 'MM/dd/yyyy, HH:mm'}}"
                                        *ngIf="vehicle.showInSearchImageId == imageModel.id"
                                        src="{{baseUrlResizeImage + '/' + imageModel.id}}" title="Show in search"
                                        style="border: 3px solid lightcoral;">

                                    </div>

                                  </div>

                                </td>
                              </tr>

                            </ng-container>
                          </table>
                        </div>
                      </div>
                    </div>
                    <div class="row pt-1">
                      <div class="col-md-12">
                        <div class="mt-4 pt-1">
                          <div class="row">

                            <div class="col-md-12 px-0" *ngIf="selectedImage > 0">
                              <div class=" mt-4 pt-1 position-relative" *ngIf="selectedImage > 0 ">
                                <div class="containerImage" *ngIf="vehicle.imageModels.length > 0 && selectedImage > 0">
                                  <img
                                    *ngIf="selectedImage != null && selectedImage > 0 &&  vehicle.showInSearchImageId != selectedImage"
                                    class="image w-100 img-fluid img-thumbnail"
                                    src="{{baseUrlImage + '/' + selectedImage}}" alt="Image" />
                                  <img
                                    *ngIf="selectedImage != null && selectedImage > 0 && vehicle.showInSearchImageId == selectedImage"
                                    class="image w-100 img-fluid img-thumbnail"
                                    src="{{baseUrlImage + '/' + selectedImage}}" alt="Image" />
                                  <label *ngIf="selectedImage == vehicle.showInSearchImageId" class="top-left"
                                    for="title">
                                    Will Show this in listing</label>
                                  <div class="top-right py-1" *ngIf="selectedImage > 0">

                                    <select class="btn btn-outline-success fw-700 me-3 mt-3 btn-sm"
                                      [(ngModel)]="imageModelDrop.docType" title="Type"
                                      style="color: {{getDocTypeColor(imageModelDrop.docType)}}" placeholder="Doc Type"
                                      #docType (change)="onChangeDocTypeDropped($event)">
                                      <option *ngFor="let docType of docTypes let i=index" value="{{docType.id}}"
                                        class="bg-white fw-700" style="color:{{docType.color}}">
                                        {{docType.name}} </option>
                                    </select>

                                    <button title="Close" (click)="selectedImage = 0"
                                      class="btn btn-outline-primary me-3 mt-3 btn-sm" for="title">Close</button>
                                    <button *ngIf="selectedImage > 0 && selectedImage != vehicle.showInSearchImageId"
                                      title="As index image during search"
                                      (click)="setImageForSearch(vehicle.id, selectedImage)"
                                      class="btn btn-outline-primary me-3 mt-3 btn-sm" for="title">Set for
                                      Index</button>
                                    <button *ngIf="selectedImage > 0" (click)="deleteImage(vehicle.id, selectedImage)"
                                      data-toggle="tooltip" data-placement="top" title="Remove this image"
                                      class="btn btn-outline-danger mt-3 btn-sm" for="title"> <i class="bi-trash"></i>
                                    </button>
                                  </div>

                                </div>
                              </div>

                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div #taggroup class="tab-pane fade" id="pdf-modals" role="tabpanel" aria-labelledby="pdf-modals"
                    tabindex="0">
                    <div class="row pt-1">
                      <div class="col-md-12">
                        <div class="mt-4 pt-1">

                          <div class="row">
                            <div class="col-md-5 mt-4 pt-4"> <strong class="fs-5">Please Upload The PDF
                                File:</strong>
                            </div>
                            <div class="col-md-7">
                              <div class="mt-4 pt-1 position-relative">
                                <button name="btn" class="btn btn-secondary-abs py-3 px-3 w-100"
                                  (click)="fileInputPdf.click()"><i class="fa fa-cloud-upload me-2"></i> Upload
                                  PDF</button>
                                <input type='file' accept="application/pdf"
                                  class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute"
                                  #fileInputPdf (change)="onSelectFileEditorPdf($event)" multiple
                                  (click)="fileInput.value = ''" />
                              </div>
                            </div>
                            <div class="col-md-12">
                              <div class="mt-2 pt-4 position-relative">
                                <div class="table-container shadow border-radius-8 border w-100">
                                  <table class="table-bordered overflow-hidden border-radius-8 w-100"
                                    *ngIf="vehicle.pdfFiles.length >0">
                                    <thead>
                                      <tr>
                                        <th class="fs-14 text-center mw-100 w-auto"> #</th>
                                        <th class="fs-14 text-center mw-100 w-auto"> File Name</th>
                                        <th class="fs-14 text-center mw-100 w-auto"> Created <i
                                            class="fa-solid fa-clock"></i></th>
                                        <th class="fs-14 text-center mw-100 w-auto"> Action</th>
                                      </tr>
                                      <tr *ngFor='let pdfFile of vehicle.pdfFiles; let i=index'>
                                        <td class="text-center fs-13" (click)="getPdf(pdfFile.token)">{{i+1}}</td>
                                        <td class="text-center fs-13" (click)="getPdf(pdfFile.token)">
                                          {{pdfFile.fileName}}</td>
                                        <td class="text-center fs-13" (click)="getPdf(pdfFile.token)"> {{
                                          pdfFile.createdAt | date: 'MM/dd/yyyy'}}</td>
                                        <td class="text-center fs-13"><button (click)="deletePdf(pdfFile.token)"
                                            title="Remove this pdf" class="btn btn-outline-danger btn-sm" for="title">
                                            <i class="bi-trash"></i> </button></td>
                                      </tr>
                                    </thead>
                                  </table>
                                </div>
                              </div>
                              <div class="mt-4 pt-1 position-relative">
                                <div class="containerImage" *ngIf="vehicle.pdfFiles.length > 0">
                                  <embed *ngIf="pdfSrc" [src]="pdfSrc" type="application/pdf" width="100%"
                                    height="600px" />
                                  <div class="bottom-right py-2">
                                    <button *ngIf="pdfSrc" (click)="deletePdf(currentToken)" data-toggle="tooltip"
                                      data-placement="top" title="Remove this pdf"
                                      class="btn btn-outline-danger mt-3 btn-sm" for="title"> <i class="bi-trash"></i>
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="d-flex align-items-center gap-3 mt-5 px-3" (click)="editModeVehicle=!editModeVehicle">
                  <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                    (click)="createVehicle(vehicle); editModeVehicle=!editModeVehicle;" href="javascript:;"
                    class="btn btn-outline-primary h-45 px-4 rounded-2 fs-14 fw-600">Save Details</a> <a
                    *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                    (click)="printPage('print-content-vehicle','vehicle'); editModeVehicle=!editModeVehicle;"
                    href="javascript:;" class="btn btn-outline-dark h-45 px-4 rounded-2 fs-14 fw-600">Print
                    Here</a> <a *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                    (click)="special(vehicle); editModeVehicle=!editModeVehicle;" href="javascript:;"
                    class="btn btn-outline-danger h-45 px-4 rounded-2 fs-14 fw-600">VIP</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal" tabindex="0" role="dialog" [ngStyle]="{'display':displayStyleTargetReason}" style="z-index: 9999">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header" style="background-color: lightgrey">
          <h4 class="modal-title">{{ this.vehicle.year}} {{
            this.vehicle.make}} {{ this.vehicle.model}}</h4>
        </div>
        <div class="modal-body">
          <div class="form-group nopadding">
            <label>Reason for Changing Target Date to {{ this.vehicle.targetDate |
              date}}</label>
            <div class="input-group">
              <input type="text" name="reason" class="form-control" placeholder="Reason for Rejection" required
                [(ngModel)]="vehicle.targetDateChangeReason" #reason="ngModel" maxlength="200"
                [ngClass]="{ 'is-invalid': reason.errors }" />
            </div>
          </div>
          <div class="form-group nopadding">
            <label> </label>
          </div>
          <div class="alert alert-danger" *ngIf="messageTargetDateReason !=''"> {{ messageTargetDateReason}} </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" (click)="closePopupYesTargetDateReason()"> Comfirm
          </button>
          <button type="button" class="btn btn-secondary" (click)="closePopupTargetDateReason()"> Cancel </button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal" tabindex="-1" role="dialog" [ngStyle]="{'display':displayStyle}">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h4 class="modal-title fw-bold fs-4">Confirmation!</h4>
        </div>
        <div class="modal-body">
          <p>Are you sure to archive this vehicle?</p>
          <button type="button" class="btn btn-outline-success px-4 mt-4 me-3" (click)="closePopupYes()">Yes</button>
          <button type="button" class="btn btn-outline-danger px-4 mt-4" (click)="closePopup()">No</button>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="myAccount" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="myAccountLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content border-radius-8">
        <div class="modal-header p-4">
          <h1 class="modal-title fs-20 fw-600 text-capitalize" id="myAccountLabel">My Account</h1>
          <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body px-2" *ngIf="currentUser">
          <form *ngIf="!isSuccessful" name="form" (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" novalidate>
            <div class="row">
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="title" class="form-label fs-14 fw-400 mb-3">Account Type</label>
                  <select class="form-select h-48 px-3 border-radius-8" name="role" #type="ngModel" size="1" style=" appearance: none;
              background-image: url('');" [(ngModel)]="form.role" required disabled
                    [ngClass]="{ 'is-invalid': f.submitted && type.errors }">
                    <option value="ROLE_USER" selected>Employee</option>
                    <option value="ROLE_SHOP">Auto Shop</option>
                    <option value="ROLE_ADMIN">Admin</option>
                  </select>
                </div>
              </div>
              <div class="col-md-4" *ngIf="form.role == 'ROLE_SHOP' || form.role == 'ROLE_RECYCLER' ">
                <div class="mt-4 pt-1">
                  <label for="bussnessName" class="form-label fs-14 fw-400 mb-3">Business/Company Name</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" name="bussinessname"
                    [(ngModel)]="form.bussinessname" required minlength="5" maxlength="200" #bussinessname="ngModel"
                    placeHolder="Enter Business/Company Name"
                    [ngClass]="{ 'is-invalid': f.submitted && bussinessname.errors }" />
                  <div class="invalid-feedback" *ngIf="bussinessname.errors && f.submitted"> <span
                      *ngIf="bussinessname.errors['required']">Business Name is required</span> <span
                      *ngIf="bussinessname.errors['minlength']">Business Name must be at least 5 characters</span>
                    <span *ngIf="bussinessname.errors['maxlength']">Business Name must be at most 200
                      characters</span>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="firstName" class="form-label fs-14 fw-400 mb-3">First Name</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" type="text" name="firstName"
                    [(ngModel)]="form.firstName" required minlength="2" maxlength="20" #firstName="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && firstName.errors }" placeholder="Enter Your First Name" />
                  <div class="invalid-feedback" *ngIf="firstName.errors && f.submitted"> <span
                      *ngIf="firstName.errors['required']">First Name is required</span> <span
                      *ngIf="firstName.errors['minlength']">First Name must be at least 2 characters</span> <span
                      *ngIf="firstName.errors['maxlength']">First Name must be at most 20 characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="lastName" class="form-label fs-14 fw-400 mb-3">Last Name</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" type="text" name="lastName"
                    [(ngModel)]="form.lastName" required minlength="2" maxlength="20" #lastName="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && lastName.errors }" placeholder="Enter Your Last Name" />
                  <div class="invalid-feedback" *ngIf="lastName.errors && f.submitted"> <span
                      *ngIf="lastName.errors['required']">Last Name is required</span> <span
                      *ngIf="lastName.errors['minlength']">Last Name must be at least 2 characters</span> <span
                      *ngIf="lastName.errors['maxlength']">Last Name must be at most 20 characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="email" class="form-label fs-14 fw-400 mb-3">Email Address</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" name="email" [(ngModel)]="form.email"
                    required email #email="ngModel" [ngClass]="{ 'is-invalid': f.submitted && email.errors }"
                    pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" maxlength="100"
                    placeholder="Enter Your Email Address" />
                  <div class="invalid-feedback" *ngIf="email.errors && f.submitted"> <span
                      *ngIf="email.errors['required']">Email is required</span> <span
                      *ngIf="email.errors['email']">Email
                      must be a valid email address</span> <span *ngIf="email.errors['pattern']">Email must be a
                      valid
                      email address</span> <span *ngIf="email.errors['maxlength']">Email must be at most 100
                      characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="phone" class="form-label fs-14 fw-400 mb-3">Phone</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" name="phone" [(ngModel)]="form.phone"
                    type="text" required maxlength="20" #phone="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && phone.errors }" pattern="^[-+()0-9]{10,12}(?:-\d+)?$"
                    placeholder="Enter Your Phone Number" />
                  <div class="invalid-feedback" *ngIf="phone.errors && f.submitted"> <span
                      *ngIf="phone.errors['required']">Phone is required</span> <span
                      *ngIf="phone.errors['pattern']">Phone must be a valid phone number</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="street" class="form-label fs-14 fw-400 mb-3">Street</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" name="street" [(ngModel)]="form.street"
                    required minlength="2" maxlength="200" #street="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && street.errors }" placeholder="Enter Your Street" />
                  <div class="invalid-feedback" *ngIf="street.errors && f.submitted"> <span
                      *ngIf="street.errors['required']">Street is required</span> <span
                      *ngIf="street.errors['minlength']">Street must be at least 2 characters</span> <span
                      *ngIf="street.errors['maxlength']">Street must be at most 200 characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="city" class="form-label fs-14 fw-400 mb-3">City</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" name="city" [(ngModel)]="form.city"
                    required minlength="2" maxlength="200" #city="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && city.errors }" placeholder="Enter Your City" />
                  <div class="invalid-feedback" *ngIf="city.errors && f.submitted"> <span
                      *ngIf="city.errors['required']">City is required</span> <span
                      *ngIf="city.errors['minlength']">City
                      must be at least 2 characters</span> <span *ngIf="city.errors['maxlength']">City must be at
                      most
                      200
                      characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="state" class="form-label fs-14 fw-400 mb-3">State</label>
                  <select class="form-select h-48 px-3 border-radius-8" name="state" #state="ngModel" size="1" required
                    [(ngModel)]="form.state" [ngClass]="{ 'is-invalid': f.submitted && state.errors }">
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="DC">District Of Columbia</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                    <option value="HI">Hawaii</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">Kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississippi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NE">Nebraska</option>
                    <option value="NV">Nevada</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New York</option>
                    <option value="NC">North Carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="OH">Ohio</option>
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennsylvania</option>
                    <option value="RI">Rhode Island</option>
                    <option value="SC">South Carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennessee</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermont</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West Virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
                  </select>
                  <div class="invalid-feedback d-block" *ngIf="state.errors && f.submitted"> <span
                      *ngIf="state.errors['required']">State is required</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="zip" class="form-label fs-14 fw-400 mb-3">Zip Code</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" pattern="[0-9]*" name="zip"
                    [(ngModel)]="form.zip" maxlength="20" required minlength="5" maxlength="20" #zip="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && zip.errors }" placeholder="Enter Your Zip Code" />
                  <div class="invalid-feedback" *ngIf="zip.errors && f.submitted"> <span
                      *ngIf="zip.errors['required']">Zip Code is required</span> <span
                      *ngIf="zip.errors['pattern']">Must
                      be a valid Zip Code</span> </div>
                </div>
              </div>
              <div class="col-md-12 mt-4">
                <div *ngIf="f.submitted && isUpdateFailed"> <span *ngIf="errorMessageProfile" class="alert alert-danger"
                    role="alert">Update failed: {{
                    errorMessageProfile
                    }}</span> </div>
              </div>
            </div>
            <div class="d-flex align-items-center gap-3 mt-5 px-3" *ngIf="currentUser">
              <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600">Update Account</button>
            </div>
          </form>
          <div *ngIf="isSuccessful" class="p-4"> <span class="alert alert-success" role="alert">Your update is
              successful!
              <button class="btn btn-sm btn-outline-primary ms-3" (click)="reload()">Ok</button>
            </span> </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="resetPassword" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="resetPasswordLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content border-radius-8">
        <div class="modal-header p-4">
          <h1 class="modal-title fs-20 fw-600 text-capitalize" id="resetPasswordLabel">Reset Password</h1>
          <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body px-2" *ngIf="currentUser">
          <form name="form" (ngSubmit)="f.form.valid && changePasswordRequest()" #f="ngForm" novalidate>
            <div class="row">
              <div class="col-md-4" *ngIf="form.role == 'ROLE_SHOP' || form.role == 'ROLE_RECYCLER' ">
                <div class="mt-4 pt-1">
                  <label for="password" class="form-label fs-14 fw-400 mb-3">Old Password</label>
                  <div class="input-group">
                    <input trimText class="form-control h-48 px-3" [type]="showPassword ? 'text' : 'password'"
                      name="password" [(ngModel)]="form.password" required minlength="6" #password="ngModel"
                      maxlength="30" [ngClass]="{ 'is-invalid': f.submitted && password.errors }"
                      placeholder="Enter Your Old Password" />
                    <div class="input-group-append">
                      <button class="btn btn-outline-secondary" type="button"> <i alt="show" class="far fa-eye eye-show"
                          (click)="showPassword = !showPassword" [class.hide]="showPassword"></i> <i alt="hide"
                          class="far fa-eye-slash eye-hide" (click)="showPassword = !showPassword"
                          [class.hide]="!showPassword"></i></button>
                    </div>
                  </div>
                  <div class="invalid-feedback" *ngIf="password.errors && f.submitted"> <span
                      *ngIf="password.errors['required']">Password is required</span> <span
                      *ngIf="password.errors['minlength']">Password must be at least 6 characters</span> <span
                      *ngIf="password.errors['maxlength']">Password must be at most 30 characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="newPassword" class="form-label fs-14 fw-400 mb-3">New Password</label>
                  <div class="input-group">
                    <input trimText class="form-control h-48 px-3" [type]="showPasswordNew ? 'text' : 'password'"
                      name="newPassword" [(ngModel)]="form.newPassword" required minlength="6" #newPassword="ngModel"
                      maxlength="30" [ngClass]="{ 'is-invalid': f.submitted && newPassword.errors }"
                      placeholder="Enter Your New Password" />
                    <div class="input-group-append">
                      <button class="btn btn-outline-secondary" type="button"> <i alt="show" class="far fa-eye eye-show"
                          (click)="showPasswordNew = !showPasswordNew" [class.hide]="showPasswordNew"></i> <i alt="hide"
                          class="far fa-eye-slash eye-hide" (click)="showPasswordNew = !showPasswordNew"
                          [class.hide]="!showPasswordNew"></i></button>
                    </div>
                  </div>
                  <div class="invalid-feedback" *ngIf="newPassword.errors && f.submitted"> <span
                      *ngIf="newPassword.errors['required']">New Password is required</span> <span
                      *ngIf="newPassword.errors['minlength']">New Password must be at least 6 characters</span>
                    <span *ngIf="newPassword.errors['maxlength']">New Password must be at most 30 characters</span>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="newPasswordComfirmed" class="form-label fs-14 fw-400 mb-3">Confirm New
                    Password</label>
                  <div class="input-group">
                    <input trimText class="form-control h-48 px-3"
                      [type]="showPaswordNewConfirmed ? 'text' : 'password'" name="passwordNew"
                      [(ngModel)]="form.newPasswordComfirmed" required minlength="6" #newPasswordComfirmed="ngModel"
                      maxlength="30" [ngClass]="{ 'is-invalid': f.submitted && newPasswordComfirmed.errors }"
                      placeholder="Please Re-Type Your New Password" />
                    <div class="input-group-append">
                      <button class="btn btn-outline-secondary" type="button"> <i alt="show" class="far fa-eye eye-show"
                          (click)="showPaswordNewConfirmed = !showPaswordNewConfirmed"
                          [class.hide]="showPaswordNewConfirmed"></i> <i alt="hide" class="far fa-eye-slash eye-hide"
                          (click)="showPaswordNewConfirmed = !showPaswordNewConfirmed"
                          [class.hide]="!showPaswordNewConfirmed"></i></button>
                    </div>
                  </div>
                  <div class="invalid-feedback" *ngIf="newPasswordComfirmed.errors && f.submitted"> <span
                      *ngIf="newPasswordComfirmed.errors['required']">Confirm New Password is required</span> <span
                      *ngIf="newPasswordComfirmed.errors['minlength']">Confirm New Password must be at least 6
                      characters</span> <span *ngIf="newPasswordComfirmed.errors['maxlength']">Confirm New Password
                      must
                      be at most 30
                      characters</span> </div>
                </div>
              </div>
              <div class="col-md-12 py-4 mt-4" *ngIf="errorMessageResetPassword != ''"> <span
                  class="alert alert-success line-height-150" role="alert">{{errorMessageResetPassword}}</span>
              </div>
            </div>
            <div class="d-flex align-items-center gap-3 mt-4 px-3" *ngIf="currentUser">
              <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600">Reset Password</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" [hidden]="detailSelected == false" id="partDetails" data-bs-backdrop="static"
    data-bs-keyboard="false" tabindex="-1" aria-labelledby="partDetailsLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" *ngIf="selectedAutopart">
      <div class="modal-content border-radius-8">
        <div class="modal-header p-4">
          <h1 class="modal-title fs-20 fw-600 text-capitalize" id="partDetailsLabel"
            style="display: inline-block; word-break: break-word;">[ {{selectedAutopart.title
            }} ] <span class="text-danger">[{{selectedAutopart.id}}]</span> FOR {{
            selectedAutopart.year }} {{ selectedAutopart.make }} {{selectedAutopart.model }}
          </h1>
          <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body px-2 submit-form">
          <div class="row" *ngIf="selectedAutopart.claimId > 0">
            <div class="col-12">
              <div class="row">
                <h2 class="fs-15 pt-1 fw-700">Estimate ID - <span class="text-danger" titile="Estimate Id"
                    *ngIf="selectedAutopart.claimId > 0">[{{selectedAutopart.claimId}}]</span><span class="text-danger"
                    titile="Purchase Order Id">[{{selectedAutopart.purchaseOrderId}}]</span></h2>
                <!-- <h2 class="fs-20 pt-1 fw-700">Purchase Order ID - <span class="text-danger"
                    titile="Purchase Order Id">[{{selectedAutopart.purchaseOrderId}}]</span></h2> -->
                <div class="pt-1">
                  <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                    <div class="table-responsive jobs-table bg-white border-radius-8 shadow">
                      <table class="table table-bordered table-sm">
                        <thead>
                          <tr>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                              style="width: 50px;">#</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                              title="Click to go to Configuration" [routerLink]="'/item-types'"
                              style="width:120px; cursor: pointer; ">Item Type</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Estimate Item
                              Description
                            </th>

                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                              style="width: 50px;">
                              Quantity</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"><i
                                class="fa-solid fa-dollar-sign"></i></th>

                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                              style="width: 100px;">Subtotal</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                              style="width: 120px;"><i class="fa-solid fa-clock"></i>
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                              style="width: 120px;">Locked <i class="fa-solid fa-clock"></i></th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                                class="fa-solid fa-user"></i></th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                              style="width:100px;">
                              Action</th>
                          </tr>


                        </thead>
                        <tbody class="readonly">

                          <tr (click)="setClaimId(claim.id)" class="shadow"
                            [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                            <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                              title="Drag and drop index number to change the order" [cdkDragDisabled]="isMobile==true"
                              cdkDrag>
                              <span class="fs-15 fw-700 text-danger">{{claim.id}}</span>
                            </td>
                            <td class="p-2 text-center">
                              <select class="form-select h-48 px-3 border-radius-8 "
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                (change)="onEnterClaimClaim('item type',claim)" [(ngModel)]="claim.itemType">
                                <option value="0" disabled selected>Select Type</option>
                                <option value="0" *ngIf="claim.itemType>0">Un-select Type</option>
                                <option [value]="itemType.id" *ngFor="let itemType of itemTypes;let i=index;">
                                  {{itemType.name}}
                                </option>
                              </select>
                            </td>
                            <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes" class="form-control"
                                placeholder="Please Specify" (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                maxlength="200"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea></td>

                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('quantity',claim)"
                                [(ngModel)]="claim.quantity"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>
                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('amount',claim)"
                                [(ngModel)]="claim.amount"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>

                            <td class="fs-13 p-2 text-center v-align-middle">${{getClaimSubTotal(claim)}}</td>
                            <td class="fs-13 p-2 text-center v-align-middle">
                              {{claim.createdAt | date: 'MM/dd/yyyy'}}
                            </td>
                            <td class="fs-13  p-2 text-center v-align-middle"><span
                                *ngIf="claim.status==1">{{claim.lockedAt |
                                date }}</span></td>
                            <td class="p-2 text-center  v-align-middle">
                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == claim.userId">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>

                            </td>
                            <td class="p-2 text-center">
                              <div class="d-flex align-items-center justifyc-cntent-center gap-1">
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==1"
                                  [disabled]="user.allowUnlockEstimate == false" title="Unlock this estimate item"
                                  (click)="lockClaim('unlock', claim)"><i class="fa fa-lock-open"></i></button>
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==0"
                                  [disabled]="user.allowLockEstimate == false" title="Lock this estimate item"
                                  (click)="lockClaim('lock', claim)"><i class="fa fa-lock"></i></button>
                                <button class="btn btn-outline-danger btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false" title="Delete"
                                  (click)="deleteVehicleClaim(null, claim)"><i class="fa fa-trash"></i></button>
                                <button class="btn btn-outline-success btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1" title="Save"
                                  (click)="onEnterClaimClaim('update', claim)"><i class="fa fa-save"></i></button>

                                <button class="btn btn-navy btn-sm" *ngIf="claim.createPurchaseOrder == true"
                                  [disabled]="user.allowAddUpdatePurchaseOrder == false || claim.notes =='' "
                                  title="Add Purchase Order" (click)="addPurchaseOrderToClaim( claim)"><i
                                    class="fa fa-plus"></i></button>

                                <button class="btn btn-info btn-sm" *ngIf="claim.createJobOrder == true"
                                  [disabled]="user.allowAddService == false || claim.notes ==''" title="Add Job Order"
                                  (click)="addJobToClaim( claim)"><i class="fa fa-plus"></i></button>


                              </div>
                            </td>
                          </tr>

                          <ng-container *ngIf="claim.createPurchaseOrder == true && claim.purchaseOrders.length> 0 ">
                            <tr>
                              <!-- <td></td> -->
                              <td class="text-center fs-14 v-align-middle opacity-50"><i
                                  class="fa-solid fa-cart-shopping"></i></td>
                              <td colspan="9" cdkDropList
                                (cdkDropListDropped)="droppedPurchaseOrdersClaim($event, claim)">

                                <table class="table-bordered table-sm shadow overflow-hidden  line-height-100 w-100"
                                  *ngIf="claim.purchaseOrders.length >0">
                                  <thead>
                                    <tr>
                                      <th class="fs-12 text-center bg-navy text-white mw-50"
                                        (click)="sortListPurchseOrdersClaim('id',claim.purchaseOrders)"
                                        title="Sort By Most Recent">
                                        PO #
                                      </th>


                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('title',claim.purchaseOrders)"
                                        title="Sort By Item Name"> PO Item Name </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('partNumber',claim.purchaseOrders)"
                                        title="Sort By Parts Number"> Parts #
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-150"
                                        (click)="sortListPurchseOrdersClaim('description',claim.purchaseOrders)"
                                        title="Sort By Description">
                                        Description </th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('vendorId',claim.purchaseOrders)"
                                        title="Sort By Most Recent">Vender</th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('status',claim.purchaseOrders)"
                                        title="Sort By Status">Approval</th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('purchaseStatus',claim.purchaseOrders)"
                                        title="Sort By Status">Status
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('grade',claim.purchaseOrders)"
                                        title="Sort By Grade">
                                        Grade
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('salePrice',claim.purchaseOrders)"
                                        title="Sort By Price">Price</th>
                                      <th class="fs-12 text-center bg-navy text-white mw-50"
                                        (click)="sortListPurchseOrdersClaim('createdAt',claim.purchaseOrders)"
                                        title="Sort By Date"><i class="fa-solid fa-clock"></i></th>
                                      <th class="fs-12 text-center bg-navy text-white mw-50">
                                        <i class="fa-solid fa-user"></i>
                                      </th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100">Action</th>
                                    </tr>
                                  </thead>
                                  <ng-container
                                    *ngFor="let purchaseOrder of claim.purchaseOrders; let i = index;  let even=even">
                                    <tr id="{{vehicle.id}}" (click)="editPurchaseOrder(purchaseOrder, i)" title=""
                                      style="cursor: pointer;"
                                      [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        [cdkDragDisabled]="isMobile==true" cdkDrag>

                                        <ng-container *ngIf="selectedAutopart.purchaseOrderId == purchaseOrder.id">
                                          <span class="fs-15 fw-700 text-danger">{{purchaseOrder.id}}</span>
                                        </ng-container>
                                        <ng-container *ngIf="selectedAutopart.purchaseOrderId != purchaseOrder.id">
                                          {{purchaseOrder.id}}
                                        </ng-container>
                                      </td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75"
                                          style="display: inline-block; word-break: break-word;">
                                          {{purchaseOrder.title}}</p>
                                      </td>
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75"
                                          style="display: inline-block; word-break: break-word;">
                                          {{purchaseOrder.partNumber}}</p>
                                      </td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                  -webkit-box-orient: vertical;
                                  -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                   overflow: hidden;"> {{purchaseOrder.description}}
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==1"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==2"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==3"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Returned At:{{ purchaseOrder.returnedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                        </p>
                                      </td>


                                      <td class="p-2 text-center  v-align-middle fs-12">

                                        <select class="form-select h-48 px-3 border-radius-8 fs-12"
                                          data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                                          style="height:30px; appearance: none; background-image: url('');" disabled
                                          [(ngModel)]="purchaseOrder.vendorId">
                                          <option [value]=" vendor.id" *ngFor="let vendor of vendors;let i=index;">
                                            {{vendor.name}}
                                          </option>
                                        </select>
                                      </td>

                                      <td title="Set Approval Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        class="text-center fs-12 v-align-middle">
                                        <select name="status" class="form-select border-radius-4 border fs-12" size="1"
                                          disabled style="height:30px; appearance: none; background-image: url('');"
                                          [(ngModel)]="purchaseOrder.status">
                                          <option value="0" selected>Not Submitted</option>
                                          <option value="1" style="color:green">For Approval</option>
                                          <option value="2" style="color:red">Rejected</option>
                                          <option value="3" style="color:blue">Approved</option>
                                        </select>
                                      </td>

                                      <td title="Set Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        class="text-center fs-12 v-align-middle">
                                        <select name="purchaseStatus" class="form-select border-radius-4 border fs-12"
                                          style="height:30px;" size="1"
                                          (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                          *ngIf="purchaseOrder.status == 3" [(ngModel)]="purchaseOrder.purchaseStatus">
                                          <option value="0" selected>No Status</option>
                                          <option value="1">Ordered</option>
                                          <option value="2">Received</option>
                                          <option value="3">Returned</option>
                                          <option value="4">Wrong Part</option>
                                        </select>
                                      </td>
                                      <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)"><select name="grade"
                                          style="height:30px; appearance: none; background-image: url('');"
                                          class="form-select h-48 border px-3 border-radius-8 fs-12" size="1" disabled
                                          [(ngModel)]="purchaseOrder.grade">
                                          <option value="undefined" disabled selected>Select Grade</option>
                                          <option value="A">A</option>
                                          <option value="B">B</option>
                                          <option value="C">C</option>
                                          <option value="Used">Used</option>
                                          <option value="New">New</option>
                                          <option value="Insurance">Insurance</option>
                                        </select></td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        ${{purchaseOrder.salePrice}}
                                      </td>
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        {{purchaseOrder.createdAt |
                                        date: 'MM/dd/yyyy'}} </td>
                                      <td class="p-2 text-center  v-align-middle fs-12">
                                        <ng-container *ngFor="let user of users;let i=index;">
                                          <span *ngIf="user.id == purchaseOrder.userId">
                                            {{(user.firstName + " " + user.lastName) | shortName:2}}
                                          </span>
                                        </ng-container>

                                      </td>
                                      <td class="text-center fs-12 v-align-middle">
                                        <div class="d-flex gap-1">
                                          <button class="btn btn-outline-danger btn-sm"
                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                            *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                            (click)="deletePurchaseOrderClaim(purchaseOrder, i, claim)">
                                            <i class="fa fa-trash"></i>
                                          </button>

                                          <button class="btn btn-outline-warning btn-sm"
                                            *ngIf="purchaseOrder.status ==0" title="Submit for Approval"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-right"></i>
                                          </button>

                                          <button class="btn btn-outline-warning btn-sm"
                                            *ngIf="purchaseOrder.status ==2" title="Re-Submit for Approval"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-right"></i>
                                          </button>

                                          <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==1"
                                            title="Reject It"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-ban"></i>
                                          </button>

                                          <button class="btn btn-outline-success btn-sm"
                                            *ngIf="purchaseOrder.status ==1" title="Approve It"
                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-check-square"></i>
                                          </button>

                                          <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==3"
                                            title="Un-Approve It"
                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-left"></i>
                                          </button>

                                          <button class="btn btn-warning btn-sm" *ngIf="purchaseOrder.status == 3"
                                            [disabled]="user.allowAddUpdateAutopart == false" title="Add Parts"
                                            (click)="addAutopartToPurchaseOrder( claim, purchaseOrder)"><i
                                              class="fa fa-plus"></i></button>

                                        </div>
                                      </td>
                                    </tr>

                                    <ng-container *ngIf="purchaseOrder.autoparts.length> 0 ">
                                      <tr>
                                        <!-- <td></td> -->
                                        <td class="text-center fs-14 v-align-middle opacity-50"><i
                                            class="fa-solid fa-tools"></i>
                                        </td>
                                        <td colspan="11" cdkDropList
                                          (cdkDropListDropped)="droppedAutoprtsPurchaseOrder($event, purchaseOrder)">


                                          <table
                                            class="table-bordered table-sm overflow-hidden shadow line-height-100 w-100">
                                            <thead>
                                              <tr class="fs-12 text-center bg-warning v-align-middle text-white mw-50">
                                                <th class="fs-12 text-center  mw-50"
                                                  (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                  title="Sort By Most Recent">
                                                  #
                                                </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                  title="Sort By Most Recent">Image</th>

                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('title', purchaseOrder)"
                                                  title="Sort By Parts Name"> Name </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)=" sortListAutopartsPurchaseOrder('partNumber', purchaseOrder)"
                                                  title="Sort By Parts Number"> Parts # </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)=" sortListAutopartsPurchaseOrder('description', purchaseOrder)"
                                                  title="Sort By Description"> Desc </th>


                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('purchaseStatus', purchaseOrder)"
                                                  title="Sort By Status"> Status </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('grade', purchaseOrder)"
                                                  title="Sort By Grade">
                                                  Grade
                                                </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('salePrice', purchaseOrder)"
                                                  title="Sort By Price"> Price </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('createdAt', purchaseOrder)"
                                                  title="Sort By Date"> At </th>
                                                <th class="fs-14 text-center mw-50"> By </th>
                                                <th class="fs-12 text-center  mw-100">Action</th>
                                              </tr>
                                            </thead>
                                            <ng-container
                                              *ngFor="let autopart of purchaseOrder.autoparts; let i = index;  let even=even">
                                              <tr id="{{vehicle.id}}" (click)="editAutopart(autopart, i)" title=""
                                                class="cursor-pointer"
                                                [style.background-color]="i == cindexAutpartPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)"
                                                  [cdkDragDisabled]="isMobile==true" cdkDrag>

                                                  <ng-container *ngIf="autopart.id == selectedAutopart.id">
                                                    <span class="fs-15 fw-700 text-danger"> {{autopart.id}}</span>
                                                  </ng-container>
                                                  <ng-container *ngIf="autopart.id != selectedAutopart.id">
                                                    {{autopart.id}}
                                                  </ng-container>

                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" (mouseover)="hover = vehicle"
                                                  (mouseleave)="hover = null"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <div class="overflow-hidden hover-img transition rounded-1 border">
                                                    <img
                                                      *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                      src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                      height="40" width="100" alt="Image"
                                                      class="object-fill rounded-1 w-100" />
                                                  </div>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75"
                                                    style="display: inline-block; word-break: break-word;">
                                                    {{autopart.title}}</p>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75"
                                                    style="display: inline-block; word-break: break-word;">
                                                    {{autopart.partNumber}}</p>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                                -webkit-box-orient: vertical;
                                                -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                                 overflow: hidden;"> {{autopart.description}}
                                                    <ng-container *ngIf="autopart.purchaseStatus==1"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==2"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==3"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==4"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                  </p>
                                                </td>

                                                <td title="Set Status" (click)=" editAutopart(autopart, i)"
                                                  class="text-center fs-12 v-align-middle"><select name="purchaseStatus"
                                                    class="form-select border-radius-4 border fs-12" size="1"
                                                    (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                    [(ngModel)]="autopart.purchaseStatus">
                                                    <option value="0" selected>No Status</option>
                                                    <option value="1">Ordered</option>
                                                    <option value="2">Received</option>
                                                    <option value="3">Returned</option>
                                                    <option value="4">Wrong Part</option>
                                                  </select></td>
                                                <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"><select name="grade" style=" appearance: none;
                                            background-image: url('');"
                                                    class="form-select border px-3 border-radius-8 fs-12" size="1"
                                                    disabled [(ngModel)]="autopart.grade">
                                                    <option value="undefined" disabled selected>Select Grade</option>
                                                    <option value="A">A</option>
                                                    <option value="B">B</option>
                                                    <option value="C">C</option>
                                                    <option value="Used">Used</option>
                                                    <option value="New">New</option>
                                                    <option value="Insurance">Insurance</option>
                                                  </select></td>


                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"> ${{autopart.salePrice}}
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"> {{autopart.createdAt |
                                                  date: 'MM/dd/yyyy'}} </td>
                                                <td class="p-2 text-center fs-12  v-align-middle">

                                                  <ng-container *ngFor="let user of users;let i=index;">
                                                    <span *ngIf="user.id == autopart.userId">
                                                      {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                    </span>
                                                  </ng-container>



                                                </td>
                                                <td class="text-center fs-12 v-align-middle">
                                                  <div class="d-flex gap-2">
                                                    <button class="btn btn-outline-danger btn-sm"
                                                      (click)="editAutopart(autopart, i)"
                                                      *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                      (click)="deleteAutopartPurchaseOrder(autopart, i, purchaseOrder)">
                                                      <i class="fa fa-trash"></i>
                                                    </button>
                                                    <button class="btn btn-outline-warning btn-sm"
                                                      (click)="editAutopart(autopart, i)"
                                                      *ngIf="this.user.allowAddUpdateAutopart == true"
                                                      data-bs-toggle="modal" data-bs-target="#editPart"><i
                                                        class="fa fa-edit"></i> </button>
                                                  </div>
                                                </td>
                                              </tr>
                                            </ng-container>
                                          </table>



                                        </td>
                                      </tr>
                                    </ng-container>

                                  </ng-container>
                                </table>

                              </td>
                            </tr>
                          </ng-container>

                          <ng-container *ngIf="claim.createJobOrder == true && claim.jobs.length> 0">
                            <tr>
                              <td></td>
                              <td class="text-center fs-14 v-align-middle opacity-50"><i class="fas fa-user"></i></td>
                              <td colspan="8">
                                <ng-container>
                                  <table class="table-bordered table-sm overflow-hidden shadow  line-height-100 w-100"
                                    cdkDropList (cdkDropListDropped)="droppedJobsClaim($event, claim)">
                                    <thead>

                                      <tr>
                                        <th class="fs-12 text-center bg-info text-white" style="width:50px">JO #</th>
                                        <th class="fs-12 text-center bg-info text-white mw-100">Job Order Name</th>
                                        <th class="fs-12 text-center bg-info text-white" style="min-width:150px">
                                          Instruction
                                        </th>
                                        <th class="fs-12 text-center bg-info text-white mw-100" style="width:100px">
                                          Assigned
                                          To</th>
                                        <th class="fs-12 text-center bg-info text-white" style="width:100px">$
                                        </th>
                                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                        <th class="fs-12 text-center bg-info text-white mw-100">Target</th>
                                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                        <th class="fs-12 text-center bg-info text-white " style="width:50px">Status
                                        </th>
                                        <th class="fs-12 text-center bg-info text-white mw-50"><i
                                            class="fa-solid fa-user"></i></th>
                                        <th class="fs-12 text-center bg-info text-white mw-100">Action</th>
                                      </tr>
                                    </thead>
                                    <tbody>

                                      <tr (click)="setJobId(job.id)" *ngFor="let job of claim.jobs; let i=index">
                                        <td class="text-center fs-12 v-align-middle" [cdkDragDisabled]="isMobile==true"
                                          cdkDrag>
                                          {{job.id}}
                                        </td>
                                        <td class="text-center fs-12 v-align-middle">
                                          <input placeholder="Enter Job Name" [(ngModel)]="job.name" maxlength="50"
                                            (keyup.enter)="onEnter('job name',job)" type="text"
                                            [disabled]="job.paidWeek> 0"
                                            class="form-control h-40 border-radius-4 border" />
                                        </td>
                                        <td class="text-center fs-12 v-align-middle"><textarea type="text" rows="1"
                                            [(ngModel)]="job.notes" class="form-control my-2" maxlength="200"
                                            (keyup.enter)="onEnter('job notes',job)" title="Job Instruction"
                                            [disabled]="job.paidWeek> 0"
                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                        </td>

                                        <td class="text-center fs-12 v-align-middle"><select
                                            class="form-select border-radius-4 h-40 border fs-12 "
                                            [(ngModel)]="job.employeeId" #device [disabled]="job.paidWeek> 0"
                                            style="height:30px;"
                                            (change)="onChangeEmployee2Claim($event, device.value, job, claim)">
                                            <option value="0" disabled selected>Select Employee</option>
                                            <option [value]="employee.id"
                                              [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                              *ngFor="let employee of employees;let i=index;">{{employee.firstName}}
                                              {{employee.lastName}}
                                              ( {{employee.roleName}},{{employee.rolePrecentage}}% <ng-container
                                                *ngIf="employee.commissionBased == true">
                                                - <span class="fw-700 text-danger">Commission Based</span>
                                              </ng-container>)
                                              [{{
                                              employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                              +
                                              employee.jobCountsFinished}}]
                                            </option>
                                          </select></td>
                                        <td class="text-center fs-12 v-align-middle"><input
                                            placeholder="Enter Job Value" [(ngModel)]="job.price" maxlength="50"
                                            class="fs-12" (keyup.enter)="onEnter('job price',job)" type="number"
                                            [disabled]="job.paidWeek> 0"
                                            class="form-control border h-40 border-radius-4" />
                                        </td>

                                        <td class="text-center fs-12 v-align-middle"><input *ngIf="job.employeeId > 0"
                                            (change)="onChangeCalendar($event, job)"
                                            max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                            [disabled]="job.paidWeek> 0" [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                                            title="Target Date" type="date"
                                            class="form-control border h-40 border-radius-4" /></td>

                                        <td class="p-2 text-center v-align-middle">
                                          <div class="form-check text-center pt-2">
                                            <input trimText class="form-check-input mx-auto mt-0" type="checkbox"
                                              [disabled]="job.paidWeek> 0"
                                              *ngIf="job.employeeId > 0 && job.targetDate != null"
                                              [checked]="isJobChecked(job)" (change)="updateJobStatus(job)" />
                                          </div>
                                        </td>
                                        <td class="p-2 text-center  v-align-middle fs-12">

                                          <ng-container *ngFor="let user of users;let i=index;">
                                            <span *ngIf="user.id == job.userId">
                                              {{(user.firstName + " " + user.lastName) | shortName:2}}
                                            </span>
                                          </ng-container>





                                        </td>
                                        <td class="text-center fs-12 v-align-middle">
                                          <div class="d-flex align-items-center justifyc-ntent-center gap-1">
                                            <button class="btn btn-outline-danger btn-sm" title="Remove"
                                              [disabled]="job.paidWeek> 0" (click)="deleteVehicleJobClaim(null, job)"><i
                                                class="fa fa-trash"></i></button>
                                            <button class="btn btn-outline-primary btn-sm" title="Save"
                                              [disabled]="job.paidWeek> 0" (click)="saveJobNotes(job)"><i
                                                class="fa fa-save"></i></button>
                                            <button class="btn btn-outline-dark btn-sm" title="Print"
                                              (click)="setJobId(job.id)"
                                              (click)="printPageJob('print-content-job', 'jobs', job)">
                                              <i class="fa fa-print"></i>
                                            </button>
                                          </div>
                                        </td>
                                      </tr>

                                    </tbody>
                                  </table>
                                </ng-container>

                              </td>
                            </tr>


                          </ng-container>


                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-4">
              <div class="mt-2 pt-1 position-relative">
                <div *ngFor='let imageModel of selectedAutopart.imageModels; let i=index' class="d-inline-block me-2">
                  <img class="mt-3 preview img-fluid img-thumbnail me-3" width="100"
                    *ngIf="selectedAutopart.showInSearchImageId != imageModel.id"
                    src="{{baseUrlResizeImageParts + '/' + imageModel.id}}" (click)="setImageAutoPart(i)"
                    style="border: 3px solid #555;"> <img class="mt-3 preview img-fluid img-thumbnail me-3" width="100"
                    *ngIf="selectedAutopart.showInSearchImageId == imageModel.id"
                    src="{{baseUrlResizeImageParts + '/' + imageModel.id}}" (click)="setImageAutoPart(i)"
                    title="Show in search" style="border: 3px solid lightcoral;">
                </div>
              </div>
            </div>
            <div class="col-md-8">
              <div class="mt-4 pt-1 position-relative">
                <div class="containerImage"> <img
                    *ngIf="selectedImage != null && selectedAutopart.showInSearchImageId > 0 && selectedAutopart.showInSearchImageId != selectedImage"
                    class="image w-100 img-fluid img-thumbnail" src="{{baseUrlImageParts + '/' + selectedImage}}"
                    alt="Image" /> <img
                    *ngIf="selectedImage != null &&  selectedAutopart.showInSearchImageId > 0 && selectedAutopart.showInSearchImageId == selectedImage"
                    class="image w-100 img-fluid img-thumbnail" src="{{baseUrlImageParts + '/' + selectedImage}}"
                    alt="Image" /> </div>
              </div>
            </div>
            <div class="col-md-12">
              <div class="mt-4 pt-1">
                <p class="py-2 fs-13 line-height-130" style="display: inline-block; word-break: break-word;">{{
                  selectedAutopart.comments }}</p>
                <p class="py-2 fs-13 line-height-130" style="display: inline-block; word-break: break-word;">{{
                  selectedAutopart.description }}</p>
                <div class="clearfix"></div>
                <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"
                  style="display: inline-block; word-break: break-word;"><b>Part No.: </b> {{
                  selectedAutopart.partNumber
                  }}</p>
                <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"
                  style="display: inline-block; word-break: break-word;"><b>Vendor.: </b> {{
                  getVendorName(selectedAutopart.vendorId)
                  }}</p>
                <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"
                  style="display: inline-block; word-break: break-word;"><b>Stock No.: </b> {{
                  selectedAutopart.stocknumber
                  }}</p>
                <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"><b>Grade: </b> {{ selectedAutopart.grade
                  }}
                </p>
                <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"><b>Sales Price: </b> $ {{
                  selectedAutopart.salePrice }}</p>
                <p class="py-2 fs-13 line-height-130 w-50 d-inline-block"><b>Created At: </b>{{
                  selectedAutopart.createdAt| date: 'MM/dd/yyyy' }}</p>
                <p class="py-2 fs-13 line-height-130 w-50 d-inline-block">
                  <ng-container *ngIf="selectedAutopart.purchaseStatus==1"> <br>
                    <span style="color:red">Ordered At: {{ selectedAutopart.orderedAt| date: 'MM/dd/yyyy'}}</span>
                  </ng-container>
                  <ng-container *ngIf="selectedAutopart.purchaseStatus==2"> <br>
                    <span style="color:red">Ordered At: {{ selectedAutopart.orderedAt| date: 'MM/dd/yyyy'}}</span>
                    <br>
                    <span style="color:red">Received At:{{ selectedAutopart.receivedAt| date: 'MM/dd/yyyy'}}</span>
                  </ng-container>
                  <ng-container *ngIf="selectedAutopart.purchaseStatus==3"> <br>
                    <span style="color:red">Ordered At: {{ selectedAutopart.orderedAt| date: 'MM/dd/yyyy'}}</span>
                    <br>
                    <span style="color:red">Received At:{{ selectedAutopart.receivedAt| date: 'MM/dd/yyyy'}}</span>
                    <br>
                    <span style="color:red">Returned At:{{ selectedAutopart.returnedAt| date: 'MM/dd/yyyy'}}</span>
                  </ng-container>
                </p>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="addNewPart" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="addNewPartLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content border-radius-8">
        <div class="modal-header p-4">
          <h1 class="modal-title fs-20 fw-600 text-capitalize" id="addNewPartLabel">Add Parts</h1>
          <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body px-2 submit-form">
          <div class="row">
            <div class="col-12">
              <div class="mt-4 pt-1 position-relative">
                <label for="phone" class="form-label fs-14 fw-400 mb-3">Images / Photos</label>
                <button name="btn" class="btn btn-secondary-abs py-3 px-3 w-100"><i class="fa fa-cloud-upload me-2"></i>
                  Upload Images</button>
                <input type='file' accept="image/jpg, image/jpeg"
                  class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute" #fileInput
                  (click)="fileInput.value = ''" (change)="onSelectFileNew($event)" multiple />
              </div>
              <h5 class="text-danger fw-700 mt-3">{{ message1}}</h5>
            </div>
            <div class="col-lg-6">
              <div class="mt-2 pt-1 position-relative"> <img *ngFor='let imageModel of imageModels;let i=index'
                  (click)="setShowInSearch(i)" [src]="imageModel.picByte"
                  class="mt-3 preview img-fluid img-thumbnail me-3" width="100" /> </div>
            </div>
            <div class="col-lg-6">
              <div class="mt-4 pt-1 position-relative">
                <div class="containerImage" *ngIf="imageModels.length> 0"> <img *ngIf="imageUrl" [src]="imageUrl"
                    class="image w-100 img-fluid img-thumbnail" />
                  <label *ngIf="imageUrl" class="top-left" for="title">Will Show This During Search</label>
                  <label *ngIf="imageUrl" class="bottom-left" for="title">Will Show This During Search</label>
                  <div class="bottom-right py-2">
                    <button data-toggle="tooltip" data-placement="top" title="Remove this image" *ngIf="imageUrl"
                      (click)="deleteCurerntImage()" class="btn btn-outline-danger mt-3 btn-sm" for="title"> <i
                        class="bi-trash"></i> </button>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Name</label>
                <input trimText class="form-control h-48 px-3 border-radius-0" type="text" required
                  placeholder="Enter Parts name" #name="ngModel" [ngClass]="{ 'is-invalid': name.errors }" minlength="2"
                  maxlength="50" [(ngModel)]="selectedAutopart.title" />
                <div class="invalid-feedback" *ngIf="name.errors "> <span *ngIf="name.errors['required']">Parts Name
                    is
                    required</span> <span *ngIf="name.errors['minlength']">Parts Name must be at least 2
                    characters</span> <span *ngIf="name.errors['maxlength']">Parts Name must be at most 50
                    characters</span> </div>
              </div>
            </div>
            <div class="col-lg-3">
              <div class="mt-4 pt-1">
                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Number</label>
                <div class="input-group">
                  <input trimText class="form-control h-48 px-3 border-radius-0" type="text"
                    placeholder="Enter Parts Number" #partNumber="ngModel"
                    [ngClass]="{ 'is-invalid': partNumber.errors }" minlength="2" maxlength="50"
                    [(ngModel)]="selectedAutopart.partNumber" name="partInfo" />

                </div>
                <div class="invalid-feedback" *ngIf="partNumber.errors "> <span
                    *ngIf="partNumber.errors['required']">Parts Number is required</span> <span
                    *ngIf="partNumber.errors['minlength']">Parts Number must be at least 2 characters</span> <span
                    *ngIf="partNumber.errors['maxlength']">Parts Number must be at most 50 characters</span> </div>
              </div>
            </div>
            <div class="col-lg-3">
              <div class="mt-4 pt-1">
                <label for="vendor" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                  title="Click to go to Configuration" [routerLink]="'/vendors'"
                  class="form-label fs-14 fw-400 mb-3 cursor-pointer">Vendor</label>
                <select class="form-select h-48 px-3 border-radius-8" name="vendor"
                  [(ngModel)]="selectedAutopart.vendorId" [disabled]="user.allowAddUpdateAutopart == false"
                  #vendor="ngModel" required [ngClass]="{ 'is-invalid': vendor.errors }">
                  <option value="undefined" disabled selected>Select Vendor</option>
                  <option [value]="vendor.id" *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}</option>
                </select>
                <div class="invalid-feedback" *ngIf="vendor.errors">
                  <span *ngIf="vendor.errors['required']">Vendor is required</span>
                </div>
              </div>
            </div>
            <div class="col-md-12">
              <div class="mt-4 pt-1">
                <label for="description" class="form-label fs-14 fw-400 mb-3">Parts Description</label>
                <textarea class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Enter Description"
                  #description="ngModel" style="line-height: 2;" [ngClass]="{ 'is-invalid': description.errors }"
                  minlength="2" rows="2" maxlength="2000" required [(ngModel)]="selectedAutopart.description"
                  name="description"></textarea>
                <div class="invalid-feedback" *ngIf="description.errors "> <span
                    *ngIf="description.errors['required']">Part Description is required</span> <span
                    *ngIf="description.errors['minlength']">Part Description must be at least 2
                    characters</span> <span *ngIf="description.errors['maxlength']">Part Descripton must be at most
                    2000
                    characters</span> </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Comments</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Enter Comments"
                  #comments="ngModel" [ngClass]="{ 'is-invalid': comments.errors }" minlength="2" maxlength="500"
                  [(ngModel)]="selectedAutopart.comments" name="comments" />
                <div class="invalid-feedback" *ngIf="comments.errors ">
                  <!-- <span *ngIf="partNumber.errors['required']">Parts Number is required</span> -->
                  <span *ngIf="comments.errors['minlength']">Parts Comments must be at least 2 characters</span>
                  <span *ngIf="comments.errors['maxlength']">Parts Comments must be at most 500 characters</span>
                </div>
              </div>
            </div>


            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="grade" class="form-label fs-14 fw-400 mb-3">Grade</label>
                <select name="grade" class="form-select h-48 px-3 border-radius-8" size="1"
                  [(ngModel)]="selectedAutopart.grade" required #grade="ngModel"
                  [ngClass]="{ 'is-invalid': grade.errors }">
                  <option value="undefined" disabled selected>Select Grade</option>
                  <option value="A">A</option>
                  <option value="B">B</option>
                  <option value="C">C</option>
                  <option value="Used">Used</option>
                  <option value="New">New</option>
                  <option value="Insurance">Insurance</option>
                </select>
                <div class="invalid-feedback" *ngIf="grade.errors "> <span *ngIf="grade.errors['required']">Grade is
                    required</span> </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="price" class="form-label fs-14 fw-400 mb-3">Price ($)</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" type="number" placeholder="Enter Price"
                  #salePrice="ngModel" [ngClass]="{ 'is-invalid': salePrice.errors }" minlength="1" maxlength="10"
                  onKeyPress="if(this.value.length==10) return false" maxlength="10" required
                  oninput="if(this.value<0)this.value=this.value * -1" [(ngModel)]="selectedAutopart.salePrice"
                  name="price" />
                <div class="invalid-feedback" *ngIf="salePrice.errors "> <span
                    *ngIf="salePrice.errors['required']">Price
                    is required</span> <span *ngIf="salePrice.errors['minlength']">Price must be at least 1
                    characters</span> <span *ngIf="salePrice.errors['maxlength']">Price must be at most 10
                    characters</span> </div>
              </div>
            </div>

            <div class="col-md-12" *ngIf="errorMessage !=''">
              <div class="alert alert-danger mt-4">{{ errorMessage}}</div>
            </div>
            <div class="col-md-12">
              <div class="mt-4 pt-1">
                <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600" *ngIf="selectedAutopart.id ==0"
                  (click)="createNewAutopart()"> Save Info</button>
                <button *ngIf="selectedAutopart.id> 0" class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600"
                  data-bs-toggle="modal" data-bs-target="#partDetails" (click)="editAutopart(selectedAutopart, 0)">
                  Details</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="addNewPurchaseOrder" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="addNewPurchaseOrderLabel">
    <div class="modal-dialog modal-xl">
      <div class="modal-content border-radius-8">
        <div class="modal-header p-4">
          <h1 class="modal-title fs-20 fw-600 text-capitalize"><span *ngIf="selectedPurchaseOrder.id==0">Add </span>
            <span *ngIf="selectedPurchaseOrder.id> 0">Edit </span>
            Purchase Order Id - <span class="text-danger"
              *ngIf="selectedPurchaseOrder.id > 0">[{{selectedPurchaseOrder.id}}]</span> <small class="fs-11 fw-300"
              *ngIf="selectedPurchaseOrder.id> 0"> Created At {{
              selectedPurchaseOrder.createdAt| date: 'MM/dd/yyyy'}} </small>
          </h1>
          <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body px-2 submit-form">
          <div class="row" *ngIf="selectedPurchaseOrder.claimId > 0">
            <div class="col-12">
              <div class="row">
                <h2 class="fs-20 pt-1 fw-700">Estimate ID - <span
                    class="text-danger">[{{selectedPurchaseOrder.claimId}}]</span></h2>
                <div class="pt-1">
                  <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                    <div class="table-responsive jobs-table bg-white border-radius-8 shadow scale-down">
                      <table class="table table-bordered table-sm">
                        <thead>
                          <tr>

                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                              style="width: 50px;">#</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                              title="Click to go to Configuration" [routerLink]="'/item-types'"
                              style="width:120px; cursor: pointer; ">Item Type</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Estimate Item
                              Description
                            </th>

                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                              style="width: 50px;">
                              Quantity</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"><i
                                class="fa-solid fa-dollar-sign"></i></th>

                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                              style="width: 100px;">Subtotal</th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                              style="width: 120px;"><i class="fa-solid fa-clock"></i>
                            </th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                              style="width: 120px;">Locked <i class="fa-solid fa-clock"></i></th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middlem mw-50"><i
                                class="fa-solid fa-user"></i></th>
                            <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                              style="width:100px;">
                              Action</th>
                          </tr>


                        </thead>
                        <tbody class="readonly">

                          <tr (click)="setClaimId(claim.id)" class="shadow"
                            [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                            <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                              title="Drag and drop index number to change the order" [cdkDragDisabled]="isMobile==true"
                              cdkDrag>
                              <span class="fs-15 fw-700 text-danger">{{claim.id}}</span>
                            </td>
                            <td class="p-2 text-center">
                              <select class="form-select h-48 px-3 border-radius-8 "
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                (change)="onEnterClaimClaim('item type',claim)" [(ngModel)]="claim.itemType">
                                <option value="0" disabled selected>Select Type</option>
                                <option value="0" *ngIf="claim.itemType>0">Un-select Type</option>
                                <option [value]="itemType.id" *ngFor="let itemType of itemTypes;let i=index;">
                                  {{itemType.name}}
                                </option>
                              </select>
                            </td>
                            <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes" class="form-control"
                                placeholder="Please Specify" (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                maxlength="200"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea></td>

                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('quantity',claim)"
                                [(ngModel)]="claim.quantity"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>
                            <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('amount',claim)"
                                [(ngModel)]="claim.amount"
                                [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                class="form-control form-control-sm h-40 border-radius-4" /></td>

                            <td class="fs-13 p-2 text-center v-align-middle">${{getClaimSubTotal(claim)}}</td>
                            <td class="fs-13 p-2 text-center v-align-middle">
                              {{claim.createdAt | date: 'MM/dd/yyyy'}}
                            </td>
                            <td class="fs-13  p-2 text-center v-align-middle"><span
                                *ngIf="claim.status==1">{{claim.lockedAt |
                                date }}</span></td>
                            <td class="p-2 text-center  v-align-middle">

                              <ng-container *ngFor="let user of users;let i=index;">
                                <span *ngIf="user.id == claim.userId">
                                  {{(user.firstName + " " + user.lastName) | shortName:2}}
                                </span>
                              </ng-container>



                            </td>
                            <td class="p-2 text-center">
                              <div class="d-flex align-items-center justifyc-cntent-center gap-1">
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==1"
                                  [disabled]="user.allowUnlockEstimate == false" title="Unlock this estimate item"
                                  (click)="lockClaim('unlock', claim)"><i class="fa fa-lock-open"></i></button>
                                <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==0"
                                  [disabled]="user.allowLockEstimate == false" title="Lock this estimate item"
                                  (click)="lockClaim('lock', claim)"><i class="fa fa-lock"></i></button>
                                <button class="btn btn-outline-danger btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false" title="Delete"
                                  (click)="deleteVehicleClaim(null, claim)"><i class="fa fa-trash"></i></button>
                                <button class="btn btn-outline-success btn-sm"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1" title="Save"
                                  (click)="onEnterClaimClaim('update', claim)"><i class="fa fa-save"></i></button>

                                <button class="btn btn-navy btn-sm" *ngIf="claim.createPurchaseOrder == true"
                                  [disabled]="user.allowAddUpdatePurchaseOrder == false" title="Add Purchase Order"
                                  (click)="addPurchaseOrderToClaim( claim)"><i class="fa fa-plus"></i></button>

                                <button class="btn btn-info btn-sm" *ngIf="claim.createJobOrder == true"
                                  [disabled]="user.allowAddService == false" title="Add Job Order"
                                  (click)="addJobToClaim( claim)"><i class="fa fa-plus"></i></button>


                              </div>
                            </td>
                          </tr>

                          <ng-container *ngIf="claim.createPurchaseOrder == true && claim.purchaseOrders.length> 0 ">
                            <tr>
                              <!-- <td></td> -->
                              <td class="text-center fs-14 v-align-middle opacity-50"><i
                                  class="fa-solid fa-cart-shopping"></i></td>
                              <td colspan="9" cdkDropList
                                (cdkDropListDropped)="droppedPurchaseOrdersClaim($event, claim)">

                                <table class="table-bordered table-sm shadow overflow-hidden  line-height-100 w-100"
                                  *ngIf="claim.purchaseOrders.length >0">
                                  <thead>
                                    <tr>
                                      <th class="fs-12 text-center bg-navy text-white mw-50"
                                        (click)="sortListPurchseOrdersClaim('id',claim.purchaseOrders)"
                                        title="Sort By Most Recent">
                                        PO #
                                      </th>


                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('title',claim.purchaseOrders)"
                                        title="Sort By Item Name"> PO Item Name </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('partNumber',claim.purchaseOrders)"
                                        title="Sort By Parts Number"> Parts #
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-150"
                                        (click)="sortListPurchseOrdersClaim('description',claim.purchaseOrders)"
                                        title="Sort By Description">
                                        Description </th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('vendorId',claim.purchaseOrders)"
                                        title="Sort By Most Recent">Vender</th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('status',claim.purchaseOrders)"
                                        title="Sort By Status">Approval</th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('purchaseStatus',claim.purchaseOrders)"
                                        title="Sort By Status">Status
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-50" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('grade',claim.purchaseOrders)"
                                        title="Sort By Grade">
                                        Grade
                                      </th>
                                      <th class="fs-12 text-center bg-navy text-white mw-50" style="width:100px"
                                        (click)="sortListPurchseOrdersClaim('salePrice',claim.purchaseOrders)"
                                        title="Sort By Price"><i class="fa-solid fa-dollar-sign"></i></th>
                                      <th class="fs-12 text-center bg-navy text-white mw-100"
                                        (click)="sortListPurchseOrdersClaim('createdAt',claim.purchaseOrders)"
                                        title="Sort By Date"><i class="fa-solid fa-clock"></i></th>
                                      <th class="fs-12 text-center bg-navy text-white mw-50"><i
                                          class="fa-solid fa-user"></i>
                                      </th>

                                      <th class="fs-12 text-center bg-navy text-white mw-100">Action</th>
                                    </tr>
                                  </thead>
                                  <ng-container
                                    *ngFor="let purchaseOrder of claim.purchaseOrders; let i = index;  let even=even">
                                    <tr id="{{vehicle.id}}" (click)="editPurchaseOrder(purchaseOrder, i)" title=""
                                      style="cursor: pointer;"
                                      [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        [cdkDragDisabled]="isMobile==true" cdkDrag>

                                        <ng-container *ngIf="selectedPurchaseOrder.id == purchaseOrder.id">
                                          <span class="text-danger fw-700 fs=15">{{purchaseOrder.id}}</span>
                                        </ng-container>
                                        <ng-container *ngIf="selectedPurchaseOrder.id != purchaseOrder.id">
                                          {{purchaseOrder.id}}
                                        </ng-container>
                                      </td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75"
                                          style="display: inline-block; word-break: break-word;">
                                          {{purchaseOrder.title}}</p>
                                      </td>
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75"
                                          style="display: inline-block; word-break: break-word;">
                                          {{purchaseOrder.partNumber}}</p>
                                      </td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder"
                                        title="Click to view details. Drag and drop index number to change the order"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                  -webkit-box-orient: vertical;
                                  -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                   overflow: hidden;"> {{purchaseOrder.description}}
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==1"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==2"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                          <ng-container *ngIf="purchaseOrder.purchaseStatus==3"> <br>
                                            <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                            <br>
                                            <span class="text-danger">Returned At:{{ purchaseOrder.returnedAt|
                                              date: 'MM/dd/yyyy'}}</span>
                                          </ng-container>
                                        </p>
                                      </td>

                                      <td class="p-2 text-center  v-align-middle fs-12">

                                        <select class="form-select h-48 px-3 border-radius-8 fs-12"
                                          data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                                          style="height:30px; appearance: none; background-image: url('');" disabled
                                          [(ngModel)]="purchaseOrder.vendorId">
                                          <option [value]=" vendor.id" *ngFor="let vendor of vendors;let i=index;">
                                            {{vendor.name}}
                                          </option>
                                        </select>
                                      </td>

                                      <td title="Set Approval Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        class="text-center fs-12 v-align-middle">
                                        <select name="status" class="form-select border-radius-4 border fs-12" size="1"
                                          disabled style="height:30px; appearance: none; background-image: url('');"
                                          [(ngModel)]="purchaseOrder.status">
                                          <option value="0" selected>Not Submitted</option>
                                          <option value="1" style="color:green">For Approval</option>
                                          <option value="2" style="color:red">Rejected</option>
                                          <option value="3" style="color:blue">Approved</option>
                                        </select>
                                      </td>

                                      <td title="Set Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                        class="text-center fs-12 v-align-middle">
                                        <select name="purchaseStatus" class="form-select border-radius-4 border fs-12"
                                          style="height:30px;" size="1"
                                          (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                          *ngIf="purchaseOrder.status == 3" [(ngModel)]="purchaseOrder.purchaseStatus">
                                          <option value="0" selected>No Status</option>
                                          <option value="1">Ordered</option>
                                          <option value="2">Received</option>
                                          <option value="3">Returned</option>
                                          <option value="4">Wrong Part</option>
                                        </select>
                                      </td>
                                      <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)"><select name="grade"
                                          style="height:30px; appearance: none; background-image: url('');"
                                          class="form-select h-48 border px-3 border-radius-8 fs-12" size="1" disabled
                                          [(ngModel)]="purchaseOrder.grade">
                                          <option value="undefined" disabled selected>Select Grade</option>
                                          <option value="A">A</option>
                                          <option value="B">B</option>
                                          <option value="C">C</option>
                                          <option value="Used">Used</option>
                                          <option value="New">New</option>
                                          <option value="Insurance">Insurance</option>
                                        </select></td>


                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        ${{purchaseOrder.salePrice}}
                                      </td>
                                      <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                        data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                        (click)=" editPurchaseOrder(purchaseOrder, i)">
                                        {{purchaseOrder.createdAt |
                                        date: 'MM/dd/yyyy'}} </td>
                                      <td class="p-2 text-center  v-align-middle fs-12">

                                        <ng-container *ngFor="let user of users;let i=index;">
                                          <span *ngIf="user.id == purchaseOrder.userId">
                                            {{(user.firstName + " " + user.lastName) | shortName:2}}
                                          </span>
                                        </ng-container>


                                      </td>
                                      <td class="text-center fs-12 v-align-middle">
                                        <div class="d-flex gap-1">
                                          <button class="btn btn-outline-danger btn-sm"
                                            (click)="editPurchaseOrder(purchaseOrder, i)"
                                            *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                            (click)="deletePurchaseOrderClaim(purchaseOrder, i, claim)">
                                            <i class="fa fa-trash"></i>
                                          </button>

                                          <button class="btn btn-outline-warning btn-sm"
                                            *ngIf="purchaseOrder.status ==0" title="Submit for Approval"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-right"></i>
                                          </button>

                                          <button class="btn btn-outline-warning btn-sm"
                                            *ngIf="purchaseOrder.status ==2" title="Re-Submit for Approval"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-right"></i>
                                          </button>

                                          <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==1"
                                            title="Reject It"
                                            (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-ban"></i>
                                          </button>

                                          <button class="btn btn-outline-success btn-sm"
                                            *ngIf="purchaseOrder.status ==1" title="Approve It"
                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-check-square"></i>
                                          </button>

                                          <button class="btn btn-outline-danger btn-sm" *ngIf="purchaseOrder.status ==3"
                                            title="Un-Approve It"
                                            (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                            [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                            <i class="fa fa-arrow-left"></i>
                                          </button>

                                          <button class="btn btn-warning btn-sm" *ngIf="purchaseOrder.status == 3"
                                            [disabled]="user.allowAddUpdateAutopart == false" title="Add Parts"
                                            (click)="addAutopartToPurchaseOrder( claim, purchaseOrder)"><i
                                              class="fa fa-plus"></i></button>

                                        </div>
                                      </td>
                                    </tr>

                                    <ng-container *ngIf="purchaseOrder.autoparts.length> 0 ">
                                      <tr>
                                        <!-- <td></td> -->
                                        <td class="text-center fs-14 v-align-middle opacity-50"><i
                                            class="fa-solid fa-tools"></i>
                                        </td>
                                        <td colspan="11" cdkDropList
                                          (cdkDropListDropped)="droppedAutoprtsPurchaseOrder($event, purchaseOrder)">


                                          <table
                                            class="table-bordered table-sm overflow-hidden shadow line-height-100 w-100">
                                            <thead>
                                              <tr class="fs-12 text-center bg-warning v-align-middle text-white mw-50">
                                                <th class="fs-12 text-center  mw-50"
                                                  (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                  title="Sort By Most Recent">
                                                  #
                                                </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                  title="Sort By Most Recent">Image</th>

                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('title', purchaseOrder)"
                                                  title="Sort By Parts Name"> Name </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)=" sortListAutopartsPurchaseOrder('partNumber', purchaseOrder)"
                                                  title="Sort By Parts Number"> Parts # </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)=" sortListAutopartsPurchaseOrder('description', purchaseOrder)"
                                                  title="Sort By Description"> Desc </th>

                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('purchaseStatus', purchaseOrder)"
                                                  title="Sort By Status"> Status </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('grade', purchaseOrder)"
                                                  title="Sort By Grade">
                                                  Grade
                                                </th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('salePrice', purchaseOrder)"
                                                  title="Sort By Price"> Price</th>
                                                <th class="fs-12 text-center  mw-100"
                                                  (click)="sortListAutopartsPurchaseOrder('createdAt', purchaseOrder)"
                                                  title="Sort By Date"> Created <i class="fa-solid fa-clock"></i></th>
                                                <th class="fs-14 text-center mw-50"><i class="fa-solid fa-user"></i>
                                                </th>
                                                <th class="fs-12 text-center  mw-100">Action</th>
                                              </tr>
                                            </thead>
                                            <ng-container
                                              *ngFor="let autopart of purchaseOrder.autoparts; let i = index;  let even=even">
                                              <tr id="{{vehicle.id}}" (click)="editAutopart(autopart, i)" title=""
                                                class="cursor-pointer"
                                                [style.background-color]="i == cindexAutpartPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)"
                                                  [cdkDragDisabled]="isMobile==true" cdkDrag> {{autopart.id}}
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" (mouseover)="hover = vehicle"
                                                  (mouseleave)="hover = null"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <div class="overflow-hidden hover-img transition rounded-1 border">
                                                    <img
                                                      *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                      src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                      height="40" width="100" alt="Image"
                                                      class="object-fill rounded-1 w-100" />
                                                  </div>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75"
                                                    style="display: inline-block; word-break: break-word;">
                                                    {{autopart.title}}</p>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75"
                                                    style="display: inline-block; word-break: break-word;">
                                                    {{autopart.partNumber}}</p>
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails"
                                                  title="Click to view details. Drag and drop index number to change the order"
                                                  (click)=" editAutopart(autopart, i)">
                                                  <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                                -webkit-box-orient: vertical;
                                                -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                                 overflow: hidden;"> {{autopart.description}}
                                                    <ng-container *ngIf="autopart.purchaseStatus==1"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==2"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==3"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.purchaseStatus==4"> <br>
                                                      <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                        date: 'MM/dd/yyyy'}}</span> <br>
                                                      <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                        date: 'MM/dd/yyyy'}}</span>
                                                    </ng-container>
                                                  </p>
                                                </td>

                                                <td title="Set Status" (click)=" editAutopart(autopart, i)"
                                                  class="text-center fs-12 v-align-middle"><select name="purchaseStatus"
                                                    class="form-select border-radius-4 border fs-12" size="1"
                                                    (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                    [(ngModel)]="autopart.purchaseStatus">
                                                    <option value="0" selected>No Status</option>
                                                    <option value="1">Ordered</option>
                                                    <option value="2">Received</option>
                                                    <option value="3">Returned</option>
                                                    <option value="4">Wrong Part</option>
                                                  </select></td>
                                                <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"><select name="grade" style=" appearance: none;
                                            background-image: url('');"
                                                    class="form-select border px-3 border-radius-8 fs-12" size="1"
                                                    disabled [(ngModel)]="autopart.grade">
                                                    <option value="undefined" disabled selected>Select Grade</option>
                                                    <option value="A">A</option>
                                                    <option value="B">B</option>
                                                    <option value="C">C</option>
                                                    <option value="Used">Used</option>
                                                    <option value="New">New</option>
                                                    <option value="Insurance">Insurance</option>
                                                  </select></td>


                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"> ${{autopart.salePrice}}
                                                </td>
                                                <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                  data-bs-target="#partDetails" title="Click to view details"
                                                  (click)=" editAutopart(autopart, i)"> {{autopart.createdAt |
                                                  date: 'MM/dd/yyyy'}} </td>
                                                <td class="p-2 text-center fs-12  v-align-middle">


                                                  <ng-container *ngFor="let user of users;let i=index;">
                                                    <span *ngIf="user.id == autopart.userId">
                                                      {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                    </span>
                                                  </ng-container>


                                                </td>
                                                <td class="text-center fs-12 v-align-middle">
                                                  <div class="d-flex gap-2">
                                                    <button class="btn btn-outline-danger btn-sm"
                                                      (click)="editAutopart(autopart, i)"
                                                      *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                      (click)="deleteAutopartPurchaseOrder(autopart, i, purchaseOrder)">
                                                      <i class="fa fa-trash"></i>
                                                    </button>
                                                    <button class="btn btn-outline-warning btn-sm"
                                                      (click)="editAutopart(autopart, i)"
                                                      *ngIf="this.user.allowAddUpdateAutopart == true"
                                                      data-bs-toggle="modal" data-bs-target="#editPart"><i
                                                        class="fa fa-edit"></i> </button>
                                                  </div>
                                                </td>
                                              </tr>
                                            </ng-container>
                                          </table>



                                        </td>
                                      </tr>
                                    </ng-container>

                                  </ng-container>
                                </table>

                              </td>
                            </tr>
                          </ng-container>

                          <ng-container *ngIf="claim.createJobOrder == true && claim.jobs.length> 0">
                            <tr>
                              <!-- <td></td> -->
                              <td class="text-center fs-14 v-align-middle opacity-50"><i class="fas fa-user"></i></td>
                              <td colspan="9">
                                <ng-container>
                                  <table class="table-bordered table-sm overflow-hidden shadow  line-height-100 w-100"
                                    cdkDropList (cdkDropListDropped)="droppedJobsClaim($event, claim)">
                                    <thead>

                                      <tr>
                                        <th class="fs-12 text-center bg-info text-white" style="width:50px">JO #</th>
                                        <th class="fs-12 text-center bg-info text-white mw-100">Job Order Name</th>
                                        <th class="fs-12 text-center bg-info text-white" style="min-width:150px">
                                          Instruction
                                        </th>
                                        <th class="fs-12 text-center bg-info text-white mw-100" style="width:100px">
                                          Assigned
                                          To</th>
                                        <th class="fs-12 text-center bg-info text-white" style="width:100px">$
                                        </th>
                                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                        <th class="fs-12 text-center bg-info text-white mw-100">Target</th>
                                        <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                        <th class="fs-12 text-center bg-info text-white " style="width:50px">Status
                                        </th>
                                        <th class="fs-12 text-center bg-info text-white mw-50"><i
                                            class="fa-solid fa-user"></i></th>
                                        <th class="fs-12 text-center bg-info text-white mw-100">Action</th>
                                      </tr>
                                    </thead>
                                    <tbody>

                                      <tr (click)="setJobId(job.id)" *ngFor="let job of claim.jobs; let i=index">
                                        <td class="text-center fs-12 v-align-middle" [cdkDragDisabled]="isMobile==true"
                                          cdkDrag>
                                          {{job.id}}
                                        </td>
                                        <td class="text-center fs-12 v-align-middle">
                                          <input placeholder="Enter Job Name" [(ngModel)]="job.name" maxlength="50"
                                            (keyup.enter)="onEnter('job name',job)" type="text"
                                            [disabled]="job.paidWeek> 0"
                                            class="form-control h-40 border-radius-4 border" />
                                        </td>
                                        <td class="text-center fs-12 v-align-middle"><textarea type="text" rows="1"
                                            [(ngModel)]="job.notes" class="form-control my-2" maxlength="200"
                                            (keyup.enter)="onEnter('job notes',job)" title="Job Instruction"
                                            [disabled]="job.paidWeek> 0"
                                            oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                        </td>

                                        <td class="text-center fs-12 v-align-middle"><select
                                            class="form-select border-radius-4 h-40 border fs-12 "
                                            [(ngModel)]="job.employeeId" #device [disabled]="job.paidWeek> 0"
                                            style="height:30px;"
                                            (change)="onChangeEmployee2Claim($event, device.value, job, claim)">
                                            <option value="0" disabled selected>Select Employee</option>
                                            <option [value]="employee.id"
                                              [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                              *ngFor="let employee of employees;let i=index;">{{employee.firstName}}
                                              {{employee.lastName}}
                                              ( {{employee.roleName}},{{employee.rolePrecentage}}% <ng-container
                                                *ngIf="employee.commissionBased == true">
                                                - <span class="fw-700 text-danger">Commission Based</span>
                                              </ng-container>)
                                              [{{
                                              employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                              +
                                              employee.jobCountsFinished}}]
                                            </option>
                                          </select></td>
                                        <td class="text-center fs-12 v-align-middle"><input
                                            placeholder="Enter Job Value" [(ngModel)]="job.price" maxlength="50"
                                            class="fs-12" (keyup.enter)="onEnter('job price',job)" type="number"
                                            [disabled]="job.paidWeek> 0"
                                            class="form-control border h-40 border-radius-4" />
                                        </td>

                                        <td class="text-center fs-12 v-align-middle"><input *ngIf="job.employeeId > 0"
                                            (change)="onChangeCalendar($event, job)"
                                            max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                            [disabled]="job.paidWeek> 0" [ngModel]="job.targetDate |  date:'yyyy-MM-dd'"
                                            title="Target Date" type="date"
                                            class="form-control border h-40 border-radius-4" /></td>

                                        <td class="p-2 text-center v-align-middle">
                                          <div class="form-check text-center pt-2">
                                            <input trimText class="form-check-input mx-auto mt-0" type="checkbox"
                                              [disabled]="job.paidWeek> 0"
                                              *ngIf="job.employeeId > 0 && job.targetDate != null"
                                              [checked]="isJobChecked(job)" (change)="updateJobStatus(job)" />
                                          </div>
                                        </td>
                                        <td class="p-2 text-center  v-align-middle fs-12">

                                          <ng-container *ngFor="let user of users;let i=index;">
                                            <span *ngIf="user.id == job.userId">
                                              {{(user.firstName + " " + user.lastName) | shortName:2}}
                                            </span>
                                          </ng-container>




                                        </td>
                                        <td class="text-center fs-12 v-align-middle">
                                          <div class="d-flex align-items-center justifyc-ntent-center gap-1">
                                            <button class="btn btn-outline-danger btn-sm" title="Remove"
                                              [disabled]="job.paidWeek> 0" (click)="deleteVehicleJobClaim(null, job)"><i
                                                class="fa fa-trash"></i></button>
                                            <button class="btn btn-outline-primary btn-sm" title="Save"
                                              [disabled]="job.paidWeek> 0" (click)="saveJobNotes(job)"><i
                                                class="fa fa-save"></i></button>
                                            <button class="btn btn-outline-dark btn-sm" title="Print"
                                              (click)="setJobId(job.id)"
                                              (click)="printPageJob('print-content-job', 'jobs', job)">
                                              <i class="fa fa-print"></i>
                                            </button>
                                          </div>
                                        </td>
                                      </tr>

                                    </tbody>
                                  </table>
                                </ng-container>

                              </td>
                            </tr>


                          </ng-container>


                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Name</label>
                <input trimText class="form-control h-48 px-3 border-radius-0" type="text" required
                  placeholder="Enter Parts name" #purchseOrderName="ngModel"
                  [ngClass]="{ 'is-invalid': purchseOrderName.errors }" minlength="2" maxlength="50"
                  [(ngModel)]="selectedPurchaseOrder.title" />
                <div class="invalid-feedback" *ngIf="purchseOrderName.errors "> <span
                    *ngIf="purchseOrderName.errors['required']">Parts Name
                    is
                    required</span> <span *ngIf="purchseOrderName.errors['minlength']">Parts Name must be at least 2
                    characters</span> <span *ngIf="purchseOrderName.errors['maxlength']">Parts Name must be at most 50
                    characters</span> </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Number</label>
                <div class="input-group">
                  <input trimText class="form-control h-48 px-3 border-radius-0" type="text"
                    placeholder="Enter Parts Number" #purchseOrderPartNumber="ngModel"
                    [ngClass]="{ 'is-invalid': purchseOrderPartNumber.errors }" minlength="2" maxlength="50"
                    [(ngModel)]="selectedPurchaseOrder.partNumber" name="partInfo" />
                  <!-- <div class="input-group-append">
                  <button class="btn btn-outline-secondary" type="button" title="AI Search"
                    (click)="aiSearchPartNumber(selectedPurchaseOrder )"><i class="fa fa-search"></i></button>
                </div> -->
                </div>
                <div class="invalid-feedback" *ngIf="purchseOrderPartNumber.errors "> <span
                    *ngIf="purchseOrderPartNumber.errors['required']">Parts Number is required</span> <span
                    *ngIf="purchseOrderPartNumber.errors['minlength']">Parts Number must be at least 2
                    characters</span>
                  <span *ngIf="purchseOrderPartNumber.errors['maxlength']">Parts Number must be at most 50
                    characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-12">
              <div class="mt-4 pt-1">
                <label for="description" class="form-label fs-14 fw-400 mb-3">Parts Description</label>
                <textarea class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Enter Description"
                  #purChaseOrderDescription="ngModel" style="line-height: 2;"
                  [ngClass]="{ 'is-invalid': purChaseOrderDescription.errors }" minlength="2" rows="2" maxlength="2000"
                  required [(ngModel)]="selectedPurchaseOrder.description" name="description"></textarea>
                <div class="invalid-feedback" *ngIf="purChaseOrderDescription.errors "> <span
                    *ngIf="purChaseOrderDescription.errors['required']">Part Description is required</span> <span
                    *ngIf="purChaseOrderDescription.errors['minlength']">Part Description must be at least 2
                    characters</span> <span *ngIf="purChaseOrderDescription.errors['maxlength']">Part Descripton must
                    be
                    at most
                    2000
                    characters</span> </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="source" class="form-label fs-14 fw-400 mb-3">Source URL</label>
                <div class="input-group">
                  <input trimText [disabled]="user.allowAddUpdateAutopart == false" maxlength="200"
                    [(ngModel)]="selectedPurchaseOrder.source" class="form-control h-48 px-3" type="text" name="source"
                    placeholder="Enter Sourc URL" />
                  <div class="input-group-append" *ngIf="selectedPurchaseOrder.source != ''">
                    <button class="btn btn-outline-secondary" type="button"
                      (click)="openSourceLink(selectedPurchaseOrder.source)"><i class="fa fa-link"></i></button>
                  </div>
                </div>
              </div>
            </div>
            <!-- <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="vendor" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                  title="Click to go to Configuration" [routerLink]="'/vendors'"
                  class="form-label fs-14 fw-400 mb-3">Vendor</label>
                <select class="form-select h-48 px-3 border-radius-8" name="vendor"
                  [(ngModel)]="selectedPurchaseOrder.vendorId" [disabled]="user.allowAddUpdateAutopart == false"
                  #vendor="ngModel" required [ngClass]="{ 'is-invalid': vendor.errors }">
                  <option value="undefined" disabled selected>Select Vendor</option>
                  <option [value]="vendor.id" *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}</option>
                </select>
                <div class="invalid-feedback" *ngIf="vendor.errors">
                  <span *ngIf="vendor.errors['required']">Vendor is required</span>
                </div>
              </div>
            </div> -->
            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="vendor" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                  title="Click to go to Configuration" [routerLink]="'/vendors'"
                  class="form-label fs-14 fw-400 mb-3">Vendor</label>
                <select class="form-select h-48 px-3 border-radius-8" name="vendor"
                  [(ngModel)]="selectedPurchaseOrder.vendorId" [disabled]="user.allowAddUpdateAutopart == false"
                  #vendor="ngModel" required [ngClass]="{ 'is-invalid': vendor.errors }">
                  <option value="undefined" disabled selected>Select Vendor</option>
                  <option [value]="vendor.id" *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}</option>
                </select>
                <div class="invalid-feedback" *ngIf="vendor.errors">
                  <span *ngIf="vendor.errors['required']">Vendor is required</span>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Comments</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Enter Comments"
                  #purchseOrderComments="ngModel" [ngClass]="{ 'is-invalid': purchseOrderComments.errors }"
                  minlength="2" maxlength="500" [(ngModel)]="selectedPurchaseOrder.comments" name="comments" />
                <div class="invalid-feedback" *ngIf="purchseOrderComments.errors ">

                  <span *ngIf="purchseOrderComments.errors['minlength']">Parts Comments must be at least 2
                    characters</span>
                  <span *ngIf="purchseOrderComments.errors['maxlength']">Parts Comments must be at most 500
                    characters</span>
                </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="grade" class="form-label fs-14 fw-400 mb-3">Grade</label>
                <select name="grade" class="form-select h-48 px-3 border-radius-8" size="1"
                  [(ngModel)]="selectedPurchaseOrder.grade" required #purchseOrderGrade="ngModel" required
                  [ngClass]="{ 'is-invalid': purchseOrderGrade.errors }">
                  <option value="undefined" disabled selected>Select Grade</option>
                  <option value="A">A</option>
                  <option value="B">B</option>
                  <option value="C">C</option>
                  <option value="Used">Used</option>
                  <option value="New">New</option>
                  <option value="Insurance">Insurance</option>
                </select>
                <div class="invalid-feedback" *ngIf="purchseOrderGrade.errors "> <span
                    *ngIf="purchseOrderGrade.errors['required']">Grade is
                    required</span> </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="price" class="form-label fs-14 fw-400 mb-3">Price ($)</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" type="number" placeholder="Enter Price"
                  #purchseOrderSalePrice="ngModel" [ngClass]="{ 'is-invalid': purchseOrderSalePrice.errors }"
                  minlength="1" maxlength="10" onKeyPress="if(this.value.length==10) return false" maxlength="10"
                  required oninput="if(this.value<0)this.value=this.value * -1"
                  [(ngModel)]="selectedPurchaseOrder.salePrice" name="price" />
                <div class="invalid-feedback" *ngIf="purchseOrderSalePrice.errors "> <span
                    *ngIf="purchseOrderSalePrice.errors['required']">Price
                    is required</span> <span *ngIf="purchseOrderSalePrice.errors['minlength']">Price must be at least
                    1
                    characters</span> <span *ngIf="purchseOrderSalePrice.errors['maxlength']">Price must be at most 10
                    characters</span> </div>
              </div>
            </div>

            <div class="col-lg-6">
              <div class="mt-4 pt-1">
                <label for="Approval status" class="form-label fs-14 fw-400 mb-3">Approval Status</label>
                <select name="status" class="form-select border-radius-4 border" size="1" disabled
                  style=" appearance: none; background-image: url('');" [(ngModel)]="selectedPurchaseOrder.status">
                  <option value="0" selected>Not Submitted</option>
                  <option value="1" style="color:green">For Approval</option>
                  <option value="2" style="color:red">Rejected</option>
                  <option value="3" style="color:blue">Approved</option>
                </select>
              </div>
            </div>


            <div class="col-12" *ngIf="selectedPurchaseOrder.status == 1">
              <div class="mt-4 pt-1">
                <label for="Rejection" class="form-label fs-14 fw-400 mb-3">Reject Reason</label>
                <input trimText class="form-control h-48 px-3 border-radius-0" type="text" required
                  placeholder="Enter Parts name" #purchseOrderShipping="ngModel"
                  [ngClass]="{ 'is-invalid': purchseOrderShipping.errors }" minlength="2" maxlength="50"
                  [(ngModel)]="selectedPurchaseOrder.shipping" />
                <div class="invalid-feedback" *ngIf="purchseOrderShipping.errors "> <span
                    *ngIf="purchseOrderShipping.errors['required']">Reject Reason
                    is required</span> <span *ngIf="purchseOrderShipping.errors['minlength']">Reject Reason must be at
                    least 2
                    characters</span> <span *ngIf="purchseOrderShipping.errors['maxlength']">Reject Reason must be at
                    most
                    50
                    characters</span> </div>
              </div>
            </div>

            <div class="col-12" *ngIf="selectedPurchaseOrder.id >0">
              <div class="row">


                <div class="col-6 alert alert-primary mt-1"><i class="fa-solid fa-clock"></i>:
                  {{ selectedPurchaseOrder.createdAt | date: 'MM/dd/yyyy, HH:mm'}} by

                  <ng-container *ngFor="let user of users;let i=index;">
                    <span *ngIf="user.id == selectedPurchaseOrder.userId">
                      {{(user.firstName + " " + user.lastName) | shortName:2}}
                    </span>
                  </ng-container>

                </div>


                <div class="col-6 alert alert-success mt-1" *ngIf="selectedPurchaseOrder.submittedAt != null">
                  Submitted At: {{ selectedPurchaseOrder.submittedAt | date: 'MM/dd/yyyy': 'MM/dd/yyyy, HH:mm'}}
                  by

                  <ng-container *ngFor="let user of users;let i=index;">
                    <span *ngIf="user.id == selectedPurchaseOrder.submittedBy">
                      {{(user.firstName + " " + user.lastName) | shortName:2}}
                    </span>
                  </ng-container>


                </div>

                <div class="col-6 alert alert-danger mt-1" *ngIf="selectedPurchaseOrder.rejectedAt !=null">
                  Rejected At: {{
                  selectedPurchaseOrder.rejectedAt | date: 'MM/dd/yyyy': 'MM/dd/yyyy, HH:mm'}} by

                  <ng-container *ngFor="let user of users;let i=index;">
                    <span *ngIf="user.id == selectedPurchaseOrder.rejectedBy">
                      {{(user.firstName + " " + user.lastName) | shortName:2}}
                    </span>
                  </ng-container>


                </div>

                <div class="col-6 alert alert-success mt-1"
                  *ngIf="selectedPurchaseOrder.approvedAt !=null && selectedPurchaseOrder.status==3">
                  Approved At: {{selectedPurchaseOrder.approvedAt | date: 'MM/dd/yyyy': 'MM/dd/yyyy, HH:mm'}} by

                  <ng-container *ngFor="let user of users;let i=index;">
                    <span *ngIf="user.id == selectedPurchaseOrder.approvedBy">
                      {{(user.firstName + " " + user.lastName) | shortName:2}}
                    </span>
                  </ng-container>


                </div>

              </div>
            </div>

            <div class="col-md-12" *ngIf="errorMessagePurchaseOrder !=''">
              <div class="alert alert-danger mt-4">{{ errorMessagePurchaseOrder}}</div>
            </div>
            <div class="col-md-12">
              <div class="mt-4 pt-1">
                <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600 mr-3"
                  (click)="savePurchaseOrder()">
                  Save
                  Info</button>

                <button class="btn btn-outline-warning h-45 px-4 rounded-4 fs-14 fw-600 mr-3"
                  *ngIf="selectedPurchaseOrder.status ==0 && user.allowAddUpdatePurchaseOrder==true"
                  (click)="setPurhaseOrderStatus(1)">Submit For
                  Approval</button>


                <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600 mr-3"
                  *ngIf="selectedPurchaseOrder.status ==1  && user.allowAddUpdatePurchaseOrder ==true"
                  (click)="setPurhaseOrderStatus(0)">Un-submitted for Approval</button>

                <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600 mr-3"
                  *ngIf="selectedPurchaseOrder.status ==2 && user.allowAddUpdatePurchaseOrder==true"
                  (click)="setPurhaseOrderStatus(1)">Re-Submit For
                  Approval</button>

                <button class="btn btn-outline-danger h-45 px-4 rounded-4 fs-14 fw-600 mr-3"
                  *ngIf="selectedPurchaseOrder.status ==1  && user.allowApproveRejectPurchaseOrder ==true"
                  (click)="setPurhaseOrderStatus(2)">Reject It</button>

                <button class="btn btn-outline-success h-45 px-4 rounded-4 fs-14 fw-600 mr-3"
                  *ngIf="selectedPurchaseOrder.status ==1  && user.allowApproveRejectPurchaseOrder ==true "
                  (click)="setPurhaseOrderStatus(3)">Approval It</button>

                <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600 mr-3"
                  *ngIf="selectedPurchaseOrder.status ==3  && user.allowApproveRejectPurchaseOrder ==true "
                  (click)="setPurhaseOrderStatus(1)">Un-Approval It</button>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="editPart" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="editPartLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content border-radius-8">
        <div class="modal-header p-4">
          <h1 class="modal-title fs-20 fw-600 text-capitalize" id="editPartLabel"
            style="display: inline-block; word-break: break-word;">Edit [{{selectedAutopart.title
            }}] <span class="text-danger">[{{selectedAutopart.id}}]</span> FOR {{
            selectedAutopart.year }} {{ selectedAutopart.make }} {{selectedAutopart.model }}
          </h1>
          <button type="button" (click)="backToListing()" class="btn-close mt-1" data-bs-dismiss="modal"
            aria-label="Close"></button>
        </div>
        <div class="modal-body px-2 submit-form" *ngIf="currentUser">
          <div class="modal-body px-2 submit-form">
            <div class="row" *ngIf="selectedAutopart.claimId > 0">
              <div class="col-12">
                <div class="row">
                  <h2 class="fs-20 pt-1 fw-700">Estimate ID - <span class="text-danger"
                      titile="Estimate Id">[{{selectedAutopart.claimId}}]</span></h2>
                  <h2 class="fs-20 pt-1 fw-700">Purchase Order ID - <span class="text-danger"
                      titile="Purchase Order Id">[{{selectedAutopart.purchaseOrderId}}]</span></h2>
                  <div class="pt-1">
                    <div class="col-12 p-3 border bg-white border-radius-8 shadow">
                      <div class="table-responsive jobs-table bg-white border-radius-8 shadow">
                        <table class="table table-bordered table-sm">
                          <thead>
                            <tr>
                              <!-- <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120" style="width: 150px;">Item Name</th> -->
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"
                                style="width: 50px;">#</th>
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"
                                title="Click to go to Configuration" [routerLink]="'/item-types'"
                                style="width:120px; cursor: pointer; ">Item Type</th>
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle">Estimate Item
                                Description
                              </th>

                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle w-10"
                                style="width: 50px;">
                                Quantity</th>
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-120"><i
                                  class="fa-solid fa-dollar-sign"></i></th>

                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                style="width: 100px;">Subtotal</th>
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                style="width: 120px;"><i class="fa-solid fa-clock"></i>
                              </th>
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-100"
                                style="width: 120px;">Locked <i class="fa-solid fa-clock"></i></th>
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle mw-50"><i
                                  class="fa-solid fa-user"></i></th>
                              <th class="bg-secondary p-4 fs-13 text-center text-white v-align-middle"
                                style="width:100px;">
                                Action</th>
                            </tr>


                          </thead>
                          <tbody class="readonly">

                            <tr (click)="setClaimId(claim.id)" class="shadow"
                              [style.background-color]="claim.id == currentClaimId? '#FFF3CD' : (true ? 'white' : 'white')">

                              <td class="fs-13 fw-700  p-2 text-center v-align-middle"
                                title="Drag and drop index number to change the order"
                                [cdkDragDisabled]="isMobile==true" cdkDrag>
                                <span class="fs-15 fw-700 text-danger">{{claim.id}}</span>
                              </td>
                              <td class="p-2 text-center">
                                <select class="form-select h-48 px-3 border-radius-8 "
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                  (change)="onEnterClaimClaim('item type',claim)" [(ngModel)]="claim.itemType">
                                  <option value="0" disabled selected>Select Type</option>
                                  <option value="0" *ngIf="claim.itemType>0">Un-select Type</option>
                                  <option [value]="itemType.id" *ngFor="let itemType of itemTypes;let i=index;">
                                    {{itemType.name}}
                                  </option>
                                </select>
                              </td>
                              <td class="fs-13 p-2"><textarea [(ngModel)]="claim.notes" class="form-control"
                                  placeholder="Please Specify" (keyup.enter)="onEnterClaim('notes',claim)" rows="1"
                                  oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'
                                  maxlength="200"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"></textarea>
                              </td>

                              <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('quantity',claim)"
                                  [(ngModel)]="claim.quantity"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                  onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                  class="form-control form-control-sm h-40 border-radius-4" /></td>
                              <td class="fs-13 p-2"><input (keyup.enter)="onEnterClaim('amount',claim)"
                                  [(ngModel)]="claim.amount"
                                  [disabled]="user.allowAddUpdateEstimate == false || claim.status==1"
                                  onKeyPress="if(this.value.length==10) return false" pattern="[0-9]" type="number"
                                  class="form-control form-control-sm h-40 border-radius-4" /></td>

                              <td class="fs-13 p-2 text-center v-align-middle">${{getClaimSubTotal(claim)}}</td>
                              <td class="fs-13 p-2 text-center v-align-middle">
                                {{claim.createdAt | date: 'MM/dd/yyyy'}}
                              </td>
                              <td class="fs-13  p-2 text-center v-align-middle"><span
                                  *ngIf="claim.status==1">{{claim.lockedAt |
                                  date }}</span></td>
                              <td class="p-2 text-center  v-align-middle">

                                <ng-container *ngFor="let user of users;let i=index;">
                                  <span *ngIf="user.id == claim.userId">
                                    {{(user.firstName + " " + user.lastName) | shortName:2}}
                                  </span>
                                </ng-container>


                              </td>
                              <td class="p-2 text-center">
                                <div class="d-flex align-items-center justifyc-cntent-center gap-1">
                                  <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==1"
                                    [disabled]="user.allowUnlockEstimate == false" title="Unlock this estimate item"
                                    (click)="lockClaim('unlock', claim)"><i class="fa fa-lock-open"></i></button>
                                  <button class="btn btn-outline-success btn-sm" *ngIf="claim.status==0"
                                    [disabled]="user.allowLockEstimate == false" title="Lock this estimate item"
                                    (click)="lockClaim('lock', claim)"><i class="fa fa-lock"></i></button>
                                  <button class="btn btn-outline-danger btn-sm"
                                    [disabled]="user.allowAddUpdateEstimate == false" title="Delete"
                                    (click)="deleteVehicleClaim(null, claim)"><i class="fa fa-trash"></i></button>
                                  <button class="btn btn-outline-success btn-sm"
                                    [disabled]="user.allowAddUpdateEstimate == false || claim.status==1" title="Save"
                                    (click)="onEnterClaimClaim('update', claim)"><i class="fa fa-save"></i></button>

                                  <button class="btn btn-navy btn-sm" *ngIf="claim.createPurchaseOrder == true"
                                    [disabled]="user.allowAddUpdatePurchaseOrder == false" title="Add Purchase Order"
                                    (click)="addPurchaseOrderToClaim( claim)"><i class="fa fa-plus"></i></button>

                                  <button class="btn btn-info btn-sm" *ngIf="claim.createJobOrder == true"
                                    [disabled]="user.allowAddService == false" title="Add Job Order"
                                    (click)="addJobToClaim( claim)"><i class="fa fa-plus"></i></button>


                                </div>
                              </td>
                            </tr>

                            <ng-container *ngIf="claim.createPurchaseOrder == true && claim.purchaseOrders.length> 0 ">
                              <tr>
                                <!-- <td></td> -->
                                <td class="text-center fs-14 v-align-middle opacity-50"><i
                                    class="fa-solid fa-cart-shopping"></i></td>
                                <td colspan="9" cdkDropList
                                  (cdkDropListDropped)="droppedPurchaseOrdersClaim($event, claim)">

                                  <table class="table-bordered table-sm shadow overflow-hidden  line-height-100 w-100"
                                    *ngIf="claim.purchaseOrders.length >0">
                                    <thead>
                                      <tr>
                                        <th class="fs-12 text-center bg-navy text-white mw-50"
                                          (click)="sortListPurchseOrdersClaim('id',claim.purchaseOrders)"
                                          title="Sort By Most Recent">
                                          PO #
                                        </th>


                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                          (click)="sortListPurchseOrdersClaim('title',claim.purchaseOrders)"
                                          title="Sort By Item Name"> PO Item Name </th>
                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                          (click)="sortListPurchseOrdersClaim('partNumber',claim.purchaseOrders)"
                                          title="Sort By Parts Number"> Parts #
                                        </th>
                                        <th class="fs-12 text-center bg-navy text-white mw-150"
                                          (click)="sortListPurchseOrdersClaim('description',claim.purchaseOrders)"
                                          title="Sort By Description">
                                          Description </th>

                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                          (click)="sortListPurchseOrdersClaim('vendorId',claim.purchaseOrders)"
                                          title="Sort By Most Recent">Vender</th>

                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                          (click)="sortListPurchseOrdersClaim('status',claim.purchaseOrders)"
                                          title="Sort By Status">Approval</th>

                                        <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                          (click)="sortListPurchseOrdersClaim('purchaseStatus',claim.purchaseOrders)"
                                          title="Sort By Status">Status
                                        </th>
                                        <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                          (click)="sortListPurchseOrdersClaim('grade',claim.purchaseOrders)"
                                          title="Sort By Grade">
                                          Grade
                                        </th>
                                        <th class="fs-12 text-center bg-navy text-white mw-100" style="width:100px"
                                          (click)="sortListPurchseOrdersClaim('salePrice',claim.purchaseOrders)"
                                          title="Sort By Price">Price</th>
                                        <th class="fs-12 text-center bg-navy text-white mw-100"
                                          (click)="sortListPurchseOrdersClaim('createdAt',claim.purchaseOrders)"
                                          title="Sort By Date"><i class="fa-solid fa-clock"></i></th>
                                        <th class="fs-12 text-center bg-navy text-white mw-50"><i
                                            class="fa-solid fa-user"></i>
                                        </th>

                                        <th class="fs-12 text-center bg-navy text-white mw-100">Action</th>
                                      </tr>
                                    </thead>
                                    <ng-container
                                      *ngFor="let purchaseOrder of claim.purchaseOrders; let i = index;  let even=even">
                                      <tr id="{{vehicle.id}}" (click)="editPurchaseOrder(purchaseOrder, i)" title=""
                                        style="cursor: pointer;"
                                        [style.background-color]="i == cindexPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                        <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                          data-bs-target="#addNewPurchaseOrder"
                                          title="Drag and drop index number to change the order"
                                          (click)=" editPurchaseOrder(purchaseOrder, i)"
                                          [cdkDragDisabled]="isMobile==true" cdkDrag>

                                          <ng-container *ngIf="selectedAutopart.purchaseOrderId == purchaseOrder.id">
                                            <span class="fs-15 fw-700 text-danger"> {{purchaseOrder.id}}</span>
                                          </ng-container>
                                          <ng-container *ngIf="selectedAutopart.purchaseOrderId != purchaseOrder.id">
                                            {{purchaseOrder.id}}
                                          </ng-container>
                                        </td>

                                        <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                          data-bs-target="#addNewPurchaseOrder"
                                          title="Click to view details. Drag and drop index number to change the order"
                                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                                          <p class="fs-12 text-black opacity-75"
                                            style="display: inline-block; word-break: break-word;">
                                            {{purchaseOrder.title}}</p>
                                        </td>
                                        <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                          data-bs-target="#addNewPurchaseOrder"
                                          title="Click to view details. Drag and drop index number to change the order"
                                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                                          <p class="fs-12 text-black opacity-75"
                                            style="display: inline-block; word-break: break-word;">
                                            {{purchaseOrder.partNumber}}</p>
                                        </td>


                                        <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                          data-bs-target="#addNewPurchaseOrder"
                                          title="Click to view details. Drag and drop index number to change the order"
                                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                                          <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                    -webkit-box-orient: vertical;
                                    -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                     overflow: hidden;"> {{purchaseOrder.description}}
                                            <ng-container *ngIf="purchaseOrder.purchaseStatus==1"> <br>
                                              <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                                date: 'MM/dd/yyyy'}}</span>
                                            </ng-container>
                                            <ng-container *ngIf="purchaseOrder.purchaseStatus==2"> <br>
                                              <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                                date: 'MM/dd/yyyy'}}</span>
                                              <br>
                                              <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                                date: 'MM/dd/yyyy'}}</span>
                                            </ng-container>
                                            <ng-container *ngIf="purchaseOrder.purchaseStatus==3"> <br>
                                              <span class="text-danger">Ordered At: {{ purchaseOrder.orderedAt|
                                                date: 'MM/dd/yyyy'}}</span>
                                              <br>
                                              <span class="text-danger">Received At:{{ purchaseOrder.receivedAt|
                                                date: 'MM/dd/yyyy'}}</span>
                                              <br>
                                              <span class="text-danger">Returned At:{{ purchaseOrder.returnedAt|
                                                date: 'MM/dd/yyyy'}}</span>
                                            </ng-container>
                                          </p>
                                        </td>

                                        <td class="p-2 text-center  v-align-middle fs-12">

                                          <select class="form-select h-48 px-3 border-radius-8 fs-12"
                                            data-bs-toggle="modal" data-bs-target="#addNewPurchaseOrder"
                                            style="height:30px; appearance: none; background-image: url('');" disabled
                                            [(ngModel)]="purchaseOrder.vendorId">
                                            <option [value]=" vendor.id" *ngFor="let vendor of vendors;let i=index;">
                                              {{vendor.name}}
                                            </option>
                                          </select>
                                        </td>

                                        <td title="Set Approval Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                          class="text-center fs-12 v-align-middle">
                                          <select name="status" class="form-select border-radius-4 border fs-12"
                                            size="1" disabled
                                            style="height:30px; appearance: none; background-image: url('');"
                                            [(ngModel)]="purchaseOrder.status">
                                            <option value="0" selected>Not Submitted</option>
                                            <option value="1" style="color:green">For Approval</option>
                                            <option value="2" style="color:red">Rejected</option>
                                            <option value="3" style="color:blue">Approved</option>
                                          </select>
                                        </td>

                                        <td title="Set Status" (click)=" editPurchaseOrder(purchaseOrder, i)"
                                          class="text-center fs-12 v-align-middle">
                                          <select name="purchaseStatus" class="form-select border-radius-4 border fs-12"
                                            style="height:30px;" size="1"
                                            (change)="onChangePurchaseOrderPurchaseStatus($event, purchaseOrder)"
                                            *ngIf="purchaseOrder.status == 3"
                                            [(ngModel)]="purchaseOrder.purchaseStatus">
                                            <option value="0" selected>No Status</option>
                                            <option value="1">Ordered</option>
                                            <option value="2">Received</option>
                                            <option value="3">Returned</option>
                                            <option value="4">Wrong Part</option>
                                          </select>
                                        </td>
                                        <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                          data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                          (click)=" editPurchaseOrder(purchaseOrder, i)"><select name="grade"
                                            style="height:30px; appearance: none; background-image: url('');"
                                            class="form-select h-48 border px-3 border-radius-8 fs-12" size="1" disabled
                                            [(ngModel)]="purchaseOrder.grade">
                                            <option value="undefined" disabled selected>Select Grade</option>
                                            <option value="A">A</option>
                                            <option value="B">B</option>
                                            <option value="C">C</option>
                                            <option value="Used">Used</option>
                                            <option value="New">New</option>
                                            <option value="Insurance">Insurance</option>
                                          </select></td>


                                        <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                          data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                                          ${{purchaseOrder.salePrice}}
                                        </td>
                                        <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                          data-bs-target="#addNewPurchaseOrder" title="Click to view details"
                                          (click)=" editPurchaseOrder(purchaseOrder, i)">
                                          {{purchaseOrder.createdAt |
                                          date: 'MM/dd/yyyy'}} </td>
                                        <td class="p-2 text-center  v-align-middle fs-12">

                                          <ng-container *ngFor="let user of users;let i=index;">
                                            <span *ngIf="user.id == purchaseOrder.userId">
                                              {{(user.firstName + " " + user.lastName) | shortName:2}}
                                            </span>
                                          </ng-container>




                                        </td>
                                        <td class="text-center fs-12 v-align-middle">
                                          <div class="d-flex gap-1">
                                            <button class="btn btn-outline-danger btn-sm"
                                              (click)="editPurchaseOrder(purchaseOrder, i)"
                                              *ngIf=" this.user.allowAddUpdatePurchaseOrder == true"
                                              (click)="deletePurchaseOrderClaim(purchaseOrder, i, claim)">
                                              <i class="fa fa-trash"></i>
                                            </button>

                                            <button class="btn btn-outline-warning btn-sm"
                                              *ngIf="purchaseOrder.status ==0" title="Submit for Approval"
                                              (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                              <i class="fa fa-arrow-right"></i>
                                            </button>

                                            <button class="btn btn-outline-warning btn-sm"
                                              *ngIf="purchaseOrder.status ==2" title="Re-Submit for Approval"
                                              (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(1)"
                                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                              <i class="fa fa-arrow-right"></i>
                                            </button>

                                            <button class="btn btn-outline-danger btn-sm"
                                              *ngIf="purchaseOrder.status ==1" title="Reject It"
                                              (click)="editPurchaseOrder(purchaseOrder, i); setPurhaseOrderStatus(2)"
                                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                              <i class="fa fa-ban"></i>
                                            </button>

                                            <button class="btn btn-outline-success btn-sm"
                                              *ngIf="purchaseOrder.status ==1" title="Approve It"
                                              (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(3)"
                                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                              <i class="fa fa-check-square"></i>
                                            </button>

                                            <button class="btn btn-outline-danger btn-sm"
                                              *ngIf="purchaseOrder.status ==3" title="Un-Approve It"
                                              (click)="editPurchaseOrder(purchaseOrder, i);setPurhaseOrderStatus(1)"
                                              [disabled]="this.user.allowApproveRejectPurchaseOrder == false">
                                              <i class="fa fa-arrow-left"></i>
                                            </button>

                                            <button class="btn btn-warning btn-sm" *ngIf="purchaseOrder.status == 3"
                                              [disabled]="user.allowAddUpdateAutopart == false" title="Add Parts"
                                              (click)="addAutopartToPurchaseOrder( claim, purchaseOrder)"><i
                                                class="fa fa-plus"></i></button>

                                          </div>
                                        </td>
                                      </tr>

                                      <ng-container *ngIf="purchaseOrder.autoparts.length> 0 ">
                                        <tr>
                                          <!-- <td></td> -->
                                          <td class="text-center fs-14 v-align-middle opacity-50"><i
                                              class="fa-solid fa-tools"></i>
                                          </td>
                                          <td colspan="10" cdkDropList
                                            (cdkDropListDropped)="droppedAutoprtsPurchaseOrder($event, purchaseOrder)">


                                            <table
                                              class="table-bordered table-sm overflow-hidden shadow line-height-100 w-100">
                                              <thead>
                                                <tr
                                                  class="fs-12 text-center bg-warning v-align-middle text-white mw-50">
                                                  <th class="fs-12 text-center  mw-50"
                                                    (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                    title="Sort By Most Recent">
                                                    #
                                                  </th>
                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)="sortListAutopartsPurchaseOrder('id', purchaseOrder)"
                                                    title="Sort By Most Recent">Image</th>

                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)="sortListAutopartsPurchaseOrder('title', purchaseOrder)"
                                                    title="Sort By Parts Name"> Name </th>
                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)=" sortListAutopartsPurchaseOrder('partNumber', purchaseOrder)"
                                                    title="Sort By Parts Number"> Parts # </th>
                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)=" sortListAutopartsPurchaseOrder('description', purchaseOrder)"
                                                    title="Sort By Description"> Desc </th>


                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)="sortListAutopartsPurchaseOrder('purchaseStatus', purchaseOrder)"
                                                    title="Sort By Status"> Status </th>
                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)="sortListAutopartsPurchaseOrder('grade', purchaseOrder)"
                                                    title="Sort By Grade">
                                                    Grade
                                                  </th>
                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)="sortListAutopartsPurchaseOrder('salePrice', purchaseOrder)"
                                                    title="Sort By Price"> Price</th>
                                                  <th class="fs-12 text-center  mw-100"
                                                    (click)="sortListAutopartsPurchaseOrder('createdAt', purchaseOrder)"
                                                    title="Sort By Date"> Created <i class="fa-solid fa-clock"></i>
                                                  </th>
                                                  <th class="fs-14 text-center" style="width:150px"><i
                                                      class="fa-solid fa-user"></i></th>
                                                  <th class="fs-12 text-center  mw-100">Action</th>
                                                </tr>
                                              </thead>
                                              <ng-container
                                                *ngFor="let autopart of purchaseOrder.autoparts; let i = index;  let even=even">
                                                <tr id="{{vehicle.id}}" (click)="editAutopart(autopart, i)" title=""
                                                  class="cursor-pointer"
                                                  [style.background-color]="i == cindexAutpartPurchaseOrder? '#eef5fb' : (even ? 'white' : 'white')">
                                                  <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails"
                                                    title="Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i)"
                                                    [cdkDragDisabled]="isMobile==true" cdkDrag>
                                                    <ng-container *ngIf="autopart.id == selectedAutopart.id">
                                                      <span class="fs-15 fw-700 text-danger"> {{autopart.id}}</span>
                                                    </ng-container>
                                                    <ng-container *ngIf="autopart.id != selectedAutopart.id">
                                                      {{autopart.id}}
                                                    </ng-container>

                                                  </td>
                                                  <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails" (mouseover)="hover = vehicle"
                                                    (mouseleave)="hover = null"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i)">
                                                    <div class="overflow-hidden hover-img transition rounded-1 border">
                                                      <img
                                                        *ngIf="autopart.imageModels.length> 0 && autopart.showInSearchImageId > 0"
                                                        src="{{baseUrlResizeImageParts + '/' + autopart.showInSearchImageId}}"
                                                        height="40" width="100" alt="Image"
                                                        class="object-fill rounded-1 w-100" />
                                                    </div>
                                                  </td>
                                                  <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i)">
                                                    <p class="fs-12 text-black opacity-75"
                                                      style="display: inline-block; word-break: break-word;">
                                                      {{autopart.title}}</p>
                                                  </td>
                                                  <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i)">
                                                    <p class="fs-12 text-black opacity-75"
                                                      style="display: inline-block; word-break: break-word;">
                                                      {{autopart.partNumber}}</p>
                                                  </td>
                                                  <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails"
                                                    title="Click to view details. Drag and drop index number to change the order"
                                                    (click)=" editAutopart(autopart, i)">
                                                    <p class="fs-12 text-black opacity-75" style="  display: -webkit-box;
                                                  -webkit-box-orient: vertical;
                                                  -webkit-line-clamp: 4;  /* Number of lines displayed before it truncate */
                                                   overflow: hidden;"> {{autopart.description}}
                                                      <ng-container *ngIf="autopart.purchaseStatus==1"> <br>
                                                        <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                          date: 'MM/dd/yyyy'}}</span> </ng-container>
                                                      <ng-container *ngIf="autopart.purchaseStatus==2"> <br>
                                                        <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                          date: 'MM/dd/yyyy'}}</span> <br>
                                                        <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                          date: 'MM/dd/yyyy'}}</span>
                                                      </ng-container>
                                                      <ng-container *ngIf="autopart.purchaseStatus==3"> <br>
                                                        <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                          date: 'MM/dd/yyyy'}}</span> <br>
                                                        <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                          date: 'MM/dd/yyyy'}}</span> <br>
                                                        <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                          date: 'MM/dd/yyyy'}}</span>
                                                      </ng-container>
                                                      <ng-container *ngIf="autopart.purchaseStatus==4"> <br>
                                                        <span class="text-danger">Ordered At: {{ autopart.orderedAt|
                                                          date: 'MM/dd/yyyy'}}</span> <br>
                                                        <span class="text-danger">Received At:{{ autopart.receivedAt|
                                                          date: 'MM/dd/yyyy'}}</span> <br>
                                                        <span class="text-danger">Returned At:{{ autopart.returnedAt|
                                                          date: 'MM/dd/yyyy'}}</span>
                                                      </ng-container>
                                                    </p>
                                                  </td>
                                                  <!-- <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal" data-bs-target="#partDetails"
                                                  title="Click to view details" (click)=" editAutopart(autopart, i)">
                                                  {{autopart.stocknumber }} </td> -->
                                                  <td title="Set Status" (click)=" editAutopart(autopart, i)"
                                                    class="text-center fs-12 v-align-middle"><select
                                                      name="purchaseStatus"
                                                      class="form-select border-radius-4 border fs-12" size="1"
                                                      (change)="onChangeAutopartPurchaseStatus($event, autopart)"
                                                      [(ngModel)]="autopart.purchaseStatus">
                                                      <option value="0" selected>No Status</option>
                                                      <option value="1">Ordered</option>
                                                      <option value="2">Received</option>
                                                      <option value="3">Returned</option>
                                                      <option value="4">Wrong Part</option>
                                                    </select></td>
                                                  <td data-bs-toggle="modal" class="text-center fs-12 v-align-middle"
                                                    data-bs-target="#partDetails" title="Click to view details"
                                                    (click)=" editAutopart(autopart, i)"><select name="grade" style=" appearance: none;
                                              background-image: url('');"
                                                      class="form-select border px-3 border-radius-8 fs-12" size="1"
                                                      disabled [(ngModel)]="autopart.grade">
                                                      <option value="undefined" disabled selected>Select Grade
                                                      </option>
                                                      <option value="A">A</option>
                                                      <option value="B">B</option>
                                                      <option value="C">C</option>
                                                      <option value="Used">Used</option>
                                                      <option value="New">New</option>
                                                      <option value="Insurance">Insurance</option>
                                                    </select></td>


                                                  <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails" title="Click to view details"
                                                    (click)=" editAutopart(autopart, i)"> ${{autopart.salePrice}}
                                                  </td>
                                                  <td class="text-center fs-12 v-align-middle" data-bs-toggle="modal"
                                                    data-bs-target="#partDetails" title="Click to view details"
                                                    (click)=" editAutopart(autopart, i)"> {{autopart.createdAt |
                                                    date: 'MM/dd/yyyy'}} </td>
                                                  <td class="p-2 text-center fs-12  v-align-middle">

                                                    <ng-container *ngFor="let user of users;let i=index;">
                                                      <span *ngIf="user.id == autopart.userId">
                                                        {{(user.firstName + " " + user.lastName) | shortName:2}}
                                                      </span>
                                                    </ng-container>

                                                  </td>
                                                  <td class="text-center fs-12 v-align-middle">
                                                    <div class="d-flex gap-2">
                                                      <button class="btn btn-outline-danger btn-sm"
                                                        (click)="editAutopart(autopart, i)"
                                                        *ngIf=" this.user.allowAddUpdateAutopart == true"
                                                        (click)="deleteAutopartPurchaseOrder(autopart, i, purchaseOrder)">
                                                        <i class="fa fa-trash"></i>
                                                      </button>
                                                      <button class="btn btn-outline-warning btn-sm"
                                                        (click)="editAutopart(autopart, i)"
                                                        *ngIf="this.user.allowAddUpdateAutopart == true"
                                                        data-bs-toggle="modal" data-bs-target="#editPart"><i
                                                          class="fa fa-edit"></i> </button>
                                                    </div>
                                                  </td>
                                                </tr>
                                              </ng-container>
                                            </table>



                                          </td>
                                        </tr>
                                      </ng-container>

                                    </ng-container>
                                  </table>

                                </td>
                              </tr>
                            </ng-container>

                            <ng-container *ngIf="claim.createJobOrder == true && claim.jobs.length> 0">
                              <tr>
                                <!-- <td></td> -->
                                <td class="text-center fs-14 v-align-middle opacity-50"><i class="fas fa-user"></i>
                                </td>
                                <td colspan="9">
                                  <ng-container>
                                    <table class="table-bordered table-sm overflow-hidden shadow  line-height-100 w-100"
                                      cdkDropList (cdkDropListDropped)="droppedJobsClaim($event, claim)">
                                      <thead>

                                        <tr>
                                          <th class="fs-12 text-center bg-info text-white" style="width:50px">JO #
                                          </th>
                                          <th class="fs-12 text-center bg-info text-white mw-100">Job Order Name</th>
                                          <th class="fs-12 text-center bg-info text-white" style="min-width:150px">
                                            Instruction
                                          </th>
                                          <th class="fs-12 text-center bg-info text-white mw-100" style="width:100px">
                                            Assigned
                                            To</th>
                                          <th class="fs-12 text-center bg-info text-white" style="width:100px">$
                                          </th>
                                          <!-- <th class="fs-12 text-center bg-info text-white mw-100">Start</th> -->
                                          <th class="fs-12 text-center bg-info text-white mw-100">Target</th>
                                          <!-- <th class="fs-12 text-center bg-info text-white mw-100">End</th> -->
                                          <th class="fs-12 text-center bg-info text-white " style="width:50px">Status
                                          </th>
                                          <th class="fs-12 text-center bg-info text-white mw-50"><i
                                              class="fa-solid fa-user"></i></th>
                                          <th class="fs-12 text-center bg-info text-white mw-100">Action</th>
                                        </tr>
                                      </thead>
                                      <tbody>

                                        <tr (click)="setJobId(job.id)" *ngFor="let job of claim.jobs; let i=index">
                                          <td class="text-center fs-12 v-align-middle"
                                            [cdkDragDisabled]="isMobile==true" cdkDrag>
                                            {{job.id}}
                                          </td>
                                          <td class="text-center fs-12 v-align-middle">
                                            <input placeholder="Enter Job Name" [(ngModel)]="job.name" maxlength="50"
                                              (keyup.enter)="onEnter('job name',job)" type="text"
                                              [disabled]="job.paidWeek> 0"
                                              class="form-control h-40 border-radius-4 border" />
                                          </td>
                                          <td class="text-center fs-12 v-align-middle"><textarea type="text" rows="1"
                                              [(ngModel)]="job.notes" class="form-control my-2" maxlength="200"
                                              (keyup.enter)="onEnter('job notes',job)" title="Job Instruction"
                                              [disabled]="job.paidWeek> 0"
                                              oninput='this.style.height = "";this.style.height = this.scrollHeight + "px"'></textarea>
                                          </td>

                                          <td class="text-center fs-12 v-align-middle"><select
                                              class="form-select border-radius-4 h-40 border fs-12 "
                                              [(ngModel)]="job.employeeId" #device [disabled]="job.paidWeek> 0"
                                              style="height:30px;"
                                              (change)="onChangeEmployee2Claim($event, device.value, job, claim)">
                                              <option value="0" disabled selected>Select Employee</option>
                                              <option [value]="employee.id"
                                                [style.background-color]="employee.id == currentEmplyeeId ? 'lightyellow' : (true ? 'white' : 'white')"
                                                *ngFor="let employee of employees;let i=index;">{{employee.firstName}}
                                                {{employee.lastName}}
                                                ( {{employee.roleName}},{{employee.rolePrecentage}}% <ng-container
                                                  *ngIf="employee.commissionBased == true">
                                                  - <span class="fw-700 text-danger">Commission Based</span>
                                                </ng-container>)
                                                [{{
                                                employee.jobCountsUnfinished}}/{{employee.jobCountsFinished}}/{{employee.jobCountsUnfinished
                                                +
                                                employee.jobCountsFinished}}]
                                              </option>
                                            </select></td>
                                          <td class="text-center fs-12 v-align-middle"><input
                                              placeholder="Enter Job Value" [(ngModel)]="job.price" maxlength="50"
                                              class="fs-12" (keyup.enter)="onEnter('job price',job)" type="number"
                                              [disabled]="job.paidWeek> 0"
                                              class="form-control border h-40 border-radius-4" />
                                          </td>

                                          <td class="text-center fs-12 v-align-middle"><input *ngIf="job.employeeId > 0"
                                              (change)="onChangeCalendar($event, job)"
                                              max="{{vehicle.targetDate | date: 'MM/dd/yyyy':'yyyy-MM-dd'}}"
                                              [disabled]="job.paidWeek> 0"
                                              [ngModel]="job.targetDate |  date:'yyyy-MM-dd'" title="Target Date"
                                              type="date" class="form-control border h-40 border-radius-4" /></td>

                                          <td class="p-2 text-center v-align-middle">
                                            <div class="form-check text-center pt-2">
                                              <input trimText class="form-check-input mx-auto mt-0" type="checkbox"
                                                [disabled]="job.paidWeek> 0"
                                                *ngIf="job.employeeId > 0 && job.targetDate != null"
                                                [checked]="isJobChecked(job)" (change)="updateJobStatus(job)" />
                                            </div>
                                          </td>
                                          <td class="p-2 text-center  v-align-middle fs-12">


                                            <ng-container *ngFor="let user of users;let i=index;">
                                              <span *ngIf="user.id == job.userId">
                                                {{(user.firstName + " " + user.lastName) | shortName:2}}
                                              </span>
                                            </ng-container>




                                          </td>
                                          <td class="text-center fs-12 v-align-middle">
                                            <div class="d-flex align-items-center justifyc-ntent-center gap-1">
                                              <button class="btn btn-outline-danger btn-sm" title="Remove"
                                                [disabled]="job.paidWeek> 0"
                                                (click)="deleteVehicleJobClaim(null, job)"><i
                                                  class="fa fa-trash"></i></button>
                                              <button class="btn btn-outline-primary btn-sm" title="Save"
                                                [disabled]="job.paidWeek> 0" (click)="saveJobNotes(job)"><i
                                                  class="fa fa-save"></i></button>
                                              <button class="btn btn-outline-dark btn-sm" title="Print"
                                                (click)="setJobId(job.id)"
                                                (click)="printPageJob('print-content-job', 'jobs', job)">
                                                <i class="fa fa-print"></i>
                                              </button>
                                            </div>
                                          </td>
                                        </tr>

                                      </tbody>
                                    </table>
                                  </ng-container>

                                </td>
                              </tr>


                            </ng-container>


                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-md-4">
                <div class="mt-4 pt-1 position-relative">
                  <button name="btn" class="btn btn-secondary-abs py-3 px-3 w-100" (click)="fileInput.click()"><i
                      class="fa fa-cloud-upload me-2"></i> Upload Images</button>
                  <input type='file'
                    class="form-control h-48 ps-5 border-radius-8 mt-5 opacity-0 top-0 position-absolute"
                    accept="image/jpg, image/jpeg" #fileInput (change)="onSelectFileEditorAutoparts($event)" multiple
                    (click)="fileInput.value = ''" />
                </div>
                <!-- <div class="mt-4 pt-1 position-relative">
              <button (click)="deleteImage(selectedAutopart.id, selectedImage)" class="btn btn-outline-danger mt-3 btn-sm"
                title="Remove Current Image"><i class="fa fa-trash"></i></button>
            </div> -->
              </div>
              <div class="col-md-4">
                <div class="mt-2 pt-1 position-relative">
                  <div *ngFor='let imageModel of selectedAutopart.imageModels; let i=index' class="d-inline-block me-2">
                    <img class="mt-3 preview img-fluid img-thumbnail me-3" width="100"
                      *ngIf="selectedAutopart.showInSearchImageId != imageModel.id"
                      src="{{baseUrlResizeImageParts + '/' + imageModel.id}}" (click)="setImageAutoPart(i)"
                      style="border: 3px solid #555;"> <img class="mt-3 preview img-fluid img-thumbnail me-3"
                      width="100" *ngIf="selectedAutopart.showInSearchImageId == imageModel.id"
                      src="{{baseUrlResizeImageParts + '/' + imageModel.id}}" (click)="setImageAutoPart(i)"
                      title="Show in search" style="border: 3px solid lightcoral;">
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1 position-relative">
                  <div class="containerImage" *ngIf="selectedAutopart.imageModels.length> 0"> <img
                      *ngIf="selectedImage != null && selectedImage != 0 &&  selectedAutopart.showInSearchImageId != selectedImage"
                      class="image w-100 img-fluid img-thumbnail" src="{{baseUrlImageParts + '/' + selectedImage}}"
                      alt="Image" /> <img
                      *ngIf="selectedImage != null && selectedImage != 0 &&  selectedAutopart.showInSearchImageId == selectedImage"
                      class="image w-100 img-fluid img-thumbnail" src="{{baseUrlImageParts + '/' + selectedImage}}"
                      alt="Image" />
                    <label *ngIf="selectedImage == selectedAutopart.showInSearchImageId" class="top-left"
                      for="title">Will
                      Show This During Search</label>
                    <div class="bottom-right py-2">
                      <button *ngIf="selectedImage != selectedAutopart.showInSearchImageId"
                        title="As index image during search"
                        (click)="setImageForSearchAutoparts(selectedAutopart.id, selectedImage)"
                        class="btn btn-primary mt-3 btn-sm" for="title">Set for Search</button>
                      <button (click)="deleteImageAutopart(selectedAutopart.id, selectedImage)" data-toggle="tooltip"
                        data-placement="top" title="Remove this image" class="btn btn-danger mt-3 btn-sm" for="title">
                        <i class="bi-trash"></i> </button>
                    </div>
                  </div>
                </div>
              </div>


              <div class="col-md-8">
                <div class="mt-4 pt-1">
                  <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Name</label>
                  <input trimText class="form-control h-48 px-3 border-radius-0" type="text" required
                    placeholder="Enter Parts name" #name="ngModel" [ngClass]="{ 'is-invalid': name.errors }"
                    minlength="2" maxlength="50" [(ngModel)]="selectedAutopart.title" />
                  <div class="invalid-feedback" *ngIf="name.errors "> <span *ngIf="name.errors['required']">Parts Name
                      is
                      required</span> <span *ngIf="name.errors['minlength']">Parts Name must be at least 2
                      characters</span> <span *ngIf="name.errors['maxlength']">Parts Name must be at most 50
                      characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Parts Number</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                    placeholder="Enter Parts Number" #partNumber="ngModel"
                    [ngClass]="{ 'is-invalid': partNumber.errors }" minlength="2" maxlength="50"
                    [(ngModel)]="selectedAutopart.partNumber" name="partInfo" />
                  <div class="invalid-feedback" *ngIf="partNumber.errors "> <span
                      *ngIf="partNumber.errors['required']">Parts Number is required</span> <span
                      *ngIf="partNumber.errors['minlength']">Parts Number must be at least 2 characters</span> <span
                      *ngIf="partNumber.errors['maxlength']">Parts Number must be at most 50 characters</span> </div>
                </div>
              </div>
              <div class="col-md-12">
                <div class="mt-4 pt-1">
                  <label for="description" class="form-label fs-14 fw-400 mb-3">Description</label>
                  <textarea class="form-control h-48 px-3 border-radius-8" type="text" style="line-height: 2;"
                    placeholder="Enter Description" #description="ngModel"
                    [ngClass]="{ 'is-invalid': description.errors }" minlength="2" rows="2" maxlength="2000" required
                    [(ngModel)]="selectedAutopart.description" name="description"></textarea>
                  <div class="invalid-feedback" *ngIf="description.errors "> <span
                      *ngIf="description.errors['required']">Description is required</span> <span
                      *ngIf="description.errors['minlength']">Description must be at least 2 characters</span> <span
                      *ngIf="description.errors['maxlength']">Descripton must be at most 2000 characters</span> </div>
                </div>
              </div>
              <div class="col-lg-3">
                <div class="mt-4 pt-1">
                  <label for="vendor" data-bs-toggle="tooltip" data-bs-dismiss="modal"
                    title="Click to go to Configuration" [routerLink]="'/vendors'"
                    class="form-label fs-14 fw-400 mb-3 cursor-pointer">Vendor</label>
                  <select class="form-select h-48 px-3 border-radius-8" name="vendor"
                    [(ngModel)]="selectedAutopart.vendorId" [disabled]="user.allowAddUpdateAutopart == false"
                    #vendor="ngModel" required [ngClass]="{ 'is-invalid': vendor.errors }">
                    <option value="undefined" disabled selected>Select Vendor</option>
                    <option [value]="vendor.id" *ngFor="let vendor of vendors;let i=index;">{{vendor.name}}</option>
                  </select>
                  <div class="invalid-feedback" *ngIf="vendor.errors">
                    <span *ngIf="vendor.errors['required']">Vendor is required</span>
                  </div>
                </div>
              </div>
              <div class="col-md-9">
                <div class="mt-4 pt-1">
                  <label for="partInfo" class="form-label fs-14 fw-400 mb-3">Comments</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                    placeholder="Enter Comments" #comments="ngModel" [ngClass]="{ 'is-invalid': comments.errors }"
                    minlength="2" maxlength="50" [(ngModel)]="selectedAutopart.comments" name="comments" />
                  <div class="invalid-feedback" *ngIf="comments.errors ">
                    <!-- <span *ngIf="partNumber.errors['required']">Parts Number is required</span> -->
                    <span *ngIf="comments.errors['minlength']">Comments must be at least 2 characters</span> <span
                      *ngIf="comments.errors['maxlength']">Comments must be at most 500 characters</span>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="grade" class="form-label fs-14 fw-400 mb-3">Grade</label>
                  <select name="grade" class="form-select h-48 px-3 border-radius-8" size="1"
                    [(ngModel)]="selectedAutopart.grade" required #grade="ngModel"
                    [ngClass]="{ 'is-invalid': grade.errors }">
                    <option value="undefined" disabled selected>Select Grade</option>
                    <option value="A">A</option>
                    <option value="B">B</option>
                    <option value="C">C</option>
                    <option value="Used">Used</option>
                    <option value="New">New</option>
                    <option value="Insurance">Insurance</option>
                  </select>
                  <div class="invalid-feedback" *ngIf="grade.errors "> <span *ngIf="grade.errors['required']">Grade is
                      required</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="price" class="form-label fs-14 fw-400 mb-3">Price ($)</label>
                  <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Enter Price"
                    #salePrice="ngModel" [ngClass]="{ 'is-invalid': salePrice.errors }" minlength="1" maxlength="10"
                    onKeyPress="if(this.value.length==10) return false" maxlength="10" required
                    oninput="if(this.value<0)this.value=this.value * -1" [(ngModel)]="selectedAutopart.salePrice"
                    name="price" />
                  <div class="invalid-feedback" *ngIf="salePrice.errors "> <span
                      *ngIf="salePrice.errors['required']">Price
                      is required</span> <span *ngIf="salePrice.errors['minlength']">Price must be at least 1
                      characters</span> <span *ngIf="salePrice.errors['maxlength']">Price must be at most 10
                      characters</span> </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="mt-4 pt-1">
                  <label for="status" class="form-label fs-14 fw-400 mb-3">Status</label>
                  <select name="purchaseStatus" class="form-select border-radius-4" size="1"
                    (change)="onChangeAutopartPurchaseStatus($event, selectedAutopart)"
                    [(ngModel)]="selectedAutopart.purchaseStatus">
                    <option value="0" selected>No Status</option>
                    <option value="1">Ordered</option>
                    <option value="2">Received</option>
                    <option value="3">Returned</option>
                    <option value="4">Wrong Part</option>
                  </select>
                </div>
              </div>


              <div class="col-md-12">
                <h5 class="text-success fw-700 my-3">{{ message1}}</h5>
                <div class="pt-1 d-flex gap-3">
                  <button class="btn btn-outline-primary h-45 px-4 rounded-4 fs-14 fw-600 mt-4 "
                    (click)="saveAutopartEditor()" *ngIf="selectedAutopart.id> 0">Save
                    Info</button>

                  <button class="btn btn-outline-success h-45 px-4 rounded-4 fs-14 fw-600 mt-4 "
                    (click)="backToListing()" data-bs-dismiss="modal">Back</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>