<script>
  // window.addEventListener('load', function () {
  //   var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
  //   var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
  //     return new bootstrap.Tooltip(tooltipTriggerEl, {
  //       container: 'body',
  //       trigger: 'hover'
  //     })
  //   })
  // })


  // var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
  // var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
  //   return new bootstrap.Tooltip(tooltipTriggerEl, {
  //     container: 'body',
  //     trigger: 'hover'
  //   })

</script>

<div>
  <div class="row nogot">
    <div class="my-fluid-col main-content col mt-4 pt-2">

      <div class="row px-2 position-sticky common-bar-top">
        <nav class="navbar navbar-expand navbar-white bg-white border-radius-8 d-flex justify-content-between">
          <button class="btn btn-primary-abs" (click)="toggleClass()"><i class="fa fa-bars"></i></button>
          <ul class="navbar-nav d-flex align-items-center gap-5">
            <li class="search-bar">
              <div class="position-relative">
                <input type="text" class="form-control bg-light height-40 border-0" [(ngModel)]="searchInput"
                  title="Search Customer Last Name" (input)="onSearchChangeCustomer($event)"
                  placeholder="Search Customer Last Name..." />
                <a (click)="searchCustomerByLastName(searchInput)" title="Search Customer Last Name"
                  class="position-absolute end-0 top-0 mt-3 me-3 text-muted"><i class="fa fa-search"></i></a>
              </div>
            </li>
            <!-- <li class="nav-item dropdown">
              <div class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false"> <a href="javascript:;" class="notification position-relative"><i class="fa fa-bell text-dark opacity-50 fs-20"></i> <span class="position-absolute top-0 start-100 translate-middle bg-danger rounded-circle text-white text-white text-center line-height-200">10</span></a> </div>
              <div class="dropdown-menu p-0 border-0 shadow border-radius-8 overflow-hidden w-100 notification-box">
                <div class="d-flex align-items-center justify-content-between p-4 border-bottom"> <strong class="fs-14">Notifications <span class="text-muted">(10)</span></strong> <a href="javascript:;" class="fs-12">Mark All Read</a> </div>
                <div class="notice-scroller"> <a href="javascript:;" class="w-100 d-block">
                  <div class="d-flex gap-3 align-items-center p-4 border-bottom"> <i class="fa fa-car fs-18 text-primary-abs text-center"></i> <span class="text-muted pe-4">
                    <p class="fs-13">Vehicle <b class="text-dark">Chevrolet</b> is due 28 days.</p>
                    <small class="fs-12">2 Hours ago</small> </span> </div>
                  </a> <a href="javascript:;" class="w-100 d-block">
                  <div class="d-flex gap-3 align-items-center p-4 border-bottom"> <i class="fa fa-user-tie fs-18 text-primary-abs text-center"></i> <span class="text-muted pe-4">
                    <p class="fs-13">New <b class="text-dark">Customer</b> has been added.</p>
                    <small class="fs-12">1 Day ago</small> </span> </div>
                  </a> <a href="javascript:;" class="w-100 d-block">
                  <div class="d-flex gap-3 align-items-center p-4 border-bottom"> <i class="fa fa-car fs-18 text-primary-abs text-center"></i> <span class="text-muted pe-4">
                    <p class="fs-13">Vehicle <b class="text-dark">Chevrolet</b> is due 28 days.</p>
                    <small class="fs-12">2 Hours ago</small> </span> </div>
                  </a> <a href="javascript:;" class="w-100 d-block">
                  <div class="d-flex gap-3 align-items-center p-4 border-bottom"> <i class="fa fa-user-tie fs-18 text-primary-abs text-center"></i> <span class="text-muted pe-4">
                    <p class="fs-13">New <b class="text-dark">Customer</b> has been added.</p>
                    <small class="fs-12">1 Day ago</small> </span> </div>
                  </a> <a href="javascript:;" class="w-100 d-block">
                  <div class="d-flex gap-3 align-items-center p-4"> <i class="fa fa-car fs-18 text-primary-abs text-center"></i> <span class="text-muted pe-4">
                    <p class="fs-13">Vehicle <b class="text-dark">Chevrolet</b> is due 28 days.</p>
                    <small class="fs-12">2 Hours ago</small> </span> </div>
                  </a> </div>
                <a href="javascript:;" class="text-center mx-auto pt-3 fs-12 d-block border-top">See all notifications</a> </div>
            </li> -->
            <li class="nav-item dropdown">
              <div class="dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                <div class="d-flex align-items-center gap-3"> <img width="40" height="40" class="border-radius-4"
                    *ngIf="company.icon != null && company.icon.length > 0"
                    [src]="'data:image/jpeg;base64,'+ company.icon" />
                  <div class="user-details"> <strong class="fs-14 mb-1 d-block">{{user.firstName}}
                      {{user.lastName}}</strong> <small
                      class="fs-13 text-dark- opacity-50">{{this.company.name}}</small> </div>
                  <i class="fa fa-angle-down opacity-50"></i>
                </div>
              </div>
              <div class="dropdown-menu p-0 border-0 shadow border-radius-8 overflow-hidden w-100 mt-3">
                <ul class="d-flex flex-column">
                  <!-- <li class="d-block p-0"><a routerLink="/users" class="dropdown-item p-3 fs-12"><i class="fa fa-users text-primary-abs fs-15 me-2 ms-1"></i> Manage Users</a></li> -->
                  <li class="d-block p-0"><button data-bs-toggle="modal" data-bs-target="#myAccount"
                      class="dropdown-item p-3 fs-12"><i class="fa fa-user text-primary-abs fs-15 me-2 ms-1"></i> My
                      Account</button></li>
                  <li class="d-block p-0"><button data-bs-toggle="modal" data-bs-target="#resetPassword"
                      class="dropdown-item p-3 fs-12"><i class="fa fa-key text-primary-abs fs-15 me-2 ms-1"></i> Reset
                      Password</button></li>
                  <li class="d-block p-0"><a routerLink="/login" class="dropdown-item p-3 fs-12" (click)="logout()"><i
                        class="fa fa-power-off text-primary-abs fs-15 me-2 ms-1"></i> Logout</a></li>
                </ul>
              </div>
            </li>
          </ul>
        </nav>
      </div>

      <div class="row mx-negative">
        <div class="col-lg-3 col-md-6 py-2" (click)="getCustomerDetail(customer2, i)" title="Click to select"
          *ngFor="let customer2 of customers; let i=index; let even=even">
          <div class="bg-white shadow-sm border-radius-8 p-4 cursor-pointer"
            [style.border]="i == cindex? '1px solid #1580da' : (even ? 'white' : 'white')">
            <div class="text-center">
              <i class="fa-solid fa-circle-user fa-4x heading-color"></i>
              <strong class="text-black fs-14 d-block pt-4 pb-2">{{ customer2.title}} {{ customer2.firstName }}
                {{customer2.lastName }}</strong>
            </div>
            <ul class="customers-details">
              <li class="d-flex gap-3 align-items-center mt-4"><i
                  class="fa fa-mobile-alt text-primary-abs border-radius-4 text-center "></i>
                <p class="fs-12 text-black opacity-75 line-height-150">{{ formatPhoneNumber(customer2.phone) }} {{
                  formatPhoneNumber(customer2.phone2) }} {{formatPhoneNumber(customer2.phone3) }}</p>
              </li>
              <li class="d-flex gap-3 align-items-center mt-4"><i
                  class="fa fa-envelope text-primary-abs border-radius-4 text-center "></i>
                <p class="fs-12 text-black opacity-75 line-height-150">{{ customer2.email }}</p>
              </li>
              <li class="d-flex gap-3 align-items-center mt-4"><i
                  class="fa fa-map-marker-alt text-primary-abs border-radius-4 text-center "></i>
                <p class="fs-12 text-black opacity-75 line-height-150">{{customer2.street}}, {{customer2.city}},
                  {{customer2.state}} {{customer2.zip}}</p>
              </li>
              <li class="d-flex gap-3 align-items-center mt-4"><i
                  class="fa fa-calendar text-primary-abs border-radius-4 text-center "></i>
                <p class="fs-12 text-black opacity-75 line-height-150">Since {{customer2.createdAt| date}}</p>
              </li>
            </ul>
          </div>
        </div>
      </div>

      <div class="d-lg-flex align-items-center justify-content-between my-4">
        <h2 class="heading-color fw-700 text-uppercase px-2 pt-4 fs-18">
          <span *ngIf="editModeCustomer==true">Add Customers</span>
          <span *ngIf="editModeCustomer==false">Add Vehicles</span>
        </h2>
        <div class="d-lg-flex align-items-center px-2 mt-2 tw-btns">
          <a *ngIf="user.allowUpdateCustomerInfo == true" (click)="reset()" href="javascript:;"
            class="h-40 fs-14 mt-2 btn btn-danger px-4 border-radius-4"><i class="fa fa-times me-2"></i>Clear Form</a>
          <a routerLink="/inshop" class="h-40 fs-14 mt-2 btn btn-primary-abs px-4 border-radius-4 ms-md-3"><i
              class="fa fa-car me-2"></i> View Vehicles</a>
        </div>
      </div>

      <div class="row pt-1 mx-negative" *ngIf="editModeCustomer==true">
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="title" class="form-label fs-14 fw-400 mb-3">Title</label>
            <select class="form-select h-48 px-3 border-radius-8" #title="ngModel" size="1" required
              [(ngModel)]="vehicle.customer.title" [ngClass]="{ 'is-invalid': title.errors }">
              <option value="undefined" disabled selected>Select Title</option>
              <option *ngFor="let title of optionsTitle">{{ title}}</option>
            </select>
            <div class="invalid-feedback" *ngIf="title.errors">
              <span *ngIf="title.errors['required']">Title is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="firstname" class="form-label fs-14 fw-400 mb-3">First Name</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Enter Your First Name" required minlength="2" maxlength="20" #firstName="ngModel"
              [ngClass]="{ 'is-invalid': firstName.errors }" [(ngModel)]="vehicle.customer.firstName" />
            <div class="invalid-feedback" *ngIf="firstName.errors">
              <span *ngIf="firstName.errors['required']">First Name is required</span>
              <span *ngIf="firstName.errors['minlength']">First Name must be at least 2 characters</span>
              <span *ngIf="firstName.errors['maxlength']">First Name must be at most 20 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="lastname" class="form-label fs-14 fw-400 mb-3">Last Name</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Enter Your Last Name" required minlength="2" maxlength="20" #lastName="ngModel"
              [ngClass]="{ 'is-invalid': lastName.errors }" [(ngModel)]="vehicle.customer.lastName" />
            <div class="invalid-feedback" *ngIf="lastName.errors">
              <span *ngIf="lastName.errors['required']">Last Name is required</span>
              <span *ngIf="lastName.errors['minlength']">Last Name must be at least 2 characters</span>
              <span *ngIf="lastName.errors['maxlength']">Last Name must be at most 20 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="mobilePhone" class="form-label fs-14 fw-400 mb-3">Mobile Phone</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Enter Your Mobile Number" required [(ngModel)]="vehicle.customer.phone" maxlength="20"
              #phone="ngModel" [ngClass]="{ 'is-invalid': phone.errors }" pattern="^[-+()0-9]{10,12}(?:-\d+)?$" />
            <div class="invalid-feedback" *ngIf="phone.errors">
              <span *ngIf="phone.errors['required']">Mobile Phone is required</span>
              <span *ngIf="phone.errors['pattern']">Phone must be a valid phone number</span>
              <span *ngIf="phone.errors['maxlength']">Phone must be at most 20 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="homePhone" class="form-label fs-14 fw-400 mb-3">Home Phone</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text" maxlength="20"
              placeholder="Enter Your Home Phone Number" [(ngModel)]="vehicle.customer.phone2" #phone2="ngModel"
              [ngClass]="{ 'is-invalid': phone2.errors }" pattern="^[-+()0-9]{10,12}(?:-\d+)?$" />
            <div class="invalid-feedback" *ngIf="phone2.errors">
              <span *ngIf="phone2.errors['pattern']">Phone must be a valid phone number</span>
              <span *ngIf="phone2.errors['maxlength']">Phone must be at most 20 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="workPhone" class="form-label fs-14 fw-400 mb-3">Work Phone</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text" maxlength="20"
              placeholder="Enter Your Work Phone Number" [(ngModel)]="vehicle.customer.phone3" #phone3="ngModel"
              [ngClass]="{ 'is-invalid': phone3.errors }" pattern="^[-+()0-9]{10,12}(?:-\d+)?$" />
            <div class="invalid-feedback" *ngIf="phone3.errors">
              <span *ngIf="phone3.errors['pattern']">Phone must be a valid phone number</span>
              <span *ngIf="phone3.errors['maxlength']">Phone must be at most 20 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="emailAddress" class="form-label fs-14 fw-400 mb-3">Email Address</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" name="email"
              [(ngModel)]="vehicle.customer.email" email pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
              #email="ngModel" [ngClass]="{ 'is-invalid': email.errors }" maxlength="100"
              placeholder="Enter Your Email Address" />
            <div class="invalid-feedback" *ngIf="email.errors">
              <!-- <span *ngIf="email.errors['required']">Email is required</span> -->
              <span *ngIf="email.errors['pattern']">Email must be a valid email address</span>
              <span *ngIf="email.errors['maxlength']">Email must be at most 100 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="street" class="form-label fs-14 fw-400 mb-3">Street</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Enter Your Street" minlength="2" maxlength="200" #street="ngModel" required
              [ngClass]="{ 'is-invalid': street.errors }" [(ngModel)]="vehicle.customer.street" />
            <div class="invalid-feedback" *ngIf="street.errors">
              <span *ngIf="street.errors['required']">Street is required</span>
              <span *ngIf="street.errors['minlength']">Street must be at least 2 characters</span>
              <span *ngIf="street.errors['maxlength']">Street must be at most 200 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="city" class="form-label fs-14 fw-400 mb-3">City</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Enter Your City" minlength="2" #city="ngModel" maxlength="200" required
              [ngClass]="{ 'is-invalid': city.errors }" [(ngModel)]="vehicle.customer.city" />
            <div class="invalid-feedback" *ngIf="city.errors">
              <span *ngIf="city.errors['required']">City is required</span>
              <span *ngIf="city.errors['minlength']">City must be at least 2 characters</span>
              <span *ngIf="city.errors['maxlength']">City must be at most 200 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="state" class="form-label fs-14 fw-400 mb-3">State</label>
            <select class="form-select h-48 px-3 border-radius-8" name="state" #state="ngModel" size="1" required
              [(ngModel)]="vehicle.customer.state" [ngClass]="{ 'is-invalid': state.errors }">
              <option value="undefined" disabled selected>Select State</option>
              <option value="AL">Alabama</option>
              <option value="AK">Alaska</option>
              <option value="AZ">Arizona</option>
              <option value="AR">Arkansas</option>
              <option value="CA">California</option>
              <option value="CO">Colorado</option>
              <option value="CT">Connecticut</option>
              <option value="DE">Delaware</option>
              <option value="DC">District Of Columbia</option>
              <option value="FL">Florida</option>
              <option value="GA">Georgia</option>
              <option value="HI">Hawaii</option>
              <option value="ID">Idaho</option>
              <option value="IL">Illinois</option>
              <option value="IN">Indiana</option>
              <option value="IA">Iowa</option>
              <option value="KS">Kansas</option>
              <option value="KY">Kentucky</option>
              <option value="LA">Louisiana</option>
              <option value="ME">Maine</option>
              <option value="MD">Maryland</option>
              <option value="MA">Massachusetts</option>
              <option value="MI">Michigan</option>
              <option value="MN">Minnesota</option>
              <option value="MS">Mississippi</option>
              <option value="MO">Missouri</option>
              <option value="MT">Montana</option>
              <option value="NE">Nebraska</option>
              <option value="NV">Nevada</option>
              <option value="NH">New Hampshire</option>
              <option value="NJ">New Jersey</option>
              <option value="NM">New Mexico</option>
              <option value="NY">New York</option>
              <option value="NC">North Carolina</option>
              <option value="ND">North Dakota</option>
              <option value="OH">Ohio</option>
              <option value="OK">Oklahoma</option>
              <option value="OR">Oregon</option>
              <option value="PA">Pennsylvania</option>
              <option value="RI">Rhode Island</option>
              <option value="SC">South Carolina</option>
              <option value="SD">South Dakota</option>
              <option value="TN">Tennessee</option>
              <option value="TX">Texas</option>
              <option value="UT">Utah</option>
              <option value="VT">Vermont</option>
              <option value="VA">Virginia</option>
              <option value="WA">Washington</option>
              <option value="WV">West Virginia</option>
              <option value="WI">Wisconsin</option>
              <option value="WY">Wyoming</option>
            </select>
            <div class="invalid-feedback" *ngIf="state.errors">
              <span *ngIf="state.errors['required']">State is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="zipCode" class="form-label fs-14 fw-400 mb-3">Zip Code</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="number"
              placeholder="Enter Your Zip Code" minlength="5" required #zip="ngModel"  pattern="[0-9]*"  
              [ngClass]="{ 'is-invalid': zip.errors }" #zipCode (keyup.enter)="searchZip(zipCode.value, vehicle)"
              maxlength="10" [(ngModel)]="vehicle.customer.zip" />
            <div class="invalid-feedback" *ngIf="zip.errors">
              <span *ngIf="zip.errors['required']">Zip Code is required</span>
              <span *ngIf="zip.errors['pattern']">Must be a valid zip</span>
              <span *ngIf="zip.errors['minlength']">Zip Code is at least 5 digits</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="zipCode" class="form-label fs-14 fw-400 mb-3">Notes</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text" maxlength="200"
              placeholder="Enter Notes" [(ngModel)]="vehicle.customer.notes" />
          </div>
        </div>
        <div class="col-12">
          <div *ngIf="errorMessage" class="form-group mt-4">
            <div class="form-group">
              <div *ngIf="errorMessage" class="alert alert-danger fs-13" role="alert">
                {{ errorMessage }}
              </div>
            </div>
          </div>
          <div *ngIf="successMessage" class="form-group mt-4">
            <div class="form-group">
              <div *ngIf="successMessage" class="alert alert-success fs-13" role="alert">
                {{ successMessage }}
              </div>
            </div>
          </div>
          <br />
          <a *ngIf="editModeCustomer == true && this.user.allowUpdateCustomerInfo == true"
            (click)="saveCustomerInfo(vehicle.customer)" href="javascript:;"
            class="btn btn-primary-abs h-45 px-4 rounded-4 fs-14 fw-600 my-4">Save Details</a>
        </div>
      </div>

      <div class="row pt-3 mx-negative">
        <div class="col-12">
          <h2 class="heading-color fw-700 text-uppercase pt-4 pb-5 fs-18" *ngIf="editModeCustomer==true">Add Vehicles
          </h2>
          <h3 class="fs-18 fw-500 text-dark">Information About Vehicle</h3>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="year" class="form-label fs-14 fw-400 mb-3">Year</label>
            <select class="form-select h-48 px-3 border-radius-8" required size="1" #year="ngModel"
              [ngClass]="{ 'is-invalid': year.errors }" [(ngModel)]="vehicle.year">
              <option value="undefined" disabled selected>Select Year</option>
              <option [value]="option" *ngFor="let option of optionsYear;let i=index;">{{option}}</option>
            </select>
            <div class="invalid-feedback d-block" *ngIf="year.errors ">
              <span *ngIf="year.errors['required']">Year is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="makeake" class="form-label fs-14 fw-400 mb-3">Make</label>
            <select class="form-select h-48 px-3 border-radius-8" #device required size="1" #make="ngModel"
              [ngClass]="{ 'is-invalid': make.errors }" (change)="onChange($event, device.value)"
              [(ngModel)]="vehicle.make">
              <option value="" disabled selected>Select Make</option>
              <option [value]="option" *ngFor="let option of optionsMake;let i=index;">{{option}}</option>
            </select>
            <div class="invalid-feedback" *ngIf="make.errors ">
              <span *ngIf="make.errors['required']">Make is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="model" class="form-label fs-14 fw-400 mb-3">Model</label>
            <select class="form-select h-48 px-3 border-radius-8" required size="1" #model="ngModel"
              [ngClass]="{ 'is-invalid': model.errors }" [(ngModel)]="vehicle.model">
              <option value="" disabled selected>Select Model</option>
              <option [value]="option" *ngFor="let option of optionsModel;let i=index;">{{option}}</option>
            </select>
            <div class="invalid-feedback" *ngIf="model.errors ">
              <span *ngIf="model.errors['required']">Model is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="color" class="form-label fs-14 fw-400 mb-3">Color</label>
            <select class="form-select h-48 px-3 border-radius-8 text-capitalize "
              style="background-color: {{vehicle.color}}" [(ngModel)]="vehicle.color" required size="1" #color="ngModel"
              [ngClass]="{ 'is-invalid': color.errors }">
              <option value="" style="background-color:black; color:white" disabled selected>Select Color
              </option>
              <option style="background-color: {{color}}" *ngFor="let color of optionsColor;let i=index;">{{color}}
              </option>
            </select>
            <div class="invalid-feedback" *ngIf="color.errors ">
              <span *ngIf="color.errors['required']">Color is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="miles" class="form-label fs-14 fw-400 mb-3">Miles</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Enter Miles"
              maxlength="20" #miles="ngModel" [ngClass]="{ 'is-invalid': miles.errors }" [(ngModel)]="vehicle.miles" />
            <div class="invalid-feedback" *ngIf="miles.errors ">
              <span *ngIf="miles.errors['maxlength']">Miles must be at most 20 characteris</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="Description" class="form-label fs-14 fw-400 mb-3">Description</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Enter Description" maxlength="200" #descriptions="ngModel"
              [ngClass]="{ 'is-invalid': descriptions.errors }" [(ngModel)]="vehicle.description" />
            <div class="invalid-feedback" *ngIf="descriptions.errors ">
              <span *ngIf="descriptions.errors['maxlength']">Description must be at most 200 characteris</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="plate" class="form-label fs-14 fw-400 mb-3">License Plate</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Enter License Plate" maxlength="100" #plate="ngModel"
              [ngClass]="{ 'is-invalid': plate.errors }" [(ngModel)]="vehicle.plate" />
          </div>
          <div class="invalid-feedback" *ngIf="plate.errors ">
            <span *ngIf="plate.errors['maxlength']">License Plate must be at most 100 characteris</span>
          </div>
        </div>
        <div class="col-md-8">
          <div class="mt-4 pt-1 form-group">
            <div class="form-group">
              <label for="VIN" class="form-label fs-14 fw-400 mb-3">VIN e.g. ZPBUA1ZL9KLA00848</label>
              <div class="input-group mb-12">
                <input type="text" class="form-control" placeholder="Enter VIN" maxlength="17" #vin="ngModel"
                  [ngClass]="{ 'is-invalid': vin.errors }" [(ngModel)]="vehicle.vin" />
                <div class="input-group-append">
                  <button class="btn btn-primary-abs" type="button" (click)="searchVin()">Decode VIN</button>
                </div>
                <div class="invalid-feedback" *ngIf="vin.errors ">
                  <span *ngIf="vin.errors['maxlength']">Vin must be at most 17 characteris</span>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-12 pt-4 mt-2">
          <h3 class="fs-18 fw-500 text-dark">Your Request</h3>
        </div>
        <div class="col-md-12 pt-3">
          <div class="mt-4 pt-1">
            <label for="workRequest" class="form-label fs-14 fw-400 mb-3">Work Requests</label>
            <textarea class="form-control px-3 border-radius-8 pt-3" rows="4" [(ngModel)]="vehicle.workRequest" required
              minlength="10" maxlength="200" #workRequest="ngModel" placeHolder="Enter Work Request"
              style="line-height: 2;" [ngClass]="{ 'is-invalid': workRequest.errors }"></textarea>
            <div class="invalid-feedback" *ngIf="workRequest.errors">
              <span *ngIf="workRequest.errors['required']">Work Request is required</span>
              <span *ngIf="workRequest.errors['minlength']">Work Request must be at least 10 characters</span>
              <span *ngIf="workRequest.errors['maxlength']">Work Request must be at most 200 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="jobRequestType" data-bs-toggle="tooltip" data-bs-placement="top"
              data-bs-title="Click to go to Configuration" [routerLink]="'/job-request-type'"
              class="form-label fs-14 fw-400 mb-3">Job Request Type </label>

            <select class="form-select h-48 px-3 border-radius-8" name="jobRequestType" required
              #jobRequestType="ngModel" [ngClass]="{ 'is-invalid': jobRequestType.errors }"
              [(ngModel)]="vehicle.jobRequestType">
              <option value="undefined" disabled selected>Select Job Request Type</option>
              <option [value]="jobRequestType.id" *ngFor="let jobRequestType of jobRequestTypes;let i=index;">
                {{jobRequestType.name}}</option>
            </select>
            <div class="invalid-feedback d-block" *ngIf="jobRequestType.errors">
              <span *ngIf="jobRequestType.errors['required']">Job Request Type is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="claimNumber" class="form-label fs-14 fw-400 mb-3">Claim Number</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text" minlength="2" maxlength="200"
              #claimNumber="ngModel" [ngClass]="{ 'is-invalid': claimNumber.errors }"
              placeholder="Enter Claim Number" [(ngModel)]="vehicle.claimNumber" />
            <div class="invalid-feedback" *ngIf="claimNumber.errors">

              <span *ngIf="claimNumber.errors['minlength']">Claim Number must be at least 2 characters</span>
              <span *ngIf="claimNumber.errors['maxlength']">Claim Number must be at most 200 characters</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="price" class="form-label fs-14 fw-400 mb-3">Price</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="number" min="0"
              placeholder="Enter Price" onKeyPress="if(this.value.length==10) return false" required
              #price="ngModel" oninput="if(this.value<0)this.value=this.value * -1"
              [ngClass]="{ 'is-invalid': price.errors }" [(ngModel)]="vehicle.price" />
            <div class="invalid-feedback d-block" *ngIf="price.errors">
              <span *ngIf="price.errors['required']">Price is required</span>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="supplymentPrice" class="form-label fs-14 fw-400 mb-3">Supplement Price</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="number" min="0"
              oninput="if(this.value<0)this.value=this.value * -1" onKeyPress="if(this.value.length==10) return false"
              placeholder="Enter Supplement Price" [(ngModel)]="vehicle.supplymentPrice" />
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="arrivalMode" data-bs-toggle="tooltip" data-bs-placement="top"
              data-bs-title="Click to go to Configuration" [routerLink]="'/arrival-mode'"
              class="form-label fs-14 fw-400 mb-3">Arrival Mode</label>
            <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.inTakeWay">
              <option value="undefined" disabled selected>Select Arrival Mode</option>
              <option [value]="inTakeWay.id" *ngFor="let inTakeWay of inTakeWays;let i=index;">{{inTakeWay.name}}
              </option>
            </select>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="paymentMethod" data-bs-toggle="tooltip" data-bs-title="Click to go to Configuration"
              [routerLink]="'/payment-method'" class="form-label fs-14 fw-400 mb-3">Payment Method</label>
            <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.paymentMethod"
              placeholder="Payment Method">
              <option value="undefined" disabled selected>Select Payment Method</option>
              <option [value]="paymentMethod.id" *ngFor="let paymentMethod of paymentMethods;let i=index;">
                {{paymentMethod.name}}</option>
            </select>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="insuranceCompany" data-bs-toggle="tooltip" data-bs-title="Click to go to Configuration"
              [routerLink]="'/insurance-companies'" class="form-label fs-14 fw-400 mb-3">Insurance Company</label>
            <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.insuranceCompany"
              placeholder="Payment Method">
              <option value="undefined" disabled selected>Select Insurance Company</option>
              <option [value]="insurancer.name" *ngFor="let insurancer of insurancers;let i=index;">{{insurancer.name}}
              </option>
            </select>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="approvalStatus" data-bs-toggle="tooltip" data-bs-title="Click to go to Configuration"
              [routerLink]="'/approval-status'" class="form-label fs-14 fw-400 mb-3">Approval Status</label>
            <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.approvalStatus"
              placeholder="Approval Status">
              <option value="undefined" disabled selected>Select Approval Status</option>
              <option [value]="approvalStatus.id" *ngFor="let approvalStatus of approvalStatuss;let i=index;">
                {{approvalStatus.name}}</option>
            </select>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="Parking" data-bs-toggle="tooltip" data-bs-title="Click to go to Configuration"
              [routerLink]="'/parking-location'" class="form-label fs-14 fw-400 mb-3">Parking</label>
            <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.location" placeholder="Parking">
              <option value="undefined" disabled selected>Select Parking</option>
              <option [value]="location.id" *ngFor="let location of locations;let i=index;">{{location.name}}</option>
            </select>
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="rentalCompany" data-bs-toggle="tooltip" data-bs-title="Click to go to Configuration"
              [routerLink]="'/rental-companies'" class="form-label fs-14 fw-400 mb-3">Rental Company</label>
            <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.loanerCarName"
              placeholder="Rental Company">
              <option value="undefined" disabled selected>Select Rental Company</option>
              <option [value]="rental.name" *ngFor="let rental of rentals;let i=index;">{{rental.name}}</option>
            </select>
          </div>
        </div>
        <div class="col-md-4" *ngIf="vehicle.loanerCarName !=  null && vehicle.loanerCarName !=''">
          <div class="mt-4 pt-1">
            <label for="rentalDueDate" class="form-label fs-14 fw-400 mb-3">Rental Due Date</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="date" placeholder="Rental Due Date"
              (change)="onChangeVehicleCalendarRental($event, vehicle)"
              [ngModel]="vehicle.rentalDate |  date:'yyyy-MM-dd'" />
          </div>
        </div>
        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="targetDate" class="form-label fs-14 fw-400 mb-3">Target Date</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="date" placeholder="Target Date"
              [disabled]="user.allowChangeJobTargetDate == false" (change)="onChangeVehicleCalendar($event, vehicle)"
              [ngModel]="vehicle.targetDate |  date:'yyyy-MM-dd'" />
          </div>
        </div>
        <div class="col-md-4" *ngIf="vehicle.targetDateChangeReason != null && vehicle.targetDateChangeReason != '' ">
          <div class="mt-4 pt-1">
            <label for="reasonChnageDate" class="form-label fs-14 fw-400 mb-3">Reason for Target Date Change</label>
            <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
              placeholder="Reason for Target Date Change" disabled [(ngModel)]="vehicle.targetDateChangeReason" />
          </div>
        </div>

        <div class="col-md-4">
          <div class="mt-4 pt-1">
            <label for="status" data-bs-toggle="tooltip" data-bs-title="Click to go to Configuration"
              [routerLink]="'/vehicle-status'" class="form-label fs-14 fw-400 mb-3">Status</label>
            <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.status" placeholder="status"
              #status [disabled]="user.allowUpdateVehicleStatus == false"
              (change)="onChangeStatus($event, status.value)" placeholder="Status">
              <option value="undefined" disabled selected>Select Status</option>
              <option *ngFor="let option of statuss; let i=index" value="{{option.id}}">{{option.name}}</option>
            </select>
          </div>
        </div>
        <div class="col-md-12">
          <div class="mt-4 pt-1">
            <label for="notesComment" class="form-label fs-14 fw-400 mb-3">Notes</label>
            <textarea trimText class="form-control h-48 px-3 border-radius-8" type="text" maxlength="2000" rows="2"
              style="line-height: 2;" placeholder="Enter Notes" [(ngModel)]="vehicle.comments"></textarea>
          </div>
        </div>
        <div class="col-12 pt-4 mt-2">
          <h3 class="fs-18 fw-500 text-dark">Prior Damage</h3>
        </div>
        <div class="col-md-12">
          <div class="mt-4 pt-1">
            <!-- <label for="priorDamages" class="form-label fs-14 fw-400 mb-3">Prior Damages {{getPriorDamageWordCount()}}
              <small>Words (500 Max)</small></label> -->
            <textarea class="form-control px-3 border-radius-8 pt-3" rows="4" style="line-height: 2;"
              placeholder="Enter All The Prior Damage" [(ngModel)]="vehicle.priorDamage" minlength="10"
              maxlength="2000" #priorDamage="ngModel" [ngClass]="{ 'is-invalid': priorDamage.errors }"
              (keyup.enter)="onSavePriorDamage(vehicle)"></textarea>

            <div class="invalid-feedback" *ngIf="priorDamage.errors">
              <span *ngIf="priorDamage.errors['required']">Prior Damage is required</span>
              <span *ngIf="priorDamage.errors['minlength']">Prior Damage must be at least 10 characters</span>
              <span *ngIf="priorDamage.errors['maxlength']">Prior Damage must be at most 2000 characters</span>
            </div>
          </div>
          <div *ngIf="errorMessageVehicle" class="form-group mt-4">
            <div class="form-group">
              <div class="alert alert-danger fs-13" role="alert">
                {{ errorMessageVehicle }}
              </div>
            </div>
          </div>
          <div *ngIf="successMessageVehicle" class="form-group mt-4">
            <div class="form-group">
              <div class="alert alert-success fs-13" role="alert">
                {{ successMessageVehicle }}
              </div>
            </div>
          </div>
          <div class="d-flex align-items-center gap-3 mt-5">
            <div class="my-5" *ngIf="this.user.allowAddAndUpdateVehicle == true"> <a (click)="createVehicle(vehicle)"
                class="btn btn-primary-abs h-45 px-4 rounded-4 fs-14 fw-600">Save Details</a> </div>
            <div class="my-5" *ngIf="vehicle.id> 0"> <a data-bs-toggle="modal" data-bs-target="#editVehicle"
                class="btn btn-primary-abs h-45 px-4 rounded-4 fs-14 fw-600">View Details</a> </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<div class="modal fade" id="editVehicle" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  *ngIf="vehicle.id> 0" aria-labelledby="editVehicleLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content border-radius-8">
      <div class="modal-header p-4">
        <h1 class="modal-title fs-20 fw-600 text-capitalize" id="editVehicleLabel">{{ vehicle.year }} {{ vehicle.make }}
          {{vehicle.model }} {{ vehicle.color }}</h1>
        <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body py-4 px-2">
        <div class="row">
          <div class="col-12" id="{{vehicle?.id}}" #target_{{vehicle?.id}}
            *ngIf="vehicle.id> 0  && editModeVehicle==false">
            <div class="table-container shadow-sm border-radius-8 border w-100">
              <table class="table-bordered table-striped overflow-hidden border-radius-8 line-height-130 w-100">
                <!-- <tr>
                  <th class="fs-13 w-25 bg-light">Year</th>
                  <td class="fs-13 w-25">{{vehicle.year}}</td>
                  <th class="fs-13 w-25 bg-light">Make</th>
                  <td class="fs-13 w-25">{{vehicle.make}}</td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">Model</th>
                  <td class="fs-13 w-25">{{vehicle.model}}</td>
                  <th class="fs-13 w-25 bg-light">Color</th>
                  <td class="fs-13 w-25" style="background-color: {{vehicle.color}}">{{vehicle.color}}</td>
                </tr> -->
                <tr>
                  <th class="fs-13 w-25 bg-light">Customer Fist/Last Name/Phone</th>
                  <td class="fs-13 w-25" style="word-break: break-word;">{{vehicle.customer.title}}
                    {{vehicle.customer.firstName}}
                    {{vehicle.customer.lastName}} @ {{
                    formatPhoneNumber( vehicle.customer.phone) }}</td>
                  <th class="fs-13 w-25 bg-light">Address</th>
                  <td class="fs-13 w-25" style="word-break: break-word;">{{ vehicle.customer.street
                    }} {{ vehicle.customer.city }} {{ vehicle.customer.state }} {{ vehicle.customer.zip }}
                  </td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">Description</th>
                  <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{vehicle.description}}</td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">R/O</th>
                  <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{ vehicle.workRequest }}</td>
                </tr>

                <tr>
                  <th class="fs-13 w-25 bg-light">Job Request</th>
                  <td class="fs-13 w-25"><ng-container
                      *ngFor="let jobRequestType of jobRequestTypes; let i=index"><ng-container
                        *ngIf="vehicle.jobRequestType==jobRequestType.id"><strong>
                          {{jobRequestType.name}}</strong></ng-container></ng-container></td>
                  <th class="fs-13 w-25 bg-light">Claim Number</th>
                  <td class="fs-13 w-25">{{vehicle.claimNumber}}</td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light"><a href="{{ baseUrlQR + vehicle.token}}" target="_blank">Vehicle
                      Status</a></th>
                  <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                      *ngFor="let option of statuss; let i=index"><strong
                        *ngIf="vehicle.status==option.id">{{option.name}}</strong></ng-container></td>


                  <th class="fs-13 w-25 bg-light">Parking Location</th>
                  <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                      *ngFor="let location of locations; let i=index"><label
                        *ngIf="vehicle.location==location.id">{{location.name}}</label></ng-container></td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">Insurance Company</th>
                  <td class="fs-13 w-25" style="word-break: break-word;">
                    <ng-container *ngIf="vehicle.insuranceCompany != null && vehicle.insuranceCompany !='' && 
                    ! vehicle.insuranceCompany.toLowerCase().includes('cash')">
                      <ng-container *ngFor=" let insurance of this.insurancers">
                        <ng-container *ngIf="insurance.name == vehicle.insuranceCompany"> {{
                          vehicle.insuranceCompany.toUpperCase() }} {{insurance.contactFirstName
                          }} {{ insurance.contactLastName}} - {{ insurance.phone }} </ng-container>
                      </ng-container>
                    </ng-container>
                  </td>
                  <th class="fs-13 w-25 bg-light">Amount</th>
                  <td class="fs-13 w-25">${{ vehicle.price }} - ${{
                    vehicle.supplymentPrice }}</td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">Approval Status</th>
                  <td class="fs-13 w-25" style="word-break: break-word;"><ng-container
                      *ngFor="let approvalStatus of approvalStatuss; let i=index"><label
                        *ngIf="vehicle.approvalStatus==approvalStatus.id">{{approvalStatus.name}}</label></ng-container>
                  </td>
                  <th class="fs-13 w-25 bg-light">Paid Status</th>
                  <td class="fs-13 w-25">
                    <strong class="badge badge-success" *ngIf="vehicle.paid==true"
                      (click)="changePaidStatus(vehicle, false)">Paid</strong>
                    <strong class="badge badge-danger" *ngIf="vehicle.paid==false"
                      (click)="changePaidStatus(vehicle, true)">Not Paid</strong>
                  </td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">Rental Info</th>
                  <td class="fs-13 w-25" style="word-break: break-word;">{{vehicle.rentalDate | date}}
                    <ng-container *ngIf="vehicle.loanerCarName != null && vehicle.loanerCarName !='' ">
                      {{ vehicle.loanerCarName }}
                      - <span *ngIf="vehicle.rentalDate != null "
                        [ngClass]="{ 'text-danger fw-bold': vehicle.rentalCountDown < 0, 'text-black fw-bold': vehicle.rentalCountDown >= 0 }">{{vehicle.rentalCountDown}}
                        Days</span>
                    </ng-container>
                  </td>
                  <th class="fs-13 w-25 bg-light">Target Date</th>
                  <td class="fs-13 w-25">{{ vehicle.targetDate |
                    date}} -

                    <span
                      [ngClass]="{ 'text-danger fw-bold': vehicle.targetDateCountDown < 0, 'text-black fw-bold': vehicle.targetDateCountDown >= 0 }">{{vehicle.targetDateCountDown}}
                      Days</span>

                  </td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">Been</th>
                  <td class="fs-13 w-75" colspan="3">{{ vehicle.createdAt |
                    date}} - <span class="text-danger fw-bold">{{vehicle.daysInShop}} Days</span></td>
                </tr>
                <tr>
                  <th class="fs-13 w-25 bg-light">Notes</th>
                  <td class="fs-13 w-75" colspan="3" style="word-break: break-word;">{{ vehicle.comments }}
                  </td>
                </tr>
                <!-- <tr *ngIf="vehicle.imageModels.length > 0">
                  <td class="fs-13 w-75" colspan="4">
                    <div class="row overflow-x-auto overflow-y-hidden">
                      <div cdkDropList (cdkDropListDropped)="droppedVehicleImage($event)"
                        class="gap-2 images-lists d-flex justify-content-between flex-wrap w-auto transition mt-4">
                        <div *ngFor='let imageModel of vehicle.imageModels; let i=index' cdkDrag
                          class="v-imgs float-start my-2 transition">
                          <img class="preview img-fluid img-thumbnail" width="100%"
                            title="{{imageModel.createdAt| date}}" *ngIf="vehicle.showInSearchImageId != imageModel.id"
                            src="{{baseUrlResizeImage + '/' + imageModel.id}}" (click)="setImage(i)"
                            style="border: 3px solid #555;">
                          <img class="preview img-fluid img-thumbnail" width="100%"
                            title="{{imageModel.createdAt | date }}"
                            *ngIf="vehicle.showInSearchImageId == imageModel.id"
                            src="{{baseUrlResizeImage + '/' + imageModel.id}}" (click)="setImage(i)"
                            title="Show in search" style="border: 3px solid lightcoral;">
                        </div>
                      </div>
                    </div>
                  </td>
                </tr> -->


              </table>
              <a (click)="editModeVehicle =!editModeVehicle; refresh(); setStep(0)" href="javascript:;"
                class="btn btn-primary-abs border-radius-4 h-45 px-4 fs-14 fw-600 mt-2">Edit Details</a>
            </div>
          </div>
          <div class="col-12 px-0">
            <div class="vehicle-form"
              *ngIf="vehicle.id> 0 && editModeVehicle==true && user.allowAddAndUpdateVehicle == true">
              <div class="row">
                <div class="col-12">
                  <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist" *ngIf="currentUser">
                    <li class="nav-item me-3" role="presentation">
                      <button (click)="setStep(3)" class="nav-link active py-3 px-4 rounded-pill fs-13 text-uppercase"
                        id="info-tab" data-bs-toggle="pill" data-bs-target="#info-tabs" type="button" role="tab"
                        aria-controls="info-tabs" aria-selected="true"><i class="fa fa-circle me-2"></i>
                        Information</button>
                    </li>
                    <li class="nav-item me-3" role="presentation">
                      <button (click)="setStep(4)" class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase"
                        id="requests-tab" data-bs-toggle="pill" data-bs-target="#requests-tabs" type="button" role="tab"
                        aria-controls="requests-tabs" aria-selected="false"><i class="fa fa-circle me-2"></i>
                        Requets</button>
                    </li>
                    <li class="nav-item me-3" role="presentation">
                      <button (click)="setStep(1)" class="nav-link py-3 px-4 rounded-pill fs-13 text-uppercase"
                        id="prior-damage" data-bs-toggle="pill" data-bs-target="#prior-damages" type="button" role="tab"
                        aria-controls="prior-damages" aria-selected="false"><i class="fa fa-circle me-2"></i> Prior
                        Damage</button>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="tab-content" id="pills-tabContent">
                <div #taggroup class="tab-pane fade show active" id="info-tabs" role="tabpanel"
                  aria-labelledby="info-tab" tabindex="0">
                  <div class="row pt-1">
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="year" class="form-label fs-14 fw-400 mb-3">Year</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.year"
                          placeholder="Year">
                          <option value="undefined" disabled selected>Select Year</option>
                          <option [value]="option" *ngFor="let option of optionsYear;let i=index;">{{option}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="makeake" class="form-label fs-14 fw-400 mb-3">Make</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.make" #device
                          (change)="onChange($event, device.value)" placeholder="Make">
                          <option value="undefined" disabled selected>Select Make</option>
                          <option [value]="option" *ngFor="let option of optionsMake;let i=index;">{{option}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="model" class="form-label fs-14 fw-400 mb-3">Model</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.model"
                          placeholder="Model">
                          <option value="undefined" disabled selected>Select Model</option>
                          <option [value]="option" *ngFor="let option of optionsModel;let i=index;">{{option}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="color" class="form-label fs-14 fw-400 mb-3">Color</label>
                        <select class="form-select h-48 px-3 border-radius-8 text-capitalize text-shadow text-white"
                          style="background-color: {{vehicle.color}}" [(ngModel)]="vehicle.color" placeholder="Color">
                          <option value="undefined" disabled selected>Select Color</option>
                          <option style="background-color: {{color}}" *ngFor="let color of optionsColor;let i=index;">
                            {{color}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="miles" class="form-label fs-14 fw-400 mb-3">Miles</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Miles"
                          [(ngModel)]="vehicle.miles" />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="Description" class="form-label fs-14 fw-400 mb-3">Description</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                          placeholder="Description" [(ngModel)]="vehicle.description" />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="plate" class="form-label fs-14 fw-400 mb-3">Plate</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Plate"
                          [(ngModel)]="vehicle.plate" />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="vin" class="form-label fs-14 fw-400 mb-3">VIN</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="VIN"
                          [(ngModel)]="vehicle.vin" />
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="mt-4 pt-1">
                        <label for="notesComment" class="form-label fs-14 fw-400 mb-3">Notes / Comments</label>
                        <textarea trimText class="form-control h-48 px-3 border-radius-8" type="text" rows="2"
                          style="line-height: 2;" placeholder="Notes / Comments" maxlength="200"
                          [(ngModel)]="vehicle.comments"></textarea>/>
                      </div>
                    </div>
                  </div>
                </div>
                <div #taggroup class="tab-pane fade" id="requests-tabs" role="tabpanel" aria-labelledby="requests-tab"
                  tabindex="0">
                  <div class="row pt-1">
                    <div class="col-md-12">
                      <div class="mt-4 pt-1">
                        <label for="workRequest" class="form-label fs-14 fw-400 mb-3">Work Requests</label>
                        <textarea class="form-control px-3 border-radius-8 pt-3" rows="4" maxlength="200"
                          style="line-height: 2;" [(ngModel)]="vehicle.workRequest"></textarea>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="jobRequestType" data-bs-toggle="tooltip" data-bs-placement="top"
                          data-bs-dismiss="modal" data-bs-title="Click to go to Configuration"
                          [routerLink]="'/job-request-type'" class="form-label fs-14 fw-400 mb-3">Job Request
                          Type</label><a [routerLink]="'/job-request-type'"></a>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.jobRequestType"
                          placeholder="Job Request Type">
                          <option value="undefined" disabled selected>Select Job Requrest Type</option>
                          <option [value]="jobRequestType.id"
                            *ngFor="let jobRequestType of jobRequestTypes;let i=index;">{{jobRequestType.name}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="claimNumber" class="form-label fs-14 fw-400 mb-3">Claim Number</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                          placeholder="Claim Number" maxlength="50" [(ngModel)]="vehicle.claimNumber" />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="price" class="form-label fs-14 fw-400 mb-3">Price</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="number" placeholder="Price"
                          maxlength="10" onKeyPress="if(this.value.length==10) return false" [(ngModel)]="vehicle.price"
                          pattern="[0-9]" />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="supplymentPrice" class="form-label fs-14 fw-400 mb-3">Supplement Price</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="text" placeholder="Price"
                          maxlength="10" [(ngModel)]="vehicle.supplymentPrice" />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="arrivalMode" class="form-label fs-14 fw-400 mb-3">Arrival Mode</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.inTakeWay"
                          placeholder="Arrival Mode">
                          <option value="undefined" disabled selected>Select Arrival Mode</option>
                          <option [value]="inTakeWay.id" *ngFor="let inTakeWay of inTakeWays;let i=index;">
                            {{inTakeWay.name}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="paymentMethod" class="form-label fs-14 fw-400 mb-3">Payment Method</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.paymentMethod"
                          placeholder="Payment Method">
                          <option value="undefined" disabled selected>Select Payment Method</option>
                          <option [value]="paymentMethod.id" *ngFor="let paymentMethod of paymentMethods;let i=index;">
                            {{paymentMethod.name}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="insuranceCompany" class="form-label fs-14 fw-400 mb-3">Insurance Company</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.insuranceCompany"
                          placeholder="Payment Method">
                          <option value="undefined" disabled selected>Select Insurance Company</option>
                          <option [value]="insurancer.name" *ngFor="let insurancer of insurancers;let i=index;">
                            {{insurancer.name}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="approvalStatus" class="form-label fs-14 fw-400 mb-3">Approval Status</label>
                        <select class="form-select h-48 px-3 border-radius-8"
                          (change)="onChangeApprovalStatus($event, approvalStatus.value)" #approvalStatus
                          [(ngModel)]="vehicle.approvalStatus" placeholder="Approval Status">
                          <option value="undefined" disabled selected>Select Approval Status</option>
                          <option [value]="approvalStatus.id"
                            *ngFor="let approvalStatus of approvalStatuss;let i=index;">{{approvalStatus.name}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="Parking" class="form-label fs-14 fw-400 mb-3">Parking</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.location"
                          placeholder="Parking">
                          <option value="undefined" disabled selected>Select Parking</option>
                          <option [value]="location.id" *ngFor="let location of locations;let i=index;">
                            {{location.name}}</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="rentalCompany" class="form-label fs-14 fw-400 mb-3">Rental Company</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.loanerCarName"
                          placeholder="Rental Company">
                          <option value="undefined" disabled selected>Select Rental Company</option>
                          <option [value]="rental.name" *ngFor="let rental of rentals;let i=index;">{{rental.name}}
                          </option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-4" *ngIf="vehicle.loanerCarName !=  null && vehicle.loanerCarName !=''">
                      <div class="mt-4 pt-1">
                        <label for="rentalDueDate" class="form-label fs-14 fw-400 mb-3">Rental Due Date</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="date"
                          placeholder="Rental Due Date" (change)="onChangeVehicleCalendarRental($event, vehicle)"
                          [ngModel]="vehicle.rentalDate |  date:'yyyy-MM-dd'" />
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="targetDate" class="form-label fs-14 fw-400 mb-3">Target Date</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="date"
                          placeholder="Target Date" [disabled]="user.allowChangeJobTargetDate == false"
                          (change)="onChangeVehicleCalendar($event, vehicle)"
                          [ngModel]="vehicle.targetDate |  date:'yyyy-MM-dd'" />
                      </div>
                    </div>
                    <div class="col-md-4"
                      *ngIf="vehicle.targetDateChangeReason != null && vehicle.targetDateChangeReason != '' ">
                      <div class="mt-4 pt-1">
                        <label for="reasonChnageDate" class="form-label fs-14 fw-400 mb-3">Reason for Target Date
                          Change</label>
                        <input trimText class="form-control h-48 px-3 border-radius-8" type="text"
                          placeholder="Reason for Target Date Change" disabled
                          [(ngModel)]="vehicle.targetDateChangeReason" />
                      </div>
                    </div>

                    <div class="col-md-4">
                      <div class="mt-4 pt-1">
                        <label for="status" class="form-label fs-14 fw-400 mb-3">Status</label>
                        <select class="form-select h-48 px-3 border-radius-8" [(ngModel)]="vehicle.status"
                          placeholder="status" #status [disabled]="user.allowUpdateVehicleStatus == false"
                          (change)="onChangeStatus($event, status.value)" placeholder="Status">
                          <option value="undefined" disabled selected>Select Status</option>
                          <option *ngFor="let option of statuss; let i=index" value="{{option.id}}">{{option.name}}
                          </option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
                <div #taggroup class="tab-pane fade" id="prior-damages" role="tabpanel" aria-labelledby="prior-damage"
                  tabindex="0">
                  <div class="row pt-1">
                    <div class="col-md-12">
                      <div class="mt-4 pt-1">
                        <label for="priorDamages" class="form-label fs-14 fw-400 mb-3">Prior Damages
                          {{getPriorDamageWordCount()}} <small>Words (500 Max)</small></label>
                        <textarea class="form-control px-3 border-radius-8 pt-3" rows="4" maxlength="500"
                          style="line-height: 2;" [(ngModel)]="vehicle.priorDamage"
                          (keyup.enter)="onSavePriorDamage(vehicle)"></textarea>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-flex align-items-center gap-3 mt-5 px-3" (click)="editModeVehicle=!editModeVehicle"> <a
                  *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                  (click)="createVehicle(vehicle); editModeVehicle=!editModeVehicle;" href="javascript:;"
                  class="btn btn-primary-abs h-45 px-4 rounded-4 fs-14 fw-600">Save Details</a> <a
                  *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                  (click)="printPage('print-content-vehicle','vehicle'); editModeVehicle=!editModeVehicle;"
                  href="javascript:;" class="btn btn-secondary-abs h-45 px-4 rounded-4 fs-14 fw-600">Print It</a> <a
                  *ngIf="user.allowAddAndUpdateVehicle == true && vehicle.id>0"
                  (click)="special(vehicle); editModeVehicle=!editModeVehicle;" href="javascript:;"
                  class="btn btn-secondary h-45 px-4 rounded-4 fs-14 fw-600">VIP</a> </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="myAccount" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="myAccountLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content border-radius-8">
      <div class="modal-header p-4">
        <h1 class="modal-title fs-20 fw-600 text-capitalize" id="myAccountLabel">My Account</h1>
        <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body px-2" *ngIf="currentUser">
        <form *ngIf="!isSuccessful" name="form" (ngSubmit)="f.form.valid && onSubmit()" #f="ngForm" novalidate>
          <div class="row">
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="title" class="form-label fs-14 fw-400 mb-3">Account Type</label>
                <select class="form-select h-48 px-3 border-radius-8" name="role" #type="ngModel" size="1" style=" appearance: none;
                background-image: url('');" [(ngModel)]="form.role" required disabled
                  [ngClass]="{ 'is-invalid': f.submitted && type.errors }">
                  <option value="ROLE_USER" selected>Employee</option>
                  <option value="ROLE_SHOP">Auto Shop</option>
                  <option value="ROLE_ADMIN">Admin</option>
                </select>
              </div>
            </div>
            <div class="col-md-4" *ngIf="form.role == 'ROLE_SHOP' || form.role == 'ROLE_RECYCLER' ">
              <div class="mt-4 pt-1">
                <label for="bussnessName" class="form-label fs-14 fw-400 mb-3">Business/Company Name</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" name="bussinessname"
                  [(ngModel)]="form.bussinessname" required minlength="5" maxlength="200" #bussinessname="ngModel"
                  placeHolder="Enter Business/Company Name"
                  [ngClass]="{ 'is-invalid': f.submitted && bussinessname.errors }" />
                <div class="invalid-feedback" *ngIf="bussinessname.errors && f.submitted">
                  <span *ngIf="bussinessname.errors['required']">Business Name is required</span>
                  <span *ngIf="bussinessname.errors['minlength']">Business Name must be at least 5 characters</span>
                  <span *ngIf="bussinessname.errors['maxlength']">Business Name must be at most 200 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="firstName" class="form-label fs-14 fw-400 mb-3">First Name</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" type="text" name="firstName"
                  [(ngModel)]="form.firstName" required minlength="2" maxlength="20" #firstName="ngModel"
                  [ngClass]="{ 'is-invalid': f.submitted && firstName.errors }"
                  placeholder="Enter Your First Name" />
                <div class="invalid-feedback" *ngIf="firstName.errors && f.submitted">
                  <span *ngIf="firstName.errors['required']">First Name is required</span>
                  <span *ngIf="firstName.errors['minlength']">First Name must be at least 2 characters</span>
                  <span *ngIf="firstName.errors['maxlength']">First Name must be at most 20 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="lastName" class="form-label fs-14 fw-400 mb-3">Last Name</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" type="text" name="lastName"
                  [(ngModel)]="form.lastName" required minlength="2" maxlength="20" #lastName="ngModel"
                  [ngClass]="{ 'is-invalid': f.submitted && lastName.errors }"
                  placeholder="Enter Your Last Name" />
                <div class="invalid-feedback" *ngIf="lastName.errors && f.submitted">
                  <span *ngIf="lastName.errors['required']">Last Name is required</span>
                  <span *ngIf="lastName.errors['minlength']">Last Name must be at least 2 characters</span>
                  <span *ngIf="lastName.errors['maxlength']">Last Name must be at most 20 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="email" class="form-label fs-14 fw-400 mb-3">Email</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" name="email" [(ngModel)]="form.email"
                  required email #email="ngModel" [ngClass]="{ 'is-invalid': f.submitted && email.errors }"
                  pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$" maxlength="100"
                  placeholder="Enter Your Email Address" />
                <div class="invalid-feedback" *ngIf="email.errors && f.submitted">
                  <span *ngIf="email.errors['required']">Email is required</span>
                  <span *ngIf="email.errors['email']">Email must be a valid email</span>
                  <span *ngIf="email.errors['pattern']">Email must be a valid email</span>
                  <span *ngIf="email.errors['maxlength']">Email must be at most 100 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="phone" class="form-label fs-14 fw-400 mb-3">Phone</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" name="phone" [(ngModel)]="form.phone"
                  required maxlength="20" #phone="ngModel" type="text"
                  [ngClass]="{ 'is-invalid': f.submitted && phone.errors }" pattern="^[-+()0-9]{10,12}(?:-\d+)?$"
                  placeholder="Enter Your Phone Number" />
                <div class="invalid-feedback" *ngIf="phone.errors && f.submitted">
                  <span *ngIf="phone.errors['required']">Phone is required</span>
                  <span *ngIf="phone.errors['pattern']">Phone must be a valid phone number</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="street" class="form-label fs-14 fw-400 mb-3">Street</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" name="street" [(ngModel)]="form.street"
                  required minlength="2" maxlength="200" #street="ngModel"
                  [ngClass]="{ 'is-invalid': f.submitted && street.errors }" placeholder="Enter Your Street" />
                <div class="invalid-feedback" *ngIf="street.errors && f.submitted">
                  <span *ngIf="street.errors['required']">Street is required</span>
                  <span *ngIf="street.errors['minlength']">Street must be at least 2 characters</span>
                  <span *ngIf="street.errors['maxlength']">Street must be at most 200 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="city" class="form-label fs-14 fw-400 mb-3">City</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" name="city" [(ngModel)]="form.city"
                  required minlength="2" maxlength="200" #city="ngModel"
                  [ngClass]="{ 'is-invalid': f.submitted && city.errors }" placeholder="Enter Your City" />
                <div class="invalid-feedback" *ngIf="city.errors && f.submitted">
                  <span *ngIf="city.errors['required']">City is required</span>
                  <span *ngIf="city.errors['minlength']">City must be at least 2 characters</span>
                  <span *ngIf="city.errors['maxlength']">City must be at most 200 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="state" class="form-label fs-14 fw-400 mb-3">State</label>
                <select class="form-select h-48 px-3 border-radius-8" name="state" #state="ngModel" size="1" required
                  [(ngModel)]="form.state" [ngClass]="{ 'is-invalid': f.submitted && state.errors }">
                  <option value="AL">Alabama</option>
                  <option value="AK">Alaska</option>
                  <option value="AZ">Arizona</option>
                  <option value="AR">Arkansas</option>
                  <option value="CA">California</option>
                  <option value="CO">Colorado</option>
                  <option value="CT">Connecticut</option>
                  <option value="DE">Delaware</option>
                  <option value="DC">District Of Columbia</option>
                  <option value="FL">Florida</option>
                  <option value="GA">Georgia</option>
                  <option value="HI">Hawaii</option>
                  <option value="ID">Idaho</option>
                  <option value="IL">Illinois</option>
                  <option value="IN">Indiana</option>
                  <option value="IA">Iowa</option>
                  <option value="KS">Kansas</option>
                  <option value="KY">Kentucky</option>
                  <option value="LA">Louisiana</option>
                  <option value="ME">Maine</option>
                  <option value="MD">Maryland</option>
                  <option value="MA">Massachusetts</option>
                  <option value="MI">Michigan</option>
                  <option value="MN">Minnesota</option>
                  <option value="MS">Mississippi</option>
                  <option value="MO">Missouri</option>
                  <option value="MT">Montana</option>
                  <option value="NE">Nebraska</option>
                  <option value="NV">Nevada</option>
                  <option value="NH">New Hampshire</option>
                  <option value="NJ">New Jersey</option>
                  <option value="NM">New Mexico</option>
                  <option value="NY">New York</option>
                  <option value="NC">North Carolina</option>
                  <option value="ND">North Dakota</option>
                  <option value="OH">Ohio</option>
                  <option value="OK">Oklahoma</option>
                  <option value="OR">Oregon</option>
                  <option value="PA">Pennsylvania</option>
                  <option value="RI">Rhode Island</option>
                  <option value="SC">South Carolina</option>
                  <option value="SD">South Dakota</option>
                  <option value="TN">Tennessee</option>
                  <option value="TX">Texas</option>
                  <option value="UT">Utah</option>
                  <option value="VT">Vermont</option>
                  <option value="VA">Virginia</option>
                  <option value="WA">Washington</option>
                  <option value="WV">West Virginia</option>
                  <option value="WI">Wisconsin</option>
                  <option value="WY">Wyoming</option>
                </select>
                <div class="invalid-feedback d-block" *ngIf="state.errors && f.submitted">
                  <span *ngIf="state.errors['required']">State is required</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="zip" class="form-label fs-14 fw-400 mb-3">Zip Code</label>
                <input trimText class="form-control h-48 px-3 border-radius-8" pattern="[0-9]*" name="zip"
                  [(ngModel)]="form.zip" maxlength="20" required minlength="5" maxlength="20" #zip="ngModel"
                  [ngClass]="{ 'is-invalid': f.submitted && zip.errors }" placeholder="Enter Your Zip Code" />
                <div class="invalid-feedback" *ngIf="zip.errors && f.submitted">
                  <span *ngIf="zip.errors['required']">Zip Code is required</span>
                  <span *ngIf="zip.errors['pattern']">Must be a valid Zip Code</span>
                </div>
              </div>
            </div>
            <div class="col-md-12 mt-4">
              <div *ngIf="f.submitted && isUpdateFailed">
                <span *ngIf="errorMessageProfile" class="alert alert-danger" role="alert">Update failed: {{
                  errorMessageProfile
                  }}</span>
              </div>
            </div>
          </div>
          <div class="d-flex align-items-center gap-3 mt-5 px-3" *ngIf="currentUser">
            <button class="btn btn-primary-abs h-45 px-4 rounded-4 fs-14 fw-600">Update Account</button>
          </div>
        </form>
        <div *ngIf="isSuccessful" class="p-4">
          <span class="alert alert-success" role="alert">Your update is successful! <button
              class="btn btn-sm btn-primary-abs ms-3" (click)="reload()">Ok</button></span>
        </div>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="resetPassword" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="resetPasswordLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content border-radius-8">
      <div class="modal-header p-4">
        <h1 class="modal-title fs-20 fw-600 text-capitalize" id="resetPasswordLabel">Reset Password</h1>
        <button type="button" class="btn-close mt-1" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body px-2" *ngIf="currentUser">
        <form name="form" (ngSubmit)="f.form.valid && changePasswordRequest()" #f="ngForm" novalidate>
          <div class="row">
            <div class="col-md-4" *ngIf="form.role == 'ROLE_SHOP' || form.role == 'ROLE_RECYCLER' ">
              <div class="mt-4 pt-1">
                <label for="password" class="form-label fs-14 fw-400 mb-3">Old Password</label>
                <div class="input-group">
                  <input trimText class="form-control h-48 px-3" [type]="showPassword ? 'text' : 'password'"
                    name="password" [(ngModel)]="form.password" required minlength="6" #password="ngModel"
                    maxlength="30" [ngClass]="{ 'is-invalid': f.submitted && password.errors }"
                    placeholder="Enter Your Old Password" />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary" type="button"> <i alt="show" class="far fa-eye eye-show"
                        (click)="showPassword = !showPassword" [class.hide]="showPassword"></i>
                      <i alt="hide" class="far fa-eye-slash eye-hide" (click)="showPassword = !showPassword"
                        [class.hide]="!showPassword"></i></button>
                  </div>
                </div>
                <div class="invalid-feedback" *ngIf="password.errors && f.submitted">
                  <span *ngIf="password.errors['required']">Password is required</span>
                  <span *ngIf="password.errors['minlength']">Password must be at least 6 characters</span>
                  <span *ngIf="password.errors['maxlength']">Password must be at most 30 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="newPassword" class="form-label fs-14 fw-400 mb-3">New Password</label>
                <div class="input-group">
                  <input trimText class="form-control h-48 px-3" [type]="showPasswordNew ? 'text' : 'password'"
                    name="newPassword" [(ngModel)]="form.newPassword" required minlength="6" #newPassword="ngModel"
                    maxlength="30" [ngClass]="{ 'is-invalid': f.submitted && newPassword.errors }"
                    placeholder="Enter Your New Password" />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary" type="button"> <i alt="show" class="far fa-eye eye-show"
                        (click)="showPasswordNew = !showPasswordNew" [class.hide]="showPasswordNew"></i>
                      <i alt="hide" class="far fa-eye-slash eye-hide" (click)="showPasswordNew = !showPasswordNew"
                        [class.hide]="!showPasswordNew"></i></button>
                  </div>
                </div>
                <div class="invalid-feedback" *ngIf="newPassword.errors && f.submitted">
                  <span *ngIf="newPassword.errors['required']">New Password is required</span>
                  <span *ngIf="newPassword.errors['minlength']">New Password must be at least 6 characters</span>
                  <span *ngIf="newPassword.errors['maxlength']">New Password must be at most 30 characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="mt-4 pt-1">
                <label for="newPasswordComfirmed" class="form-label fs-14 fw-400 mb-3">Confirm New Password</label>
                <div class="input-group">
                  <input trimText class="form-control h-48 px-3" [type]="showPaswordNewConfirmed ? 'text' : 'password'"
                    name="passwordNew" [(ngModel)]="form.newPasswordComfirmed" required minlength="6"
                    #newPasswordComfirmed="ngModel" maxlength="30"
                    [ngClass]="{ 'is-invalid': f.submitted && newPasswordComfirmed.errors }"
                    placeholder="Please Re-Type Your New Password" />
                  <div class="input-group-append">
                    <button class="btn btn-outline-secondary" type="button"> <i alt="show" class="far fa-eye eye-show"
                        (click)="showPaswordNewConfirmed = !showPaswordNewConfirmed"
                        [class.hide]="showPaswordNewConfirmed"></i>
                      <i alt="hide" class="far fa-eye-slash eye-hide"
                        (click)="showPaswordNewConfirmed = !showPaswordNewConfirmed"
                        [class.hide]="!showPaswordNewConfirmed"></i></button>
                  </div>
                </div>
                <div class="invalid-feedback" *ngIf="newPasswordComfirmed.errors && f.submitted">
                  <span *ngIf="newPasswordComfirmed.errors['required']">Confirm New Password is required</span>
                  <span *ngIf="newPasswordComfirmed.errors['minlength']">Confirm New Password must be at least 6
                    characters</span>
                  <span *ngIf="newPasswordComfirmed.errors['maxlength']">Confirm New Password must be at most 30
                    characters</span>
                </div>
              </div>
            </div>
            <div class="col-md-12 py-4 mt-4" *ngIf="errorMessageResetPassword != ''">
              <span class="alert alert-success line-height-150" role="alert">{{errorMessageResetPassword}}</span>
            </div>
          </div>
          <div class="d-flex align-items-center gap-3 mt-4 px-3" *ngIf="currentUser">
            <button class="btn btn-primary-abs h-45 px-4 rounded-4 fs-14 fw-600">Reset Password</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>